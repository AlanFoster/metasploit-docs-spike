{
  "name": "Authentication Capture: MSSQL",
  "fullname": "auxiliary/server/capture/mssql",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "auxiliary",
  "author": [
    "Patrik Karlsson <patrik@cqure.net>"
  ],
  "description": "This module provides a fake MSSQL service that\n      is designed to capture authentication credentials. The modules\n      supports both the weak encoded database logins as well as Windows\n      logins (NTLM).",
  "references": [

  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/server/capture/mssql.rb",
  "ref_name": "server/capture/mssql",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "address",
      "name": "SRVHOST",
      "required": true,
      "default": "0.0.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."
    },
    {
      "type": "port",
      "name": "SRVPORT",
      "required": true,
      "default": 1433,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local port to listen on."
    },
    {
      "type": "string",
      "name": "ListenerComm",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The specific communication channel to use for this service"
    },
    {
      "type": "bool",
      "name": "SSLCompression",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSL/TLS-level compression"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maximum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "SMBServerMaximumBuffer",
      "required": true,
      "default": 2,
      "aliases": [

      ],
      "advanced": true,
      "description": "The maximum number of data in megabytes to buffer"
    },
    {
      "type": "integer",
      "name": "SMBServerIdleTimeout",
      "required": true,
      "default": 120,
      "aliases": [

      ],
      "advanced": true,
      "description": "The maximum amount of time to keep an idle session open in seconds"
    },
    {
      "type": "string",
      "name": "CAINPWFILE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local filename to store the hashes in Cain&Abel format"
    },
    {
      "type": "string",
      "name": "JOHNPWFILE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The prefix to the local filename to store the hashes in JOHN format"
    },
    {
      "type": "string",
      "name": "CHALLENGE",
      "required": true,
      "default": "1122334455667788",
      "aliases": [

      ],
      "advanced": false,
      "description": "The 8 byte challenge "
    },
    {
      "type": "bool",
      "name": "SMB_EXTENDED_SECURITY",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use smb extended security negociation, when set client will use ntlmssp, if not then client will use classic lanman authentification"
    },
    {
      "type": "string",
      "name": "DOMAIN_NAME",
      "required": true,
      "default": "anonymous",
      "aliases": [

      ],
      "advanced": true,
      "description": "The domain name used during smb exchange with smb extended security set "
    }
  ]
}