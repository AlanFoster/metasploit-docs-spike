{
  "name": "Nuuo Central Management Server User Session Token Bruteforce",
  "fullname": "auxiliary/gather/nuuo_cms_bruteforce",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2018-10-11",
  "type": "auxiliary",
  "author": [
    "Pedro Ribeiro <pedrib@gmail.com>"
  ],
  "description": "Nuuo Central Management Server below version 2.4 has a flaw where it sends the\n        heap address of the user object instead of a real session number when a user logs\n        in. This can be used to reduce the keyspace for the session number from 10 million\n        to 1.2 million, and with a bit of analysis it can be guessed in less than 500k tries.\n        This module does exactly that - it uses a computed occurence table to try the most common\n        combinations up to 1.2 million to try to guess a valid user session.\n        This session number can then be used to achieve code execution or download files - see\n        the other Nuuo CMS auxiliary and exploit modules.\n        Note that for this to work a user has to be logged into the system.",
  "references": [
    "https://cvedetails.com/cve/CVE-2018-17888/",
    "https://ics-cert.us-cert.gov/advisories/ICSA-18-284-02",
    "https://seclists.org/fulldisclosure/2019/Jan/51",
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/nuuo-cms-ownage.txt"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/gather/nuuo_cms_bruteforce.rb",
  "ref_name": "gather/nuuo_cms_bruteforce",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 5180,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "NCSSESSION",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Session number of logged in user"
    },
    {
      "type": "string",
      "name": "NCSUSER",
      "required": false,
      "default": "admin",
      "aliases": [

      ],
      "advanced": false,
      "description": "NUUO Central Management System username"
    },
    {
      "type": "string",
      "name": "NCSPASS",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for NCSUSER"
    },
    {
      "type": "string",
      "name": "NCSVERSION",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Version header used during login"
    },
    {
      "type": "bool",
      "name": "NCSBRUTEAPI",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Bruteforce Version header used during login"
    },
    {
      "type": "bool",
      "name": "NCSTRACE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Show NCS requests and responses"
    }
  ]
}