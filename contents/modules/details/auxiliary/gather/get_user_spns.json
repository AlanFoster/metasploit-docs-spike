{
  "name": "Gather Ticket Granting Service (TGS) tickets for User Service Principal Names (SPN)",
  "fullname": "auxiliary/gather/get_user_spns",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2014-09-27",
  "type": "auxiliary",
  "author": [
    "Alberto Solino",
    "Jacob Robles"
  ],
  "description": "This module will try to find Service Principal Names that are associated with normal user accounts.\n        Since normal accounts' passwords tend to be shorter than machine accounts, and knowing that a TGS request\n        will encrypt the ticket with the account the SPN is running under, this could be used for an offline\n        bruteforcing attack of the SPNs account NTLM hash if we can gather valid TGS for those SPNs.\n        This is part of the kerberoast attack research by Tim Medin (@timmedin).",
  "references": [
    "https://github.com/CoreSecurity/impacket/blob/master/examples/GetUserSPNs.py",
    "https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/gather/get_user_spns.py",
  "ref_name": "gather/get_user_spns",
  "check": false,
  "post_auth": true,
  "default_credential": false,
  "notes": {
    "AKA": [
      "GetUserSPNs.py",
      "Kerberoast"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of concurrent threads (max one per host)"
    },
    {
      "type": "bool",
      "name": "ShowProgress",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Display progress messages during a scan"
    },
    {
      "type": "integer",
      "name": "ShowProgressPercent",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "The interval in percent that progress should be shown"
    },
    {
      "type": "string",
      "name": "domain",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target Active Directory domain"
    },
    {
      "type": "string",
      "name": "pass",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for the domain user account"
    },
    {
      "type": "string",
      "name": "user",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Username for a domain account"
    }
  ]
}