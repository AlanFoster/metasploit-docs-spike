{
  "name": "MS14-068 Microsoft Kerberos Checksum Validation Vulnerability",
  "fullname": "auxiliary/admin/kerberos/ms14_068_kerberos_checksum",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2014-11-18",
  "type": "auxiliary",
  "author": [
    "Tom Maddock",
    "Sylvain Monne",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability in the Microsoft Kerberos implementation. The problem\n        exists in the verification of the Privilege Attribute Certificate (PAC) from a Kerberos TGS\n        request, where a domain user may forge a PAC with arbitrary privileges, including\n        Domain Administrator. This module requests a TGT ticket with a forged PAC and exports it to\n        a MIT Kerberos Credential Cache file. It can be loaded on Windows systems with the Mimikatz\n        help. It has been tested successfully on Windows 2008.",
  "references": [
    "https://cvedetails.com/cve/CVE-2014-6324/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2014/MS14-068",
    "OSVDB (114751)",
    "http://blogs.technet.com/b/srd/archive/2014/11/18/additional-information-about-cve-2014-6324.aspx",
    "https://labs.mwrinfosecurity.com/blog/2014/12/16/digging-into-ms14-068-exploitation-and-defence/",
    "https://github.com/bidord/pykek",
    "https://blog.rapid7.com/2014/12/25/12-days-of-haxmas-ms14-068-now-in-metasploit"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/admin/kerberos/ms14_068_kerberos_checksum.rb",
  "ref_name": "admin/kerberos/ms14_068_kerberos_checksum",
  "check": false,
  "post_auth": true,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 88,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "integer",
      "name": "Timeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": false,
      "description": "The TCP timeout to establish connection and read data"
    },
    {
      "type": "string",
      "name": "USER",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The Domain User"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The Domain User password"
    },
    {
      "type": "string",
      "name": "DOMAIN",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The Domain (upper case) Ex: DEMO.LOCAL"
    },
    {
      "type": "string",
      "name": "USER_SID",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The Domain User SID, Ex: S-1-5-21-1755879683-3641577184-3486455962-1000"
    }
  ]
}