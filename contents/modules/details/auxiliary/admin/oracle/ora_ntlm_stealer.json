{
  "name": "Oracle SMB Relay Code Execution",
  "fullname": "auxiliary/admin/oracle/ora_ntlm_stealer",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2009-04-07",
  "type": "auxiliary",
  "author": [
    "Sh2kerr <research[ad]dsecrg.com>"
  ],
  "description": "This module will help you to get Administrator access to OS using an unprivileged\n        Oracle database user (you need only CONNECT and RESOURCE privileges).\n        To do this you must firstly run smb_sniffer or smb_relay module on your sever.\n        Then you must connect to Oracle database and run this module Ora_NTLM_stealer.rb\n        which will connect to your SMB sever with credentials of Oracle RDBMS.\n        So if smb_relay is working, you will get Administrator access to server which\n        runs Oracle. If not than you can decrypt HALFLM hash.",
  "references": [
    "http://dsecrg.com/pages/pub/show.php?id=17"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/admin/oracle/ora_ntlm_stealer.rb",
  "ref_name": "admin/oracle/ora_ntlm_stealer",
  "check": false,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "string",
      "name": "RHOST",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "The Oracle host."
    },
    {
      "type": "string",
      "name": "RPORT",
      "required": true,
      "default": "1521",
      "aliases": [

      ],
      "advanced": false,
      "description": "The TNS port."
    },
    {
      "type": "string",
      "name": "SID",
      "required": true,
      "default": "ORCL",
      "aliases": [

      ],
      "advanced": false,
      "description": "The sid to authenticate with."
    },
    {
      "type": "string",
      "name": "DBUSER",
      "required": true,
      "default": "SCOTT",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to authenticate with."
    },
    {
      "type": "string",
      "name": "DBPASS",
      "required": true,
      "default": "TIGER",
      "aliases": [

      ],
      "advanced": false,
      "description": "The password to authenticate with."
    },
    {
      "type": "string",
      "name": "IP",
      "required": false,
      "default": "0.0.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "IP address of SMB proxy."
    }
  ]
}