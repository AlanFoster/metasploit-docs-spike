{
  "name": "HP Data Protector 6.1 EXEC_CMD Command Execution",
  "fullname": "auxiliary/admin/hp/hp_data_protector_cmd",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2011-02-07",
  "type": "auxiliary",
  "author": [
    "ch0ks",
    "c4an",
    "wireghoul",
    "sinn3r <sinn3r@metasploit.com>"
  ],
  "description": "This module exploits HP Data Protector's omniinet process, specifically\n        against a Windows setup.\n\n        When an EXEC_CMD packet is sent, omniinet.exe will attempt to look\n        for that user-supplied filename with kernel32!FindFirstFileW().  If the file\n        is found, the process will then go ahead execute it with CreateProcess()\n        under a new thread.  If the filename isn't found, FindFirstFileW() will throw\n        an error (0x03), and then bails early without triggering CreateProcess().\n\n        Because of these behaviors, if you try to supply an argument, FindFirstFileW()\n        will look at that as part of the filename, and then bail.\n\n        Please note that when you specify the 'CMD' option, the base path begins\n        under C:\\.",
  "references": [
    "https://cvedetails.com/cve/CVE-2011-0923/",
    "OSVDB (72526)",
    "http://www.zerodayinitiative.com/advisories/ZDI-11-055",
    "http://hackarandas.com/blog/2011/08/04/hp-data-protector-remote-shell-for-hpux"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/admin/hp/hp_data_protector_cmd.rb",
  "ref_name": "admin/hp/hp_data_protector_cmd",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 5555,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "CMD",
      "required": true,
      "default": "Windows\\System32\\calc.exe",
      "aliases": [

      ],
      "advanced": false,
      "description": "File to execute"
    }
  ]
}