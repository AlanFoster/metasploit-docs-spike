{
  "name": "Moxa Device Credential Retrieval",
  "fullname": "auxiliary/admin/scada/moxa_credentials_recovery",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2015-07-28",
  "type": "auxiliary",
  "author": [
    "Patrick DeSantis <p@t-r10t.com>",
    "K. Reid Wightman <reid@revics-security.com>"
  ],
  "description": "The Moxa protocol listens on 4800/UDP and will respond to broadcast\n        or direct traffic.  The service is known to be used on Moxa devices\n        in the NPort, OnCell, and MGate product lines.  Many devices with\n        firmware versions older than 2017 or late 2016 allow admin credentials\n        and SNMP read and read/write community strings to be retrieved without\n        authentication.\n\n        This module is the work of Patrick DeSantis of Cisco Talos and K. Reid\n        Wightman.\n\n        Tested on: Moxa NPort 6250 firmware v1.13, MGate MB3170 firmware 2.5,\n        and NPort 5110 firmware 2.6.",
  "references": [
    "https://cvedetails.com/cve/CVE-2016-9361/",
    "http://www.securityfocus.com/bid/85965",
    "https://www.digitalbond.com/blog/2016/10/25/serial-killers/",
    "https://github.com/reidmefirst/MoxaPass/blob/master/moxa_getpass.py",
    "https://ics-cert.us-cert.gov/advisories/ICSA-16-336-02"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/admin/scada/moxa_credentials_recovery.rb",
  "ref_name": "admin/scada/moxa_credentials_recovery",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 4800,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "enum",
      "name": "FUNCTION",
      "required": true,
      "default": "CREDS",
      "aliases": [

      ],
      "advanced": false,
      "description": "Pull credentials or enumerate all function codes (Accepted: CREDS, ENUM)"
    }
  ]
}