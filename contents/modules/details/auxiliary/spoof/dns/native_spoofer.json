{
  "name": "Native DNS Spoofer (Example)",
  "fullname": "auxiliary/spoof/dns/native_spoofer",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "auxiliary",
  "author": [
    "RageLtMan <rageltman@sempervictus>"
  ],
  "description": "This module provides a Rex based DNS service to resolve queries intercepted\n        via the capture mixin. Configure STATIC_ENTRIES to contain host-name mappings\n        desired for spoofing using a hostsfile or space/semicolon separated entries.\n        In default configuration, the service operates as a normal native DNS server\n        with the exception of consuming from and writing to the wire as opposed to a\n        listening socket. Best when compromising routers or spoofing L2 in order to\n        prevent return of the real reply which causes a race condition. The method\n        by which replies are filtered is up to the user (though iptables works fine).",
  "references": [

  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [
    53
  ],
  "autofilter_services": [
    "dns"
  ],
  "targets": null,
  "path": "/modules/auxiliary/spoof/dns/native_spoofer.rb",
  "ref_name": "spoof/dns/native_spoofer",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "string",
      "name": "INTERFACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The name of the interface"
    },
    {
      "type": "string",
      "name": "FILTER",
      "required": false,
      "default": "dst port 53",
      "aliases": [

      ],
      "advanced": false,
      "description": "The filter string for capturing traffic"
    },
    {
      "type": "integer",
      "name": "SNAPLEN",
      "required": true,
      "default": 65535,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of bytes to capture"
    },
    {
      "type": "integer",
      "name": "TIMEOUT",
      "required": true,
      "default": 500,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of seconds to wait for new data"
    },
    {
      "type": "integer",
      "name": "SECRET",
      "required": true,
      "default": 1297303073,
      "aliases": [

      ],
      "advanced": true,
      "description": "A 32-bit cookie for probe requests."
    },
    {
      "type": "address",
      "name": "GATEWAY_PROBE_HOST",
      "required": true,
      "default": "8.8.8.8",
      "aliases": [

      ],
      "advanced": true,
      "description": "Send a TTL=1 random UDP datagram to this host to discover the default gateway's MAC"
    },
    {
      "type": "port",
      "name": "GATEWAY_PROBE_PORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The port on GATEWAY_PROBE_HOST to send a random UDP probe to (random if 0 or unset)"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 53,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "DOMAIN",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target domain name"
    },
    {
      "type": "string",
      "name": "NS",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specify the nameservers to use for queries, space separated"
    },
    {
      "type": "string",
      "name": "SEARCHLIST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "DNS domain search list, comma separated"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "Number of threads to use in threaded queries"
    },
    {
      "type": "string",
      "name": "DnsClientDefaultNS",
      "required": false,
      "default": "8.8.8.8 8.8.4.4",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the default to use for queries, space separated"
    },
    {
      "type": "integer",
      "name": "DnsClientRetry",
      "required": false,
      "default": 2,
      "aliases": [

      ],
      "advanced": true,
      "description": "Number of times to try to resolve a record if no response is received"
    },
    {
      "type": "integer",
      "name": "DnsClientRetryInterval",
      "required": false,
      "default": 2,
      "aliases": [

      ],
      "advanced": true,
      "description": "Number of seconds to wait before doing a retry"
    },
    {
      "type": "bool",
      "name": "DnsClientReportARecords",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Add hosts found via BRT and RVL to DB"
    },
    {
      "type": "bool",
      "name": "DnsClientRVLExistingOnly",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Only perform lookups on hosts in DB"
    },
    {
      "type": "bool",
      "name": "DnsClientTcpDns",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Run queries over TCP"
    },
    {
      "type": "path",
      "name": "DnsClientResolvconf",
      "required": true,
      "default": "/dev/null",
      "aliases": [

      ],
      "advanced": true,
      "description": "Resolvconf formatted configuration file to use for Resolver"
    },
    {
      "type": "address",
      "name": "SRVHOST",
      "required": true,
      "default": "127.0.2.2",
      "aliases": [

      ],
      "advanced": false,
      "description": "The local host to listen on for DNS services."
    },
    {
      "type": "port",
      "name": "SRVPORT",
      "required": true,
      "default": 53,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local port to listen on."
    },
    {
      "type": "string",
      "name": "ListenerComm",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The specific communication channel to use for this service"
    },
    {
      "type": "string",
      "name": "STATIC_ENTRIES",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "DNS domain search list (hosts file or space/semicolon separate entries)"
    },
    {
      "type": "bool",
      "name": "DISABLE_RESOLVER",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disable DNS request forwarding"
    },
    {
      "type": "bool",
      "name": "DISABLE_NS_CACHE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disable DNS response caching"
    },
    {
      "type": "bool",
      "name": "DnsServerUdp",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Serve UDP DNS requests"
    },
    {
      "type": "bool",
      "name": "DnsServerTcp",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Serve TCP DNS requests"
    }
  ]
}