{
  "name": "Identify endpoints speaking the Remote Desktop Protocol (RDP)",
  "fullname": "auxiliary/scanner/rdp/rdp_scanner",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "auxiliary",
  "author": [
    "Jon Hart <jon_hart@rapid7.com>"
  ],
  "description": "This module attempts to connect to the specified Remote Desktop Protocol port\n          and determines if it speaks RDP.\n\n          When available, the Credential Security Support Provider (CredSSP) protocol will be used to identify the\n          version of Windows on which the server is running. Enabling the DETECT_NLA option will cause a second\n          connection to be made to the server to identify if Network Level Authentication (NLA) is required.",
  "references": [
    "https://msdn.microsoft.com/en-us/library/cc240445.aspx"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/scanner/rdp/rdp_scanner.rb",
  "ref_name": "scanner/rdp/rdp_scanner",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 3389,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "RDP_USER",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to report during connect, UNSET = random"
    },
    {
      "type": "string",
      "name": "RDP_CLIENT_NAME",
      "required": false,
      "default": "rdesktop",
      "aliases": [

      ],
      "advanced": false,
      "description": "The client computer name to report during connect, UNSET = random"
    },
    {
      "type": "string",
      "name": "RDP_DOMAIN",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The client domain name to report during connect"
    },
    {
      "type": "address",
      "name": "RDP_CLIENT_IP",
      "required": true,
      "default": "192.168.0.100",
      "aliases": [

      ],
      "advanced": false,
      "description": "The client IPv4 address to report during connect"
    },
    {
      "type": "integer",
      "name": "RDP_TLS_SECURITY_LEVEL",
      "required": true,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Change default TLS security level. \"0\" (default) means everything is permitted. \"1\" rejects very weak parameters and \"2\" is even stricter."
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of concurrent threads (max one per host)"
    },
    {
      "type": "bool",
      "name": "ShowProgress",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Display progress messages during a scan"
    },
    {
      "type": "integer",
      "name": "ShowProgressPercent",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "The interval in percent that progress should be shown"
    },
    {
      "type": "bool",
      "name": "DETECT_NLA",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Detect Network Level Authentication (NLA)"
    }
  ]
}