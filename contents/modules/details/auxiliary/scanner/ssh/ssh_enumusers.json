{
  "name": "SSH Username Enumeration",
  "fullname": "auxiliary/scanner/ssh/ssh_enumusers",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "auxiliary",
  "author": [
    "kenkeiras",
    "Dariusz Tytko",
    "Michal Sajdak",
    "Qualys",
    "wvu <wvu@metasploit.com>"
  ],
  "description": "This module uses a malformed packet or timing attack to enumerate users on\n        an OpenSSH server.\n\n        The default action sends a malformed (corrupted) SSH_MSG_USERAUTH_REQUEST\n        packet using public key authentication (must be enabled) to enumerate users.\n\n        On some versions of OpenSSH under some configurations, OpenSSH will return a\n        \"permission denied\" error for an invalid user faster than for a valid user,\n        creating an opportunity for a timing attack to enumerate users.\n\n        Testing note: invalid users were logged, while valid users were not. YMMV.",
  "references": [
    "https://cvedetails.com/cve/CVE-2003-0190/",
    "https://cvedetails.com/cve/CVE-2006-5229/",
    "https://cvedetails.com/cve/CVE-2016-6210/",
    "https://cvedetails.com/cve/CVE-2018-15473/",
    "OSVDB (32721)",
    "http://www.securityfocus.com/bid/20418",
    "https://seclists.org/oss-sec/2018/q3/124",
    "https://sekurak.pl/openssh-users-enumeration-cve-2018-15473/"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/scanner/ssh/ssh_enumusers.rb",
  "ref_name": "scanner/ssh/ssh_enumusers",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 22,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "SSH_IDENT",
      "required": true,
      "default": "SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSH client identification string"
    },
    {
      "type": "integer",
      "name": "SSH_TIMEOUT",
      "required": false,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the maximum time to negotiate a SSH session"
    },
    {
      "type": "bool",
      "name": "SSH_DEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSH debugging output (Extreme verbosity!)"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of concurrent threads (max one per host)"
    },
    {
      "type": "bool",
      "name": "ShowProgress",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Display progress messages during a scan"
    },
    {
      "type": "integer",
      "name": "ShowProgressPercent",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "The interval in percent that progress should be shown"
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Single username to test (username spray)"
    },
    {
      "type": "path",
      "name": "USER_FILE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "File containing usernames, one per line"
    },
    {
      "type": "integer",
      "name": "THRESHOLD",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": false,
      "description": "Amount of seconds needed before a user is considered found (timing attack only)"
    },
    {
      "type": "bool",
      "name": "CHECK_FALSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Check for false positives (random username)"
    },
    {
      "type": "integer",
      "name": "RETRY_NUM",
      "required": true,
      "default": 3,
      "aliases": [

      ],
      "advanced": true,
      "description": "The number of attempts to connect to a SSH server for each user"
    }
  ]
}