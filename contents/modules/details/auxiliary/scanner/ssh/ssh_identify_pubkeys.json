{
  "name": "SSH Public Key Acceptance Scanner",
  "fullname": "auxiliary/scanner/ssh/ssh_identify_pubkeys",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "auxiliary",
  "author": [
    "todb <todb@metasploit.com>",
    "hdm <x@hdm.io>",
    "Stuart Morgan <stuart.morgan@mwrinfosecurity.com>"
  ],
  "description": "This module can determine what public keys are configured for\n        key-based authentication across a range of machines, users, and\n        sets of known keys. The SSH protocol indicates whether a particular\n        key is accepted prior to the client performing the actual signed\n        authentication request. To use this module, a text file containing\n        one or more SSH keys should be provided. These can be private or\n        public, so long as no passphrase is set on the private keys.\n\n        If you have loaded a database plugin and connected to a database\n        this module will record authorized public keys and hosts so you can\n        track your process.\n\n        Key files may be a single public (unencrypted) key, or several public\n        keys concatenated together as an ASCII text file. Non-key data should be\n        silently ignored. Private keys will only utilize the public key component\n        stored within the key file.",
  "references": [

  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/scanner/ssh/ssh_identify_pubkeys.rb",
  "ref_name": "scanner/ssh/ssh_identify_pubkeys",
  "check": false,
  "post_auth": true,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Whether to print output for all attempts"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of concurrent threads (max one per host)"
    },
    {
      "type": "bool",
      "name": "ShowProgress",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Display progress messages during a scan"
    },
    {
      "type": "integer",
      "name": "ShowProgressPercent",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "The interval in percent that progress should be shown"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "A specific username to authenticate as"
    },
    {
      "type": "path",
      "name": "USER_FILE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "File containing usernames, one per line"
    },
    {
      "type": "integer",
      "name": "BRUTEFORCE_SPEED",
      "required": true,
      "default": 5,
      "aliases": [

      ],
      "advanced": false,
      "description": "How fast to bruteforce, from 0 to 5"
    },
    {
      "type": "bool",
      "name": "DB_ALL_USERS",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Add all users in the current database to the list"
    },
    {
      "type": "bool",
      "name": "STOP_ON_SUCCESS",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Stop guessing when a credential works for a host"
    },
    {
      "type": "bool",
      "name": "REMOVE_USER_FILE",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Automatically delete the USER_FILE on module completion"
    },
    {
      "type": "bool",
      "name": "REMOVE_PASS_FILE",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Automatically delete the PASS_FILE on module completion"
    },
    {
      "type": "bool",
      "name": "REMOVE_USERPASS_FILE",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Automatically delete the USERPASS_FILE on module completion"
    },
    {
      "type": "bool",
      "name": "PASSWORD_SPRAY",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Reverse the credential pairing order. For each password, attempt every possible user."
    },
    {
      "type": "integer",
      "name": "TRANSITION_DELAY",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Amount of time (in minutes) to delay before transitioning to the next user in the array (or password when PASSWORD_SPRAY=true)"
    },
    {
      "type": "integer",
      "name": "MaxGuessesPerService",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of credentials to try per service instance. If set to zero or a non-number, this option will not be used."
    },
    {
      "type": "integer",
      "name": "MaxMinutesPerService",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum time in minutes to bruteforce the service instance. If set to zero or a non-number, this option will not be used."
    },
    {
      "type": "integer",
      "name": "MaxGuessesPerUser",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": " Maximum guesses for a particular username for the service instance. Note that users are considered unique among different services, so a user at 10.1.1.1:22 is different from one at 10.2.2.2:22, and both will be tried up to the MaxGuessesPerUser limit. If set to zero or a non-number, this option will not be used."
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 22,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "SSH_IDENT",
      "required": true,
      "default": "SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSH client identification string"
    },
    {
      "type": "integer",
      "name": "SSH_TIMEOUT",
      "required": false,
      "default": 30,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the maximum time to negotiate a SSH session"
    },
    {
      "type": "bool",
      "name": "SSH_DEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSH debugging output (Extreme verbosity!)"
    },
    {
      "type": "path",
      "name": "KEY_FILE",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Filename of one or several cleartext public keys."
    },
    {
      "type": "bool",
      "name": "SSH_BYPASS",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Verify that authentication was not bypassed when keys are found"
    },
    {
      "type": "string",
      "name": "SSH_KEYFILE_B64",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": true,
      "description": "Raw data of an unencrypted SSH public key. This should be used by programmatic interfaces to this module only."
    },
    {
      "type": "path",
      "name": "KEY_DIR",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Directory of several keys. Filenames must not begin with a dot in order to be read."
    }
  ]
}