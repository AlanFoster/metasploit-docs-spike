{
  "name": "Redis File Upload",
  "fullname": "auxiliary/scanner/redis/file_upload",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2015-11-11",
  "type": "auxiliary",
  "author": [
    "Nixawk",
    "Jon Hart <jon_hart@rapid7.com>"
  ],
  "description": "This module can be used to leverage functionality exposed by Redis to\n          achieve somewhat arbitrary file upload to a file and directory to\n          which the user account running the redis instance has access.  It is\n          not totally arbitrary because the exact contents of the file cannot\n          be completely controlled given the nature of how Redis stores its\n          database on disk.",
  "references": [
    "http://antirez.com/news/96",
    "http://blog.knownsec.com/2015/11/analysis-of-redis-unauthorized-of-expolit/",
    "http://redis.io/topics/protocol"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/scanner/redis/file_upload.rb",
  "ref_name": "scanner/redis/file_upload",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 6379,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of concurrent threads (max one per host)"
    },
    {
      "type": "bool",
      "name": "ShowProgress",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Display progress messages during a scan"
    },
    {
      "type": "integer",
      "name": "ShowProgressPercent",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "The interval in percent that progress should be shown"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": false,
      "default": "foobared",
      "aliases": [

      ],
      "advanced": false,
      "description": "Redis password for authentication test"
    },
    {
      "type": "integer",
      "name": "READ_TIMEOUT",
      "required": true,
      "default": 2,
      "aliases": [

      ],
      "advanced": true,
      "description": "Seconds to wait while reading redis responses"
    },
    {
      "type": "path",
      "name": "LocalFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Local file to be uploaded"
    },
    {
      "type": "string",
      "name": "RemoteFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Remote file path"
    },
    {
      "type": "bool",
      "name": "DISABLE_RDBCOMPRESSION",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disable compression when saving if found to be enabled"
    },
    {
      "type": "bool",
      "name": "FLUSHALL",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Run flushall to remove all redis data before saving"
    }
  ]
}