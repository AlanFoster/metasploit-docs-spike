{
  "name": "Ruby on Rails Action View MIME Memory Exhaustion",
  "fullname": "auxiliary/dos/http/rails_action_view",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-12-04",
  "type": "auxiliary",
  "author": [
    "Toby Hsieh",
    "joev <joev@metasploit.com>",
    "sinn3r <sinn3r@metasploit.com>"
  ],
  "description": "This module exploits a Denial of Service (DoS) condition in Action View that requires\n        a controller action. By sending a specially crafted content-type header to a Rails\n        application, it is possible for it to store the invalid MIME type, and may eventually\n        consume all memory if enough invalid MIMEs are given.\n\n        Versions 3.0.0 and other later versions are affected, fixed in 4.0.2 and 3.2.16.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-6414/",
    "OSVDB (100525)",
    "http://www.securityfocus.com/bid/64074",
    "https://seclists.org/oss-sec/2013/q4/400",
    "https://github.com/rails/rails/commit/bee3b7f9371d1e2ddcfe6eaff5dcb26c0a248068"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": null,
  "path": "/modules/auxiliary/dos/http/rails_action_view.rb",
  "ref_name": "dos/http/rails_action_view",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 80,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "URIPATH",
      "required": true,
      "default": "/",
      "aliases": [

      ],
      "advanced": false,
      "description": "The URI that routes to a Rails controller action"
    },
    {
      "type": "integer",
      "name": "MAXSTRINGSIZE",
      "required": true,
      "default": 60000,
      "aliases": [

      ],
      "advanced": false,
      "description": "Max string size"
    },
    {
      "type": "integer",
      "name": "REQCOUNT",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "Number of HTTP requests to pipeline per connection"
    },
    {
      "type": "integer",
      "name": "RLIMIT",
      "required": true,
      "default": 100000,
      "aliases": [

      ],
      "advanced": false,
      "description": "Number of requests to send"
    }
  ]
}