{
  "name": "Microsoft IIS FTP Server LIST Stack Exhaustion",
  "fullname": "auxiliary/dos/windows/ftp/iis_list_exhaustion",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2009-09-03",
  "type": "auxiliary",
  "author": [
    "Kingcope",
    "Myo Soe"
  ],
  "description": "This module triggers Denial of Service condition in the Microsoft Internet\n        Information Services (IIS) FTP Server 5.0 through 7.0 via a list (ls) -R command\n        containing a wildcard. For this exploit to work in most cases, you need 1) a valid\n        ftp account: either read-only or write-access account 2) the \"FTP Publishing\" must\n        be configured as \"manual\" mode in startup type 3) there must be at least one\n        directory under FTP root directory. If your provided an FTP account has write-access\n        privilege and there is no single directory, a new directory with random name will be\n        created prior to sending exploit payload.",
  "references": [
    "https://cvedetails.com/cve/CVE-2009-2521/",
    "http://www.securityfocus.com/bid/36273",
    "OSVDB (57753)",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2009/MS09-053",
    "http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0040.html"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [
    21,
    2121
  ],
  "autofilter_services": [
    "ftp"
  ],
  "targets": null,
  "path": "/modules/auxiliary/dos/windows/ftp/iis_list_exhaustion.rb",
  "ref_name": "dos/windows/ftp/iis_list_exhaustion",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 21,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "FTPUSER",
      "required": false,
      "default": "anonymous",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to authenticate as"
    },
    {
      "type": "string",
      "name": "FTPPASS",
      "required": false,
      "default": "mozilla@example.com",
      "aliases": [

      ],
      "advanced": false,
      "description": "The password for the specified username"
    },
    {
      "type": "integer",
      "name": "FTPTimeout",
      "required": true,
      "default": 16,
      "aliases": [

      ],
      "advanced": true,
      "description": "The number of seconds to wait for a reply from an FTP command"
    },
    {
      "type": "bool",
      "name": "FTPDEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Whether or not to print verbose debug statements"
    },
    {
      "type": "bool",
      "name": "PassiveMode",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set true for extended passive (EPSV) ftp mode."
    }
  ]
}