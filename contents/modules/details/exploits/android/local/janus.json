{
  "name": "Android Janus APK Signature bypass",
  "fullname": "exploit/android/local/janus",
  "aliases": [

  ],
  "rank": 0,
  "disclosure_date": "2017-07-31",
  "type": "exploit",
  "author": [
    "GuardSquare",
    "V-E-O",
    "timwr",
    "h00die"
  ],
  "description": "This module exploits CVE-2017-13156 in Android to install a payload into another\n        application. The payload APK will have the same signature and can be installed\n        as an update, preserving the existing data.\n        The vulnerability was fixed in the 5th December 2017 security patch, and was\n        additionally fixed by the APK Signature scheme v2, so only APKs signed with\n        the v1 scheme are vulnerable.\n        Payload handler is disabled, and a multi/handler must be started first.",
  "references": [
    "https://cvedetails.com/cve/CVE-2017-13156/",
    "https://www.guardsquare.com/en/blog/new-android-vulnerability-allows-attackers-modify-apps-without-affecting-their-signatures",
    "https://github.com/V-E-O/PoC/tree/master/CVE-2017-13156"
  ],
  "platform": "Android",
  "arch": "dalvik",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/android/local/janus.rb",
  "ref_name": "android/local/janus",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "SideEffects": [
      "ARTIFACTS_ON_DISK",
      "SCREEN_EFFECTS"
    ],
    "Stability": [
      "SERVICE_RESOURCE_LOSS"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "integer",
      "name": "FileDropperDelay",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Delay in seconds before attempting cleanup"
    },
    {
      "type": "integer",
      "name": "PingbackRetries",
      "required": true,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "How many additional successful pingbacks"
    },
    {
      "type": "integer",
      "name": "PingbackSleep",
      "required": true,
      "default": 30,
      "aliases": [

      ],
      "advanced": true,
      "description": "Time (in seconds) to sleep between pingbacks"
    },
    {
      "type": "string",
      "name": "PayloadUUIDSeed",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A string to use when generating the payload UUID (deterministic)"
    },
    {
      "type": "string",
      "name": "PayloadUUIDRaw",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A hex string representing the raw 8-byte PUID value for the UUID"
    },
    {
      "type": "string",
      "name": "PayloadUUIDName",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A human-friendly name to reference this unique payload (requires tracking)"
    },
    {
      "type": "bool",
      "name": "PayloadUUIDTracking",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Whether or not to automatically register generated UUIDs"
    },
    {
      "type": "string",
      "name": "PACKAGE",
      "required": true,
      "default": "com.phonegap.camerasample",
      "aliases": [

      ],
      "advanced": false,
      "description": "The package to target, or ALL to attempt all"
    },
    {
      "type": "bool",
      "name": "ForceExploit",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Override check result"
    }
  ]
}