{
  "name": "PostgreSQL CREATE LANGUAGE Execution",
  "fullname": "exploit/multi/postgres/postgres_createlang",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2016-01-01",
  "type": "exploit",
  "author": [
    "Micheal Cottingham",
    "midnitesnake",
    "Nixawk"
  ],
  "description": "Some installations of Postgres 8 and 9 are configured to allow loading external scripting languages.\n        Most commonly this is Perl and Python. When enabled, command execution is possible on the host.\n        To execute system commands, loading the \"untrusted\" version of the language is necessary.\n        This requires a superuser. This is usually postgres. The execution should be platform-agnostic,\n        and has been tested on OS X, Windows, and Linux.\n\n        This module attempts to load Perl or Python to execute system commands. As this dynamically loads\n        a scripting language to execute commands, it is not necessary to drop a file on the filesystem.\n\n        Only Postgres 8 and up are supported.",
  "references": [
    "http://www.postgresql.org/docs/current/static/sql-createlanguage.html",
    "http://www.postgresql.org/docs/current/static/plperl.html",
    "http://www.postgresql.org/docs/current/static/plpython.html"
  ],
  "platform": "Linux, Unix, Windows, OSX",
  "arch": "cmd",
  "autofilter_ports": [
    5432
  ],
  "autofilter_services": [
    "postgres"
  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/multi/postgres/postgres_createlang.rb",
  "ref_name": "multi/postgres/postgres_createlang",
  "check": true,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 5432,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "DATABASE",
      "required": true,
      "default": "template1",
      "aliases": [

      ],
      "advanced": false,
      "description": "The database to authenticate against"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": true,
      "default": "postgres",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to authenticate as"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": false,
      "default": "postgres",
      "aliases": [

      ],
      "advanced": false,
      "description": "The password for the specified username. Leave blank for a random password."
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    }
  ]
}