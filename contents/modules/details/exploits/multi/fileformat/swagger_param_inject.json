{
  "name": "JSON Swagger CodeGen Parameter Injector",
  "fullname": "exploit/multi/fileformat/swagger_param_inject",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2016-06-23",
  "type": "exploit",
  "author": [
    "ethersnowman <scott_davis@rapid7.com>"
  ],
  "description": "This module generates an Open API Specification 2.0 (Swagger) compliant\n        json document that includes payload insertion points in parameters.\n\n        In order for the payload to be executed, an attacker must convince\n        someone to generate code from a specially modified swagger.json file\n        within a vulnerable swagger-codgen appliance/container/api/service,\n        and then to execute that generated code (or include it into software\n        which will later be executed by another victim). By doing so, an\n        attacker can execute arbitrary code as the victim user. The same\n        vulnerability exists in the YAML format.",
  "references": [
    "https://cvedetails.com/cve/CVE-2016-5641/",
    "http://github.com/swagger-api/swagger-codegen",
    "https://blog.rapid7.com/2016/06/23/r7-2016-06-remote-code-execution-via-swagger-parameter-injection-cve-2016-5641"
  ],
  "platform": "NodeJS, PHP, Java, Ruby",
  "arch": "nodejs, php, java, ruby",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "NodeJS",
    "PHP",
    "Java JSP",
    "Ruby"
  ],
  "path": "/modules/exploits/multi/fileformat/swagger_param_inject.rb",
  "ref_name": "multi/fileformat/swagger_param_inject",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": false,
      "default": "msf-swagger.json",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file to write."
    },
    {
      "type": "string",
      "name": "INFO_DESCRIPTION",
      "required": true,
      "default": "A",
      "aliases": [

      ],
      "advanced": false,
      "description": "Swagger info description"
    },
    {
      "type": "string",
      "name": "INFO_VERSION",
      "required": true,
      "default": "1.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "Swagger info version."
    },
    {
      "type": "string",
      "name": "INFO_TITLE",
      "required": true,
      "default": "C",
      "aliases": [

      ],
      "advanced": false,
      "description": "Swagger info title."
    },
    {
      "type": "enum",
      "name": "SWAGGER_SCHEME",
      "required": true,
      "default": "http",
      "aliases": [

      ],
      "advanced": false,
      "description": "Protocol scheme (Accepted: http, https, ws, wss)"
    },
    {
      "type": "string",
      "name": "SWAGGER_HOST",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "a valid hostname or IPv4"
    },
    {
      "type": "string",
      "name": "BASE_PATH",
      "required": true,
      "default": "/",
      "aliases": [

      ],
      "advanced": false,
      "description": "The root path of API on host."
    },
    {
      "type": "string",
      "name": "PATH",
      "required": true,
      "default": "/a",
      "aliases": [

      ],
      "advanced": false,
      "description": "Path of request/response on root path."
    },
    {
      "type": "string",
      "name": "PATH_DESCRIPTION",
      "required": true,
      "default": "D",
      "aliases": [

      ],
      "advanced": false,
      "description": "Description of a path request object"
    },
    {
      "type": "string",
      "name": "PATH_RESPONSE_DESCRIPTION",
      "required": true,
      "default": "E",
      "aliases": [

      ],
      "advanced": false,
      "description": "Description of a path response object"
    },
    {
      "type": "string",
      "name": "DEFINITION_DESCRIPTION",
      "required": true,
      "default": "F",
      "aliases": [

      ],
      "advanced": false,
      "description": "Description of an object definition."
    }
  ]
}