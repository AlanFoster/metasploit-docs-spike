{
  "name": "PeaZip Zip Processing Command Injection",
  "fullname": "exploit/multi/fileformat/peazip_command_injection",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2009-06-05",
  "type": "exploit",
  "author": [
    "pyrokinesis",
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits a command injection vulnerability in PeaZip. All\n        versions prior to 2.6.2 are suspected vulnerable. Testing was conducted with\n        version 2.6.1 on Windows.\n\n        In order for the command to be executed, an attacker must convince someone to\n        open a specially crafted zip file with PeaZip, and access the specially file via\n        double-clicking it. By doing so, an attacker can execute arbitrary commands\n        as the victim user.",
  "references": [
    "https://cvedetails.com/cve/CVE-2009-2261/",
    "OSVDB (54966)",
    "http://peazip.sourceforge.net/",
    "https://www.exploit-db.com/exploits/8881"
  ],
  "platform": "Linux, Unix, Windows",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/multi/fileformat/peazip_command_injection.rb",
  "ref_name": "multi/fileformat/peazip_command_injection",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.zip",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}