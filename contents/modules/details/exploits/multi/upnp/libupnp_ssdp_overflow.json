{
  "name": "Portable UPnP SDK unique_service_name() Remote Code Execution",
  "fullname": "exploit/multi/upnp/libupnp_ssdp_overflow",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-01-29",
  "type": "exploit",
  "author": [
    "hdm <x@hdm.io>",
    "Alex Eubanks <endeavor@rainbowsandpwnies.com>",
    "Richard Harman <richard@richardharman.com>",
    "Frederic Basse <contact@fredericb.info>"
  ],
  "description": "This module exploits a buffer overflow in the unique_service_name()\n        function of libupnp's SSDP processor. The libupnp library is used across\n        thousands of devices and is referred to as the Intel SDK for UPnP\n        Devices or the Portable SDK for UPnP Devices.\n\n        Due to size limitations on many devices, this exploit uses a separate TCP\n        listener to stage the real payload.",
  "references": [
    "https://cvedetails.com/cve/CVE-2012-5958/",
    "OSVDB (89611)",
    "https://www.kb.cert.org/vuls/id/922681",
    "https://blog.rapid7.com/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic",
    "Supermicro Onboard IPMI (X9SCL/X9SCM) Intel SDK 1.3.1",
    "Axis Camera M1011 5.20.1 UPnP/1.4.1",
    "Debug Target"
  ],
  "path": "/modules/exploits/multi/upnp/libupnp_ssdp_overflow.rb",
  "ref_name": "multi/upnp/libupnp_ssdp_overflow",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 1900,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "address",
      "name": "CBHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The listener address used for staging the real payload"
    },
    {
      "type": "port",
      "name": "CBPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The listener port used for staging the real payload"
    }
  ]
}