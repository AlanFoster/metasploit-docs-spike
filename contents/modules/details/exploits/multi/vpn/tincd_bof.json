{
  "name": "Tincd Post-Authentication Remote TCP Stack Buffer Overflow",
  "fullname": "exploit/multi/vpn/tincd_bof",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2013-04-22",
  "type": "exploit",
  "author": [
    "Tobias Ospelt",
    "Martin Schobert"
  ],
  "description": "This module exploits a stack buffer overflow in Tinc's tincd\n        service. After authentication, a specially crafted tcp packet (default port 655)\n        leads to a buffer overflow and allows to execute arbitrary code. This module has\n        been tested with tinc-1.1pre6 on Windows XP (custom calc payload) and Windows 7\n        (windows/meterpreter/reverse_tcp), and tinc version 1.0.19 from the ports of\n        FreeBSD 9.1-RELEASE # 0 and various other OS, see targets. The exploit probably works\n        for all versions <= 1.1pre6.\n        A manually compiled version (1.1.pre6) on Ubuntu 12.10 with gcc 4.7.2 seems to\n        be a non-exploitable crash due to calls to __memcpy_chk depending on how tincd\n        was compiled. Bug got fixed in version 1.0.21/1.1pre7. While writing this module\n        it was recommended to the maintainer to start using DEP/ASLR and other protection\n        mechanisms.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-1428/",
    "OSVDB (92653)",
    "http://www.securityfocus.com/bid/59369",
    "http://www.floyd.ch/?p=741",
    "http://sitsec.net/blog/2013/04/22/stack-based-buffer-overflow-in-the-vpn-software-tinc-for-authenticated-peers/"
  ],
  "platform": "",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP x86, tinc 1.1.pre6 (exe installer)",
    "Windows 7 x86, tinc 1.1.pre6 (exe installer)",
    "FreeBSD 9.1-RELEASE # 0 x86, tinc 1.0.19 (ports)",
    "Fedora 19 x86 ROP (NX), write binary to disk payloads, tinc 1.0.20 (manual compile)",
    "Fedora 19 x86 ROP (NX), CMD exec payload, tinc 1.0.20 (manual compile)",
    "Archlinux 2013.04.01 x86, tinc 1.0.20 (manual compile)",
    "OpenSuse 11.2 x86, tinc 1.0.20 (manual compile)",
    "Pidora 18 ARM ROP(NX)/ASLR brute force, write binary to disk payloads, tinc 1.0.20 (manual compile with restarting daemon)",
    "Pidora 18 ARM ROP(NX)/ASLR brute force, CMD exec payload, tinc 1.0.20 (manual compile with restarting daemon)",
    "Crash only: Ubuntu 12.10 x86, tinc 1.1.pre6 (apt-get or manual compile)",
    "Crash only: Fedora 16 x86, tinc 1.0.19 (yum)",
    "Crash only: OpenSuse 11.2 x86, tinc 1.0.16 (rpm package)",
    "Crash only: Debian 7.3 ARM, tinc 1.0.19 (apt-get)"
  ],
  "path": "/modules/exploits/multi/vpn/tincd_bof.rb",
  "ref_name": "multi/vpn/tincd_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "bool",
      "name": "EXE::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom exe instead of automatically generating a payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the executable template"
    },
    {
      "type": "path",
      "name": "EXE::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The executable template file name."
    },
    {
      "type": "bool",
      "name": "EXE::Inject",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to preserve the original EXE function"
    },
    {
      "type": "bool",
      "name": "EXE::OldMethod",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to use the substitution EXE generation method."
    },
    {
      "type": "bool",
      "name": "EXE::FallBack",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use the default template in case the specified one is missing"
    },
    {
      "type": "bool",
      "name": "MSI::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom msi instead of automatically generating a payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the msi template"
    },
    {
      "type": "path",
      "name": "MSI::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The msi template file name"
    },
    {
      "type": "bool",
      "name": "MSI::UAC",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 655,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "path",
      "name": "SERVER_PUBLIC_KEY_FILE",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "Server's public key"
    },
    {
      "type": "path",
      "name": "CLIENT_PRIVATE_KEY_FILE",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "Client private key"
    },
    {
      "type": "string",
      "name": "CLIENT_NAME",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "Your client name (pre-shared with server)"
    },
    {
      "type": "string",
      "name": "BINARY_DROP_LOCATION",
      "required": false,
      "default": "/tmp",
      "aliases": [

      ],
      "advanced": false,
      "description": "Short location to drop executable on server, usually /tmp or ."
    },
    {
      "type": "integer",
      "name": "BRUTEFORCE_TRIES",
      "required": false,
      "default": 200,
      "aliases": [

      ],
      "advanced": false,
      "description": "How many brute force tries (ASLR brute force)"
    },
    {
      "type": "integer",
      "name": "WAIT",
      "required": false,
      "default": 3,
      "aliases": [

      ],
      "advanced": false,
      "description": "Waiting time for server daemon restart (ASLR brute force)"
    }
  ]
}