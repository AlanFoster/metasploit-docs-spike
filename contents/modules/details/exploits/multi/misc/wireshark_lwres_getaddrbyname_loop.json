{
  "name": "Wireshark LWRES Dissector getaddrsbyname_request Buffer Overflow (loop)",
  "fullname": "exploit/multi/misc/wireshark_lwres_getaddrbyname_loop",
  "aliases": [

  ],
  "rank": 500,
  "disclosure_date": "2010-01-27",
  "type": "exploit",
  "author": [
    "babi",
    "jduck <jduck@metasploit.com>",
    "redsand"
  ],
  "description": "The LWRES dissector in Wireshark version 0.9.15 through 1.0.10 and 1.2.0 through\n        1.2.5 allows remote attackers to execute arbitrary code due to a stack-based buffer\n        overflow. This bug found and reported by babi.\n\n        This particular exploit targets the dissect_getaddrsbyname_request function. Several\n        other functions also contain potentially exploitable stack-based buffer overflows.\n\n        The Windows version (of 1.2.5 at least) is compiled with /GS, which prevents\n        exploitation via the return address on the stack. Sending a larger string allows\n        exploitation using the SEH bypass method. However, this packet will usually get\n        fragmented, which may cause additional complications.\n\n        NOTE: The vulnerable code is reached only when the packet dissection is rendered.\n        If the packet is fragmented, all fragments must be captured and reassembled to\n        exploit this issue.\n\n        This version loops, sending the packet every X seconds until the job is killed.",
  "references": [
    "https://cvedetails.com/cve/CVE-2010-0304/",
    "OSVDB (61987)",
    "http://www.securityfocus.com/bid/37985",
    "http://www.wireshark.org/security/wnpa-sec-2010-02.html",
    "http://anonsvn.wireshark.org/viewvc/trunk-1.2/epan/dissectors/packet-lwres.c?view=diff&r1=31596&r2=28492&diff_format=h"
  ],
  "platform": "Linux, OSX, Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "tshark 1.0.2-3+lenny7 on Debian 5.0.3 (x86)",
    "wireshark 1.0.2-3+lenny7 on Debian 5.0.3 (x86)",
    "wireshark 1.2.5 on RHEL 5.4 (x64)",
    "wireshark 1.2.5 on Mac OS X 10.5 (x86)",
    "wireshark/tshark 1.2.1 and 1.2.5 on Windows (x86)"
  ],
  "path": "/modules/exploits/multi/misc/wireshark_lwres_getaddrbyname_loop.rb",
  "ref_name": "multi/misc/wireshark_lwres_getaddrbyname_loop",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": "239.255.255.250",
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 921,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    },
    {
      "type": "string",
      "name": "INTERFACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The name of the interface"
    },
    {
      "type": "integer",
      "name": "SNAPLEN",
      "required": true,
      "default": 65535,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of bytes to capture"
    },
    {
      "type": "integer",
      "name": "TIMEOUT",
      "required": true,
      "default": 500,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of seconds to wait for new data"
    },
    {
      "type": "integer",
      "name": "SECRET",
      "required": true,
      "default": 1297303073,
      "aliases": [

      ],
      "advanced": true,
      "description": "A 32-bit cookie for probe requests."
    },
    {
      "type": "address",
      "name": "GATEWAY_PROBE_HOST",
      "required": true,
      "default": "8.8.8.8",
      "aliases": [

      ],
      "advanced": true,
      "description": "Send a TTL=1 random UDP datagram to this host to discover the default gateway's MAC"
    },
    {
      "type": "port",
      "name": "GATEWAY_PROBE_PORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The port on GATEWAY_PROBE_HOST to send a random UDP probe to (random if 0 or unset)"
    },
    {
      "type": "address",
      "name": "SHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "This option can be used to specify a spoofed source address"
    },
    {
      "type": "integer",
      "name": "DELAY",
      "required": true,
      "default": 5,
      "aliases": [

      ],
      "advanced": false,
      "description": "This option sets the delay between sent packets"
    },
    {
      "type": "bool",
      "name": "ExitOnSession",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Return from the exploit after a session has been created"
    }
  ]
}