{
  "name": "Java JMX Server Insecure Configuration Java Code Execution",
  "fullname": "exploit/multi/misc/java_jmx_server",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2013-05-22",
  "type": "exploit",
  "author": [
    "Braden Thomas",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module takes advantage a Java JMX interface insecure configuration, which would\n        allow loading classes from any remote (HTTP) URL. JMX interfaces with authentication\n        disabled (com.sun.management.jmxremote.authenticate=false) should be vulnerable, while\n        interfaces with authentication enabled will be vulnerable only if a weak configuration\n        is deployed (allowing to use javax.management.loading.MLet, having a security manager\n        allowing to load a ClassLoader MBean, etc.).",
  "references": [
    "https://docs.oracle.com/javase/8/docs/technotes/guides/jmx/JMX_1_4_specification.pdf",
    "https://www.optiv.com/blog/exploiting-jmx-rmi",
    "https://cvedetails.com/cve/CVE-2015-2342/"
  ],
  "platform": "Java",
  "arch": "java",
  "autofilter_ports": [
    999,
    1090,
    1098,
    1099,
    1100,
    1101,
    1102,
    1103,
    1129,
    1030,
    1035,
    1199,
    1234,
    1440,
    3273,
    3333,
    3900,
    2199,
    2809,
    5520,
    5580,
    5521,
    5999,
    6060,
    6789,
    6996,
    7700,
    7800,
    7878,
    7890,
    7801,
    8050,
    8051,
    8085,
    8091,
    8205,
    8303,
    8642,
    8701,
    8686,
    8888,
    8889,
    8890,
    8901,
    8902,
    8903,
    8999,
    9001,
    9003,
    9004,
    9005,
    9050,
    9090,
    9099,
    9300,
    9500,
    9711,
    9809,
    9810,
    9811,
    9812,
    9813,
    9814,
    9815,
    9875,
    9910,
    9991,
    9999,
    10001,
    10162,
    10098,
    10099,
    11001,
    11099,
    11333,
    12000,
    13013,
    14000,
    15000,
    15001,
    15200,
    16000,
    17200,
    18980,
    20000,
    23791,
    26256,
    31099,
    33000,
    32913,
    37718,
    45230,
    47001,
    47002,
    50050,
    50500,
    50501,
    50502,
    50503,
    50504
  ],
  "autofilter_services": [
    "rmi",
    "rmid",
    "java-rmi",
    "rmiregistry"
  ],
  "targets": [
    "Generic (Java Payload)"
  ],
  "path": "/modules/exploits/multi/misc/java_jmx_server.rb",
  "ref_name": "multi/misc/java_jmx_server",
  "check": true,
  "post_auth": true,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "address",
      "name": "SRVHOST",
      "required": true,
      "default": "0.0.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."
    },
    {
      "type": "port",
      "name": "SRVPORT",
      "required": true,
      "default": 8080,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local port to listen on."
    },
    {
      "type": "string",
      "name": "ListenerComm",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The specific communication channel to use for this service"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "path",
      "name": "SSLCert",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Path to a custom SSL certificate (default is randomly generated)"
    },
    {
      "type": "bool",
      "name": "SSLCompression",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSL/TLS-level compression"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "URIPATH",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The URI to use for this exploit (default is random)"
    },
    {
      "type": "bool",
      "name": "HTTP::no_cache",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disallow the browser to cache HTTP content"
    },
    {
      "type": "bool",
      "name": "HTTP::chunked",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""
    },
    {
      "type": "bool",
      "name": "HTTP::header_folding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable folding of HTTP headers"
    },
    {
      "type": "bool",
      "name": "HTTP::junk_headers",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable insertion of random junk HTTP headers"
    },
    {
      "type": "enum",
      "name": "HTTP::compression",
      "required": false,
      "default": "none",
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"
    },
    {
      "type": "string",
      "name": "HTTP::server_name",
      "required": true,
      "default": "Apache",
      "aliases": [

      ],
      "advanced": false,
      "description": "Configures the Server header of all outgoing replies"
    },
    {
      "type": "address",
      "name": "URIHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Host to use in URI (useful for tunnels)"
    },
    {
      "type": "port",
      "name": "URIPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Port to use in URI (useful for tunnels)"
    },
    {
      "type": "bool",
      "name": "SendRobots",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Return a robots.txt file if asked for one"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "RmiReadLoopTimeout",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to wait for data between read iterations"
    },
    {
      "type": "string",
      "name": "JMX_ROLE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The role to interact with an authenticated JMX endpoint"
    },
    {
      "type": "string",
      "name": "JMX_PASSWORD",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The password to interact with an authenticated JMX endpoint"
    },
    {
      "type": "string",
      "name": "JMXRMI",
      "required": true,
      "default": "jmxrmi",
      "aliases": [

      ],
      "advanced": false,
      "description": "The name where the JMX RMI interface is bound"
    }
  ]
}