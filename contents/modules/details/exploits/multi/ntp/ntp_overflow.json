{
  "name": "NTP Daemon readvar Buffer Overflow",
  "fullname": "exploit/multi/ntp/ntp_overflow",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2001-04-04",
  "type": "exploit",
  "author": [
    "aushack <patrick@osisecurity.com.au>"
  ],
  "description": "This module exploits a stack based buffer overflow in the\n        ntpd and xntpd service. By sending an overly long 'readvar'\n        request it is possible to execute code remotely. As the stack\n        is corrupted, this module uses the Egghunter technique.",
  "references": [
    "https://cvedetails.com/cve/CVE-2001-0414/",
    "OSVDB (805)",
    "http://www.securityfocus.com/bid/2540",
    "https://www.kb.cert.org/vuls/id/970472"
  ],
  "platform": "Linux",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "RedHat Linux 7.0 ntpd 4.0.99j",
    "RedHat Linux 7.0 ntpd 4.0.99j w/debug",
    "RedHat Linux 7.0 ntpd 4.0.99k",
    "Debugging"
  ],
  "path": "/modules/exploits/multi/ntp/ntp_overflow.rb",
  "ref_name": "multi/ntp/ntp_overflow",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 123,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    }
  ]
}