{
  "name": "MS14-062 Microsoft Bluetooth Personal Area Networking (BthPan.sys) Privilege Escalation",
  "fullname": "exploit/windows/local/bthpan",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2014-07-18",
  "type": "exploit",
  "author": [
    "Matt Bergin <level@korelogic.com>",
    "Jay Smith <jsmith@korelogic.com>"
  ],
  "description": "A vulnerability within Microsoft Bluetooth Personal Area Networking module,\n        BthPan.sys, can allow an attacker to inject memory controlled by the attacker\n        into an arbitrary location. This can be used by an attacker to overwrite\n        HalDispatchTable+0x4 and execute arbitrary code by subsequently calling\n        NtQueryIntervalProfile.",
  "references": [
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2014/MS14-062",
    "https://cvedetails.com/cve/CVE-2014-4971/",
    "https://www.korelogic.com/Resources/Advisories/KL-001-2014-002.txt",
    "OSVDB (109387)"
  ],
  "platform": "Windows",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP SP3"
  ],
  "path": "/modules/exploits/windows/local/bthpan.rb",
  "ref_name": "windows/local/bthpan",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}