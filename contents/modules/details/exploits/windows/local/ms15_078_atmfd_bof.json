{
  "name": "MS15-078 Microsoft Windows Font Driver Buffer Overflow",
  "fullname": "exploit/windows/local/ms15_078_atmfd_bof",
  "aliases": [

  ],
  "rank": 0,
  "disclosure_date": "2015-07-11",
  "type": "exploit",
  "author": [
    "Eugene Ching",
    "Mateusz Jurczyk",
    "Cedric Halbronn",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a pool based buffer overflow in the atmfd.dll driver when parsing\n        a malformed font. The vulnerability was exploited by the hacking team and disclosed in\n        the July data leak. This module has been tested successfully on vulnerable builds of\n        Windows 8.1 x64.",
  "references": [
    "https://cvedetails.com/cve/CVE-2015-2426/",
    "https://cvedetails.com/cve/CVE-2015-2433/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2015/MS15-078",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2015/MS15-080",
    "https://github.com/vlad902/hacking-team-windows-kernel-lpe",
    "https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2015/september/exploiting-cve-2015-2426-and-how-i-ported-it-to-a-recent-windows-8.1-64-bit/",
    "https://code.google.com/p/google-security-research/issues/detail?id=369",
    "https://code.google.com/p/google-security-research/issues/detail?id=480"
  ],
  "platform": "Windows",
  "arch": "x64",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows 8.1 x64"
  ],
  "path": "/modules/exploits/windows/local/ms15_078_atmfd_bof.rb",
  "ref_name": "windows/local/ms15_078_atmfd_bof",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}