{
  "name": "Windows Capcom.sys Kernel Execution Exploit (x64 only)",
  "fullname": "exploit/windows/local/capcom_sys_exec",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "1999-01-01",
  "type": "exploit",
  "author": [
    "TheWack0lian",
    "OJ Reeves"
  ],
  "description": "This module abuses the Capcom.sys kernel driver's function that allows for an\n        arbitrary function to be executed in the kernel from user land. This function\n        purposely disables SMEP prior to invoking a function given by the caller.\n        This has been tested on Windows 7, 8.1 and Windows 10 (x64).",
  "references": [
    "https://twitter.com/TheWack0lian/status/779397840762245124"
  ],
  "platform": "Windows",
  "arch": "x64",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows x64 (<= 10)"
  ],
  "path": "/modules/exploits/windows/local/capcom_sys_exec.rb",
  "ref_name": "windows/local/capcom_sys_exec",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}