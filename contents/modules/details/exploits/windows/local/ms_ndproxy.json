{
  "name": "MS14-002 Microsoft Windows ndproxy.sys Local Privilege Escalation",
  "fullname": "exploit/windows/local/ms_ndproxy",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2013-11-27",
  "type": "exploit",
  "author": [
    "Unknown",
    "ryujin",
    "Shahin Ramezany",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a flaw in the ndproxy.sys driver on Windows XP SP3 and Windows 2003\n        SP2 systems, exploited in the wild in November, 2013. The vulnerability exists while\n        processing an IO Control Code 0x8fff23c8 or 0x8fff23cc, where user provided input is used\n        to access an array unsafely, and the value is used to perform a call, leading to a NULL\n        pointer dereference which is exploitable on both Windows XP and Windows 2003 systems. This\n        module has been tested successfully on Windows XP SP3 and Windows 2003 SP2. In order to\n        work the service \"Routing and Remote Access\" must be running on the target system.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-5065/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2014/MS14-002",
    "OSVDB (100368)",
    "http://www.securityfocus.com/bid/63971",
    "https://www.exploit-db.com/exploits/30014",
    "http://labs.portcullis.co.uk/blog/cve-2013-5065-ndproxy-array-indexing-error-unpatched-vulnerability/",
    "http://technet.microsoft.com/en-us/security/advisory/2914486",
    "http://www.secniu.com/blog/?p=53",
    "http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/ms-windows-local-privilege-escalation-zero-day-in-the-wild.html",
    "http://blog.spiderlabs.com/2013/12/the-kernel-is-calling-a-zeroday-pointer-cve-2013-5065-ring-ring.html"
  ],
  "platform": "Windows",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic",
    "Windows XP SP3",
    "Windows Server 2003 SP2"
  ],
  "path": "/modules/exploits/windows/local/ms_ndproxy.rb",
  "ref_name": "windows/local/ms_ndproxy",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}