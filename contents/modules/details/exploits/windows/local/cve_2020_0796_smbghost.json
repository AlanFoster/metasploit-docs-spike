{
  "name": "SMBv3 Compression Buffer Overflow",
  "fullname": "exploit/windows/local/cve_2020_0796_smbghost",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2020-03-13",
  "type": "exploit",
  "author": [
    "Daniel García Gutiérrez",
    "Manuel Blanco Parajón",
    "Spencer McIntyre"
  ],
  "description": "A vulnerability exists within the Microsoft Server Message Block 3.1.1 (SMBv3) protocol that can be leveraged to\n            execute code on a vulnerable server. This local exploit implementation leverages this flaw to elevate itself\n            before injecting a payload into winlogon.exe.",
  "references": [
    "https://cvedetails.com/cve/CVE-2020-0796/",
    "https://github.com/danigargu/CVE-2020-0796",
    "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/adv200005"
  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows 10 v1903-1909 x64"
  ],
  "path": "/modules/exploits/windows/local/cve_2020_0796_smbghost.rb",
  "ref_name": "windows/local/cve_2020_0796_smbghost",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "Stability": [
      "crash-os-restarts"
    ],
    "Reliability": [
      "repeatable-session"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "bool",
      "name": "AutoCheck",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Run check before exploitation"
    }
  ]
}