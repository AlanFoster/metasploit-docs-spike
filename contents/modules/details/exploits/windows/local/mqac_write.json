{
  "name": "MQAC.sys Arbitrary Write Privilege Escalation",
  "fullname": "exploit/windows/local/mqac_write",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2014-07-22",
  "type": "exploit",
  "author": [
    "Matt Bergin",
    "Spencer McIntyre"
  ],
  "description": "A vulnerability within the MQAC.sys module allows an attacker to\n        overwrite an arbitrary location in kernel memory.\n\n        This module will elevate itself to SYSTEM, then inject the payload\n        into another SYSTEM process.",
  "references": [
    "https://cvedetails.com/cve/CVE-2014-4971/",
    "https://www.exploit-db.com/exploits/34112",
    "https://www.korelogic.com/Resources/Advisories/KL-001-2014-003.txt"
  ],
  "platform": "Windows",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP SP3"
  ],
  "path": "/modules/exploits/windows/local/mqac_write.rb",
  "ref_name": "windows/local/mqac_write",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "Stability": [
      "crash-os-restarts"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}