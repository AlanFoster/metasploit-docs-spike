{
  "name": "Windows TrackPopupMenu Win32k NULL Pointer Dereference",
  "fullname": "exploit/windows/local/ms14_058_track_popup_menu",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2014-10-14",
  "type": "exploit",
  "author": [
    "Unknown",
    "juan vazquez <juan.vazquez@metasploit.com>",
    "Spencer McIntyre",
    "OJ Reeves <oj@buffered.io>"
  ],
  "description": "This module exploits a NULL Pointer Dereference in win32k.sys, the vulnerability\n        can be triggered through the use of TrackPopupMenu. Under special conditions, the\n        NULL pointer dereference can be abused on xxxSendMessageTimeout to achieve arbitrary\n        code execution. This module has been tested successfully on Windows XP SP3, Windows\n        2003 SP2, Windows 7 SP1 and Windows 2008 32bits. Also on Windows 7 SP1 and Windows\n        2008 R2 SP1 64 bits.",
  "references": [
    "https://cvedetails.com/cve/CVE-2014-4113/",
    "OSVDB (113167)",
    "http://www.securityfocus.com/bid/70364",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2014/MS14-058",
    "http://blog.trendmicro.com/trendlabs-security-intelligence/an-analysis-of-a-windows-kernel-mode-vulnerability-cve-2014-4113/"
  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows x86",
    "Windows x64"
  ],
  "path": "/modules/exploits/windows/local/ms14_058_track_popup_menu.rb",
  "ref_name": "windows/local/ms14_058_track_popup_menu",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "Stability": [
      "crash-os-restarts"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}