{
  "name": "Windows NTUserMessageCall Win32k Kernel Pool Overflow (Schlamperei)",
  "fullname": "exploit/windows/local/ms13_053_schlamperei",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2013-12-01",
  "type": "exploit",
  "author": [
    "Nils",
    "Jon",
    "Donato Capitella <donato.capitella@mwrinfosecurity.com>",
    "Ben Campbell <ben.campbell@mwrinfosecurity.com>"
  ],
  "description": "This module leverages a kernel pool overflow in Win32k which allows local privilege escalation.\n        The kernel shellcode nulls the ACL for the winlogon.exe process (a SYSTEM process).\n        This allows any unprivileged process to freely migrate to winlogon.exe, achieving\n        privilege escalation. This exploit was used in pwn2own 2013 by MWR to break out of chrome's sandbox.\n        NOTE: when a meterpreter session started by this exploit exits, winlogin.exe is likely to crash.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-1300/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2013/MS13-053",
    "https://labs.mwrinfosecurity.com/blog/2013/09/06/mwr-labs-pwn2own-2013-write-up---kernel-exploit/"
  ],
  "platform": "Windows",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows 7 SP0/SP1"
  ],
  "path": "/modules/exploits/windows/local/ms13_053_schlamperei.rb",
  "ref_name": "windows/local/ms13_053_schlamperei",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}