{
  "name": "HP OmniInet.exe MSG_PROTOCOL Buffer Overflow",
  "fullname": "exploit/windows/misc/hp_omniinet_2",
  "aliases": [

  ],
  "rank": 500,
  "disclosure_date": "2009-12-17",
  "type": "exploit",
  "author": [
    "EgiX <n0b0d13s@gmail.com>",
    "Fairuzan Roslan <riaf@mysec.org>",
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits a stack-based buffer overflow in the Hewlett-Packard\n        OmniInet NT Service. By sending a specially crafted MSG_PROTOCOL (0x010b)\n        packet, a remote attacker may be able to execute arbitrary code with elevated\n        privileges.\n\n        This service is installed with HP OpenView Data Protector, HP Application\n        Recovery Manager and potentially other products. This exploit has been tested\n        against versions 6.1, 6.0, and 5.50 of Data Protector. and versions 6.0 and 6.1\n        of Application Recovery Manager.\n\n        NOTE: There are actually two consecutive wcscpy() calls in the program (which\n        may be why ZDI considered them two separate issues). However, this module only\n        exploits the second one.",
  "references": [
    "https://cvedetails.com/cve/CVE-2009-3844/",
    "http://www.securityfocus.com/bid/37250",
    "OSVDB (60852)",
    "http://www.zerodayinitiative.com/advisories/ZDI-09-091"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic Targeting",
    "HP OpenView Storage Data Protector A.05.50: INET, internal build 330",
    "HP OpenView Storage Data Protector A.06.00: INET, internal build 331",
    "HP StorageWorks Application Recovery Manager A.06.00: INET, internal build 81",
    "HP Application Recovery Manager software A.06.10: INET, internal build 282"
  ],
  "path": "/modules/exploits/windows/misc/hp_omniinet_2.rb",
  "ref_name": "windows/misc/hp_omniinet_2",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 5555,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    }
  ]
}