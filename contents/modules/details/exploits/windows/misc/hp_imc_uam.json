{
  "name": "HP Intelligent Management Center UAM Buffer Overflow",
  "fullname": "exploit/windows/misc/hp_imc_uam",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2012-08-29",
  "type": "exploit",
  "author": [
    "e6af8de8b1d4b2b6d5ba2610cbf9cd38",
    "sinn3r <sinn3r@metasploit.com>",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a remote buffer overflow in HP Intelligent Management Center\n        UAM. The vulnerability exists in the uam.exe component, when using sprint in a\n        insecure way for logging purposes. The vulnerability can be triggered by sending a\n        malformed packet to the 1811/UDP port. The module has been successfully tested on\n        HP iMC 5.0 E0101 and UAM 5.0 E0102 over Windows Server 2003 SP2 (DEP bypass).",
  "references": [
    "https://cvedetails.com/cve/CVE-2012-3274/",
    "OSVDB (85060)",
    "http://www.securityfocus.com/bid/55271",
    "http://www.zerodayinitiative.com/advisories/ZDI-12-171",
    "https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c03589863"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "HP iMC 5.0 E0101 / UAM 5.0 E0102 on Windows 2003 SP2"
  ],
  "path": "/modules/exploits/windows/misc/hp_imc_uam.rb",
  "ref_name": "windows/misc/hp_imc_uam",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 1811,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    }
  ]
}