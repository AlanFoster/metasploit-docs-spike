{
  "name": "Yokogawa CS3000 BKFSim_vhfd.exe Buffer Overflow",
  "fullname": "exploit/windows/scada/yokogawa_bkfsim_vhfd",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2014-05-23",
  "type": "exploit",
  "author": [
    "Redsadic <julian.vilas@gmail.com>",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a stack based buffer overflow on Yokogawa CS3000. The vulnerability\n        exists in the service BKFSim_vhfd.exe when using malicious user-controlled data to create\n        logs using functions like vsprintf and memcpy in an insecure way. This module has been\n        tested successfully on Yokogawa Centum CS3000 R3.08.50 over Windows XP SP3.",
  "references": [
    "https://cvedetails.com/cve/CVE-2014-3888/",
    "http://jvn.jp/vu/JVNVU95045914/index.html",
    "http://www.yokogawa.com/dcs/security/ysar/YSAR-14-0002E.pdf",
    "https://blog.rapid7.com/2014/07/07/r7-2014-06-disclosure-yokogawa-centum-cs-3000-bkfsimvhfdexe-buffer-overflow"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Yokogawa Centum CS3000 R3.08.50 / Windows XP SP3"
  ],
  "path": "/modules/exploits/windows/scada/yokogawa_bkfsim_vhfd.rb",
  "ref_name": "windows/scada/yokogawa_bkfsim_vhfd",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 20010,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    }
  ]
}