{
  "name": "Nuuo Central Management Server Authenticated Arbitrary File Upload",
  "fullname": "exploit/windows/nuuo/nuuo_cms_fu",
  "aliases": [

  ],
  "rank": 0,
  "disclosure_date": "2018-10-11",
  "type": "exploit",
  "author": [
    "Pedro Ribeiro <pedrib@gmail.com>"
  ],
  "description": "The COMMITCONFIG verb is used by a CMS client to upload and modify the configuration of the\n      CMS Server.\n      The vulnerability is in the \"FileName\" parameter, which accepts directory traversal (..\\..\\)\n      characters. Therefore, this function can be abused to overwrite any files in the installation\n      drive of CMS Server.\n\n      This vulnerability is exploitable in CMS versions up to and including v2.4.\n\n      This module will either use a provided session number (which can be guessed with an auxiliary\n      module) or attempt to login using a provided username and password - it will also try the\n      default credentials if nothing is provided.\n\n      This module will overwrite the LicenseTool.dll file in the CMS Server installation. If the module\n      fails to restore LicenseTool.dll then the installation will be corrupted and NCS Server will\n      not execute successfully.",
  "references": [
    "https://cvedetails.com/cve/CVE-2018-17936/",
    "https://ics-cert.us-cert.gov/advisories/ICSA-18-284-02",
    "https://seclists.org/fulldisclosure/2019/Jan/51",
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/nuuo-cms-ownage.txt"
  ],
  "platform": "Windows",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Nuuo Central Management Server <= v2.4.0"
  ],
  "path": "/modules/exploits/windows/nuuo/nuuo_cms_fu.rb",
  "ref_name": "windows/nuuo/nuuo_cms_fu",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "bool",
      "name": "EXE::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom exe instead of automatically generating a payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the executable template"
    },
    {
      "type": "path",
      "name": "EXE::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The executable template file name."
    },
    {
      "type": "bool",
      "name": "EXE::Inject",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to preserve the original EXE function"
    },
    {
      "type": "bool",
      "name": "EXE::OldMethod",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to use the substitution EXE generation method."
    },
    {
      "type": "bool",
      "name": "EXE::FallBack",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use the default template in case the specified one is missing"
    },
    {
      "type": "bool",
      "name": "MSI::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom msi instead of automatically generating a payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the msi template"
    },
    {
      "type": "path",
      "name": "MSI::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The msi template file name"
    },
    {
      "type": "bool",
      "name": "MSI::UAC",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 5180,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "NCSSESSION",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Session number of logged in user"
    },
    {
      "type": "string",
      "name": "NCSUSER",
      "required": false,
      "default": "admin",
      "aliases": [

      ],
      "advanced": false,
      "description": "NUUO Central Management System username"
    },
    {
      "type": "string",
      "name": "NCSPASS",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for NCSUSER"
    },
    {
      "type": "string",
      "name": "NCSVERSION",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Version header used during login"
    },
    {
      "type": "bool",
      "name": "NCSBRUTEAPI",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Bruteforce Version header used during login"
    },
    {
      "type": "bool",
      "name": "NCSTRACE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Show NCS requests and responses"
    }
  ]
}