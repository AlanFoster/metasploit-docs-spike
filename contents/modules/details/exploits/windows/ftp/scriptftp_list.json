{
  "name": "ScriptFTP LIST Remote Buffer Overflow",
  "fullname": "exploit/windows/ftp/scriptftp_list",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2011-10-12",
  "type": "exploit",
  "author": [
    "modpr0be",
    "TecR0c <roccogiovannicalvi@gmail.com>",
    "mr_me <steventhomasseeley@gmail.com>"
  ],
  "description": "AmmSoft's ScriptFTP client is susceptible to a remote buffer overflow\n        vulnerability that is triggered when processing a sufficiently long\n        filename during a FTP LIST command resulting in overwriting the\n        exception handler. Social engineering of executing a specially crafted\n        ftp file by double click will result in connecting to our malicious\n        server and perform arbitrary code execution which allows the attacker to\n        gain the same rights as the user running ScriptFTP. This vulnerability\n        affects versions 3.3 and earlier.",
  "references": [
    "https://cvedetails.com/cve/CVE-2011-3976/",
    "OSVDB (75633)",
    "https://www.exploit-db.com/exploits/17876",
    "https://www.kb.cert.org/vuls/id/440219"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP SP3 / Windows Vista"
  ],
  "path": "/modules/exploits/windows/ftp/scriptftp_list.rb",
  "ref_name": "windows/ftp/scriptftp_list",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "address",
      "name": "SRVHOST",
      "required": true,
      "default": "0.0.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."
    },
    {
      "type": "port",
      "name": "SRVPORT",
      "required": true,
      "default": 21,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local port to listen on."
    },
    {
      "type": "string",
      "name": "ListenerComm",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The specific communication channel to use for this service"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Negotiate SSL for incoming connections"
    },
    {
      "type": "path",
      "name": "SSLCert",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Path to a custom SSL certificate (default is randomly generated)"
    },
    {
      "type": "bool",
      "name": "SSLCompression",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSL/TLS-level compression"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maximum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "port",
      "name": "PASVPORT",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local PASV data port to listen on (0 is random)"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.ftp",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}