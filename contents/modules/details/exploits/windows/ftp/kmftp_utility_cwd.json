{
  "name": "Konica Minolta FTP Utility 1.00 Post Auth CWD Command SEH Overflow",
  "fullname": "exploit/windows/ftp/kmftp_utility_cwd",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2015-08-23",
  "type": "exploit",
  "author": [
    "Shankar Damodaran",
    "Muhamad Fadzil Ramli <mind1355@gmail.com>"
  ],
  "description": "This module exploits an SEH overflow in Konica Minolta FTP Server 1.00.\n        Konica Minolta FTP fails to check input size when parsing 'CWD' commands, which\n        leads to an SEH overflow.  Konica FTP allows anonymous access by default; valid\n        credentials are typically unnecessary to exploit this vulnerability.",
  "references": [
    "https://cvedetails.com/cve/CVE-2015-7768/",
    "EBD (37908)"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [
    21,
    2121
  ],
  "autofilter_services": [
    "ftp"
  ],
  "targets": [
    "Windows 7 SP1 x86"
  ],
  "path": "/modules/exploits/windows/ftp/kmftp_utility_cwd.rb",
  "ref_name": "windows/ftp/kmftp_utility_cwd",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 21,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "FTPUSER",
      "required": false,
      "default": "anonymous",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to authenticate as"
    },
    {
      "type": "string",
      "name": "FTPPASS",
      "required": false,
      "default": "mozilla@example.com",
      "aliases": [

      ],
      "advanced": false,
      "description": "The password for the specified username"
    },
    {
      "type": "integer",
      "name": "FTPTimeout",
      "required": true,
      "default": 16,
      "aliases": [

      ],
      "advanced": true,
      "description": "The number of seconds to wait for a reply from an FTP command"
    },
    {
      "type": "bool",
      "name": "FTPDEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Whether or not to print verbose debug statements"
    },
    {
      "type": "bool",
      "name": "PassiveMode",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set true for extended passive (EPSV) ftp mode."
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    }
  ]
}