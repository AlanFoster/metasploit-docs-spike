{
  "name": "MS12-027 MSCOMCTL ActiveX Buffer Overflow",
  "fullname": "exploit/windows/fileformat/ms12_027_mscomctl_bof",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2012-04-10",
  "type": "exploit",
  "author": [
    "Unknown",
    "juan vazquez <juan.vazquez@metasploit.com>",
    "sinn3r <sinn3r@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow in MSCOMCTL.OCX. It uses a malicious\n        RTF to embed the specially crafted MSComctlLib.ListViewCtrl.2 Control as exploited\n        in the wild on April 2012.\n\n        This module targets Office 2007 and Office 2010 targets. The DEP/ASLR bypass on Office\n        2010 is done with the Ikazuchi ROP chain proposed by Abysssec. This chain uses\n        \"msgr3en.dll\", which will load after office got load, so the malicious file must\n        be loaded through \"File / Open\" to achieve exploitation.",
  "references": [
    "https://cvedetails.com/cve/CVE-2012-0158/",
    "OSVDB (81125)",
    "http://www.securityfocus.com/bid/52911",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2012/MS12-027",
    "http://contagiodump.blogspot.com.es/2012/04/cve2012-0158-south-china-sea-insider.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Microsoft Office 2007 [no-SP/SP1/SP2/SP3] English on Windows [XP SP3 / 7 SP1] English",
    "Microsoft Office 2010 SP1 English on Windows [XP SP3 / 7 SP1] English"
  ],
  "path": "/modules/exploits/windows/fileformat/ms12_027_mscomctl_bof.rb",
  "ref_name": "windows/fileformat/ms12_027_mscomctl_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.doc",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}