{
  "name": "McAfee Remediation Client ActiveX Control Buffer Overflow",
  "fullname": "exploit/windows/fileformat/mcafee_hercules_deletesnapshot",
  "aliases": [

  ],
  "rank": 100,
  "disclosure_date": "2008-08-04",
  "type": "exploit",
  "author": [
    "MC <mc@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow in McAfee Remediation Agent 4.5.0.41. When\n        sending an overly long string to the DeleteSnapshot() method\n        of enginecom.dll (3.7.0.9) an attacker may be able to execute arbitrary code.\n        This control is not marked safe for scripting, so choose your attack vector accordingly.",
  "references": [
    "OSVDB (94540)",
    "https://www.exploit-db.com/exploits/16639"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP SP0-SP3 / Windows Vista / IE 6.0 SP0-SP2 / IE 7"
  ],
  "path": "/modules/exploits/windows/fileformat/mcafee_hercules_deletesnapshot.rb",
  "ref_name": "windows/fileformat/mcafee_hercules_deletesnapshot",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": false,
      "default": "msf.html",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}