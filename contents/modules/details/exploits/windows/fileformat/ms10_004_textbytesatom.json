{
  "name": "MS10-004 Microsoft PowerPoint Viewer TextBytesAtom Stack Buffer Overflow",
  "fullname": "exploit/windows/fileformat/ms10_004_textbytesatom",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2010-02-09",
  "type": "exploit",
  "author": [
    "SkD",
    "Snake",
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow vulnerability in the handling of\n        the TextBytesAtom records by Microsoft PowerPoint Viewer. According to Microsoft,\n        the PowerPoint Viewer distributed with Office 2003 SP3 and earlier, as well as\n        Office 2004 for Mac, are vulnerable.\n\n        NOTE: The vulnerable code path is not reachable on versions of Windows prior to\n        Windows Vista.",
  "references": [
    "https://cvedetails.com/cve/CVE-2010-0033/",
    "OSVDB (62241)",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2010/MS10-004",
    "http://www.zerodayinitiative.com/advisories/ZDI-10-017"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Microsoft PowerPoint Viewer 2003",
    "Microsoft PowerPoint Viewer 2003 (kb949041 or kb956500) or Office 2003 SP3",
    "Microsoft PowerPoint Viewer 2003 (kb969615)",
    "Crash Target for Debugging"
  ],
  "path": "/modules/exploits/windows/fileformat/ms10_004_textbytesatom.rb",
  "ref_name": "windows/fileformat/ms10_004_textbytesatom",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.ppt",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    },
    {
      "type": "string",
      "name": "OUTPUTPATH",
      "required": true,
      "default": "/Users/alan/.msf4/local",
      "aliases": [

      ],
      "advanced": false,
      "description": "Path to output the file"
    }
  ]
}