{
  "name": "Office OLE Multiple DLL Side Loading Vulnerabilities",
  "fullname": "exploit/windows/fileformat/office_ole_multiple_dll_hijack",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2015-12-08",
  "type": "exploit",
  "author": [
    "Yorick Koster"
  ],
  "description": "Multiple DLL side loading vulnerabilities were found in various COM components.\n        These issues can be exploited by loading various these components as an embedded\n        OLE object. When instantiating a vulnerable object Windows will try to load one\n        or more DLLs from the current working directory. If an attacker convinces the\n        victim to open a specially crafted (Office) document from a directory also\n        containing the attacker's DLL file, it is possible to execute arbitrary code with\n        the privileges of the target user. This can potentially result in the attacker\n        taking complete control of the affected system.",
  "references": [
    "https://cvedetails.com/cve/CVE-2015-6132/",
    "https://cvedetails.com/cve/CVE-2015-6128/",
    "https://cvedetails.com/cve/CVE-2015-6133/",
    "https://cvedetails.com/cve/CVE-2016-0041/",
    "https://cvedetails.com/cve/CVE-2016-0100/",
    "https://cvedetails.com/cve/CVE-2016-3235/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2015/MS15-132",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/MS16-014",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/MS16-025",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/MS16-041",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/MS16-070",
    "https://securify.nl/advisory/SFY20150801/com__services_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150805/event_viewer_snapin_multiple_dll_side_loading_vulnerabilities.html",
    "https://securify.nl/advisory/SFY20150803/windows_authentication_ui_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20151102/shutdown_ux_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150802/shockwave_flash_object_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150806/ole_db_provider_for_oracle_multiple_dll_side_loading_vulnerabilities.html",
    "https://securify.nl/advisory/SFY20150905/nps_datastore_server_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150906/bda_mpeg2_transport_information_filter_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20151101/mapsupdatetask_task_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150904/windows_mail_find_people_dll_side_loading_vulnerability.html",
    "https://securify.nl/advisory/SFY20150804/microsoft_visio_multiple_dll_side_loading_vulnerabilities.html"
  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "All",
    "COM+ Services / Windows Vista - 10 / Office 2007 - 2016 (MS15-132)",
    "Shockwave Flash Object / Windows 10 / Office 2013 (APSB15-28)",
    "Windows Authentication UI / Windows 10 / Office 2013 - 2016 (MS15-132)",
    "Shutdown UX / Windows 10 / Office 2016 (MS15-132)",
    "MapUpdateTask Tasks / Windows 10 / Office 2016 (MS16-014)",
    "Microsoft Visio 2010 / Windows 7 (MS16-070)",
    "Event Viewer Snapin / Windows Vista - 7 / Office 2007 - 2013 (MS15-132)",
    "OLE DB Provider for Oracle / Windows Vista - 7 / Office 2007 - 2013 (MS16-014)",
    "Windows Mail Find People / Windows Vista / Office 2010 (MS16-025)",
    "NPS Datastore server / Windows Vista / Office 2010 (MS16-014)",
    "BDA MPEG2 Transport Information Filter / Windows Vista / Office 2010 (MS16-014)"
  ],
  "path": "/modules/exploits/windows/fileformat/office_ole_multiple_dll_hijack.rb",
  "ref_name": "windows/fileformat/office_ole_multiple_dll_hijack",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.ppsx",
      "aliases": [

      ],
      "advanced": false,
      "description": "The PPSX file"
    },
    {
      "type": "bool",
      "name": "EXE::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom exe instead of automatically generating a payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the executable template"
    },
    {
      "type": "path",
      "name": "EXE::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The executable template file name."
    },
    {
      "type": "bool",
      "name": "EXE::Inject",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to preserve the original EXE function"
    },
    {
      "type": "bool",
      "name": "EXE::OldMethod",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to use the substitution EXE generation method."
    },
    {
      "type": "bool",
      "name": "EXE::FallBack",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use the default template in case the specified one is missing"
    },
    {
      "type": "bool",
      "name": "MSI::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom msi instead of automatically generating a payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the msi template"
    },
    {
      "type": "path",
      "name": "MSI::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The msi template file name"
    },
    {
      "type": "bool",
      "name": "MSI::UAC",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"
    }
  ]
}