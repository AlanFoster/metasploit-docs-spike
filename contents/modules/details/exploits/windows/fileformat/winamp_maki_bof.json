{
  "name": "Winamp MAKI Buffer Overflow",
  "fullname": "exploit/windows/fileformat/winamp_maki_bof",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2009-05-20",
  "type": "exploit",
  "author": [
    "Monica Sojeong Hong",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a stack based buffer overflow in Winamp 5.55. The flaw\n        exists in the gen_ff.dll and occurs while parsing a specially crafted MAKI file,\n        where memmove is used in an insecure way with user controlled data.\n\n        To exploit the vulnerability the attacker must convince the victim to install the\n        generated mcvcore.maki file in the \"scripts\" directory of the default \"Bento\" skin,\n        or generate a new skin using the crafted mcvcore.maki file. The module has been\n        tested successfully on Windows XP SP3 and Windows 7 SP1.",
  "references": [
    "https://cvedetails.com/cve/CVE-2009-1831/",
    "OSVDB (54902)",
    "http://www.securityfocus.com/bid/35052",
    "https://www.exploit-db.com/exploits/8783",
    "https://www.exploit-db.com/exploits/8772",
    "https://www.exploit-db.com/exploits/8770",
    "https://www.exploit-db.com/exploits/8767",
    "http://vrt-sourcefire.blogspot.com/2009/05/winamp-maki-parsing-vulnerability.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Winamp 5.55 / Windows XP SP3 / Windows 7 SP1"
  ],
  "path": "/modules/exploits/windows/fileformat/winamp_maki_bof.rb",
  "ref_name": "windows/fileformat/winamp_maki_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    }
  ]
}