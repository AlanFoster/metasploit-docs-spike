{
  "name": "Adobe Reader ToolButton Use After Free",
  "fullname": "exploit/windows/fileformat/adobe_toolbutton",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-08-08",
  "type": "exploit",
  "author": [
    "Soroush Dalili",
    "Unknown",
    "sinn3r <sinn3r@metasploit.com>",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a use after free condition on Adobe Reader versions 11.0.2, 10.1.6\n        and 9.5.4 and prior. The vulnerability exists while handling the ToolButton object, where\n        the cEnable callback can be used to early free the object memory. Later use of the object\n        allows triggering the use after free condition. This module has been tested successfully\n        on Adobe Reader 11.0.2, 10.0.4 and 9.5.0 on Windows XP SP3, as exploited in the wild in\n        November, 2013.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-3346/",
    "OSVDB (96745)",
    "http://www.zerodayinitiative.com/advisories/ZDI-13-212",
    "http://www.adobe.com/support/security/bulletins/apsb13-15.html",
    "http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/ms-windows-local-privilege-escalation-zero-day-in-the-wild.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows XP / Adobe Reader 9/10/11"
  ],
  "path": "/modules/exploits/windows/fileformat/adobe_toolbutton.rb",
  "ref_name": "windows/fileformat/adobe_toolbutton",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.pdf",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}