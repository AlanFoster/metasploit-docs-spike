{
  "name": "Apple Quicktime 7 Invalid Atom Length Buffer Overflow",
  "fullname": "exploit/windows/fileformat/apple_quicktime_rdrf",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-05-22",
  "type": "exploit",
  "author": [
    "Jason Kratzer",
    "Tom Gallagher",
    "Paul Bates",
    "sinn3r <sinn3r@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability found in Apple QuickTime. The flaw is\n        triggered when QuickTime fails to properly handle the data length for certain\n        atoms such as 'rdrf' or 'dref' in the Alis record, which may result a buffer\n        overflow by loading a specially crafted .mov file, and allows arbitrary\n        code execution under the context of the current user. Please note: Since an egghunter\n        is used to search for the payload, this may require additional time for\n        the exploit to complete.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-1017/",
    "OSVDB (93625)",
    "http://www.securityfocus.com/bid/60097",
    "http://support.apple.com/kb/HT5770",
    "http://www.zerodayinitiative.com/advisories/ZDI-13-110"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Quicktime 7.7.0 - 7.7.3 on Windows XP SP3"
  ],
  "path": "/modules/exploits/windows/fileformat/apple_quicktime_rdrf.rb",
  "ref_name": "windows/fileformat/apple_quicktime_rdrf",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.mov",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}