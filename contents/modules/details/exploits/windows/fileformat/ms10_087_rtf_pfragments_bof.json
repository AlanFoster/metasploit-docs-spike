{
  "name": "MS10-087 Microsoft Word RTF pFragments Stack Buffer Overflow (File Format)",
  "fullname": "exploit/windows/fileformat/ms10_087_rtf_pfragments_bof",
  "aliases": [

  ],
  "rank": 500,
  "disclosure_date": "2010-11-09",
  "type": "exploit",
  "author": [
    "wushi of team509",
    "unknown",
    "jduck <jduck@metasploit.com>",
    "DJ Manila Ice, Vesh, CA"
  ],
  "description": "This module exploits a stack-based buffer overflow in the handling of the\n        'pFragments' shape property within the Microsoft Word RTF parser. All versions\n        of Microsoft Office 2010, 2007, 2003, and XP prior to the release of the\n        MS10-087 bulletin are vulnerable.\n\n        This module does not attempt to exploit the vulnerability via Microsoft Outlook.\n\n        The Microsoft Word RTF parser was only used by default in versions of Microsoft\n        Word itself prior to Office 2007. With the release of Office 2007, Microsoft\n        began using the Word RTF parser, by default, to handle rich-text messages within\n        Outlook as well. It was possible to configure Outlook 2003 and earlier to use\n        the Microsoft Word engine too, but it was not a default setting.\n\n        It appears as though Microsoft Office 2000 is not vulnerable. It is unlikely that\n        Microsoft will confirm or deny this since Office 2000 has reached its support\n        cycle end-of-life.",
  "references": [
    "https://cvedetails.com/cve/CVE-2010-3333/",
    "OSVDB (69085)",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2010/MS10-087",
    "http://www.securityfocus.com/bid/44652",
    "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=880"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic",
    "Microsoft Office 2002 SP3 English on Windows XP SP3 English",
    "Microsoft Office 2003 SP3 English on Windows XP SP3 English",
    "Microsoft Office 2007 SP0 English on Windows XP SP3 English",
    "Microsoft Office 2007 SP0 English on Windows Vista SP0 English",
    "Microsoft Office 2007 SP0 English on Windows 7 SP0 English",
    "Crash Target for Debugging"
  ],
  "path": "/modules/exploits/windows/fileformat/ms10_087_rtf_pfragments_bof.rb",
  "ref_name": "windows/fileformat/ms10_087_rtf_pfragments_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.rtf",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    }
  ]
}