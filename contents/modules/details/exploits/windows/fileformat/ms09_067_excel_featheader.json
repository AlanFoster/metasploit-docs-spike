{
  "name": "MS09-067 Microsoft Excel Malformed FEATHEADER Record Vulnerability",
  "fullname": "exploit/windows/fileformat/ms09_067_excel_featheader",
  "aliases": [

  ],
  "rank": 400,
  "disclosure_date": "2009-11-10",
  "type": "exploit",
  "author": [
    "Sean Larsson",
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability in the handling of the FEATHEADER record\n          by Microsoft Excel. Revisions of Office XP and later prior to the release of the\n          MS09-067 bulletin are vulnerable.\n\n          When processing a FEATHEADER (Shared Feature) record, Microsoft used a data\n          structure from the file to calculate a pointer offset without doing proper\n          validation. Attacker supplied data is then used to calculate the location of an\n          object, and in turn a virtual function call. This results in arbitrary code\n          execution.\n\n          NOTE: On some versions of Office, the user will need to dismiss a warning dialog\n          prior to the payload executing.",
  "references": [
    "https://cvedetails.com/cve/CVE-2009-3129/",
    "OSVDB (59860)",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2009/MS09-067",
    "http://www.securityfocus.com/bid/36945",
    "http://www.zerodayinitiative.com/advisories/ZDI-09-083",
    "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=832"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Microsoft Office 2002 (XP) SP3 base English on Windows XP SP3 English",
    "Microsoft Office 2002 (XP) SP3 w/kb969680 English on Windows XP SP3 English",
    "Microsoft Office 2003 SP0 English on Windows XP SP3 English",
    "Microsoft Office 2007 SP2 English on Windows XP SP3 English",
    "Crash Target for Debugging"
  ],
  "path": "/modules/exploits/windows/fileformat/ms09_067_excel_featheader.rb",
  "ref_name": "windows/fileformat/ms09_067_excel_featheader",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.xls",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    },
    {
      "type": "string",
      "name": "OUTPUTPATH",
      "required": true,
      "default": "/Users/alan/.msf4/local",
      "aliases": [

      ],
      "advanced": false,
      "description": "The output path to use."
    }
  ]
}