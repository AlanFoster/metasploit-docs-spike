{
  "name": "Chasys Draw IES Buffer Overflow",
  "fullname": "exploit/windows/fileformat/chasys_draw_ies_bmp_bof",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-07-26",
  "type": "exploit",
  "author": [
    "Christopher Gabriel",
    "Longinos Recuero Bustos",
    "Javier 'soez'",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a buffer overflow vulnerability found in Chasys Draw IES\n        (version 4.10.01). The vulnerability exists in the module flt_BMP.dll, while\n        parsing BMP files, where the ReadFile function is used to store user provided data\n        on the stack in an insecure way. It results in arbitrary code execution under the\n        context of the user viewing a specially crafted BMP file. This module has been\n        tested successfully with Chasys Draw IES 4.10.01 on Windows XP SP3 and Windows 7\n        SP1.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-3928/",
    "OSVDB (95689)",
    "http://www.securityfocus.com/bid/61463",
    "http://secunia.com/advisories/53773/",
    "http://longinox.blogspot.com/2013/08/explot-stack-based-overflow-bypassing.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Chasys Draw IES 4.10.01 / Windows XP SP3 / Windows 7 SP1"
  ],
  "path": "/modules/exploits/windows/fileformat/chasys_draw_ies_bmp_bof.rb",
  "ref_name": "windows/fileformat/chasys_draw_ies_bmp_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.bmp",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}