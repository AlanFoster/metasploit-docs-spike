{
  "name": "KingView Log File Parsing Buffer Overflow",
  "fullname": "exploit/windows/fileformat/kingview_kingmess_kvl",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2012-11-20",
  "type": "exploit",
  "author": [
    "Lucas Apa",
    "Carlos Mario Penagos Hollman",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability found in KingView <= 6.55. It exists in\n        the KingMess.exe application when handling log files, due to the insecure usage of\n        sprintf. This module uses a malformed .kvl file which must be opened by the victim\n        via the KingMess.exe application, through the 'Browse Log Files' option. The module\n        has been tested successfully on KingView 6.52 and KingView 6.53 Free Trial over\n        Windows XP SP3.",
  "references": [
    "https://cvedetails.com/cve/CVE-2012-4711/",
    "OSVDB (89690)",
    "http://www.securityfocus.com/bid/57909",
    "http://ics-cert.us-cert.gov/pdf/ICSA-13-043-02.pdf"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "KingView 6.52 English / KingView 6.53 Free Trial / Kingmess.exe 65.20.2003.10300 / Windows XP SP3"
  ],
  "path": "/modules/exploits/windows/fileformat/kingview_kingmess_kvl.rb",
  "ref_name": "windows/fileformat/kingview_kingmess_kvl",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.kvl",
      "aliases": [

      ],
      "advanced": false,
      "description": "The filename"
    }
  ]
}