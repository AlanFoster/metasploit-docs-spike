{
  "name": "Irfanview JPEG2000 jp2 Stack Buffer Overflow",
  "fullname": "exploit/windows/fileformat/irfanview_jpeg2000_bof",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2012-01-16",
  "type": "exploit",
  "author": [
    "Parvez Anwar <parvez@greyhathacker.net>",
    "mr_me <steventhomasseeley@gmail.com>",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a stack-based buffer overflow vulnerability in\n        version <= 4.3.2.0 of Irfanview's JPEG2000.dll plugin. This exploit has\n        been tested on a specific version of irfanview (v4.3.2), although other\n        versions may work also. The vulnerability is triggered via parsing an\n        invalid qcd chunk structure and specifying a malformed qcd size and\n        data.\n\n        Payload delivery and vulnerability trigger can be executed in multiple\n        ways. The user can double click the file, use the file dialog, open via\n        the icon and drag/drop the file into Irfanview's window. An egg hunter\n        is used for stability.",
  "references": [
    "https://cvedetails.com/cve/CVE-2012-0897/",
    "OSVDB (78333)",
    "http://www.securityfocus.com/bid/51426",
    "http://www.greyhathacker.net/?p=525"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Irfanview 4.32 / Plugins 4.32 / Windows Universal"
  ],
  "path": "/modules/exploits/windows/fileformat/irfanview_jpeg2000_bof.rb",
  "ref_name": "windows/fileformat/irfanview_jpeg2000_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.jp2",
      "aliases": [

      ],
      "advanced": false,
      "description": "The output file name."
    }
  ]
}