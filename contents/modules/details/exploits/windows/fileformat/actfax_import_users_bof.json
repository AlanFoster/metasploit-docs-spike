{
  "name": "ActiveFax (ActFax) 4.3 Client Importer Buffer Overflow",
  "fullname": "exploit/windows/fileformat/actfax_import_users_bof",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2012-08-28",
  "type": "exploit",
  "author": [
    "Craig Freyman",
    "Brandon Perry",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module exploits a vulnerability in ActiveFax Server. The vulnerability is\n        a stack based buffer overflow in the \"Import Users from File\" function, due to the\n        insecure usage of strcpy while parsing the csv formatted file. The module creates a\n        .exp file that must be imported with ActiveFax Server. It must be imported with the\n        default character set 'ECMA-94 / Latin 1 (ISO 8859)'. The module has been tested\n        successfully on ActFax Server 4.32 over Windows XP SP3 and Windows 7 SP1. In the\n        Windows XP case, when ActFax runs as a service, it will execute as SYSTEM.",
  "references": [
    "OSVDB (85175)",
    "https://www.exploit-db.com/exploits/20915",
    "http://www.pwnag3.com/2012/08/actfax-local-privilege-escalation.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "ActFax 4.32 / Windows XP SP3 EN / Windows 7 SP1"
  ],
  "path": "/modules/exploits/windows/fileformat/actfax_import_users_bof.rb",
  "ref_name": "windows/fileformat/actfax_import_users_bof",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": false,
      "default": "msf.exp",
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    }
  ]
}