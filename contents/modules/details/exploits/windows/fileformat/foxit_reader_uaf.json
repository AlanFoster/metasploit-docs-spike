{
  "name": "Foxit PDF Reader Pointer Overwrite UAF",
  "fullname": "exploit/windows/fileformat/foxit_reader_uaf",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2018-04-20",
  "type": "exploit",
  "author": [
    "mr_me",
    "bit from meepwn",
    "saelo",
    "Jacob Robles"
  ],
  "description": "Foxit PDF Reader v9.0.1.1049 has a Use-After-Free vulnerability\n        in the Text Annotations component and the TypedArray's use\n        uninitialized pointers.\n\n        The vulnerabilities can be combined to leak a vtable memory address,\n        which can be adjusted to point to the base address of the executable.\n        A ROP chain can be constructed that will execute when Foxit Reader\n        performs the UAF.\n\n        This module has been tested on Windows 7 x64, Windows 10 Pro x64\n        Build 17134, and Windows 10 Enterprise x64. Windows 10 Enterprise\n        must have insecure logons enabled for the exploit to work as expected.",
  "references": [
    "https://cvedetails.com/cve/CVE-2018-9948/",
    "https://cvedetails.com/cve/CVE-2018-9958/",
    "http://www.zerodayinitiative.com/advisories/ZDI-18-332",
    "http://www.zerodayinitiative.com/advisories/ZDI-18-342",
    "https://srcincite.io/blog/2018/06/22/foxes-among-us-foxit-reader-vulnerability-discovery-and-exploitation.html",
    "https://srcincite.io/pocs/cve-2018-99{48,58}.pdf.txt"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Windows 10 Pro x64 Build 17134"
  ],
  "path": "/modules/exploits/windows/fileformat/foxit_reader_uaf.rb",
  "ref_name": "windows/fileformat/foxit_reader_uaf",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The file name."
    },
    {
      "type": "string",
      "name": "EXENAME",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "EXE file to download"
    },
    {
      "type": "string",
      "name": "SHARE",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "SMB share hosting exe"
    }
  ]
}