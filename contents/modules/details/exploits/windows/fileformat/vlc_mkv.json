{
  "name": "VLC Media Player MKV Use After Free",
  "fullname": "exploit/windows/fileformat/vlc_mkv",
  "aliases": [

  ],
  "rank": 500,
  "disclosure_date": "2018-05-24",
  "type": "exploit",
  "author": [
    "Eugene Ng - GovTech",
    "Winston Ho - GovTech"
  ],
  "description": "This module exploits a use after free vulnerability in\n        VideoLAN VLC =< 2.2.8. The vulnerability exists in the parsing of\n        MKV files and affects both 32 bits and 64 bits.\n\n          In order to exploit this, this module will generate two files:\n        The first .mkv file contains the main vulnerability and heap spray,\n        the second .mkv file is required in order to take the vulnerable code\n        path and should be placed under the same directory as the .mkv file.\n\n          This module has been tested against VLC v2.2.8. Tested with payloads\n        windows/exec, windows/x64/exec, windows/shell/reverse_tcp,\n        windows/x64/shell/reverse_tcp. Meterpreter payloads if used can\n        cause the application to crash instead.",
  "references": [
    "https://cvedetails.com/cve/CVE-2018-11529/",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11529",
    "https://www.exploit-db.com/exploits/44979"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "VLC 2.2.8 on Windows 10 x86",
    "VLC 2.2.8 on Windows 10 x64"
  ],
  "path": "/modules/exploits/windows/fileformat/vlc_mkv.rb",
  "ref_name": "windows/fileformat/vlc_mkv",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "MKV_ONE",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "mkv that should be opened"
    },
    {
      "type": "string",
      "name": "MKV_TWO",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "The auxiliary file name."
    }
  ]
}