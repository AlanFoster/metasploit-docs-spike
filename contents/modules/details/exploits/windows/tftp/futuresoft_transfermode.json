{
  "name": "FutureSoft TFTP Server 2000 Transfer-Mode Overflow",
  "fullname": "exploit/windows/tftp/futuresoft_transfermode",
  "aliases": [

  ],
  "rank": 200,
  "disclosure_date": "2005-05-31",
  "type": "exploit",
  "author": [
    "MC <mc@metasploit.com>"
  ],
  "description": "This module exploits a stack buffer overflow in the FutureSoft TFTP Server\n        2000 product. By sending an overly long transfer-mode string, we were able\n        to overwrite both the SEH and the saved EIP. A subsequent write-exception\n        that will occur allows the transferring of execution to our shellcode\n        via the overwritten SEH. This module has been tested against Windows\n        2000 Professional and for some reason does not seem to work against\n        Windows 2000 Server (could not trigger the overflow at all).",
  "references": [
    "https://cvedetails.com/cve/CVE-2005-1812/",
    "OSVDB (16954)",
    "http://www.securityfocus.com/bid/13821"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic",
    "Windows 2000 Pro English ALL",
    "Windows XP Pro SP0/SP1 English",
    "Windows NT SP5/SP6a English",
    "Windows 2003 Server English"
  ],
  "path": "/modules/exploits/windows/tftp/futuresoft_transfermode.rb",
  "ref_name": "windows/tftp/futuresoft_transfermode",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 69,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "bool",
      "name": "DynamicSehRecord",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate a dynamic SEH record (more stealthy)"
    }
  ]
}