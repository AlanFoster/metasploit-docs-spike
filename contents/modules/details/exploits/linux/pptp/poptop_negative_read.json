{
  "name": "Poptop Negative Read Overflow",
  "fullname": "exploit/linux/pptp/poptop_negative_read",
  "aliases": [

  ],
  "rank": 500,
  "disclosure_date": "2003-04-09",
  "type": "exploit",
  "author": [
    "spoonm <spoonm@no$email.com>"
  ],
  "description": "This is an exploit for the Poptop negative read overflow.  This will\n        work against versions prior to 1.1.3-b3 and 1.1.3-20030409, but I\n        currently do not have a good way to detect Poptop versions.\n\n        The server will by default only allow 4 concurrent manager processes\n        (what we run our code in), so you could have a max of 4 shells at once.\n\n        Using the current method of exploitation, our socket will be closed\n        before we have the ability to run code, preventing the use of Findsock.",
  "references": [
    "https://cvedetails.com/cve/CVE-2003-0213/",
    "OSVDB (3293)",
    "http://securityfocus.com/archive/1/317995",
    "http://www.freewebs.com/blightninjas/"
  ],
  "platform": "Linux",
  "arch": "x86",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Linux Bruteforce"
  ],
  "path": "/modules/exploits/linux/pptp/poptop_negative_read.rb",
  "ref_name": "linux/pptp/poptop_negative_read",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 1723,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "BruteWait",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Delay between brute force attempts"
    },
    {
      "type": "integer",
      "name": "BruteStep",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Step size between brute force attempts"
    },
    {
      "type": "integer",
      "name": "PreReturnLength",
      "required": true,
      "default": 220,
      "aliases": [

      ],
      "advanced": true,
      "description": "Space before we hit the return address.  Affects PayloadSpace."
    },
    {
      "type": "integer",
      "name": "RetLength",
      "required": true,
      "default": 32,
      "aliases": [

      ],
      "advanced": true,
      "description": "Length of returns after payload."
    },
    {
      "type": "integer",
      "name": "ExtraSpace",
      "required": true,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "The exploit builds two protocol frames, the header frame and the control frame. ExtraSpace allows you use this space for the payload instead of the protocol (breaking the protocol, but still triggering the bug). If this value is <= 128, it doesn't really disobey the protocol, it just uses the Vendor and Hostname fields for payload data (these should eventually be filled in to look like a real client, ie windows).  I've had successful exploitation with this set to 154, but nothing over 128 is suggested."
    },
    {
      "type": "string",
      "name": "Hostname",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": true,
      "description": "PPTP Packet hostname"
    },
    {
      "type": "string",
      "name": "Vendor",
      "required": true,
      "default": "Microsoft Windows NT",
      "aliases": [

      ],
      "advanced": true,
      "description": "PPTP Packet vendor"
    }
  ]
}