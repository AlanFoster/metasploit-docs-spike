{
  "name": "Service Persistence",
  "fullname": "exploit/linux/local/service_persistence",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "1983-01-01",
  "type": "exploit",
  "author": [
    "h00die <mike@shorebreaksecurity.com>",
    "Cale Black"
  ],
  "description": "This module will create a service on the box, and mark it for auto-restart.\n          We need enough access to write service files and potentially restart services\n          Targets:\n            System V:\n              CentOS <= 5\n              Debian <= 6\n              Kali 2.0\n              Ubuntu <= 9.04\n            Upstart:\n              CentOS 6\n              Fedora >= 9, < 15\n              Ubuntu >= 9.10, <= 14.10\n            systemd:\n              CentOS 7\n              Debian >= 7, <=8\n              Fedora >= 15\n              Ubuntu >= 15.04\n          Note: System V won't restart the service if it dies, only an init change (reboot etc) will restart it.",
  "references": [
    "https://www.digitalocean.com/community/tutorials/how-to-configure-a-linux-service-to-start-automatically-after-a-crash-or-reboot-part-1-practical-examples"
  ],
  "platform": "Unix, Linux",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Auto",
    "System V",
    "Upstart",
    "systemd",
    "systemd user"
  ],
  "path": "/modules/exploits/linux/local/service_persistence.rb",
  "ref_name": "linux/local/service_persistence",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "integer",
      "name": "FileDropperDelay",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Delay in seconds before attempting cleanup"
    },
    {
      "type": "path",
      "name": "SHELLPATH",
      "required": true,
      "default": "/usr/local/bin",
      "aliases": [

      ],
      "advanced": false,
      "description": "Writable path to put our shell"
    },
    {
      "type": "string",
      "name": "SHELL_NAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Name of shell file to write"
    },
    {
      "type": "string",
      "name": "SERVICE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Name of service to create"
    },
    {
      "type": "bool",
      "name": "EnableService",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable the service"
    }
  ]
}