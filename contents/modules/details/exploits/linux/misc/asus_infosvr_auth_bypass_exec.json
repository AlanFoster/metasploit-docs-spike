{
  "name": "ASUS infosvr Auth Bypass Command Execution",
  "fullname": "exploit/linux/misc/asus_infosvr_auth_bypass_exec",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2015-01-04",
  "type": "exploit",
  "author": [
    "Friedrich Postelstorfer",
    "jduck <jduck@metasploit.com>",
    "bcoles <bcoles@gmail.com>"
  ],
  "description": "This module exploits an authentication bypass vulnerability in the\n        infosvr service running on UDP port 9999 on various ASUS routers to\n        execute arbitrary commands as root.\n\n        This module launches the BusyBox Telnet daemon on the port specified\n        in the TelnetPort option to gain an interactive remote shell.\n\n        This module was tested successfully on an ASUS RT-N12E with firmware\n        version 2.0.0.35.\n\n        Numerous ASUS models are reportedly affected, but untested.",
  "references": [
    "https://cvedetails.com/cve/CVE-2014-9583/",
    "https://www.exploit-db.com/exploits/35688",
    "https://github.com/jduck/asus-cmd"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/linux/misc/asus_infosvr_auth_bypass_exec.rb",
  "ref_name": "linux/misc/asus_infosvr_auth_bypass_exec",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 9999,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "TelnetPort",
      "required": true,
      "default": 4444,
      "aliases": [

      ],
      "advanced": false,
      "description": "The port for Telnetd to bind"
    },
    {
      "type": "integer",
      "name": "TelnetTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of seconds to wait for connection to telnet"
    },
    {
      "type": "integer",
      "name": "TelnetBannerTimeout",
      "required": true,
      "default": 25,
      "aliases": [

      ],
      "advanced": false,
      "description": "The number of seconds to wait for the telnet banner"
    },
    {
      "type": "string",
      "name": "CommandShellCleanupCommand",
      "required": true,
      "default": "exit",
      "aliases": [

      ],
      "advanced": true,
      "description": "A command to run before the session is closed"
    }
  ]
}