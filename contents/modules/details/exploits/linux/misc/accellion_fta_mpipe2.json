{
  "name": "Accellion FTA MPIPE2 Command Execution",
  "fullname": "exploit/linux/misc/accellion_fta_mpipe2",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2011-02-07",
  "type": "exploit",
  "author": [
    "hdm <x@hdm.io>"
  ],
  "description": "This module exploits a chain of vulnerabilities in the Accellion\n        File Transfer appliance. This appliance exposes a UDP service on\n        port 8812 that acts as a gateway to the internal communication bus.\n        This service uses Blowfish encryption for authentication, but the\n        appliance ships with two easy to guess default authentication keys.\n        This module abuses the known default encryption keys to inject a\n        message into the communication bus. In order to execute arbitrary\n        commands on the remote appliance, a message is injected into the bus\n        destined for the 'matchrep' service. This service exposes a function\n        named 'insert_plugin_meta_info' which is vulnerable to an input\n        validation flaw in a call to system(). This provides access to the\n        'soggycat' user account, which has sudo privileges to run the\n        primary admin tool as root. These two flaws are fixed in update\n        version FTA_8_0_562.",
  "references": [
    "OSVDB (71362)",
    "OSVDB (71363)",
    "http://www.rapid7.com/security-center/advisories/R7-0039.jsp"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/linux/misc/accellion_fta_mpipe2.rb",
  "ref_name": "linux/misc/accellion_fta_mpipe2",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 8812,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "string",
      "name": "APPID",
      "required": true,
      "default": "1000",
      "aliases": [

      ],
      "advanced": false,
      "description": "The application ID (usually 1000)"
    }
  ]
}