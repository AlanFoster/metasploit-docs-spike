{
  "name": "Cisco UCS Director default scpuser password",
  "fullname": "exploit/linux/ssh/cisco_ucs_scpuser",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2019-08-21",
  "type": "exploit",
  "author": [
    "Pedro Ribeiro <pedrib@gmail.com>"
  ],
  "description": "This module abuses a known default password on Cisco UCS Director. The 'scpuser'\n        has the password of 'scpuser', and allows an attacker to login to the virtual appliance\n        via SSH.\n        This module  has been tested with Cisco UCS Director virtual machines 6.6.0 and 6.7.0.\n        Note that Cisco also mentions in their advisory that their IMC Supervisor and\n        UCS Director Express are also affected by these vulnerabilities, but this module\n        was not tested with those products.",
  "references": [
    "https://cvedetails.com/cve/CVE-2019-1935/",
    "https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190821-imcs-usercred",
    "https://seclists.org/fulldisclosure/2019/Aug/36",
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/cisco-ucs-rce.txt"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Cisco UCS Director < 6.7.2.0"
  ],
  "path": "/modules/exploits/linux/ssh/cisco_ucs_scpuser.rb",
  "ref_name": "linux/ssh/cisco_ucs_scpuser",
  "check": false,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 22,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "SSH_IDENT",
      "required": true,
      "default": "SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSH client identification string"
    },
    {
      "type": "integer",
      "name": "SSH_TIMEOUT",
      "required": false,
      "default": 30,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the maximum time to negotiate a SSH session"
    },
    {
      "type": "bool",
      "name": "SSH_DEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSH debugging output (Extreme verbosity!)"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": true,
      "default": "scpuser",
      "aliases": [

      ],
      "advanced": false,
      "description": "Username to login with"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": true,
      "default": "scpuser",
      "aliases": [

      ],
      "advanced": false,
      "description": "Password to login with"
    }
  ]
}