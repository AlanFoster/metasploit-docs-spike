{
  "name": "SolarWinds LEM Default SSH Password Remote Code Execution",
  "fullname": "exploit/linux/ssh/solarwinds_lem_exec",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2017-03-17",
  "type": "exploit",
  "author": [
    "Mehmet Ince <mehmet@mehmetince.net>"
  ],
  "description": "This module exploits the default credentials of SolarWinds LEM. A menu system is encountered when the SSH\n        service is accessed with the default username and password which is \"cmc\" and \"password\". By exploiting a\n        vulnerability that exist on the menuing script, an attacker can escape from restricted shell.\n\n        This module was tested against SolarWinds LEM v6.3.1.",
  "references": [
    "https://cvedetails.com/cve/CVE-2017-7722/",
    "http://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/"
  ],
  "platform": "Python",
  "arch": "python",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic"
  ],
  "path": "/modules/exploits/linux/ssh/solarwinds_lem_exec.rb",
  "ref_name": "linux/ssh/solarwinds_lem_exec",
  "check": false,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 32022,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "SSH_IDENT",
      "required": true,
      "default": "SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSH client identification string"
    },
    {
      "type": "integer",
      "name": "SSH_TIMEOUT",
      "required": false,
      "default": 30,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the maximum time to negotiate a SSH session"
    },
    {
      "type": "bool",
      "name": "SSH_DEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSH debugging output (Extreme verbosity!)"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": true,
      "default": "cmc",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username for authentication"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": true,
      "default": "password",
      "aliases": [

      ],
      "advanced": false,
      "description": "The password for authentication"
    }
  ]
}