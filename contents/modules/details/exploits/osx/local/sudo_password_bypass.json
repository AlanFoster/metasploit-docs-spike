{
  "name": "Mac OS X Sudo Password Bypass",
  "fullname": "exploit/osx/local/sudo_password_bypass",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-02-28",
  "type": "exploit",
  "author": [
    "Todd C. Miller",
    "joev <joev@metasploit.com>",
    "juan vazquez <juan.vazquez@metasploit.com>"
  ],
  "description": "This module gains a session with root permissions on versions of OS X with\n        sudo binary vulnerable to CVE-2013-1775. Tested working on Mac OS 10.7-10.8.4,\n        and possibly lower versions.\n\n        If your session belongs to a user with Administrative Privileges\n        (the user is in the sudoers file and is in the \"admin group\"), and the\n        user has ever run the \"sudo\" command, it is possible to become the super\n        user by running `sudo -k` and then resetting the system clock to 01-01-1970.\n\n        This module will fail silently if the user is not an admin, if the user has never\n        run the sudo command, or if the admin has locked the Date/Time preferences.\n\n        Note: If the user has locked the Date/Time preferences, requests to overwrite\n        the system clock will be ignored, and the module will silently fail. However,\n        if the \"Require an administrator password to access locked preferences\" setting\n        is not enabled, the Date/Time preferences are often unlocked every time the admin\n        logs in, so you can install persistence and wait for a chance later.",
  "references": [
    "https://cvedetails.com/cve/CVE-2013-1775/",
    "OSVDB (90677)",
    "http://www.securityfocus.com/bid/58203",
    "http://www.sudo.ws/sudo/alerts/epoch_ticket.html"
  ],
  "platform": "OSX",
  "arch": "x86, x64, cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Mac OS X x86 (Native Payload)",
    "Mac OS X x64 (Native Payload)",
    "CMD"
  ],
  "path": "/modules/exploits/osx/local/sudo_password_bypass.rb",
  "ref_name": "osx/local/sudo_password_bypass",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "bool",
      "name": "EXE::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom exe instead of automatically generating a payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the executable template"
    },
    {
      "type": "path",
      "name": "EXE::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The executable template file name."
    },
    {
      "type": "bool",
      "name": "EXE::Inject",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to preserve the original EXE function"
    },
    {
      "type": "bool",
      "name": "EXE::OldMethod",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to use the substitution EXE generation method."
    },
    {
      "type": "bool",
      "name": "EXE::FallBack",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use the default template in case the specified one is missing"
    },
    {
      "type": "bool",
      "name": "MSI::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom msi instead of automatically generating a payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the msi template"
    },
    {
      "type": "path",
      "name": "MSI::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The msi template file name"
    },
    {
      "type": "bool",
      "name": "MSI::UAC",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"
    },
    {
      "type": "integer",
      "name": "FileDropperDelay",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Delay in seconds before attempting cleanup"
    },
    {
      "type": "string",
      "name": "TMP_FILE",
      "required": true,
      "default": "/tmp/.<random>/<random>",
      "aliases": [

      ],
      "advanced": true,
      "description": "For the native targets, specifies the path that the executable will be dropped on the client machine."
    }
  ]
}