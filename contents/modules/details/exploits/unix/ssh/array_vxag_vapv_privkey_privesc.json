{
  "name": "Array Networks vAPV and vxAG Private Key Privilege Escalation Code Execution",
  "fullname": "exploit/unix/ssh/array_vxag_vapv_privkey_privesc",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2014-02-03",
  "type": "exploit",
  "author": [
    "xistence <xistence@0x90.nl>"
  ],
  "description": "This module exploits a default hardcoded private SSH key or default hardcoded\n        login and password in the vAPV 8.3.2.17 and vxAG 9.2.0.34 appliances made\n        by Array Networks. After logged in as the unprivileged user, it's possible to modify\n        the world-writable file /ca/bin/monitor.sh with attacker-supplied arbitrary code.\n        Execution is possible by using the backend tool, running setuid, to turn the debug\n        monitoring on. This makes it possible to trigger a payload with root privileges.",
  "references": [
    "OSVDB (104652)",
    "OSVDB (104653)",
    "OSVDB (104654)",
    "https://packetstormsecurity.com/files/125761"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "vAPV 8.3.2.17 / vxAG 9.2.0.34"
  ],
  "path": "/modules/exploits/unix/ssh/array_vxag_vapv_privkey_privesc.rb",
  "ref_name": "unix/ssh/array_vxag_vapv_privkey_privesc",
  "check": false,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "bool",
      "name": "EXE::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom exe instead of automatically generating a payload exe"
    },
    {
      "type": "path",
      "name": "EXE::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the executable template"
    },
    {
      "type": "path",
      "name": "EXE::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The executable template file name."
    },
    {
      "type": "bool",
      "name": "EXE::Inject",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to preserve the original EXE function"
    },
    {
      "type": "bool",
      "name": "EXE::OldMethod",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Set to use the substitution EXE generation method."
    },
    {
      "type": "bool",
      "name": "EXE::FallBack",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use the default template in case the specified one is missing"
    },
    {
      "type": "bool",
      "name": "MSI::EICAR",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Generate an EICAR file instead of regular payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Custom",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use custom msi instead of automatically generating a payload msi"
    },
    {
      "type": "path",
      "name": "MSI::Path",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The directory in which to look for the msi template"
    },
    {
      "type": "path",
      "name": "MSI::Template",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The msi template file name"
    },
    {
      "type": "bool",
      "name": "MSI::UAC",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 22,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "SSH_IDENT",
      "required": true,
      "default": "SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSH client identification string"
    },
    {
      "type": "integer",
      "name": "SSH_TIMEOUT",
      "required": false,
      "default": 30,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the maximum time to negotiate a SSH session"
    },
    {
      "type": "bool",
      "name": "SSH_DEBUG",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSH debugging output (Extreme verbosity!)"
    },
    {
      "type": "bool",
      "name": "SSHKEY",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Use SSH key instead of password"
    },
    {
      "type": "string",
      "name": "USER",
      "required": true,
      "default": "sync",
      "aliases": [

      ],
      "advanced": false,
      "description": "vAPV/vxAG SSH user"
    },
    {
      "type": "string",
      "name": "PASS",
      "required": true,
      "default": "click1",
      "aliases": [

      ],
      "advanced": false,
      "description": "vAPV/vxAG SSH password"
    }
  ]
}