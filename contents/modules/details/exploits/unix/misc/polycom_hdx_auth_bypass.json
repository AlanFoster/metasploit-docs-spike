{
  "name": "Polycom Command Shell Authorization Bypass",
  "fullname": "exploit/unix/misc/polycom_hdx_auth_bypass",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2013-01-18",
  "type": "exploit",
  "author": [
    "Paul Haas <Paul.Haas@Security-Assessment.com>",
    "h00die <mike@shorebreaksecurity.com>"
  ],
  "description": "The login component of the Polycom Command Shell on Polycom HDX\n          video endpoints, running software versions 3.0.5 and earlier,\n          is vulnerable to an authorization bypass when simultaneous\n          connections are made to the service, allowing remote network\n          attackers to gain access to a sandboxed telnet prompt without\n          authentication. Versions prior to 3.0.4 contain OS command\n          injection in the ping command which can be used to execute\n          arbitrary commands as root.",
  "references": [
    "http://www.security-assessment.com/files/documents/advisory/Polycom%20HDX%20Telnet%20Authorization%20Bypass%20-%20RELEASE.pdf",
    "http://blog.tempest.com.br/joao-paulo-campello/polycom-web-management-interface-os-command-injection.html",
    "https://www.exploit-db.com/exploits/24494"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Universal"
  ],
  "path": "/modules/exploits/unix/misc/polycom_hdx_auth_bypass.rb",
  "ref_name": "unix/misc/polycom_hdx_auth_bypass",
  "check": true,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "addressrange",
      "name": "RHOSTS",
      "required": true,
      "default": null,
      "aliases": [
        "RHOST"
      ],
      "advanced": false,
      "description": "The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 23,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Negotiate SSL/TLS for outgoing connections"
    },
    {
      "type": "enum",
      "name": "SSLVersion",
      "required": true,
      "default": "Auto",
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"
    },
    {
      "type": "enum",
      "name": "SSLVerifyMode",
      "required": false,
      "default": "PEER",
      "aliases": [

      ],
      "advanced": true,
      "description": "SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "string",
      "name": "Proxies",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "A proxy chain of format type:host:port[,type:host:port][...]"
    },
    {
      "type": "port",
      "name": "CPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client port"
    },
    {
      "type": "address",
      "name": "CHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The local client address"
    },
    {
      "type": "integer",
      "name": "ConnectTimeout",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": true,
      "description": "Maximum number of seconds to establish a TCP connection"
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maxiumum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "address",
      "name": "CBHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The listener address used for staging the final payload"
    },
    {
      "type": "port",
      "name": "CBPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The listener port used for staging the final payload"
    },
    {
      "type": "integer",
      "name": "THREADS",
      "required": false,
      "default": 6,
      "aliases": [

      ],
      "advanced": true,
      "description": "Threads for authentication bypass"
    },
    {
      "type": "integer",
      "name": "MAX_CONNECTIONS",
      "required": false,
      "default": 100,
      "aliases": [

      ],
      "advanced": true,
      "description": "Threads for authentication bypass"
    }
  ]
}