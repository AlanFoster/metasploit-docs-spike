{
  "name": "DHCP Client Command Injection (DynoRoot)",
  "fullname": "exploit/unix/dhcp/rhel_dhcp_client_command_injection",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2018-05-15",
  "type": "exploit",
  "author": [
    "Felix Wilhelm",
    "Kevin Kirsche <d3c3pt10n[AT]deceiveyour.team>"
  ],
  "description": "This module exploits the DynoRoot vulnerability, a flaw in how the\n         NetworkManager integration script included in the DHCP client in\n         Red Hat Enterprise Linux 6 and 7, Fedora 28, and earlier\n         processes DHCP options. A malicious DHCP server, or an attacker on\n         the local network able to spoof DHCP responses, could use this flaw\n         to execute arbitrary commands with root privileges on systems using\n         NetworkManager and configured to obtain network configuration using\n         the DHCP protocol.",
  "references": [
    "https://cvedetails.com/cve/CVE-2018-1111/",
    "https://github.com/kkirsche/CVE-2018-1111",
    "https://twitter.com/_fel1x/status/996388421273882626?lang=en",
    "https://access.redhat.com/security/vulnerabilities/3442151",
    "https://dynoroot.ninja/",
    "https://nvd.nist.gov/vuln/detail/CVE-2018-1111",
    "https://www.tenable.com/blog/advisory-red-hat-dhcp-client-command-injection-trouble",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1111"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "Automatic Target"
  ],
  "path": "/modules/exploits/unix/dhcp/rhel_dhcp_client_command_injection.rb",
  "ref_name": "unix/dhcp/rhel_dhcp_client_command_injection",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "AKA": [
      "DynoRoot"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "SRVHOST",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The IP of the DHCP server"
    },
    {
      "type": "string",
      "name": "NETMASK",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The netmask of the local subnet"
    },
    {
      "type": "string",
      "name": "DHCPIPSTART",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The first IP to give out"
    },
    {
      "type": "string",
      "name": "DHCPIPEND",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The last IP to give out"
    },
    {
      "type": "string",
      "name": "ROUTER",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The router IP address"
    },
    {
      "type": "string",
      "name": "BROADCAST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The broadcast address to send to"
    },
    {
      "type": "string",
      "name": "DNSSERVER",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The DNS server IP address"
    },
    {
      "type": "string",
      "name": "HOSTSTART",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The optional host integer counter"
    }
  ]
}