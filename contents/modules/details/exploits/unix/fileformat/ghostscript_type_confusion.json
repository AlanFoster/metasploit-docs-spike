{
  "name": "Ghostscript Type Confusion Arbitrary Command Execution",
  "fullname": "exploit/unix/fileformat/ghostscript_type_confusion",
  "aliases": [

  ],
  "rank": 600,
  "disclosure_date": "2017-04-27",
  "type": "exploit",
  "author": [
    "Atlassian Security Team",
    "hdm <x@hdm.io>"
  ],
  "description": "This module exploits a type confusion vulnerability in Ghostscript that can\n        be exploited to obtain arbitrary command execution. This vulnerability affects\n        Ghostscript versions 9.21 and earlier and can be exploited through libraries\n        such as ImageMagick and Pillow.",
  "references": [
    "https://cvedetails.com/cve/CVE-2017-8291/",
    "https://bugs.ghostscript.com/show_bug.cgi?id=697808",
    "https://seclists.org/oss-sec/2017/q2/148",
    "https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=04b37bbce174eed24edec7ad5b920eb93db4d47d",
    "https://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=4f83478c88c2e05d6e8d79ca4557eb039354d2f3"
  ],
  "platform": "Unix",
  "arch": "cmd",
  "autofilter_ports": [

  ],
  "autofilter_services": [

  ],
  "targets": [
    "EPS file"
  ],
  "path": "/modules/exploits/unix/fileformat/ghostscript_type_confusion.rb",
  "ref_name": "unix/fileformat/ghostscript_type_confusion",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
    "AKA": [
      "ghostbutt"
    ],
    "RelatedModules": [
      "exploit/multi/fileformat/ghostscript_failed_restore",
      "exploit/unix/fileformat/imagemagick_delegate"
    ]
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "WfsDelay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": true,
      "description": "Additional delay when waiting for a session"
    },
    {
      "type": "bool",
      "name": "EnableContextEncoding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Use transient context when encoding payloads"
    },
    {
      "type": "path",
      "name": "ContextInformationFile",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The information file that contains context information"
    },
    {
      "type": "bool",
      "name": "DisablePayloadHandler",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Disable the handler code for the selected payload"
    },
    {
      "type": "string",
      "name": "FILENAME",
      "required": true,
      "default": "msf.eps",
      "aliases": [

      ],
      "advanced": false,
      "description": "Output file"
    }
  ]
}