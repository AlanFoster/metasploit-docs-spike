{
  "name": "Windows Escalate NtUserLoadKeyboardLayoutEx Privilege Escalation",
  "fullname": "post/windows/escalate/ms10_073_kbdlayout",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": "2010-10-12",
  "type": "post",
  "author": [
    "Ruben Santamarta",
    "jduck <jduck@metasploit.com>"
  ],
  "description": "This module exploits the keyboard layout vulnerability exploited by Stuxnet. When\n        processing specially crafted keyboard layout files (DLLs), the Windows kernel fails\n        to validate that an array index is within the bounds of the array. By loading\n        a specially crafted keyboard layout, an attacker can execute code in Ring 0.",
  "references": [
    "OSVDB (68552)",
    "https://cvedetails.com/cve/CVE-2010-2743/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2010/MS10-073",
    "http://www.reversemode.com/index.php?option=com_content&task=view&id=71&Itemid=1",
    "https://www.exploit-db.com/exploits/15985"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/escalate/ms10_073_kbdlayout.rb",
  "ref_name": "windows/escalate/ms10_073_kbdlayout",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    }
  ]
}