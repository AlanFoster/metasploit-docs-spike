{
  "name": "Windows Outbound-Filtering Rules",
  "fullname": "post/windows/recon/outbound_ports",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Borja Merino <bmerinofe@gmail.com>"
  ],
  "description": "This module makes some kind of TCP traceroute to get outbound-filtering rules.\n        It will try to make a TCP connection to a certain public IP address (this IP\n        does not need to be under your control) using different TTL incremental values.\n        This way if you get an answer (ICMP TTL time exceeded packet) from a public IP\n        device you can infer that the destination port is allowed. Setting STOP to\n        true the module will stop as soon as you reach a public IP (this will generate\n        less noise in the network).",
  "references": [
    "http://www.shelliscoming.com/2014/11/getting-outbound-filtering-rules-by.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/recon/outbound_ports.rb",
  "ref_name": "windows/recon/outbound_ports",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "address",
      "name": "ADDRESS",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Destination IP address."
    },
    {
      "type": "integer",
      "name": "HOPS",
      "required": true,
      "default": 3,
      "aliases": [

      ],
      "advanced": false,
      "description": "Number of hops to get."
    },
    {
      "type": "integer",
      "name": "MIN_TTL",
      "required": true,
      "default": 1,
      "aliases": [

      ],
      "advanced": false,
      "description": "Starting TTL value."
    },
    {
      "type": "string",
      "name": "PORTS",
      "required": true,
      "default": "80,443",
      "aliases": [

      ],
      "advanced": false,
      "description": "Ports to test (e.g. 80,443,100-110)."
    },
    {
      "type": "integer",
      "name": "TIMEOUT",
      "required": true,
      "default": 3,
      "aliases": [

      ],
      "advanced": false,
      "description": "Timeout for the ICMP socket."
    },
    {
      "type": "bool",
      "name": "STOP",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Stop when it finds a public IP."
    }
  ]
}