{
  "name": "Windows Manage Privilege Based Process Migration ",
  "fullname": "post/windows/manage/priv_migrate",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Josh Hale \"sn0wfa11\" <jhale85446@gmail.com>",
    "theLightCosine <theLightCosine@metasploit.com>"
  ],
  "description": "This module will migrate a Meterpreter session based on session privileges.\n         It will do everything it can to migrate, including spawning a new User level process.\n         For sessions with Admin rights: It will try to migrate into a System level process in the following\n         order: ANAME (if specified), services.exe, wininit.exe, svchost.exe, lsm.exe, lsass.exe, and winlogon.exe.\n         If all these fail and NOFAIL is set to true, it will fall back to User level migration. For sessions with User level rights:\n         It will try to migrate to a user level process, if that fails it will attempt to spawn the process\n         then migrate to it. It will attempt the User level processes in the following order:\n         NAME (if specified), explorer.exe, then notepad.exe.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/priv_migrate.rb",
  "ref_name": "windows/manage/priv_migrate",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "ANAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "System process to migrate to. For sessions with Admin rights. (See Module Description.)"
    },
    {
      "type": "string",
      "name": "NAME",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Process to migrate to. For sessions with User rights. (See Module Description.)"
    },
    {
      "type": "bool",
      "name": "KILL",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Kill original session process."
    },
    {
      "type": "bool",
      "name": "NOFAIL",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Migrate to user level process if Admin migration fails. May downgrade privileged shells."
    }
  ]
}