{
  "name": "Windows Manage Local Microsoft SQL Server Authorization Bypass",
  "fullname": "post/windows/manage/mssql_local_auth_bypass",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Scott Sutherland <scott.sutherland@netspi.com>"
  ],
  "description": "When this module is executed, it can be used to add a sysadmin to local\n        SQL Server instances.  It first attempts to gain LocalSystem privileges\n        using the \"getsystem\" escalation methods. If those privileges are not\n        sufficient to add a sysadmin, then it will migrate to the SQL Server\n        service process associated with the target instance.  The sysadmin\n        login is added to the local SQL Server using native SQL clients and\n        stored procedures.  If no instance is specified then the first identified\n        instance will be used.\n\n        Why is this possible? By default in SQL Server 2k-2k8, LocalSystem\n        is assigned syadmin privileges.  Microsoft changed the default in\n        SQL Server 2012 so that LocalSystem no longer has sysadmin privileges.\n        However, this can be overcome by migrating to the SQL Server process.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/mssql_local_auth_bypass.rb",
  "ref_name": "windows/manage/mssql_local_auth_bypass",
  "check": false,
  "post_auth": true,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "DB_USERNAME",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "New sysadmin login"
    },
    {
      "type": "string",
      "name": "DB_PASSWORD",
      "required": true,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for new sysadmin login"
    },
    {
      "type": "string",
      "name": "INSTANCE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Name of target SQL Server instance"
    },
    {
      "type": "bool",
      "name": "REMOVE_LOGIN",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Remove DB_USERNAME login from database"
    }
  ]
}