{
  "name": "Windows Manage Add User to the Domain and/or to a Domain Group",
  "fullname": "post/windows/manage/add_user",
  "aliases": [
    "post/windows/manage/add_user_domain"
  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Joshua Abraham <jabra@rapid7.com>"
  ],
  "description": "This module adds a user to the Domain and/or to a Domain group. It will\n        check if sufficient privileges are present for certain actions and run\n        getprivs for system.  If you elevated privs to system, the\n        SeAssignPrimaryTokenPrivilege will not be assigned. You need to migrate to\n        a process that is running as system. If you don't have privs, this script\n        exits.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/add_user.rb",
  "ref_name": "windows/manage/add_user",
  "check": false,
  "post_auth": true,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The username of the user to add (not-qualified, e.g. BOB)"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Password of the user"
    },
    {
      "type": "string",
      "name": "GROUP",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Add user into group, creating it if necessary"
    },
    {
      "type": "bool",
      "name": "ADDTOGROUP",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Add group if it does not exist"
    },
    {
      "type": "bool",
      "name": "ADDTODOMAIN",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Add to Domain if true, otherwise add locally"
    },
    {
      "type": "string",
      "name": "TOKEN",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "Username or PID of the token which will be used (if blank, Domain Admin tokens will be enumerated)"
    }
  ]
}