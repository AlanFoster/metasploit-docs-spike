{
  "name": "Forward SSH Agent Requests To Remote Pageant",
  "fullname": "post/windows/manage/forward_pageant",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Stuart Morgan <stuart.morgan@mwrinfosecurity.com>",
    "Ben Campbell <eat_meatballs@hotmail.co.uk>"
  ],
  "description": "This module forwards SSH agent requests from a local socket to a remote Pageant instance.\n                         If a target Windows machine is compromised and is running Pageant, this will allow the\n                         attacker to run normal OpenSSH commands (e.g. ssh-add -l) against the Pageant host which are\n                         tunneled through the meterpreter session. This could therefore be used to authenticate\n                         with a remote host using a private key which is loaded into a remote user's Pageant instance,\n                         without ever having knowledge of the private key itself.\n\n                         Note that this requires the PageantJacker meterpreter extension, but this will be automatically\n                         loaded into the remote meterpreter session by this module if it is not already loaded.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/forward_pageant.rb",
  "ref_name": "windows/manage/forward_pageant",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "SocketPath",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specify a filename for the local UNIX socket."
    }
  ]
}