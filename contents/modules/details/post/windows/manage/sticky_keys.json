{
  "name": "Sticky Keys Persistance Module",
  "fullname": "post/windows/manage/sticky_keys",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "OJ Reeves"
  ],
  "description": "This module makes it possible to apply the 'sticky keys' hack to a session with appropriate\n        rights. The hack provides a means to get a SYSTEM shell using UI-level interaction at an RDP\n        login screen or via a UAC confirmation dialog. The module modifies the Debug registry setting\n        for certain executables.\n\n        The module options allow for this hack to be applied to:\n\n        SETHC   (sethc.exe is invoked when SHIFT is pressed 5 times),\n        UTILMAN (Utilman.exe is invoked by pressing WINDOWS+U),\n        OSK     (osk.exe is invoked by pressing WINDOWS+U, then launching the on-screen keyboard), and\n        DISP    (DisplaySwitch.exe is invoked by pressing WINDOWS+P).\n\n        The hack can be added using the ADD action, and removed with the REMOVE action.\n\n        Custom payloads and binaries can be run as part of this exploit, but must be manually uploaded\n        to the target prior to running the module. By default, a SYSTEM command prompt is installed\n        using the registry method if this module is run without modifying any parameters.",
  "references": [
    "https://social.technet.microsoft.com/Forums/windows/en-US/a3968ec9-5824-4bc2-82a2-a37ea88c273a/sticky-keys-exploit",
    "http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/sticky_keys.rb",
  "ref_name": "windows/manage/sticky_keys",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "enum",
      "name": "TARGET",
      "required": true,
      "default": "SETHC",
      "aliases": [

      ],
      "advanced": false,
      "description": "The target binary to add the exploit to. (Accepted: SETHC, UTILMAN, OSK, DISP)"
    },
    {
      "type": "string",
      "name": "EXE",
      "required": true,
      "default": "%SYSTEMROOT%\\system32\\cmd.exe",
      "aliases": [

      ],
      "advanced": false,
      "description": "Executable to execute when the exploit is triggered."
    }
  ]
}