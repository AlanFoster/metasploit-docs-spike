{
  "name": "Architecture Migrate",
  "fullname": "post/windows/manage/archmigrate",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Koen Riepe (koen.riepe <Koen Riepe (koen.riepe@fox-it.com)>"
  ],
  "description": "This module checks if the meterpreter architecture is the same as the OS architecture and if it's incompatible it spawns a\n                          new process with the correct architecture and migrates into that process.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/manage/archmigrate.rb",
  "ref_name": "windows/manage/archmigrate",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "EXE",
      "required": true,
      "default": "C:\\windows\\sysnative\\svchost.exe",
      "aliases": [

      ],
      "advanced": false,
      "description": "The executable to start and migrate into"
    },
    {
      "type": "bool",
      "name": "FALLBACK",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "If the selected migration executable does not exist fallback to a sysnative file"
    },
    {
      "type": "bool",
      "name": "IGNORE_SYSTEM",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Migrate even if you have SYSTEM privileges"
    }
  ]
}