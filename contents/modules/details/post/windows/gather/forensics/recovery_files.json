{
  "name": "Windows Gather Deleted Files Enumeration and Recovering",
  "fullname": "post/windows/gather/forensics/recovery_files",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Borja Merino <bmerinofe@gmail.com>"
  ],
  "description": "This module lists and attempts to recover deleted files from NTFS file systems. Use\n        the FILES option to guide recovery. Leave this option empty to enumerate deleted files in the\n        DRIVE. Set FILES to an extension (e.g., \"pdf\") to recover deleted files with that\n        extension, or set FILES to a comma separated list of IDs (from enumeration) to\n        recover those files. The user must have account file enumeration. Recovery\n        may take a long time; use the TIMEOUT option to abort enumeration or recovery by\n        extension after a specified period (in seconds).",
  "references": [
    "http://www.youtube.com/watch?v=9yzCf360ujY&hd=1"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/gather/forensics/recovery_files.rb",
  "ref_name": "windows/gather/forensics/recovery_files",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "FILES",
      "required": false,
      "default": "",
      "aliases": [

      ],
      "advanced": false,
      "description": "ID or extensions of the files to recover in a comma separated way. Let empty to enumerate deleted files."
    },
    {
      "type": "string",
      "name": "DRIVE",
      "required": true,
      "default": "C:",
      "aliases": [

      ],
      "advanced": false,
      "description": "Drive you want to recover files from."
    },
    {
      "type": "integer",
      "name": "TIMEOUT",
      "required": true,
      "default": 3600,
      "aliases": [

      ],
      "advanced": false,
      "description": "Search timeout. If 0 the module will go through the entire $MFT."
    }
  ]
}