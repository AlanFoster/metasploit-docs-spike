{
  "name": "Windows Gather Active Directory Users",
  "fullname": "post/windows/gather/enum_ad_users",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Ben Campbell <eat_meatballs@hotmail.co.uk>",
    "Carlos Perez <carlos_perez@darkoperator.com>",
    "Stuart Morgan <stuart.morgan@mwrinfosecurity.com>"
  ],
  "description": "This module will enumerate user accounts in the default Active Domain (AD) directory and stores\n      them in the database. If GROUP_MEMBER is set to the DN of a group, this will list the members of\n      that group by performing a recursive/nested search (i.e. it will list users who are members of\n      groups that are members of groups that are members of groups (etc) which eventually include the\n      target group DN.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/gather/enum_ad_users.rb",
  "ref_name": "windows/gather/enum_ad_users",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "DOMAIN",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The domain to query or distinguished name (e.g. DC=test,DC=com)"
    },
    {
      "type": "integer",
      "name": "MAX_SEARCH",
      "required": true,
      "default": 500,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maximum values to retrieve, 0 for all."
    },
    {
      "type": "bool",
      "name": "STORE_LOOT",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Store file in loot."
    },
    {
      "type": "bool",
      "name": "EXCLUDE_LOCKED",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Exclude in search locked accounts.."
    },
    {
      "type": "bool",
      "name": "EXCLUDE_DISABLED",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Exclude from search disabled accounts."
    },
    {
      "type": "string",
      "name": "ADDITIONAL_FIELDS",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Additional fields to retrieve, comma separated"
    },
    {
      "type": "string",
      "name": "FILTER",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Customised LDAP filter"
    },
    {
      "type": "string",
      "name": "GROUP_MEMBER",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Recursively list users that are effectve members of the group DN specified."
    },
    {
      "type": "enum",
      "name": "UAC",
      "required": true,
      "default": "ANY",
      "aliases": [

      ],
      "advanced": false,
      "description": "Filter on User Account Control Setting. (Accepted: ANY, NO_PASSWORD, CHANGE_PASSWORD, NEVER_EXPIRES, SMARTCARD_REQUIRED, NEVER_LOGGEDON)"
    }
  ]
}