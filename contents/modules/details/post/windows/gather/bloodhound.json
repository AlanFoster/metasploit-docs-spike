{
  "name": "BloodHound Ingestor",
  "fullname": "post/windows/gather/bloodhound",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "h4ng3r <h4ng3r@computerpirate.me>"
  ],
  "description": "This module will execute the BloodHound C# Ingestor (aka SharpHound) to gather sessions, local admin, domain trusts and more. With this information BloodHound will easily identify highly complex attack paths that would otherwise be impossible to quickly identify within an Active Directory environment.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "x86, x64",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/gather/bloodhound.rb",
  "ref_name": "windows/gather/bloodhound",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "address",
      "name": "SRVHOST",
      "required": true,
      "default": "0.0.0.0",
      "aliases": [

      ],
      "advanced": false,
      "description": "The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."
    },
    {
      "type": "port",
      "name": "SRVPORT",
      "required": true,
      "default": 8080,
      "aliases": [

      ],
      "advanced": false,
      "description": "The local port to listen on."
    },
    {
      "type": "string",
      "name": "ListenerComm",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "The specific communication channel to use for this service"
    },
    {
      "type": "bool",
      "name": "SSL",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Negotiate SSL for incoming connections"
    },
    {
      "type": "path",
      "name": "SSLCert",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Path to a custom SSL certificate (default is randomly generated)"
    },
    {
      "type": "bool",
      "name": "SSLCompression",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable SSL/TLS-level compression"
    },
    {
      "type": "string",
      "name": "SSLCipher",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""
    },
    {
      "type": "integer",
      "name": "TCP::max_send_size",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maximum tcp segment size.  (0 = disable)"
    },
    {
      "type": "integer",
      "name": "TCP::send_delay",
      "required": false,
      "default": 0,
      "aliases": [

      ],
      "advanced": false,
      "description": "Delays inserted before every send.  (0 = disable)"
    },
    {
      "type": "string",
      "name": "URIPATH",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The URI to use for this exploit (default is random)"
    },
    {
      "type": "bool",
      "name": "HTTP::no_cache",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disallow the browser to cache HTTP content"
    },
    {
      "type": "bool",
      "name": "HTTP::chunked",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""
    },
    {
      "type": "bool",
      "name": "HTTP::header_folding",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable folding of HTTP headers"
    },
    {
      "type": "bool",
      "name": "HTTP::junk_headers",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable insertion of random junk HTTP headers"
    },
    {
      "type": "enum",
      "name": "HTTP::compression",
      "required": false,
      "default": "none",
      "aliases": [

      ],
      "advanced": false,
      "description": "Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"
    },
    {
      "type": "string",
      "name": "HTTP::server_name",
      "required": true,
      "default": "Apache",
      "aliases": [

      ],
      "advanced": false,
      "description": "Configures the Server header of all outgoing replies"
    },
    {
      "type": "address",
      "name": "URIHOST",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Host to use in URI (useful for tunnels)"
    },
    {
      "type": "port",
      "name": "URIPORT",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Port to use in URI (useful for tunnels)"
    },
    {
      "type": "bool",
      "name": "SendRobots",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Return a robots.txt file if asked for one"
    },
    {
      "type": "bool",
      "name": "Powershell::persist",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Run the payload in a loop"
    },
    {
      "type": "integer",
      "name": "Powershell::prepend_sleep",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Prepend seconds of sleep"
    },
    {
      "type": "bool",
      "name": "Powershell::prepend_protections_bypass",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Prepend AMSI/SBL bypass"
    },
    {
      "type": "bool",
      "name": "Powershell::strip_comments",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Strip comments"
    },
    {
      "type": "bool",
      "name": "Powershell::strip_whitespace",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Strip whitespace"
    },
    {
      "type": "bool",
      "name": "Powershell::sub_vars",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Substitute variable names"
    },
    {
      "type": "bool",
      "name": "Powershell::sub_funcs",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Substitute function names"
    },
    {
      "type": "bool",
      "name": "Powershell::exec_in_place",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Produce PSH without executable wrapper"
    },
    {
      "type": "bool",
      "name": "Powershell::exec_rc4",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Encrypt PSH with RC4"
    },
    {
      "type": "bool",
      "name": "Powershell::remove_comspec",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Produce script calling powershell directly"
    },
    {
      "type": "bool",
      "name": "Powershell::noninteractive",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Execute powershell without interaction"
    },
    {
      "type": "bool",
      "name": "Powershell::encode_final_payload",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Encode final payload for -EncodedCommand"
    },
    {
      "type": "bool",
      "name": "Powershell::encode_inner_payload",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Encode inner payload for -EncodedCommand"
    },
    {
      "type": "bool",
      "name": "Powershell::wrap_double_quotes",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": true,
      "description": "Wraps the -Command argument in single quotes"
    },
    {
      "type": "bool",
      "name": "Powershell::no_equals",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Pad base64 until no \"=\" remains"
    },
    {
      "type": "enum",
      "name": "Powershell::method",
      "required": true,
      "default": "reflection",
      "aliases": [

      ],
      "advanced": true,
      "description": "Payload delivery method (Accepted: net, reflection, old, msil)"
    },
    {
      "type": "integer",
      "name": "Powershell::Post::timeout",
      "required": true,
      "default": 15,
      "aliases": [

      ],
      "advanced": true,
      "description": "Powershell execution timeout, set < 0 to run async without termination"
    },
    {
      "type": "bool",
      "name": "Powershell::Post::log_output",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Write output to log file"
    },
    {
      "type": "bool",
      "name": "Powershell::Post::dry_run",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Return encoded output to caller"
    },
    {
      "type": "bool",
      "name": "Powershell::Post::force_wow64",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Force WOW64 execution"
    },
    {
      "type": "string",
      "name": "CollectionMethod",
      "required": true,
      "default": "Default",
      "aliases": [

      ],
      "advanced": false,
      "description": "The collection method to use. This parameter accepts a comma separated list of values. Accepted values are Default, Group, LocalAdmin, RDP, DCOM, GPOLocalGroup, Session, ObjectProps, ComputerOnly, LoggedOn, Trusts, ACL, Container, DcOnly, All"
    },
    {
      "type": "string",
      "name": "Domain",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specifies the domain to enumerate. If not specified, will enumerate the current domain your user context specifies"
    },
    {
      "type": "bool",
      "name": "SearchForest",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Expands data collection to include all domains in the forest."
    },
    {
      "type": "bool",
      "name": "Stealth",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Use stealth collection options, will sacrifice data quality in favor of much reduced network impact"
    },
    {
      "type": "bool",
      "name": "SkipGCDeconfliction",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Skips Global Catalog deconfliction during session enumeration. This option can result in more inaccuracy in data."
    },
    {
      "type": "bool",
      "name": "ExcludeDC",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Exclude domain controllers from session queries. Useful for ATA environments which detect this behavior"
    },
    {
      "type": "string",
      "name": "OU",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Limit enumeration to this OU. Takes a DistinguishedName."
    },
    {
      "type": "string",
      "name": "DomainController",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specify which Domain Controller to request data from. Defaults to closest DC using Site Names"
    },
    {
      "type": "integer",
      "name": "LdapPort",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Override the port used to connect to LDAP"
    },
    {
      "type": "bool",
      "name": "SecureLdap",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Uses LDAPs instead of unencrypted LDAP on port 636"
    },
    {
      "type": "bool",
      "name": "IgnoreLdapCert",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Ignores the certificate for LDAP"
    },
    {
      "type": "string",
      "name": "LDAPUser",
      "required": false,
      "default": "Default",
      "aliases": [

      ],
      "advanced": false,
      "description": "User to connect to LDAP with"
    },
    {
      "type": "string",
      "name": "LDAPPass",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for user you are connecting to LDAP with"
    },
    {
      "type": "string",
      "name": "DisableKerbSigning",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Disables Kerberos Signing on requests."
    },
    {
      "type": "integer",
      "name": "Threads",
      "required": true,
      "default": 10,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specifies the number of threads to use during enumeration"
    },
    {
      "type": "integer",
      "name": "PingTimeout",
      "required": true,
      "default": 250,
      "aliases": [

      ],
      "advanced": false,
      "description": "Specifies timeout for ping requests to computers in milliseconds"
    },
    {
      "type": "bool",
      "name": "SkipPing",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Skip all ping checks for computers. This option will most likely be slower as API calls will be made to all computers regardless of being up Use this option if ping is disabled on the network for some reason"
    },
    {
      "type": "integer",
      "name": "LoopDelay",
      "required": true,
      "default": 300,
      "aliases": [

      ],
      "advanced": false,
      "description": "Amount of time to wait between session enumeration loops in minutes. This option should be used in conjunction with the SessionLoop enumeration method."
    },
    {
      "type": "string",
      "name": "MaxLoopTime",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Length of time to run looped session collection. Format: 0d0h0m0s or any variation of this format. Use in conjunction with -CollectionMethod SessionLoop. Default will loop for two hours"
    }
  ]
}