{
  "name": "Windows Gather Credentials Local Administrator Password Solution",
  "fullname": "post/windows/gather/credentials/enum_laps",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Ben Campbell <eat_meatballs@hotmail.co.uk>"
  ],
  "description": "This module will recover the LAPS (Local Administrator Password Solution) passwords,\n        configured in Active Directory, which is usually only accessible by privileged users.\n        Note that the local administrator account name is not stored in Active Directory,\n        so it is assumed to be 'Administrator' by default.",
  "references": [

  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/gather/credentials/enum_laps.rb",
  "ref_name": "windows/gather/credentials/enum_laps",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "string",
      "name": "DOMAIN",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The domain to query or distinguished name (e.g. DC=test,DC=com)"
    },
    {
      "type": "integer",
      "name": "MAX_SEARCH",
      "required": true,
      "default": 500,
      "aliases": [

      ],
      "advanced": false,
      "description": "Maximum values to retrieve, 0 for all."
    },
    {
      "type": "string",
      "name": "LOCAL_ADMIN_NAME",
      "required": true,
      "default": "Administrator",
      "aliases": [

      ],
      "advanced": false,
      "description": "The username to store the password against"
    },
    {
      "type": "bool",
      "name": "STORE_DB",
      "required": true,
      "default": false,
      "aliases": [

      ],
      "advanced": false,
      "description": "Store file in loot."
    },
    {
      "type": "bool",
      "name": "STORE_LOOT",
      "required": true,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Store file in loot."
    },
    {
      "type": "string",
      "name": "FILTER",
      "required": true,
      "default": "(&(objectCategory=Computer)(ms-MCS-AdmPwd=*))",
      "aliases": [

      ],
      "advanced": false,
      "description": "Search filter."
    }
  ]
}