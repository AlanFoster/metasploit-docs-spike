{
  "name": "Windows Gather Group Policy Preference Saved Passwords",
  "fullname": "post/windows/gather/credentials/gpp",
  "aliases": [

  ],
  "rank": 300,
  "disclosure_date": null,
  "type": "post",
  "author": [
    "Ben Campbell <eat_meatballs@hotmail.co.uk>",
    "Loic Jaquemet <loic.jaquemet+msf@gmail.com>",
    "scriptmonkey <scriptmonkey@owobble.co.uk>",
    "theLightCosine <theLightCosine@metasploit.com>",
    "mubix <mubix@hak5.org>"
  ],
  "description": "This module enumerates the victim machine's domain controller and\n        connects to it via SMB. It then looks for Group Policy Preference XML\n        files containing local user accounts and passwords and decrypts them\n        using Microsofts public AES key.\n\n        Cached Group Policy files may be found on end-user devices if the group\n        policy object is deleted rather than unlinked.\n\n        Tested on WinXP SP3 Client and Win2k8 R2 DC.",
  "references": [
    "http://msdn.microsoft.com/en-us/library/cc232604(v=prot.13)",
    "http://rewtdance.blogspot.com/2012/06/exploiting-windows-2008-group-policy.html",
    "http://blogs.technet.com/grouppolicy/archive/2009/04/22/passwords-in-group-policy-preferences-updated.aspx",
    "https://labs.portcullis.co.uk/blog/are-you-considering-using-microsoft-group-policy-preferences-think-again/",
    "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2014/MS14-025"
  ],
  "platform": "Windows",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/windows/gather/credentials/gpp.rb",
  "ref_name": "windows/gather/credentials/gpp",
  "check": false,
  "post_auth": false,
  "default_credential": false,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "bool",
      "name": "ALL",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enumerate all domains on network."
    },
    {
      "type": "bool",
      "name": "STORE",
      "required": false,
      "default": true,
      "aliases": [

      ],
      "advanced": false,
      "description": "Store the enumerated files in loot."
    },
    {
      "type": "string",
      "name": "DOMAINS",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "Enumerate list of space separated domains DOMAINS=\"dom1 dom2\"."
    }
  ]
}