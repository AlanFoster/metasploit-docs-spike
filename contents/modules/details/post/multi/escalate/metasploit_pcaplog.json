{
  "name": "Multi Escalate Metasploit pcap_log Local Privilege Escalation",
  "fullname": "post/multi/escalate/metasploit_pcaplog",
  "aliases": [

  ],
  "rank": 0,
  "disclosure_date": "2012-07-16",
  "type": "post",
  "author": [
    "0a29406d9794e4f9b30b3c5d6702c708"
  ],
  "description": "Metasploit < 4.4 contains a vulnerable 'pcap_log' plugin which, when used with the default settings,\n          creates pcap files in /tmp with predictable file names. This exploits this by hard-linking these\n          filenames to /etc/passwd, then sending a packet with a privileged user entry contained within.\n          This, and all the other packets, are appended to /etc/passwd.\n\n          Successful exploitation results in the creation of a new superuser account.\n\n          This module requires manual clean-up. Upon success, you should remove /tmp/msf3-session*pcap\n          files and truncate /etc/passwd. Note that if this module fails, you can potentially induce\n          a permanent DoS on the target by corrupting the /etc/passwd file.",
  "references": [
    "http://www.securityfocus.com/bid/54472",
    "http://0a29.blogspot.com/2012/07/0a29-12-2-metasploit-pcaplog-plugin.html",
    "https://community.rapid7.com/docs/DOC-1946"
  ],
  "platform": "BSD, Linux, Unix",
  "arch": "",
  "autofilter_ports": null,
  "autofilter_services": null,
  "targets": null,
  "path": "/modules/post/multi/escalate/metasploit_pcaplog.rb",
  "ref_name": "multi/escalate/metasploit_pcaplog",
  "check": false,
  "post_auth": true,
  "default_credential": true,
  "notes": {
  },
  "needs_cleanup": null,
  "options": [
    {
      "type": "string",
      "name": "WORKSPACE",
      "required": false,
      "default": null,
      "aliases": [

      ],
      "advanced": true,
      "description": "Specify the workspace for this module"
    },
    {
      "type": "bool",
      "name": "VERBOSE",
      "required": false,
      "default": false,
      "aliases": [

      ],
      "advanced": true,
      "description": "Enable detailed status messages"
    },
    {
      "type": "integer",
      "name": "SESSION",
      "required": true,
      "default": null,
      "aliases": [

      ],
      "advanced": false,
      "description": "The session to run this module on."
    },
    {
      "type": "port",
      "name": "RPORT",
      "required": true,
      "default": 2940,
      "aliases": [

      ],
      "advanced": false,
      "description": "The target port"
    },
    {
      "type": "string",
      "name": "USERNAME",
      "required": true,
      "default": "metasploit",
      "aliases": [

      ],
      "advanced": false,
      "description": "Username for the new superuser"
    },
    {
      "type": "string",
      "name": "PASSWORD",
      "required": true,
      "default": "metasploit",
      "aliases": [

      ],
      "advanced": false,
      "description": "Password for the new superuser"
    },
    {
      "type": "integer",
      "name": "MINUTES",
      "required": true,
      "default": 5,
      "aliases": [

      ],
      "advanced": false,
      "description": "Number of minutes to try to inject"
    }
  ]
}