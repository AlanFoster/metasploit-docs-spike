{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/post/windows/manage/powershell/exec_powershell","result":{"data":{"moduleMetadataJson":{"id":"c8230b32-d73f-5ded-a5bb-dff80c2095cd","name":"Windows Manage PowerShell Download and/or Execute","fullname":"post/windows/manage/powershell/exec_powershell","description":"This module will download and execute a PowerShell script over a meterpreter session.\n        The user may also enter text substitutions to be made in memory before execution.\n        Setting VERBOSE to true will output both the script prior to execution and the results.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/powershell/exec_powershell","documentationSlug":"/modules/documentation/post/windows/manage/powershell/exec_powershell","referencesSlug":"/modules/references/post/windows/manage/powershell/exec_powershell"},"author":["Nicholas Nam (nick <Nicholas Nam (nick@executionflow.org)>","RageLtMan <rageltman@sempervictus>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":false,"evasion":false,"name":"SESSION","required":true,"default":"","description":"The session to run this module on."},{"advanced":true,"evasion":false,"name":"Powershell::persist","required":true,"default":"false","description":"Run the payload in a loop"},{"advanced":true,"evasion":false,"name":"Powershell::prepend_sleep","required":false,"default":"","description":"Prepend seconds of sleep"},{"advanced":true,"evasion":false,"name":"Powershell::prepend_protections_bypass","required":true,"default":"false","description":"Prepend AMSI/SBL bypass"},{"advanced":true,"evasion":false,"name":"Powershell::strip_comments","required":true,"default":"true","description":"Strip comments"},{"advanced":true,"evasion":false,"name":"Powershell::strip_whitespace","required":true,"default":"false","description":"Strip whitespace"},{"advanced":true,"evasion":false,"name":"Powershell::sub_vars","required":true,"default":"false","description":"Substitute variable names"},{"advanced":true,"evasion":false,"name":"Powershell::sub_funcs","required":true,"default":"false","description":"Substitute function names"},{"advanced":true,"evasion":false,"name":"Powershell::exec_in_place","required":true,"default":"false","description":"Produce PSH without executable wrapper"},{"advanced":true,"evasion":false,"name":"Powershell::exec_rc4","required":true,"default":"false","description":"Encrypt PSH with RC4"},{"advanced":true,"evasion":false,"name":"Powershell::remove_comspec","required":true,"default":"false","description":"Produce script calling powershell directly"},{"advanced":true,"evasion":false,"name":"Powershell::noninteractive","required":true,"default":"true","description":"Execute powershell without interaction"},{"advanced":true,"evasion":false,"name":"Powershell::encode_final_payload","required":true,"default":"false","description":"Encode final payload for -EncodedCommand"},{"advanced":true,"evasion":false,"name":"Powershell::encode_inner_payload","required":true,"default":"false","description":"Encode inner payload for -EncodedCommand"},{"advanced":true,"evasion":false,"name":"Powershell::wrap_double_quotes","required":true,"default":"true","description":"Wraps the -Command argument in single quotes"},{"advanced":true,"evasion":false,"name":"Powershell::no_equals","required":true,"default":"false","description":"Pad base64 until no \"=\" remains"},{"advanced":true,"evasion":false,"name":"Powershell::method","required":true,"default":"reflection","description":"Payload delivery method (Accepted: net, reflection, old, msil)"},{"advanced":true,"evasion":false,"name":"Powershell::Post::timeout","required":true,"default":"15","description":"Powershell execution timeout, set < 0 to run async without termination"},{"advanced":true,"evasion":false,"name":"Powershell::Post::log_output","required":true,"default":"false","description":"Write output to log file"},{"advanced":true,"evasion":false,"name":"Powershell::Post::dry_run","required":true,"default":"false","description":"Return encoded output to caller"},{"advanced":true,"evasion":false,"name":"Powershell::Post::force_wow64","required":true,"default":"false","description":"Force WOW64 execution"},{"advanced":false,"evasion":false,"name":"SCRIPT","required":true,"default":"/Users/alan/Documents/code/metasploit-framework/scripts/ps/msflag.ps1","description":"Path to the local PS script"},{"advanced":true,"evasion":false,"name":"SUBSTITUTIONS","required":false,"default":"","description":"Script subs in gsub format - original,sub;original,sub"},{"advanced":true,"evasion":false,"name":"DELETE","required":false,"default":"false","description":"Delete file after execution"},{"advanced":true,"evasion":false,"name":"DRY_RUN","required":false,"default":"false","description":"Only show what would be done"},{"advanced":true,"evasion":false,"name":"TIMEOUT","required":false,"default":"15","description":"Execution timeout"}]}},"pageContext":{"id":"c8230b32-d73f-5ded-a5bb-dff80c2095cd"}}}