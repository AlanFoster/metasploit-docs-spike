{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/auxiliary/admin/smb/psexec_ntdsgrab","result":{"data":{"moduleMetadataJson":{"id":"9166129f-cb84-5366-b489-3c001403d9db","name":"PsExec NTDS.dit And SYSTEM Hive Download Utility","fullname":"auxiliary/admin/smb/psexec_ntdsgrab","description":"This module authenticates to an Active Directory Domain Controller and creates\n        a volume shadow copy of the %SYSTEMDRIVE%. It then pulls down copies of the\n        ntds.dit file as well as the SYSTEM hive and stores them. The ntds.dit and SYSTEM\n        hive copy can be used in combination with other tools for offline extraction of AD\n        password hashes. All of this is done without uploading a single binary to the\n        target host.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/smb/psexec_ntdsgrab","documentationSlug":"/modules/documentation/auxiliary/admin/smb/psexec_ntdsgrab","referencesSlug":"/modules/references/auxiliary/admin/smb/psexec_ntdsgrab"},"author":["Royce Davis <rdavis@accuvant.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":false,"evasion":false,"name":"RHOSTS","required":true,"default":"","description":"The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"},{"advanced":false,"evasion":false,"name":"RPORT","required":true,"default":"445","description":"The SMB service port"},{"advanced":true,"evasion":false,"name":"SSL","required":false,"default":"false","description":"Negotiate SSL/TLS for outgoing connections"},{"advanced":true,"evasion":false,"name":"SSLVersion","required":true,"default":"Auto","description":"Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"},{"advanced":true,"evasion":false,"name":"SSLVerifyMode","required":false,"default":"PEER","description":"SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"},{"advanced":true,"evasion":false,"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"advanced":true,"evasion":false,"name":"Proxies","required":false,"default":"","description":"A proxy chain of format type:host:port[,type:host:port][...]"},{"advanced":true,"evasion":false,"name":"CPORT","required":false,"default":"","description":"The local client port"},{"advanced":true,"evasion":false,"name":"CHOST","required":false,"default":"","description":"The local client address"},{"advanced":true,"evasion":false,"name":"ConnectTimeout","required":true,"default":"10","description":"Maximum number of seconds to establish a TCP connection"},{"advanced":false,"evasion":true,"name":"TCP::max_send_size","required":false,"default":"0","description":"Maxiumum tcp segment size.  (0 = disable)"},{"advanced":false,"evasion":true,"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"advanced":false,"evasion":true,"name":"DCERPC::max_frag_size","required":true,"default":"4096","description":"Set the DCERPC packet fragmentation size"},{"advanced":false,"evasion":true,"name":"DCERPC::fake_bind_multi","required":false,"default":"true","description":"Use multi-context bind calls"},{"advanced":false,"evasion":true,"name":"DCERPC::fake_bind_multi_prepend","required":false,"default":"0","description":"Set the number of UUIDs to prepend before the target"},{"advanced":false,"evasion":true,"name":"DCERPC::fake_bind_multi_append","required":false,"default":"0","description":"Set the number of UUIDs to append the target"},{"advanced":false,"evasion":true,"name":"DCERPC::smb_pipeio","required":false,"default":"rw","description":"Use a different delivery method for accessing named pipes (Accepted: rw, trans)"},{"advanced":true,"evasion":false,"name":"DCERPC::ReadTimeout","required":true,"default":"10","description":"The number of seconds to wait for DCERPC responses"},{"advanced":true,"evasion":false,"name":"NTLM::UseNTLMv2","required":true,"default":"true","description":"Use NTLMv2 instead of NTLM2_session when 'Negotiate NTLM2' key is true"},{"advanced":true,"evasion":false,"name":"NTLM::UseNTLM2_session","required":true,"default":"true","description":"Activate the 'Negotiate NTLM2 key' flag, forcing the use of a NTLMv2_session"},{"advanced":true,"evasion":false,"name":"NTLM::SendLM","required":true,"default":"true","description":"Always send the LANMAN response (except when NTLMv2_session is specified)"},{"advanced":true,"evasion":false,"name":"NTLM::UseLMKey","required":true,"default":"false","description":"Activate the 'Negotiate Lan Manager Key' flag, using the LM key when the LM response is sent"},{"advanced":true,"evasion":false,"name":"NTLM::SendNTLM","required":true,"default":"true","description":"Activate the 'Negotiate NTLM key' flag, indicating the use of NTLM responses"},{"advanced":true,"evasion":false,"name":"NTLM::SendSPN","required":true,"default":"true","description":"Send an avp of type SPN in the ntlmv2 client blob, this allows authentication on Windows 7+/Server 2008 R2+ when SPN is required"},{"advanced":false,"evasion":true,"name":"SMB::pipe_evasion","required":true,"default":"false","description":"Enable segmented read/writes for SMB Pipes"},{"advanced":false,"evasion":true,"name":"SMB::pipe_write_min_size","required":true,"default":"1","description":"Minimum buffer size for pipe writes"},{"advanced":false,"evasion":true,"name":"SMB::pipe_write_max_size","required":true,"default":"1024","description":"Maximum buffer size for pipe writes"},{"advanced":false,"evasion":true,"name":"SMB::pipe_read_min_size","required":true,"default":"1","description":"Minimum buffer size for pipe reads"},{"advanced":false,"evasion":true,"name":"SMB::pipe_read_max_size","required":true,"default":"1024","description":"Maximum buffer size for pipe reads"},{"advanced":false,"evasion":true,"name":"SMB::pad_data_level","required":true,"default":"0","description":"Place extra padding between headers and data (level 0-3)"},{"advanced":false,"evasion":true,"name":"SMB::pad_file_level","required":true,"default":"0","description":"Obscure path names used in open/create (level 0-3)"},{"advanced":false,"evasion":true,"name":"SMB::obscure_trans_pipe_level","required":true,"default":"0","description":"Obscure PIPE string in TransNamedPipe (level 0-3)"},{"advanced":true,"evasion":false,"name":"SMBDirect","required":false,"default":"true","description":"The target port is a raw SMB service (not NetBIOS)"},{"advanced":false,"evasion":false,"name":"SMBUser","required":false,"default":"","description":"The username to authenticate as"},{"advanced":false,"evasion":false,"name":"SMBPass","required":false,"default":"","description":"The password for the specified username"},{"advanced":false,"evasion":false,"name":"SMBDomain","required":false,"default":".","description":"The Windows domain to use for authentication"},{"advanced":true,"evasion":false,"name":"SMBName","required":true,"default":"*SMBSERVER","description":"The NetBIOS hostname (required for port 139 connections)"},{"advanced":true,"evasion":false,"name":"SMB::VerifySignature","required":true,"default":"false","description":"Enforces client-side verification of server response signatures"},{"advanced":true,"evasion":false,"name":"SMB::ChunkSize","required":true,"default":"500","description":"The chunk size for SMB segments, bigger values will increase speed but break NT 4.0 and SMB signing"},{"advanced":true,"evasion":false,"name":"SMB::Native_OS","required":true,"default":"Windows 2000 2195","description":"The Native OS to send during authentication"},{"advanced":true,"evasion":false,"name":"SMB::Native_LM","required":true,"default":"Windows 2000 5.0","description":"The Native LM to send during authentication"},{"advanced":false,"evasion":false,"name":"SERVICE_NAME","required":false,"default":"","description":"The service name"},{"advanced":false,"evasion":false,"name":"SERVICE_DISPLAY_NAME","required":false,"default":"","description":"The service display name"},{"advanced":false,"evasion":false,"name":"SERVICE_DESCRIPTION","required":false,"default":"","description":"Service description to to be used on target for pretty listing"},{"advanced":true,"evasion":false,"name":"SERVICE_PERSIST","required":true,"default":"false","description":"Create an Auto run service and do not remove it."},{"advanced":false,"evasion":false,"name":"SMBSHARE","required":true,"default":"C$","description":"The name of a writeable share on the server"},{"advanced":false,"evasion":false,"name":"VSCPATH","required":false,"default":"","description":"The path to the target Volume Shadow Copy"},{"advanced":false,"evasion":false,"name":"WINPATH","required":true,"default":"WINDOWS","description":"The name of the Windows directory (examples: WINDOWS, WINNT)"},{"advanced":false,"evasion":false,"name":"CREATE_NEW_VSC","required":false,"default":"false","description":"If true, attempts to create a volume shadow copy"}]}},"pageContext":{"id":"9166129f-cb84-5366-b489-3c001403d9db"}}}