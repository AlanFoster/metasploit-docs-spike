{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/auxiliary/admin/mssql/mssql_ntlm_stealer","result":{"data":{"moduleMetadataJson":{"id":"82ef2865-75af-5ff1-9cd9-3b7637f54808","name":"Microsoft SQL Server NTLM Stealer","fullname":"auxiliary/admin/mssql/mssql_ntlm_stealer","description":"This module can be used to help capture or relay the LM/NTLM credentials of the\n        account running the remote SQL Server service. The module will use the supplied\n        credentials to connect to the target SQL Server instance and execute the native\n        \"xp_dirtree\" or \"xp_fileexist\" stored procedure.   The stored procedures will then\n        force the service account to authenticate to the system defined in the SMBProxy\n        option. In order for the attack to be successful, the SMB capture or relay module\n        must be running on the system defined as the SMBProxy.  The database account used\n        to connect to the database should only require the \"PUBLIC\" role to execute.\n        Successful execution of this attack usually results in local administrative access\n        to the Windows system.  Specifically, this works great for relaying credentials\n        between two SQL Servers using a shared service account to get shells.  However, if\n        the relay fails, then the LM hash can be reversed using the Halflm rainbow tables\n        and john the ripper. Thanks to \"Sh2kerr\" who wrote the ora_ntlm_stealer for the\n        inspiration.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/mssql/mssql_ntlm_stealer","documentationSlug":"/modules/documentation/auxiliary/admin/mssql/mssql_ntlm_stealer"},"author":["nullbind <scott.sutherland@netspi.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"name":"RHOSTS","required":true,"default":"","description":"The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"},{"name":"RPORT","required":true,"default":"1433","description":"The target port"},{"name":"CPORT","required":false,"default":"","description":"The local client port"},{"name":"CHOST","required":false,"default":"","description":"The local client address"},{"name":"SSL","required":false,"default":"false","description":"Negotiate SSL/TLS for outgoing connections"},{"name":"SSLVersion","required":true,"default":"Auto","description":"Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"},{"name":"SSLVerifyMode","required":false,"default":"PEER","description":"SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"},{"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"name":"Proxies","required":false,"default":"","description":"A proxy chain of format type:host:port[,type:host:port][...]"},{"name":"ConnectTimeout","required":true,"default":"10","description":"Maximum number of seconds to establish a TCP connection"},{"name":"TCP::max_send_size","required":false,"default":"0","description":"Maxiumum tcp segment size.  (0 = disable)"},{"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"name":"NTLM::UseNTLMv2","required":true,"default":"true","description":"Use NTLMv2 instead of NTLM2_session when 'Negotiate NTLM2' key is true"},{"name":"NTLM::UseNTLM2_session","required":true,"default":"true","description":"Activate the 'Negotiate NTLM2 key' flag, forcing the use of a NTLMv2_session"},{"name":"NTLM::SendLM","required":true,"default":"true","description":"Always send the LANMAN response (except when NTLMv2_session is specified)"},{"name":"NTLM::UseLMKey","required":true,"default":"false","description":"Activate the 'Negotiate Lan Manager Key' flag, using the LM key when the LM response is sent"},{"name":"NTLM::SendNTLM","required":true,"default":"true","description":"Activate the 'Negotiate NTLM key' flag, indicating the use of NTLM responses"},{"name":"NTLM::SendSPN","required":true,"default":"true","description":"Send an avp of type SPN in the ntlmv2 client blob, this allows authentication on Windows 7+/Server 2008 R2+ when SPN is required"},{"name":"USERNAME","required":false,"default":"sa","description":"The username to authenticate as"},{"name":"PASSWORD","required":false,"default":"","description":"The password for the specified username"},{"name":"TDSENCRYPTION","required":true,"default":"false","description":"Use TLS/SSL for TDS data \"Force Encryption\""},{"name":"USE_WINDOWS_AUTHENT","required":true,"default":"false","description":"Use windows authentification (requires DOMAIN option set)"},{"name":"HEX2BINARY","required":false,"default":"/Users/alan/Documents/code/metasploit-framework/data/exploits/mssql/h2b","description":"The path to the hex2binary script on the disk"},{"name":"DOMAIN","required":true,"default":"WORKSTATION","description":"The domain to use for windows authentication"},{"name":"THREADS","required":true,"default":"1","description":"The number of concurrent threads (max one per host)"},{"name":"ShowProgress","required":true,"default":"true","description":"Display progress messages during a scan"},{"name":"ShowProgressPercent","required":true,"default":"10","description":"The interval in percent that progress should be shown"},{"name":"SMBPROXY","required":true,"default":"0.0.0.0","description":"IP of SMB proxy or sniffer."}]}},"pageContext":{"id":"82ef2865-75af-5ff1-9cd9-3b7637f54808"}}}