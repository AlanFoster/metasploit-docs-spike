{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/browser/ms13_059_cflatmarkuppointer","result":{"data":{"moduleMetadataJson":{"id":"0cfea2fb-7ca0-5d64-a7f1-ddc1f8ebc061","name":"MS13-059 Microsoft Internet Explorer CFlatMarkupPointer Use-After-Free","fullname":"exploit/windows/browser/ms13_059_cflatmarkuppointer","description":"This is a memory corruption bug found in Microsoft Internet Explorer. On IE 9,\n        it seems to only affect certain releases of mshtml.dll, ranging from a newly\n        installed IE9 (9.0.8112.16446), to 9.00.8112.16502 (July 2013 update). IE8\n        requires a different way to trigger the vulnerability, but not currently covered\n        by this module.\n\n        The issue is specific to the browser's IE7 document compatibility, which can be\n        defined in X-UA-Compatible, and the content editable mode must be enabled. An\n        \"onmove\" event handler is also necessary to be able to trigger the bug, and the\n        event will be run twice before the crash. The first time is due to the position\n        change of the body element, which is also when a MSHTML!CFlatMarkupPointer::`vftable'\n        object is created during a \"SelectAll\" command, and this object will be used later\n        on for the crash. The second onmove event seems to be triggered by a InsertButton\n        (or Insert-whatever) command, which is also responsible for the free of object\n        CFlatMarkupPointer during page rendering. The EnsureRecalcNotify() function will\n        then still return an invalid reference to CFlatMarkupPointer (stored in EBX), and\n        then passes this on to the next functions (GetLineInfo -> QIClassID).  When this\n        reference arrives in function QIClassID, an access violation finally occurs when\n        the function is trying to call QueryInterface() with the bad reference, and this\n        results a crash. Successful control of the freed memory may leverage arbitrary code\n        execution under the context of the user.\n\n        Note: It is also possible to see a different object being freed and used, doesn't\n        always have to be CFlatMarkupPointer.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/browser/ms13_059_cflatmarkuppointer","documentationSlug":"/modules/documentation/exploit/windows/browser/ms13_059_cflatmarkuppointer","referencesSlug":"/modules/references/exploit/windows/browser/ms13_059_cflatmarkuppointer"},"author":["corelanc0d3r","sinn3r <sinn3r@metasploit.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":true,"evasion":false,"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"advanced":true,"evasion":false,"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"advanced":true,"evasion":false,"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"advanced":false,"evasion":false,"name":"SRVHOST","required":true,"default":"0.0.0.0","description":"The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."},{"advanced":false,"evasion":false,"name":"SRVPORT","required":true,"default":"8080","description":"The local port to listen on."},{"advanced":true,"evasion":false,"name":"ListenerComm","required":false,"default":"","description":"The specific communication channel to use for this service"},{"advanced":false,"evasion":false,"name":"SSL","required":false,"default":"false","description":"Negotiate SSL for incoming connections"},{"advanced":false,"evasion":false,"name":"SSLCert","required":false,"default":"","description":"Path to a custom SSL certificate (default is randomly generated)"},{"advanced":true,"evasion":false,"name":"SSLCompression","required":false,"default":"false","description":"Enable SSL/TLS-level compression"},{"advanced":true,"evasion":false,"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"advanced":false,"evasion":true,"name":"TCP::max_send_size","required":false,"default":"0","description":"Maximum tcp segment size.  (0 = disable)"},{"advanced":false,"evasion":true,"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"advanced":false,"evasion":false,"name":"URIPATH","required":false,"default":"","description":"The URI to use for this exploit (default is random)"},{"advanced":false,"evasion":true,"name":"HTTP::no_cache","required":false,"default":"false","description":"Disallow the browser to cache HTTP content"},{"advanced":false,"evasion":true,"name":"HTTP::chunked","required":false,"default":"false","description":"Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""},{"advanced":false,"evasion":true,"name":"HTTP::header_folding","required":false,"default":"false","description":"Enable folding of HTTP headers"},{"advanced":false,"evasion":true,"name":"HTTP::junk_headers","required":false,"default":"false","description":"Enable insertion of random junk HTTP headers"},{"advanced":false,"evasion":true,"name":"HTTP::compression","required":false,"default":"none","description":"Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"},{"advanced":false,"evasion":true,"name":"HTTP::server_name","required":true,"default":"Apache","description":"Configures the Server header of all outgoing replies"},{"advanced":true,"evasion":false,"name":"URIHOST","required":false,"default":"","description":"Host to use in URI (useful for tunnels)"},{"advanced":true,"evasion":false,"name":"URIPORT","required":false,"default":"","description":"Port to use in URI (useful for tunnels)"},{"advanced":true,"evasion":false,"name":"SendRobots","required":false,"default":"false","description":"Return a robots.txt file if asked for one"},{"advanced":false,"evasion":true,"name":"HTML::unicode","required":false,"default":"none","description":"Enable HTTP obfuscation via unicode (Accepted: none, utf-16le, utf-16be, utf-16be-marker, utf-32le, utf-32be)"},{"advanced":false,"evasion":true,"name":"HTML::base64","required":false,"default":"none","description":"Enable HTML obfuscation via an embeded base64 html object (IE not supported) (Accepted: none, plain, single_pad, double_pad, random_space_injection)"},{"advanced":false,"evasion":true,"name":"HTML::javascript::escape","required":false,"default":"0","description":"Enable HTML obfuscation via HTML escaping (number of iterations)"},{"advanced":true,"evasion":false,"name":"JsObfuscate","required":false,"default":"0","description":"Number of times to obfuscate JavaScript"},{"advanced":true,"evasion":false,"name":"JsIdentifiers","required":false,"default":"","description":"Identifiers to preserve for JsObfu"},{"advanced":false,"evasion":false,"name":"Retries","required":false,"default":"true","description":"Allow the browser to retry the module"},{"advanced":true,"evasion":false,"name":"CookieName","required":false,"default":"__ua","description":"The name of the tracking cookie"},{"advanced":true,"evasion":false,"name":"CookieExpiration","required":false,"default":"","description":"Cookie expiration in years (blank=expire on exit)"},{"advanced":true,"evasion":false,"name":"Custom404","required":false,"default":"","description":"An external custom 404 URL (Example: http://example.com/404.html)"}]}},"pageContext":{"id":"0cfea2fb-7ca0-5d64-a7f1-ddc1f8ebc061"}}}