{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/browser/aventail_epi_activex","result":{"data":{"moduleMetadataJson":{"id":"d30a824f-75b0-5842-8584-1ea1ee7c5cb4","name":"SonicWALL Aventail epi.dll AuthCredential Format String","fullname":"exploit/windows/browser/aventail_epi_activex","description":"This module exploits a format string vulnerability within version 10.0.4.x and\n        10.5.1 of the SonicWALL Aventail SSL-VPN Endpoint Interrogator/Installer ActiveX\n        control (epi.dll). By calling the 'AuthCredential' method with a specially\n        crafted Unicode format string, an attacker can cause memory corruption and\n        execute arbitrary code.\n\n        Unfortunately, it does not appear to be possible to indirectly re-use existing\n        stack data for more reliable exploitation. This is due to several particulars\n        about this vulnerability. First, the format string must be a Unicode string,\n        which uses two bytes per character. Second, the buffer is allocated on the\n        stack using the 'alloca' function. As such, each additional format specifier (%x)\n        will add four more bytes to the size allocated. This results in the inability to\n        move the read pointer outside of the buffer.\n\n        Further testing showed that using specifiers that pop more than four bytes does\n        not help. Any number of format specifiers will result in accessing the same value\n        within the buffer.\n\n        NOTE: It may be possible to leverage the vulnerability to leak memory contents.\n        However, that has not been fully investigated at this time.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/browser/aventail_epi_activex","documentationSlug":"/modules/documentation/exploit/windows/browser/aventail_epi_activex"},"author":["Nikolas Sotiriu","jduck <jduck@metasploit.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"name":"SRVHOST","required":true,"default":"0.0.0.0","description":"The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."},{"name":"SRVPORT","required":true,"default":"8080","description":"The local port to listen on."},{"name":"ListenerComm","required":false,"default":"","description":"The specific communication channel to use for this service"},{"name":"SSL","required":false,"default":"false","description":"Negotiate SSL for incoming connections"},{"name":"SSLCert","required":false,"default":"","description":"Path to a custom SSL certificate (default is randomly generated)"},{"name":"SSLCompression","required":false,"default":"false","description":"Enable SSL/TLS-level compression"},{"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"name":"TCP::max_send_size","required":false,"default":"0","description":"Maximum tcp segment size.  (0 = disable)"},{"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"name":"URIPATH","required":false,"default":"","description":"The URI to use for this exploit (default is random)"},{"name":"HTTP::no_cache","required":false,"default":"false","description":"Disallow the browser to cache HTTP content"},{"name":"HTTP::chunked","required":false,"default":"false","description":"Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""},{"name":"HTTP::header_folding","required":false,"default":"false","description":"Enable folding of HTTP headers"},{"name":"HTTP::junk_headers","required":false,"default":"false","description":"Enable insertion of random junk HTTP headers"},{"name":"HTTP::compression","required":false,"default":"none","description":"Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"},{"name":"HTTP::server_name","required":true,"default":"Apache","description":"Configures the Server header of all outgoing replies"},{"name":"URIHOST","required":false,"default":"","description":"Host to use in URI (useful for tunnels)"},{"name":"URIPORT","required":false,"default":"","description":"Port to use in URI (useful for tunnels)"},{"name":"SendRobots","required":false,"default":"false","description":"Return a robots.txt file if asked for one"},{"name":"HTML::unicode","required":false,"default":"none","description":"Enable HTTP obfuscation via unicode (Accepted: none, utf-16le, utf-16be, utf-16be-marker, utf-32le, utf-32be)"},{"name":"HTML::base64","required":false,"default":"none","description":"Enable HTML obfuscation via an embeded base64 html object (IE not supported) (Accepted: none, plain, single_pad, double_pad, random_space_injection)"},{"name":"HTML::javascript::escape","required":false,"default":"0","description":"Enable HTML obfuscation via HTML escaping (number of iterations)"}]}},"pageContext":{"id":"d30a824f-75b0-5842-8584-1ea1ee7c5cb4"}}}