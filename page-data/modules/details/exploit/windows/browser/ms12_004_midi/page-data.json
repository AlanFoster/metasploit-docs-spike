{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/browser/ms12_004_midi","result":{"data":{"moduleMetadataJson":{"id":"ec9c41c9-9ba0-5b81-937d-c7693f211cc4","name":"MS12-004 midiOutPlayNextPolyEvent Heap Overflow","fullname":"exploit/windows/browser/ms12_004_midi","description":"This module exploits a heap overflow vulnerability in the Windows Multimedia\n        Library (winmm.dll). The vulnerability occurs when parsing specially crafted\n        MIDI files.  Remote code execution can be achieved by using the Windows Media Player\n        ActiveX control.\n\n          Exploitation is done by supplying a specially crafted MIDI file with\n        specific events, causing the offset calculation being higher than what is\n        available on the heap (0x400 allocated by WINMM!winmmAlloc), and then allowing\n        us to either \"inc al\" or \"dec al\" a byte.  This can be used to corrupt an array\n        (CImplAry) we setup, and force the browser to confuse types from tagVARIANT objects,\n        which leverages remote code execution under the context of the user.\n\n          Note: At this time, for IE 8 target, msvcrt ROP is used by default. However,\n        if you know your target's patch level, you may also try the 'MSHTML' advanced\n        option for an info leak based attack.  Currently, this module only supports two\n        MSHTML builds: 8.0.6001.18702, which is often seen in a newly installed XP SP3.\n        Or 8.0.6001.19120, which is patch level before the MS12-004 fix.\n\n          Also, based on our testing, the vulnerability does not seem to trigger when\n        the victim machine is operated via rdesktop.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/browser/ms12_004_midi","documentationSlug":"/modules/documentation/exploit/windows/browser/ms12_004_midi"},"author":["Shane Garrett","juan vazquez <juan.vazquez@metasploit.com>","sinn3r <sinn3r@metasploit.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"name":"SRVHOST","required":true,"default":"0.0.0.0","description":"The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."},{"name":"SRVPORT","required":true,"default":"8080","description":"The local port to listen on."},{"name":"ListenerComm","required":false,"default":"","description":"The specific communication channel to use for this service"},{"name":"SSL","required":false,"default":"false","description":"Negotiate SSL for incoming connections"},{"name":"SSLCert","required":false,"default":"","description":"Path to a custom SSL certificate (default is randomly generated)"},{"name":"SSLCompression","required":false,"default":"false","description":"Enable SSL/TLS-level compression"},{"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"name":"TCP::max_send_size","required":false,"default":"0","description":"Maximum tcp segment size.  (0 = disable)"},{"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"name":"URIPATH","required":false,"default":"","description":"The URI to use for this exploit (default is random)"},{"name":"HTTP::no_cache","required":false,"default":"false","description":"Disallow the browser to cache HTTP content"},{"name":"HTTP::chunked","required":false,"default":"false","description":"Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""},{"name":"HTTP::header_folding","required":false,"default":"false","description":"Enable folding of HTTP headers"},{"name":"HTTP::junk_headers","required":false,"default":"false","description":"Enable insertion of random junk HTTP headers"},{"name":"HTTP::compression","required":false,"default":"none","description":"Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"},{"name":"HTTP::server_name","required":true,"default":"Apache","description":"Configures the Server header of all outgoing replies"},{"name":"URIHOST","required":false,"default":"","description":"Host to use in URI (useful for tunnels)"},{"name":"URIPORT","required":false,"default":"","description":"Port to use in URI (useful for tunnels)"},{"name":"SendRobots","required":false,"default":"false","description":"Return a robots.txt file if asked for one"},{"name":"HTML::unicode","required":false,"default":"none","description":"Enable HTTP obfuscation via unicode (Accepted: none, utf-16le, utf-16be, utf-16be-marker, utf-32le, utf-32be)"},{"name":"HTML::base64","required":false,"default":"none","description":"Enable HTML obfuscation via an embeded base64 html object (IE not supported) (Accepted: none, plain, single_pad, double_pad, random_space_injection)"},{"name":"HTML::javascript::escape","required":false,"default":"0","description":"Enable HTML obfuscation via HTML escaping (number of iterations)"},{"name":"OBFUSCATE","required":false,"default":"false","description":"Enable JavaScript obfuscation"},{"name":"MSHTML","required":false,"default":"","description":"MSHTML Build Version (Accepted: , 8.0.6001.18702, 8.0.6001.19120)"}]}},"pageContext":{"id":"ec9c41c9-9ba0-5b81-937d-c7693f211cc4"}}}