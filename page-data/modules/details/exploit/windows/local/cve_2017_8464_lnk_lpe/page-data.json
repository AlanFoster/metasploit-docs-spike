{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/local/cve_2017_8464_lnk_lpe","result":{"data":{"moduleMetadataJson":{"id":"5fa1702b-2247-539a-a9ec-be54f18b8d88","name":"LNK Code Execution Vulnerability","fullname":"exploit/windows/local/cve_2017_8464_lnk_lpe","description":"This module exploits a vulnerability in the handling of Windows Shortcut files (.LNK)\n          that contain a dynamic icon, loaded from a malicious DLL.\n\n          This vulnerability is a variant of MS15-020 (CVE-2015-0096). The created LNK file is\n          similar except an additional SpecialFolderDataBlock is included. The folder ID set\n          in this SpecialFolderDataBlock is set to the Control Panel. This is enough to bypass\n          the CPL whitelist. This bypass can be used to trick Windows into loading an arbitrary\n          DLL file.\n\n          The PATH option must be an absolute path to a writeable directory which is indexed for\n          searching. If no PATH is specified, the module defaults to %USERPROFILE%.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/local/cve_2017_8464_lnk_lpe","documentationSlug":"/modules/documentation/exploit/windows/local/cve_2017_8464_lnk_lpe","referencesSlug":"/modules/references/exploit/windows/local/cve_2017_8464_lnk_lpe"},"author":["Uncredited","Yorick Koster","Spencer McIntyre"],"notes":{"SideEffects":["artifacts-on-disk"],"Reliability":null,"Stability":["crash-service-restarts"]},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":true,"evasion":false,"name":"WfsDelay","required":false,"default":"0","description":"Additional delay when waiting for a session"},{"advanced":true,"evasion":false,"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"advanced":true,"evasion":false,"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"advanced":true,"evasion":false,"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"advanced":false,"evasion":false,"name":"SESSION","required":true,"default":"","description":"The session to run this module on."},{"advanced":true,"evasion":false,"name":"EXE::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload exe"},{"advanced":true,"evasion":false,"name":"EXE::Custom","required":false,"default":"","description":"Use custom exe instead of automatically generating a payload exe"},{"advanced":true,"evasion":false,"name":"EXE::Path","required":false,"default":"","description":"The directory in which to look for the executable template"},{"advanced":true,"evasion":false,"name":"EXE::Template","required":false,"default":"","description":"The executable template file name."},{"advanced":true,"evasion":false,"name":"EXE::Inject","required":false,"default":"false","description":"Set to preserve the original EXE function"},{"advanced":true,"evasion":false,"name":"EXE::OldMethod","required":false,"default":"false","description":"Set to use the substitution EXE generation method."},{"advanced":true,"evasion":false,"name":"EXE::FallBack","required":false,"default":"false","description":"Use the default template in case the specified one is missing"},{"advanced":true,"evasion":false,"name":"MSI::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload msi"},{"advanced":true,"evasion":false,"name":"MSI::Custom","required":false,"default":"","description":"Use custom msi instead of automatically generating a payload msi"},{"advanced":true,"evasion":false,"name":"MSI::Path","required":false,"default":"","description":"The directory in which to look for the msi template"},{"advanced":true,"evasion":false,"name":"MSI::Template","required":false,"default":"","description":"The msi template file name"},{"advanced":true,"evasion":false,"name":"MSI::UAC","required":false,"default":"false","description":"Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"},{"advanced":true,"evasion":false,"name":"FileDropperDelay","required":false,"default":"","description":"Delay in seconds before attempting cleanup"},{"advanced":false,"evasion":false,"name":"FILENAME","required":false,"default":"","description":"The LNK file"},{"advanced":false,"evasion":false,"name":"DLLNAME","required":false,"default":"","description":"The DLL file containing the payload"},{"advanced":false,"evasion":false,"name":"PATH","required":false,"default":"","description":"An explicit path to where the files should be written to"},{"advanced":true,"evasion":false,"name":"LnkComment","required":true,"default":"Manage Flash Player Settings","description":"The comment to use in the generated LNK file"},{"advanced":true,"evasion":false,"name":"LnkDisplayName","required":true,"default":"Flash Player","description":"The display name to use in the generated LNK file"}]}},"pageContext":{"id":"5fa1702b-2247-539a-a9ec-be54f18b8d88"}}}