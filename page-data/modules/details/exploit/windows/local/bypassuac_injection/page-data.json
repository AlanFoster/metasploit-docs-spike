{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/local/bypassuac_injection","result":{"data":{"moduleMetadataJson":{"id":"13211ea7-cf8a-5b46-b614-f98d97fd6f1d","name":"Windows Escalate UAC Protection Bypass (In Memory Injection)","fullname":"exploit/windows/local/bypassuac_injection","description":"This module will bypass Windows UAC by utilizing the trusted publisher\n        certificate through process injection. It will spawn a second shell that\n        has the UAC flag turned off. This module uses the Reflective DLL Injection\n        technique to drop only the DLL payload binary instead of three separate\n        binaries in the standard technique. However, it requires the correct\n        architecture to be selected, (use x64 for SYSWOW64 systems also).\n        If specifying EXE::Custom your DLL should call ExitProcess() after starting\n        your payload in a separate process.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/local/bypassuac_injection","documentationSlug":"/modules/documentation/exploit/windows/local/bypassuac_injection"},"author":["David Kennedy \"ReL1K\" <kennedyd013@gmail.com>","mitnick","mubix <mubix@hak5.org>","Ben Campbell <eat_meatballs@hotmail.co.uk>","Lesage","OJ Reeves"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"name":"WfsDelay","required":false,"default":"0","description":"Additional delay when waiting for a session"},{"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"name":"SESSION","required":true,"default":"","description":"The session to run this module on."},{"name":"EXE::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload exe"},{"name":"EXE::Custom","required":false,"default":"","description":"Use custom exe instead of automatically generating a payload exe"},{"name":"EXE::Path","required":false,"default":"","description":"The directory in which to look for the executable template"},{"name":"EXE::Template","required":false,"default":"","description":"The executable template file name."},{"name":"EXE::Inject","required":false,"default":"false","description":"Set to preserve the original EXE function"},{"name":"EXE::OldMethod","required":false,"default":"false","description":"Set to use the substitution EXE generation method."},{"name":"EXE::FallBack","required":false,"default":"false","description":"Use the default template in case the specified one is missing"},{"name":"MSI::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload msi"},{"name":"MSI::Custom","required":false,"default":"","description":"Use custom msi instead of automatically generating a payload msi"},{"name":"MSI::Path","required":false,"default":"","description":"The directory in which to look for the msi template"},{"name":"MSI::Template","required":false,"default":"","description":"The msi template file name"},{"name":"MSI::UAC","required":false,"default":"false","description":"Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"},{"name":"FileDropperDelay","required":false,"default":"","description":"Delay in seconds before attempting cleanup"},{"name":"Powershell::persist","required":true,"default":"false","description":"Run the payload in a loop"},{"name":"Powershell::prepend_sleep","required":false,"default":"","description":"Prepend seconds of sleep"},{"name":"Powershell::prepend_protections_bypass","required":true,"default":"false","description":"Prepend AMSI/SBL bypass"},{"name":"Powershell::strip_comments","required":true,"default":"true","description":"Strip comments"},{"name":"Powershell::strip_whitespace","required":true,"default":"false","description":"Strip whitespace"},{"name":"Powershell::sub_vars","required":true,"default":"false","description":"Substitute variable names"},{"name":"Powershell::sub_funcs","required":true,"default":"false","description":"Substitute function names"},{"name":"Powershell::exec_in_place","required":true,"default":"false","description":"Produce PSH without executable wrapper"},{"name":"Powershell::exec_rc4","required":true,"default":"false","description":"Encrypt PSH with RC4"},{"name":"Powershell::remove_comspec","required":true,"default":"false","description":"Produce script calling powershell directly"},{"name":"Powershell::noninteractive","required":true,"default":"true","description":"Execute powershell without interaction"},{"name":"Powershell::encode_final_payload","required":true,"default":"false","description":"Encode final payload for -EncodedCommand"},{"name":"Powershell::encode_inner_payload","required":true,"default":"false","description":"Encode inner payload for -EncodedCommand"},{"name":"Powershell::wrap_double_quotes","required":true,"default":"true","description":"Wraps the -Command argument in single quotes"},{"name":"Powershell::no_equals","required":true,"default":"false","description":"Pad base64 until no \"=\" remains"},{"name":"Powershell::method","required":true,"default":"reflection","description":"Payload delivery method (Accepted: net, reflection, old, msil)"}]}},"pageContext":{"id":"13211ea7-cf8a-5b46-b614-f98d97fd6f1d"}}}