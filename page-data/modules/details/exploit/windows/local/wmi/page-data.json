{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/local/wmi","result":{"data":{"moduleMetadataJson":{"id":"a4500580-6dc6-58c0-b9c4-7e91af2c7ee8","name":"Windows Management Instrumentation (WMI) Remote Command Execution","fullname":"exploit/windows/local/wmi","description":"This module executes powershell on the remote host using the current\n          user credentials or those supplied. Instead of using PSEXEC over TCP\n          port 445 we use the WMIC command to start a Remote Procedure Call on\n          TCP port 135 and an ephemeral port. Set ReverseListenerComm to tunnel\n          traffic through that session.\n\n          The result is similar to psexec but with the added benefit of using\n          the session's current authentication token instead of having to know\n          a password or hash.\n\n          The remote host must be configured to allow remote Windows Management\n          Instrumentation.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/local/wmi","documentationSlug":"/modules/documentation/exploit/windows/local/wmi","referencesSlug":"/modules/references/exploit/windows/local/wmi"},"author":["Ben Campbell <eat_meatballs@hotmail.co.uk>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":true,"evasion":false,"name":"WfsDelay","required":false,"default":"0","description":"Additional delay when waiting for a session"},{"advanced":true,"evasion":false,"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"advanced":true,"evasion":false,"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"advanced":true,"evasion":false,"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"advanced":false,"evasion":false,"name":"SESSION","required":true,"default":"","description":"The session to run this module on."},{"advanced":true,"evasion":false,"name":"Powershell::persist","required":true,"default":"false","description":"Run the payload in a loop"},{"advanced":true,"evasion":false,"name":"Powershell::prepend_sleep","required":false,"default":"","description":"Prepend seconds of sleep"},{"advanced":true,"evasion":false,"name":"Powershell::prepend_protections_bypass","required":true,"default":"false","description":"Prepend AMSI/SBL bypass"},{"advanced":true,"evasion":false,"name":"Powershell::strip_comments","required":true,"default":"true","description":"Strip comments"},{"advanced":true,"evasion":false,"name":"Powershell::strip_whitespace","required":true,"default":"false","description":"Strip whitespace"},{"advanced":true,"evasion":false,"name":"Powershell::sub_vars","required":true,"default":"false","description":"Substitute variable names"},{"advanced":true,"evasion":false,"name":"Powershell::sub_funcs","required":true,"default":"false","description":"Substitute function names"},{"advanced":true,"evasion":false,"name":"Powershell::exec_in_place","required":true,"default":"false","description":"Produce PSH without executable wrapper"},{"advanced":true,"evasion":false,"name":"Powershell::exec_rc4","required":true,"default":"false","description":"Encrypt PSH with RC4"},{"advanced":true,"evasion":false,"name":"Powershell::remove_comspec","required":true,"default":"false","description":"Produce script calling powershell directly"},{"advanced":true,"evasion":false,"name":"Powershell::noninteractive","required":true,"default":"true","description":"Execute powershell without interaction"},{"advanced":true,"evasion":false,"name":"Powershell::encode_final_payload","required":true,"default":"false","description":"Encode final payload for -EncodedCommand"},{"advanced":true,"evasion":false,"name":"Powershell::encode_inner_payload","required":true,"default":"false","description":"Encode inner payload for -EncodedCommand"},{"advanced":true,"evasion":false,"name":"Powershell::wrap_double_quotes","required":true,"default":"true","description":"Wraps the -Command argument in single quotes"},{"advanced":true,"evasion":false,"name":"Powershell::no_equals","required":true,"default":"false","description":"Pad base64 until no \"=\" remains"},{"advanced":true,"evasion":false,"name":"Powershell::method","required":true,"default":"reflection","description":"Payload delivery method (Accepted: net, reflection, old, msil)"},{"advanced":false,"evasion":false,"name":"SMBUser","required":false,"default":"","description":"The username to authenticate as"},{"advanced":false,"evasion":false,"name":"SMBPass","required":false,"default":"","description":"The password for the specified username"},{"advanced":false,"evasion":false,"name":"SMBDomain","required":false,"default":"","description":"The Windows domain to use for authentication"},{"advanced":false,"evasion":false,"name":"TIMEOUT","required":true,"default":"10","description":"Timeout for WMI command in seconds"},{"advanced":false,"evasion":false,"name":"RHOSTS","required":true,"default":"","description":"Target address range or CIDR identifier"},{"advanced":false,"evasion":false,"name":"ReverseListenerComm","required":false,"default":"","description":"The specific communication channel to use for this listener"}]}},"pageContext":{"id":"a4500580-6dc6-58c0-b9c4-7e91af2c7ee8"}}}