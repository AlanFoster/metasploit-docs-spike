{"componentChunkName":"component---src-templates-module-details-template-tsx","path":"/modules/details/exploit/windows/mssql/mssql_payload","result":{"data":{"moduleMetadataJson":{"id":"290f85d5-f041-5076-9c30-85324c29eb39","name":"Microsoft SQL Server Payload Execution","fullname":"exploit/windows/mssql/mssql_payload","description":"This module executes an arbitrary payload on a Microsoft SQL Server by using\n        the \"xp_cmdshell\" stored procedure. Currently, three delivery methods are supported.\n\n        First, the original method uses Windows 'debug.com'. File size restrictions are\n        avoided by incorporating the debug bypass method presented by SecureStat at\n        Defcon 17. Since this method invokes ntvdm, it is not available on x64 systems.\n\n        A second method takes advantage of the Command Stager subsystem. This allows using\n        various techniques, such as using a TFTP server, to send the executable. By default\n        the Command Stager uses 'wcsript.exe' to generate the executable on the target.\n\n        Finally, ReL1K's latest method utilizes PowerShell to transmit and recreate the\n        payload on the target.\n\n        NOTE: This module will leave a payload executable on the target system when the\n        attack is finished.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/mssql/mssql_payload","documentationSlug":"/modules/documentation/exploit/windows/mssql/mssql_payload","referencesSlug":"/modules/references/exploit/windows/mssql/mssql_payload"},"author":["David Kennedy \"ReL1K\" <kennedyd013@gmail.com>","jduck <jduck@metasploit.com>"],"notes":{"SideEffects":null,"Reliability":null,"Stability":null},"options":[{"advanced":true,"evasion":false,"name":"WORKSPACE","required":false,"default":"","description":"Specify the workspace for this module"},{"advanced":true,"evasion":false,"name":"VERBOSE","required":false,"default":"false","description":"Enable detailed status messages"},{"advanced":true,"evasion":false,"name":"WfsDelay","required":false,"default":"0","description":"Additional delay when waiting for a session"},{"advanced":true,"evasion":false,"name":"EnableContextEncoding","required":false,"default":"false","description":"Use transient context when encoding payloads"},{"advanced":true,"evasion":false,"name":"ContextInformationFile","required":false,"default":"","description":"The information file that contains context information"},{"advanced":true,"evasion":false,"name":"DisablePayloadHandler","required":false,"default":"false","description":"Disable the handler code for the selected payload"},{"advanced":false,"evasion":false,"name":"RHOSTS","required":true,"default":"","description":"The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'"},{"advanced":false,"evasion":false,"name":"RPORT","required":true,"default":"1433","description":"The target port"},{"advanced":true,"evasion":false,"name":"CPORT","required":false,"default":"","description":"The local client port"},{"advanced":true,"evasion":false,"name":"CHOST","required":false,"default":"","description":"The local client address"},{"advanced":false,"evasion":false,"name":"SSL","required":false,"default":"false","description":"Negotiate SSL for incoming connections"},{"advanced":true,"evasion":false,"name":"SSLVersion","required":true,"default":"Auto","description":"Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS1, TLS1.1, TLS1.2)"},{"advanced":true,"evasion":false,"name":"SSLVerifyMode","required":false,"default":"PEER","description":"SSL verification method (Accepted: CLIENT_ONCE, FAIL_IF_NO_PEER_CERT, NONE, PEER)"},{"advanced":true,"evasion":false,"name":"SSLCipher","required":false,"default":"","description":"String for SSL cipher spec - \"DHE-RSA-AES256-SHA\" or \"ADH\""},{"advanced":true,"evasion":false,"name":"Proxies","required":false,"default":"","description":"A proxy chain of format type:host:port[,type:host:port][...]"},{"advanced":true,"evasion":false,"name":"ConnectTimeout","required":true,"default":"10","description":"Maximum number of seconds to establish a TCP connection"},{"advanced":false,"evasion":true,"name":"TCP::max_send_size","required":false,"default":"0","description":"Maximum tcp segment size.  (0 = disable)"},{"advanced":false,"evasion":true,"name":"TCP::send_delay","required":false,"default":"0","description":"Delays inserted before every send.  (0 = disable)"},{"advanced":true,"evasion":false,"name":"NTLM::UseNTLMv2","required":true,"default":"true","description":"Use NTLMv2 instead of NTLM2_session when 'Negotiate NTLM2' key is true"},{"advanced":true,"evasion":false,"name":"NTLM::UseNTLM2_session","required":true,"default":"true","description":"Activate the 'Negotiate NTLM2 key' flag, forcing the use of a NTLMv2_session"},{"advanced":true,"evasion":false,"name":"NTLM::SendLM","required":true,"default":"true","description":"Always send the LANMAN response (except when NTLMv2_session is specified)"},{"advanced":true,"evasion":false,"name":"NTLM::UseLMKey","required":true,"default":"false","description":"Activate the 'Negotiate Lan Manager Key' flag, using the LM key when the LM response is sent"},{"advanced":true,"evasion":false,"name":"NTLM::SendNTLM","required":true,"default":"true","description":"Activate the 'Negotiate NTLM key' flag, indicating the use of NTLM responses"},{"advanced":true,"evasion":false,"name":"NTLM::SendSPN","required":true,"default":"true","description":"Send an avp of type SPN in the ntlmv2 client blob, this allows authentication on Windows 7+/Server 2008 R2+ when SPN is required"},{"advanced":false,"evasion":false,"name":"USERNAME","required":false,"default":"sa","description":"The username to authenticate as"},{"advanced":false,"evasion":false,"name":"PASSWORD","required":false,"default":"","description":"The password for the specified username"},{"advanced":false,"evasion":false,"name":"TDSENCRYPTION","required":true,"default":"false","description":"Use TLS/SSL for TDS data \"Force Encryption\""},{"advanced":false,"evasion":false,"name":"USE_WINDOWS_AUTHENT","required":true,"default":"false","description":"Use windows authentification (requires DOMAIN option set)"},{"advanced":true,"evasion":false,"name":"HEX2BINARY","required":false,"default":"/Users/alan/Documents/code/metasploit-framework/data/exploits/mssql/h2b","description":"The path to the hex2binary script on the disk"},{"advanced":true,"evasion":false,"name":"DOMAIN","required":true,"default":"WORKSTATION","description":"The domain to use for windows authentication"},{"advanced":true,"evasion":false,"name":"EXE::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload exe"},{"advanced":true,"evasion":false,"name":"EXE::Custom","required":false,"default":"","description":"Use custom exe instead of automatically generating a payload exe"},{"advanced":true,"evasion":false,"name":"EXE::Path","required":false,"default":"","description":"The directory in which to look for the executable template"},{"advanced":true,"evasion":false,"name":"EXE::Template","required":false,"default":"","description":"The executable template file name."},{"advanced":true,"evasion":false,"name":"EXE::Inject","required":false,"default":"false","description":"Set to preserve the original EXE function"},{"advanced":true,"evasion":false,"name":"EXE::OldMethod","required":false,"default":"false","description":"Set to use the substitution EXE generation method."},{"advanced":true,"evasion":false,"name":"EXE::FallBack","required":false,"default":"false","description":"Use the default template in case the specified one is missing"},{"advanced":true,"evasion":false,"name":"MSI::EICAR","required":false,"default":"false","description":"Generate an EICAR file instead of regular payload msi"},{"advanced":true,"evasion":false,"name":"MSI::Custom","required":false,"default":"","description":"Use custom msi instead of automatically generating a payload msi"},{"advanced":true,"evasion":false,"name":"MSI::Path","required":false,"default":"","description":"The directory in which to look for the msi template"},{"advanced":true,"evasion":false,"name":"MSI::Template","required":false,"default":"","description":"The msi template file name"},{"advanced":true,"evasion":false,"name":"MSI::UAC","required":false,"default":"false","description":"Create an MSI with a UAC prompt (elevation to SYSTEM if accepted)"},{"advanced":false,"evasion":false,"name":"SRVHOST","required":true,"default":"0.0.0.0","description":"The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses."},{"advanced":false,"evasion":false,"name":"SRVPORT","required":true,"default":"8080","description":"The local port to listen on."},{"advanced":true,"evasion":false,"name":"ListenerComm","required":false,"default":"","description":"The specific communication channel to use for this service"},{"advanced":false,"evasion":false,"name":"SSLCert","required":false,"default":"","description":"Path to a custom SSL certificate (default is randomly generated)"},{"advanced":true,"evasion":false,"name":"SSLCompression","required":false,"default":"false","description":"Enable SSL/TLS-level compression"},{"advanced":false,"evasion":false,"name":"URIPATH","required":false,"default":"","description":"The URI to use for this exploit (default is random)"},{"advanced":false,"evasion":true,"name":"HTTP::no_cache","required":false,"default":"false","description":"Disallow the browser to cache HTTP content"},{"advanced":false,"evasion":true,"name":"HTTP::chunked","required":false,"default":"false","description":"Enable chunking of HTTP responses via \"Transfer-Encoding: chunked\""},{"advanced":false,"evasion":true,"name":"HTTP::header_folding","required":false,"default":"false","description":"Enable folding of HTTP headers"},{"advanced":false,"evasion":true,"name":"HTTP::junk_headers","required":false,"default":"false","description":"Enable insertion of random junk HTTP headers"},{"advanced":false,"evasion":true,"name":"HTTP::compression","required":false,"default":"none","description":"Enable compression of HTTP responses via content encoding (Accepted: none, gzip, deflate)"},{"advanced":false,"evasion":true,"name":"HTTP::server_name","required":true,"default":"Apache","description":"Configures the Server header of all outgoing replies"},{"advanced":true,"evasion":false,"name":"URIHOST","required":false,"default":"","description":"Host to use in URI (useful for tunnels)"},{"advanced":true,"evasion":false,"name":"URIPORT","required":false,"default":"","description":"Port to use in URI (useful for tunnels)"},{"advanced":true,"evasion":false,"name":"SendRobots","required":false,"default":"false","description":"Return a robots.txt file if asked for one"},{"advanced":true,"evasion":false,"name":"CMDSTAGER::FLAVOR","required":false,"default":"auto","description":"The CMD Stager to use. (Accepted: auto, vbs)"},{"advanced":true,"evasion":false,"name":"CMDSTAGER::DECODER","required":false,"default":"","description":"The decoder stub to use."},{"advanced":true,"evasion":false,"name":"CMDSTAGER::TEMP","required":false,"default":"","description":"Writable directory for staged files"},{"advanced":true,"evasion":false,"name":"CMDSTAGER::SSL","required":false,"default":"false","description":"Use SSL/TLS for supported stagers"},{"advanced":false,"evasion":false,"name":"METHOD","required":true,"default":"cmd","description":"Which payload delivery method to use (ps, cmd, or old)"}]}},"pageContext":{"id":"290f85d5-f041-5076-9c30-85324c29eb39"}}}