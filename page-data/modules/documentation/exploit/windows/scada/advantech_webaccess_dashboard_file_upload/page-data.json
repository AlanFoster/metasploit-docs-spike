{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/scada/advantech_webaccess_dashboard_file_upload","result":{"data":{"moduleMetadataJson":{"id":"e30060f4-3c75-5c33-b3be-4eb89b25a00d","name":"Advantech WebAccess Dashboard Viewer uploadImageCommon Arbitrary File Upload","fullname":"exploit/windows/scada/advantech_webaccess_dashboard_file_upload","description":"This module exploits an arbitrary file upload vulnerability found in Advantech WebAccess 8.0.\n\n         This vulnerability allows remote attackers to execute arbitrary code on vulnerable installations\n         of Advantech WebAccess. Authentication is not required to exploit this vulnerability.\n\n         The specific flaw exists within the WebAccess Dashboard Viewer. Insufficient validation within\n         the uploadImageCommon function in the UploadAjaxAction script allows unauthenticated callers to\n         upload arbitrary code (instead of an image) to the server, which will then be executed under the\n         high-privilege context of the IIS AppPool.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/windows/scada/advantech_webaccess_dashboard_file_upload","documentationSlug":"/modules/documentation/exploit/windows/scada/advantech_webaccess_dashboard_file_upload"},"documentation":{"html":"<p>Advantech WebAccess is a web-based software package for human-machine interfaces and supervisory\ncontrol and data acquisition (SCADA). WebAccess 8.0 suffers from a vulnerability that allows an\nattacker to upload a malicious file onto the web server, and gain arbitrary code execution under\nthe context of IIS APPPOOL\\WADashboard_pool.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>All builds of Advantech WebAccess 8.0 are affected:</p>\n<ul>\n<li><a href=\"http://advcloudfiles.advantech.com/web/Download/webaccess/8.0/AdvantechWebAccessUSANode8.0_20150816.exe\">WebAccess 8.0 _20150816</a></li>\n<li><a href=\"http://advcloudfiles.advantech.com/web/Download/webaccess/8.0/AdvantechWebAccessUSANode8.0_20141103_3.4.3.exe\">WebAccess 8.0 _20141103</a></li>\n</ul>\n<p>For exploitation, there is a difference between the two versions. The 2014 version of WebAccess 8.0\nhad two upload actions in the UploadAjaxAction class: uploadBannerImage, and uploadImageCommon. The\n2015 version of WebAccess 8.0 added another upload action: uploadFile. This exploit uses the\nuploadImageCommon action because it works for both.</p>\n<p>Advantech WebAccess 8.1 mitigated the vulnerability by enforcing authentication for\nUploadAjaxAction. However, keep in mind that WebAccess 8.1 comes with a default credential of\nuser name \"admin\" with a blank password, which means the user is likely still at risk by using the\ndefault configuration.</p>\n<p>advantech<em>webaccess</em>dashboard<em>file</em>upload will not attempt to exploit WebAccess 8.1.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start a Windows machine (such as Windows 7 SP1).</li>\n<li>To install Advantech WebAccess, make sure to install the Internet Information Services Windows\nfeature.</li>\n<li>Download WebAccess 8.0, and install it. After installation, make sure the web application is\noperational by accessing with a browser (on port 80).</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/windows/scada/advantech_webaccess_dashboard_file_upload</code></li>\n<li>Do: <code class=\"language-text\">set RHOST [TARGET_IP]</code></li>\n<li>Set other options if needed</li>\n<li>Do: <code class=\"language-text\">exploit</code>, and you should get a session.</li>\n</ol>"}}},"pageContext":{"id":"e30060f4-3c75-5c33-b3be-4eb89b25a00d"}}}