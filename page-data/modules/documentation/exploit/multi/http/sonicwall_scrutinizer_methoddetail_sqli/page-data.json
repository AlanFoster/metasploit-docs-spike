{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli","result":{"data":{"moduleMetadataJson":{"id":"e99cf2d1-8cce-5bc2-b5ca-0a3ac5cb6aa2","name":"Dell SonicWALL Scrutinizer 11.01 methodDetail SQL Injection","fullname":"exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli","description":"This module exploits a vulnerability found in Dell SonicWALL Scrutinizer. The methodDetail\n        parameter in exporters.php allows an attacker to write arbitrary files to the file system\n        with an SQL Injection attack, and gain remote code execution under the context of SYSTEM\n        for Windows, or as Apache for Linux.\n\n        Authentication is required to exploit this vulnerability, but this module uses\n        the default admin:admin credential.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli","documentationSlug":"/modules/documentation/exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli","referencesSlug":"/modules/references/exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli"},"documentation":{"html":"<p>Dell SonicWALL Scrutinizer is multi-vendor, application traffic analytics, visualization and\nreporting tool to measure and troubleshoot real-time network performance. It is used by routers,\nfirewalls, and other network equipment products.</p>\n<p>In version 11.0.1, SonicWall Scrutinizer suffers from a vulnerability that allows a remote\nattacker to inject a malicious SQL string into the methodDetail parameter, and then gain\ncontrol of execution under the context of SYSTEM on Windows, or Apache on Linux.</p>\n<p>Authentication is required to exploit this vulnerability. However, SonicWALL Scrutinizer does\ncome with a default username and password (admin:admin), which is also somewhat unsafe.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>As reported by the vendor, only version 11.0.1 is vulnerable to the SQL injection attack.</p>\n<p>For testing purposes, you may download the vulnerable version of Dell SonicWALL Scrutinizer for Windows from:\n<a href=\"http://software.sonicwall.com/ScrutinizerSW/184-003184-00_Rev_A_sonicwall-oem-Scrutinizer-windows-installer.exe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://software.sonicwall.com/ScrutinizerSW/184-003184-00<em>Rev</em>A_sonicwall-oem-Scrutinizer-windows-installer.exe</a>.</p>\n<p>If you prefer the appliance, then you can get it from: <a href=\"http://software.sonicwall.com/scrutinizerVA/184-003186-00_Rev_A_Dell_SonicWALL_ScrutinizerVA.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://software.sonicwall.com/scrutinizerVA/184-003186-00<em>Rev</em>A<em>Dell</em>SonicWALL_ScrutinizerVA.zip</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>For testing purposes, the Windows installer is a bit easier to use. You should be able to complete\nit by simply following the instructions on the screen.</p>\n<p>The Linux appliance requires more steps. To be able to use this, make sure you have more than 20GB\non disk. And you may need to modify the boot menu to <a href=\"https://wiki.centos.org/TipsAndTricks/ResetRootPassword\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reset the root password</a> if you cannot get around the scrutinizer login screen.</p>\n<p>Using the sonicwall<em>scrutinizer</em>methoddetail_sqli module is rather straight-forward. Make sure\nyou have a valid username and password, and configure the payload for the target. You will most\nlikely use the module like this:</p>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/sonicwall_scrutinizer_methoddetail_sqli</code></li>\n<li>Do: <code class=\"language-text\">set RHOST [TARGET IP]</code></li>\n<li>Do: <code class=\"language-text\">set PAYLOAD [PAYLOAD NAME]</code> (use <code class=\"language-text\">show payloads</code> for more info)</li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>sonicwall<em>scrutinizer</em>methoddetail_sqli supports two platforms: Windows and Linux. By default,\nit can automatically find the right OS, and configure the exploit and payload generation\naccordingly.</p>\n<p><strong>Using the module against Windows platform</strong></p>\n<p>If sonicwall<em>scrutinizer</em>methoddetail_sqli is able to exploit SonicWALL Scrutinizer successfully,\non Windows you will be compromising the host as SYSTEM - the highest privilege. However, since\nWindows does not allow you to delete the malicious executable that is in use, you will have to\ndo this manually at some point after you've migrated to a different process. The exploit should\ntell you where this binary is like this message:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[!] This exploit may require manual cleanup of &#39;YrfCO.exe&#39; on the target</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>Using the module against Linux platform</strong></p>\n<p>For Linux platform, sonicwall<em>scrutinizer</em>methoddetail_sqli was specifically written against\nthe Linux appliance provided by Dell, but it should also work against other similar machines.</p>\n<p>Unlike Windows, if the module is able to successfully exploit the machine, you won't have the\nhighest privilege, instead you start off with Apache.</p>\n<p>Automatic cleanup is not an issue on Linux. Both the PHP backdoor and the Linux binary\nshould be automatically removed without problems.</p>"}}},"pageContext":{"id":"e99cf2d1-8cce-5bc2-b5ca-0a3ac5cb6aa2"}}}