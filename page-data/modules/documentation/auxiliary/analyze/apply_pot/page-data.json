{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/analyze/apply_pot","result":{"data":{"moduleMetadataJson":{"id":"4a15f032-1787-539b-88e8-b580b6b8dd7c","name":"Apply Pot File To Hashes","fullname":"auxiliary/analyze/apply_pot","description":"This module uses a John the Ripper or Hashcat .pot file to crack any password\n        hashes in the creds database instantly.  JtR's --show functionality is used to\n        help combine all the passwords into an easy to use format.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/analyze/apply_pot","documentationSlug":"/modules/documentation/auxiliary/analyze/apply_pot"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module applies a john the ripper (or hashcat) style .pot file to hashes in the database.\nThis will allow very fast cracking of all supported hash types which have already been cracked.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Have at least one set of hashes in the database</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/analyze/apply_pot</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should hopefully crack a password.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>   <strong>CONFIG</strong></p>\n<p>   The path to a John config file (JtR option: <code class=\"language-text\">--config</code>).  Default is <code class=\"language-text\">metasploit-framework/data/john.conf</code></p>\n<p>   <strong>JOHN_PATH</strong></p>\n<p>   The absolute path to the John the Ripper executable.  Default behavior is to search <code class=\"language-text\">path</code> for\n<code class=\"language-text\">john</code> and <code class=\"language-text\">john.exe</code>.</p>\n<p>   <strong>POT</strong></p>\n<p>   The path to a John POT file (JtR option: <code class=\"language-text\">--pot</code>) to use instead.  The <code class=\"language-text\">pot</code> file is the data file which\nrecords cracked password hashes.  Kali linux's default location is <code class=\"language-text\">/root/.john/john.pot</code>.\nDefault is <code class=\"language-text\">~/.msf4/john.pot</code>.</p>\n<p>   <strong>DeleteTempFiles</strong></p>\n<p>   This option will prevent deletion of the wordlist and file containing hashes.  This may be useful for\nrunning the hashes through john if it wasn't cracked, or for debugging. Default is <code class=\"language-text\">false</code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>In this scenario, we fill a bunch of different hash types into the creds db.  You'll need a\n.pot file with the cracked hashes, the following can be used:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">rEK1ecacw.7.c:password\n_J9..K0AyUubDrfOgO4s:password\n$2a$05$bvIG6Nmid91Mu9RcmmWZfO5HJIMCT8riNW0hEp8f6/FuA2/mHZFpe:password\nyhMEAyLkfWqeQ:se\n$1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/:password\n$5$MnfsQ4iN$ZMTppKN16y/tIsUYs/obHlhdP.Os80yXhTurpBMUbA5:password\n$6$zWwwXKNj$gLAOoZCjcr8p/.VgV/FkGC3NX7BsXys3KHYePfuIGMNjY83dVxugPYlxVg/evpcVEJLT/rSwZcDMlVVf/bhf.1:password\n0x0100A607BA7C54A24D17B565C59F1743776A10250F581D482DA8:foo\n0x01004086CEB6BF932BC4151A1AF1F13CD17301D70816A8886908:toto\n0x0100A607BA7C54A24D17B565C59F1743776A10250F581D482DA8B6D6261460D3F53B279CC6913CE747006A2E3254:FOO\n0x0200F733058A07892C5CACE899768F89965F6BD1DED7955FE89E1C9A10E27849B0B213B5CE92CC9347ECCB34C3EFADAF2FD99BFFECD8D9150DD6AACB5D409A9D2652A4E0AF16:Password1!\n445ff82636a7ba59:probe\n*5AD8F88516BD021DD43F171E2C785C69F8E54ADB:tere\nO$SIMON#4f8bc1809cb2af77:A\nO$SYSTEM#9eedfa0ad26c6d52:THALES\n8F2D65FB5547B71C8DA3760F10960428CD307B1C6271691FC55C1F56554A:epsilon\n$oracle12c$e3243b98974159cc24fd2c9a8b30ba62e0e83b6ca2fc7c55177c3a7f82602e3bdd17ceb9b9091cf9dad672b8be961a9eac4d344bdba878edc5dcb5899f689ebd8dd1be3f67bff9813a464382381ab36b:epsilon\n$dynamic_1034$be86a79bf2043622d58d5453c47d4860$HEX$24556578616d706c65:password\n$LM$ac404c4ba2c66533:ASE\n$LM$4a3b108f3fa6cb6d:D\n$LM$e52cac67419a9a22:PASSWOR\n$NT$8846f7eaee8fb117ad06bdd830b7586c:password</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (hashes_pot.rb)&gt; creds -d\nCredentials\n===========\n\nhost  origin  service  public  private  realm  private_type  JtR Format\n----  ------  -------  ------  -------  -----  ------------  ----------\n\nresource (hashes_pot.rb)&gt; creds add user:des_password hash:rEK1ecacw.7.c jtr:des\nresource (hashes_pot.rb)&gt; creds add user:md5_password hash:$1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/ jtr:md5\nresource (hashes_pot.rb)&gt; creds add user:bsdi_password hash:_J9..K0AyUubDrfOgO4s jtr:bsdi\nresource (hashes_pot.rb)&gt; creds add user:sha256_password hash:$5$MnfsQ4iN$ZMTppKN16y/tIsUYs/obHlhdP.Os80yXhTurpBMUbA5 jtr:sha256,crypt\nresource (hashes_pot.rb)&gt; creds add user:sha512_password hash:$6$zWwwXKNj$gLAOoZCjcr8p/.VgV/FkGC3NX7BsXys3KHYePfuIGMNjY83dVxugPYlxVg/evpcVEJLT/rSwZcDMlVVf/bhf.1 jtr:sha512,crypt\nresource (hashes_pot.rb)&gt; creds add user:blowfish_password hash:$2a$05$bvIG6Nmid91Mu9RcmmWZfO5HJIMCT8riNW0hEp8f6/FuA2/mHZFpe jtr:bf\nresource (hashes_pot.rb)&gt; creds add user:lm_password ntlm:E52CAC67419A9A224A3B108F3FA6CB6D:8846F7EAEE8FB117AD06BDD830B7586C jtr:lm\nresource (hashes_pot.rb)&gt; creds add user:nt_password ntlm:AAD3B435B51404EEAAD3B435B51404EE:8846F7EAEE8FB117AD06BDD830B7586C jtr:nt\nresource (hashes_pot.rb)&gt; creds add user:mssql05_toto hash:0x01004086CEB6BF932BC4151A1AF1F13CD17301D70816A8886908 jtr:mssql05\nresource (hashes_pot.rb)&gt; creds add user:mssql_foo hash:0x0100A607BA7C54A24D17B565C59F1743776A10250F581D482DA8B6D6261460D3F53B279CC6913CE747006A2E3254 jtr:mssql\nresource (hashes_pot.rb)&gt; creds add user:mssql12_Password1! hash:0x0200F733058A07892C5CACE899768F89965F6BD1DED7955FE89E1C9A10E27849B0B213B5CE92CC9347ECCB34C3EFADAF2FD99BFFECD8D9150DD6AACB5D409A9D2652A4E0AF16 jtr:mssql12\nresource (hashes_pot.rb)&gt; creds add user:mysql_probe hash:445ff82636a7ba59 jtr:mysql\nresource (hashes_pot.rb)&gt; creds add user:mysql-sha1_tere hash:*5AD8F88516BD021DD43F171E2C785C69F8E54ADB jtr:mysql-sha1\nresource (hashes_pot.rb)&gt; creds add user:simon hash:4F8BC1809CB2AF77 jtr:des,oracle\nresource (hashes_pot.rb)&gt; creds add user:SYSTEM hash:9EEDFA0AD26C6D52 jtr:des,oracle\nresource (hashes_pot.rb)&gt; creds add user:DEMO hash:&#39;S:8F2D65FB5547B71C8DA3760F10960428CD307B1C6271691FC55C1F56554A;H:DC9894A01797D91D92ECA1DA66242209;T:23D1F8CAC9001F69630ED2DD8DF67DD3BE5C470B5EA97B622F757FE102D8BF14BEDC94A3CC046D10858D885DB656DC0CBF899A79CD8C76B788744844CADE54EEEB4FDEC478FB7C7CBFBBAC57BA3EF22C&#39; jtr:raw-sha1,oracle\nresource (hashes_pot.rb)&gt; creds add user:oracle11_epsilon hash:&#39;S:8F2D65FB5547B71C8DA3760F10960428CD307B1C6271691FC55C1F56554A;H:DC9894A01797D91D92ECA1DA66242209;T:23D1F8CAC9001F69630ED2DD8DF67DD3BE5C470B5EA97B622F757FE102D8BF14BEDC94A3CC046D10858D885DB656DC0CBF899A79CD8C76B788744844CADE54EEEB4FDEC478FB7C7CBFBBAC57BA3EF22C&#39; jtr:raw-sha1,oracle\nresource (hashes_pot.rb)&gt; creds add user:oracle12c_epsilon hash:&#39;H:DC9894A01797D91D92ECA1DA66242209;T:E3243B98974159CC24FD2C9A8B30BA62E0E83B6CA2FC7C55177C3A7F82602E3BDD17CEB9B9091CF9DAD672B8BE961A9EAC4D344BDBA878EDC5DCB5899F689EBD8DD1BE3F67BFF9813A464382381AB36B&#39; jtr:pbkdf2,oracle12c\nresource (hashes_pot.rb)&gt; creds add user:example postgres:md5be86a79bf2043622d58d5453c47d4860\nresource (hashes_pot.rb)&gt; use auxiliary/analyze/apply_pot\nresource (hashes_pot.rb)&gt; run\n[*] Hashes Written out to /tmp/hashes_tmp20190203-16380-1974mdz\n[*] Checking bcrypt hashes against pot file\n[+] blowfish_password:password\n[*] Checking bsdicrypt hashes against pot file\n[+] bsdi_password:password\n[*] Checking crypt hashes against pot file\nWarning: hash encoding string length 46, type id $d\nappears to be unsupported on this system; will not load such hashes.\n[+] des_password:password\n[+] md5_password:password\n[+] sha256_password:password\n[+] sha512_password:password\n[*] Checking descrypt hashes against pot file\n[+] des_password:password\n[*] Checking lm hashes against pot file\n[+] lm_password:password\n[*] Checking nt hashes against pot file\n[+] lm_password:password\n[+] nt_password:password\n[*] Checking md5crypt hashes against pot file\n[+] md5_password:password\n[*] Checking mysql hashes against pot file\n[+] mysql_probe:probe\n[*] Checking mysql-sha1 hashes against pot file\n[+] mysql-sha1_tere:tere\n[*] Checking mssql hashes against pot file\n[+] mssql_foo:FOO\n[*] Checking mssql05 hashes against pot file\n[+] mssql05_toto:toto\n[+] mssql_foo:foo\n[*] Checking mssql12 hashes against pot file\n[+] mssql12_Password1!:Password1!\n[*] Checking oracle hashes against pot file\n[+] simon:A\n[+] SYSTEM:THALES\n[*] Checking oracle11 hashes against pot file\n[+] DEMO:epsilon\n[+] oracle11_epsilon:epsilon\n[*] Checking oracle12c hashes against pot file\n[+] oracle12c_epsilon:epsilon\n[*] Checking dynamic_1506 hashes against pot file\n[*] Checking dynamic_1034 hashes against pot file\n[+] example:password\n[*] Auxiliary module execution completed\nresource (hashes_pot.rb)&gt; creds\nCredentials\n===========\n\nhost  origin  service  public              private                                                                                                                                                                                                                                                               realm  private_type        JtR Format\n----  ------  -------  ------              -------                                                                                                                                                                                                                                                               -----  ------------        ----------\n                       des_password        password                                                                                                                                                                                                                                                                     Password            \n                       des_password        rEK1ecacw.7.c                                                                                                                                                                                                                                                                Nonreplayable hash  des\n                       md5_password        password                                                                                                                                                                                                                                                                     Password            \n                       md5_password        $1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/                                                                                                                                                                                                                                           Nonreplayable hash  md5\n                       bsdi_password       password                                                                                                                                                                                                                                                                     Password            \n                       bsdi_password       _J9..K0AyUubDrfOgO4s                                                                                                                                                                                                                                                         Nonreplayable hash  bsdi\n                       sha256_password     password                                                                                                                                                                                                                                                                     Password            \n                       sha256_password     $5$MnfsQ4iN$ZMTppKN16y/tIsUYs/obHlhdP.Os80yXhTurpBMUbA5                                                                                                                                                                                                                      Nonreplayable hash  sha256,crypt\n                       sha512_password     password                                                                                                                                                                                                                                                                     Password            \n                       sha512_password     $6$zWwwXKNj$gLAOoZCjcr8p/.VgV/FkGC3NX7BsXys3KHYePfuIGMNjY83dVxugPYlxVg/evpcVEJLT/rSwZcDMlVVf/bhf.1                                                                                                                                                                           Nonreplayable hash  sha512,crypt\n                       blowfish_password   password                                                                                                                                                                                                                                                                     Password            \n                       blowfish_password   $2a$05$bvIG6Nmid91Mu9RcmmWZfO5HJIMCT8riNW0hEp8f6/FuA2/mHZFpe                                                                                                                                                                                                                 Nonreplayable hash  bf\n                       lm_password         password                                                                                                                                                                                                                                                                     Password            \n                       lm_password         e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c                                                                                                                                                                                                            NTLM hash           nt,lm\n                       nt_password         password                                                                                                                                                                                                                                                                     Password            \n                       nt_password         aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c                                                                                                                                                                                                            NTLM hash           nt,lm\n                       mssql05_toto        toto                                                                                                                                                                                                                                                                         Password            \n                       mssql05_toto        0x01004086CEB6BF932BC4151A1AF1F13CD17301D70816A8886908                                                                                                                                                                                                                       Nonreplayable hash  mssql05\n                       mssql_foo           foo                                                                                                                                                                                                                                                                          Password            \n                       mssql_foo           FOO                                                                                                                                                                                                                                                                          Password            \n                       mssql_foo           0x0100A607BA7C54A24D17B565C59F1743776A10250F581D482DA8B6D6261460D3F53B279CC6913CE747006A2E3254                                                                                                                                                                               Nonreplayable hash  mssql\n                       mssql12_Password1!  Password1!                                                                                                                                                                                                                                                                   Password            \n                       mssql12_Password1!  0x0200F733058A07892C5CACE899768F89965F6BD1DED7955FE89E1C9A10E27849B0B213B5CE92CC9347ECCB34C3EFADAF2FD99BFFECD8D9150DD6AACB5D409A9D2652A4E0AF16                                                                                                                               Nonreplayable hash  mssql12\n                       mysql_probe         probe                                                                                                                                                                                                                                                                        Password            \n                       mysql_probe         445ff82636a7ba59                                                                                                                                                                                                                                                             Nonreplayable hash  mysql\n                       mysql-sha1_tere     tere                                                                                                                                                                                                                                                                         Password            \n                       mysql-sha1_tere     *5AD8F88516BD021DD43F171E2C785C69F8E54ADB                                                                                                                                                                                                                                    Nonreplayable hash  mysql-sha1\n                       simon               A                                                                                                                                                                                                                                                                            Password            \n                       simon               4F8BC1809CB2AF77                                                                                                                                                                                                                                                             Nonreplayable hash  des,oracle\n                       SYSTEM              THALES                                                                                                                                                                                                                                                                       Password            \n                       SYSTEM              9EEDFA0AD26C6D52                                                                                                                                                                                                                                                             Nonreplayable hash  des,oracle\n                       DEMO                epsilon                                                                                                                                                                                                                                                                      Password            \n                       DEMO                S:8F2D65FB5547B71C8DA3760F10960428CD307B1C6271691FC55C1F56554A;H:DC9894A01797D91D92ECA1DA66242209;T:23D1F8CAC9001F69630ED2DD8DF67DD3BE5C470B5EA97B622F757FE102D8BF14BEDC94A3CC046D10858D885DB656DC0CBF899A79CD8C76B788744844CADE54EEEB4FDEC478FB7C7CBFBBAC57BA3EF22C         Nonreplayable hash  raw-sha1,oracle\n                       oracle11_epsilon    epsilon                                                                                                                                                                                                                                                                      Password            \n                       oracle11_epsilon    S:8F2D65FB5547B71C8DA3760F10960428CD307B1C6271691FC55C1F56554A;H:DC9894A01797D91D92ECA1DA66242209;T:23D1F8CAC9001F69630ED2DD8DF67DD3BE5C470B5EA97B622F757FE102D8BF14BEDC94A3CC046D10858D885DB656DC0CBF899A79CD8C76B788744844CADE54EEEB4FDEC478FB7C7CBFBBAC57BA3EF22C         Nonreplayable hash  raw-sha1,oracle\n                       oracle12c_epsilon   epsilon                                                                                                                                                                                                                                                                      Password            \n                       oracle12c_epsilon   H:DC9894A01797D91D92ECA1DA66242209;T:E3243B98974159CC24FD2C9A8B30BA62E0E83B6CA2FC7C55177C3A7F82602E3BDD17CEB9B9091CF9DAD672B8BE961A9EAC4D344BDBA878EDC5DCB5899F689EBD8DD1BE3F67BFF9813A464382381AB36B                                                                        Nonreplayable hash  pbkdf2,oracle12c\n                       example             password                                                                                                                                                                                                                                                                     Password            \n                       example             md5be86a79bf2043622d58d5453c47d4860                                                                                                                                                                                                                                          Postgres md5        raw-md5,postgres</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"4a15f032-1787-539b-88e8-b580b6b8dd7c"}}}