{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/http/wordpress_content_injection","result":{"data":{"moduleMetadataJson":{"id":"8c33ca66-d133-56e2-8c86-f4474228334e","name":"WordPress REST API Content Injection","fullname":"auxiliary/scanner/http/wordpress_content_injection","description":"This module exploits a content injection vulnerability in WordPress\n        versions 4.7 and 4.7.1 via type juggling in the REST API.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/http/wordpress_content_injection","documentationSlug":"/modules/documentation/auxiliary/scanner/http/wordpress_content_injection","referencesSlug":"/modules/references/auxiliary/scanner/http/wordpress_content_injection"},"documentation":{"html":"<p><strong>Feature description:</strong></p>\n<p>This adds a module for the WordPress <a href=\"https://wordpress.org/wordpress-4.7.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">4.7</a>/<a href=\"https://wordpress.org/wordpress-4.7.1.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">4.7.1</a>\ncontent injection vulnerability detailed at\n<a href=\"https://blog.sucuri.net/2017/02/content-injection-vulnerability-wordpress-rest-api.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://blog.sucuri.net/2017/02/content-injection-vulnerability-wordpress-rest-api.html</a>.</p>\n<p><strong>Verification steps:</strong></p>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Download <a href=\"https://wordpress.org/wordpress-4.7.1.tar.gz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://wordpress.org/wordpress-4.7.1.tar.gz</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language-text\">tar xf wordpress-4.7.1.tar.gz -C /var/www/html --no-same-owner</code></li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Prevent auto-update with either:</p>\n<ol>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Ensure the install dir is not writable by the web user</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Add the following to <code class=\"language-text\">wp_config.php</code> (after install)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">define( &#39;WP_AUTO_UPDATE_CORE&#39;, false );\ndefine( &#39;AUTOMATIC_UPDATER_DISABLED&#39;, true );</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n</ol>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Install Wordpress</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Start <code class=\"language-text\">msfconsole</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language-text\">use auxiliary/scanner/http/wordpress_content_injection</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">rhost</code>, <code class=\"language-text\">rport</code> and <code class=\"language-text\">TARGETURI</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">ACTION</code> to either <code class=\"language-text\">LIST</code> or <code class=\"language-text\">UPDATE</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Set <code class=\"language-text\">POST_ID</code> and <code class=\"language-text\">POST_TITLE</code>, <code class=\"language-text\">POST_CONTENT</code>, and/or <code class=\"language-text\">POST_PASSWORD</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Run the module</li>\n</ul>\n<p><strong>Sample run:</strong></p>\n<p>This is just the <code class=\"language-text\">LIST</code> action...</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(wordpress_content_injection) &gt; run\n\n[*] REST API found in HTML document\nPosts at https://[redacted]:443/ (REST API: /wp-json/wp/v2)\n============================================================\n\nID  Title         URL                                        Password\n--  -----         ---                                        --------\n1   Hello world!  https://[redacted]/2016/10/hello-world/    No\n87  Hello world!  https://[redacted]/2016/08/hello-world-2/  No\n\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(wordpress_content_injection) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8c33ca66-d133-56e2-8c86-f4474228334e"}}}