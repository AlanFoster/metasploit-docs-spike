{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/ssh/ssh_enumusers","result":{"data":{"moduleMetadataJson":{"id":"135c689c-61aa-511b-bd92-b96c43a9659d","name":"SSH Username Enumeration","fullname":"auxiliary/scanner/ssh/ssh_enumusers","description":"This module uses a malformed packet or timing attack to enumerate users on\n        an OpenSSH server.\n\n        The default action sends a malformed (corrupted) SSH_MSG_USERAUTH_REQUEST\n        packet using public key authentication (must be enabled) to enumerate users.\n\n        On some versions of OpenSSH under some configurations, OpenSSH will return a\n        \"permission denied\" error for an invalid user faster than for a valid user,\n        creating an opportunity for a timing attack to enumerate users.\n\n        Testing note: invalid users were logged, while valid users were not. YMMV.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/ssh/ssh_enumusers","documentationSlug":"/modules/documentation/auxiliary/scanner/ssh/ssh_enumusers","referencesSlug":"/modules/references/auxiliary/scanner/ssh/ssh_enumusers"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module uses a malformed packet or timing attack to enumerate users on\nan OpenSSH server.</p>\n<p>Testing note: invalid users were logged, while valid users were not. YMMV.</p>\n<h2 id=\"actions\" style=\"position:relative;\"><a href=\"#actions\" aria-label=\"actions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Actions</h2>\n<p><strong>Malformed Packet</strong></p>\n<p>The default action sends a malformed (corrupted) <code class=\"language-text\">SSH_MSG_USERAUTH_REQUEST</code>\npacket using public key authentication (must be enabled) to enumerate users.</p>\n<p><strong>Timing Attack</strong></p>\n<p>On some versions of OpenSSH under some configurations, OpenSSH will return a\n\"permission denied\" error for an invalid user faster than for a valid user,\ncreating an opportunity for a timing attack to enumerate users.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>USERNAME</strong></p>\n<p>Single username to test (username spray).</p>\n<p><strong>USER_FILE</strong></p>\n<p>File containing usernames, one per line.</p>\n<p><strong>THRESHOLD</strong></p>\n<p>Amount of seconds needed before a user is considered found (timing attack only).</p>\n<p><strong>CHECK_FALSE</strong></p>\n<p>Check for false positives (random username).</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/scanner/ssh/ssh_enumusers\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; set rhosts [redacted]\nrhosts =&gt; [redacted]\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; echo $&#39;wvu\\nbcook&#39; &gt; users\n[*] exec: echo $&#39;wvu\\nbcook&#39; &gt; users\n\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; set user_file users\nuser_file =&gt; users\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; set verbose true\nverbose =&gt; true\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; run\n\n[*] [redacted]:22 - SSH - Using malformed packet technique\n[*] [redacted]:22 - SSH - Starting scan\n[+] [redacted]:22 - SSH - User &#39;wvu&#39; found\n[-] [redacted]:22 - SSH - User &#39;bcook&#39; not found\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; set action Timing Attack\naction =&gt; Timing Attack\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; run\n\n[*] [redacted]:22 - SSH - Using timing attack technique\n[*] [redacted]:22 - SSH - Starting scan\n[+] [redacted]:22 - SSH - User &#39;wvu&#39; found\n[-] [redacted]:22 - SSH - User &#39;bcook&#39; not found\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt; creds\nCredentials\n===========\n\nhost         origin       service       public  private  realm  private_type\n----         ------       -------       ------  -------  -----  ------------\n[redacted]   [redacted]   22/tcp (ssh)  wvu\n\nmsf5 auxiliary(scanner/ssh/ssh_enumusers) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"135c689c-61aa-511b-bd92-b96c43a9659d"}}}