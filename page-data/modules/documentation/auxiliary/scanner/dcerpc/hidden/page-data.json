{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/dcerpc/hidden","result":{"data":{"moduleMetadataJson":{"id":"1adc4b5e-2bbc-53f9-9b94-df493e5a5be1","name":"Hidden DCERPC Service Discovery","fullname":"auxiliary/scanner/dcerpc/hidden","description":"This module will query the endpoint mapper and make a list\n      of all ncacn_tcp RPC services. It will then connect to each of\n      these services and use the management API to list all other\n      RPC services accessible on this port. Any RPC service found attached\n      to a TCP port, but not listed in the endpoint mapper, will be displayed\n      and analyzed to see whether anonymous access is permitted.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/dcerpc/hidden","documentationSlug":"/modules/documentation/auxiliary/scanner/dcerpc/hidden"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>The hidden scanner connects to a given range of IP addresses and tries to locate any RPC services that are not listed in the Endpoint Mapper and determines if anonymous access to the service is allowed.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/dcerpc/hidden</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS [IP]</code></li>\n<li>Do: <code class=\"language-text\">set THREADS [number of threads]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/dcerpc/hidden\nmsf auxiliary(hidden) &gt; set RHOSTS 192.168.1.200-254\nRHOSTS =&gt; 192.168.1.200-254\nmsf auxiliary(hidden) &gt; set THREADS 55\nTHREADS =&gt; 55\nmsf auxiliary(hidden) &gt; run\n\n[*] Connecting to the endpoint mapper service...\n[*] Connecting to the endpoint mapper service...\n[*] Connecting to the endpoint mapper service...\n...snip...\n[*] Connecting to the endpoint mapper service...\n[*] Connecting to the endpoint mapper service...\n[*] Could not obtain the endpoint list: DCERPC FAULT =&gt; nca_s_fault_access_denied\n[*] Could not contact the endpoint mapper on 192.168.1.203\n[*] Could not obtain the endpoint list: DCERPC FAULT =&gt; nca_s_fault_access_denied\n[*] Could not contact the endpoint mapper on 192.168.1.201\n[*] Could not connect to the endpoint mapper service\n[*] Could not contact the endpoint mapper on 192.168.1.250\n[*] Looking for services on 192.168.1.204:1025...\n[*] \tHIDDEN: UUID 12345778-1234-abcd-ef00-0123456789ab v0.0\n[*] Looking for services on 192.168.1.202:49152...\n[*] \t\tCONN BIND CALL ERROR=DCERPC FAULT =&gt; nca_s_fault_ndr \n[*] \n[*] \tHIDDEN: UUID c681d488-d850-11d0-8c52-00c04fd90f7e v1.0\n[*] \t\tCONN BIND CALL ERROR=DCERPC FAULT =&gt; nca_s_fault_ndr \n[*] \n[*] \tHIDDEN: UUID 11220835-5b26-4d94-ae86-c3e475a809de v1.0\n[*] \t\tCONN BIND ERROR=DCERPC FAULT =&gt; nca_s_fault_access_denied \n[*] \n[*] \tHIDDEN: UUID 5cbe92cb-f4be-45c9-9fc9-33e73e557b20 v1.0\n[*] \t\tCONN BIND ERROR=DCERPC FAULT =&gt; nca_s_fault_access_denied \n[*] \n[*] \tHIDDEN: UUID 3919286a-b10c-11d0-9ba8-00c04fd92ef5 v0.0\n[*] \t\tCONN BIND CALL DATA=0000000057000000 \n[*] \n[*] \tHIDDEN: UUID 1cbcad78-df0b-4934-b558-87839ea501c9 v0.0\n[*] \t\tCONN BIND ERROR=DCERPC FAULT =&gt; nca_s_fault_access_denied \n[*] \n[*] \tHIDDEN: UUID c9378ff1-16f7-11d0-a0b2-00aa0061426a v1.0\n[*] \t\tCONN BIND ERROR=DCERPC FAULT =&gt; nca_s_fault_access_denied \n[*] \n[*] Remote Management Interface Error: The connection timed out (192.168.1.202:49152).\n...snip...\n[*] Scanned 55 of 55 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(hidden) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"1adc4b5e-2bbc-53f9-9b94-df493e5a5be1"}}}