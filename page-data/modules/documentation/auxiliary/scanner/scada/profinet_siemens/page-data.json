{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/scada/profinet_siemens","result":{"data":{"moduleMetadataJson":{"id":"c2015110-0876-54b5-8458-3b380e8c4e11","name":"Siemens Profinet Scanner","fullname":"auxiliary/scanner/scada/profinet_siemens","description":"This module will use Layer2 packets, known as Profinet Discovery packets,\n        to detect all Siemens (and sometimes other) devices on a network.\n        It is perfectly SCADA-safe, as there will only be ONE single packet sent out.\n        Devices will respond with their IP configuration and hostnames.\n        Created by XiaK Industrial Security Research Center (www[dot]xiak[dot]be))","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/scada/profinet_siemens","documentationSlug":"/modules/documentation/auxiliary/scanner/scada/profinet_siemens"},"documentation":{"html":"<p>Siemens Industrial controllers and most other industrial OEMs\nuse a proprietary protocol to discover their devices accross a network.\nIn the case of Siemens this is called the Profinet Discover Protocol.\nKnown in Wireshark as PN_DCP</p>\n<p>It works purely on Layer 2 (Ethernet addresses) and sends out a single\nmulticast packet (making it safe to use in sensitive networks).\nEach profinet enabled responds with an array of information:</p>\n<ul>\n<li>Its IP address, Subnetmask and Gateway</li>\n<li>Its Profinet Devicename ('Station Name')</li>\n<li>The Type of station</li>\n<li>A Vendor ID (e.g. '002a'), signifing the vendor (e.g. 'Siemens')</li>\n<li>A Device Role (e.g. '01'), signifing the type of device (e.g. 'IO-Controller')</li>\n<li>A Device ID (e.g. '010d'), signifing the device type (e.g. 'S7-1200')</li>\n</ul>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This is a hardware choice of design, and as such CANNOT be changed without\nloss of compatibility.\nPossible mitigations include: pulling the plug (literally), using network isolation\n(Firewall, Router, IDS, IPS, network segmentation, etc...) or not allowing bad\npeople on your network.</p>\n<p>Most, if not all, PLC's (computers that control engines, robots, conveyor\nbelts, sensors, camera's, doorlocks, CRACs ...) have vulnerabilities where,\nusing their own tools, remote configuration and programming can be done\n<em>WITHOUT</em> authentication.  Investigators and underground hackers are just now\ncreating simple tools to convert the, often proprietary, protocols into simple\nscripts.  The operating word here is \"proprietary\". Right now, the only thing\nstopping very bad stuff from happening. </p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>The following demonstrates a basic scenario, we \"detect\" two devices:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; search profinet\nmsf &gt; use auxiliary/scanner/scada/profinet_siemens\nmsf auxiliary(profinet_siemens) &gt; run\n\n[*] Sending packet out to eth0\n[+] Parsing packet from 00:0e:8c:cf:7b:1a\nType of station: ET200S CPU\nName of station: pn-io-1\nVendor and Device Type: Siemens, ET200S\nDevice Role: IO-Controller\nIP, Subnetmask and Gateway are: 172.16.108.11, 255.255.0.0, 172.16.108.11\n\n[+] Parsing packet from 00:50:56:b6:fe:b6\nType of station: SIMATIC-PC\nName of station: nm\nVendor and Device Type: Siemens, PC Simulator\nDevice Role: IO-Controller\nIP, Subnetmask and Gateway are: 172.16.30.102, 255.255.0.0, 172.16.0.1\n\n[+] I found 2 devices for you!\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(profinet_siemens) &gt; show options\n\nModule options (auxiliary/scanner/scada/profinet_siemens):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   INTERFACE  eth0             yes       Set an interface\n   TIMEOUT    2                yes       Seconds to wait, set longer on slower networks</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>By default, the module uses interface 'eth0', there is a check to see if it is live.</p>\n<p>The module will send out an ethernet packet and wait for responses.\nBy default, it will wait 2 seconds for any responses, this is long enough for most networks.\nIncrease this on larger and/or slower networks, it just increases the wait time.</p>"}}},"pageContext":{"id":"c2015110-0876-54b5-8458-3b380e8c4e11"}}}