{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/scada/moxa_discover","result":{"data":{"moduleMetadataJson":{"id":"f324fe9d-9110-578f-97db-f443a8d80d67","name":"Moxa UDP Device Discovery","fullname":"auxiliary/scanner/scada/moxa_discover","description":"The Moxa protocol listens on 4800/UDP and will respond to broadcast\n          or direct traffic.  The service is known to be used on Moxa devices\n          in the NPort, OnCell, and MGate product lines.\n\n          A discovery packet compels a Moxa device to respond to the sender\n          with some basic device information that is needed for more advanced\n          functions.  The discovery data is 8 bytes in length and is the most\n          basic example of the Moxa protocol.  It may be sent out as a\n          broadcast (destination 255.255.255.255) or to an individual device.\n\n          Devices that respond to this query may be vulnerable to serious\n          information disclosure vulnerabilities, such as CVE-2016-9361.\n\n          The module is the work of Patrick DeSantis of Cisco Talos and is\n          derived from original work by K. Reid Wightman. Tested and validated\n          on a Moxa NPort 6250 with firmware versions 1.13 and 1.15.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/scada/moxa_discover","documentationSlug":"/modules/documentation/auxiliary/scanner/scada/moxa_discover"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The Moxa protocol listens on 4800/UDP and will respond to broadcast\nor direct traffic.  The service is known to be used on Moxa devices\nin the NPort, OnCell, and MGate product lines.</p>\n<p>  A discovery packet compels a Moxa device to respond to the sender\nwith some basic device information that is needed for more advanced\nfunctions.  The discovery data is 8 bytes in length and is the most\nbasic example of the Moxa protocol.  It may be sent out as a\nbroadcast (destination 255.255.255.255) or to an individual device.</p>\n<p>  Devices that respond to this query may be vulnerable to serious\ninformation disclosure vulnerabilities, such as CVE-2016-9361.</p>\n<p>  The module is the work of Patrick DeSantis of Cisco Talos and is\nderived from original work by K. Reid Wightman. Tested and validated\non a Moxa NPort 6250 with firmware versions 1.13 and 1.15.</p>\n<p>  The discovery request contains the bytes:</p>\n<p>  <code class=\"language-text\">\\x01\\x00\\x00\\x08\\x00\\x00\\x00\\x00</code></p>\n<p>  Where the function code (first byte) 0x01 is Moxa discovery/identify\nand the fourth byte is the length of the full data payload.</p>\n<p>  The first byte of a response will always be the func code + 0x80\n(the most significant bit of the byte is set to 1, so 0b00000001\nbecomes 0b10000001, or 0x81).</p>\n<p>  A valid response is 24 bytes, starts with 0x81, and contains the values\n0x00, 0x90, 0xe8 (the Moxa OIU) in bytes 14, 15, and 16.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/scada/moxa_discover</code></li>\n<li>Do: <code class=\"language-text\">set RHOSTS</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>Devices running the Moxa service should respond</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>RHOSTS</strong></p>\n<p>  Target(s) to scan; can be single target, a range, or broadcast.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; hosts\n\nHosts\n=====\n\nmsf &gt; use auxiliary/scanner/scada/moxa_discover\nmsf auxiliary(moxa_discover) &gt; set RHOSTS 192.168.127.254\nRHOSTS =&gt; 192.168.127.254\nmsf auxiliary(moxa_discover) &gt; show options\n\nModule options (auxiliary/scanner/scada/moxa_discover):\n\n  Name       Current Setting  Required  Description\n  ----       ---------------  --------  -----------\n  BATCHSIZE  256              yes       The number of hosts to probe in each set\n  RHOSTS     192.168.127.254  yes       The target address range or CIDR identifier\n  RPORT      4800             yes       The target port (UDP)\n  THREADS    10               yes       The number of concurrent threads\n\nmsf auxiliary(moxa_discover) &gt; run\n\n[+] 192.168.127.254:4800 Moxa Device Found!\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(moxa_discover) &gt; hosts\n\nHosts\n=====\n\naddress          mac  name  os_name  os_flavor  os_sp  purpose  info         comments\n-------          ---  ----  -------  ---------  -----  -------  ----         --------\n192.168.127.254             Unknown                    device   Moxa Device\n\nmsf auxiliary(moxa_discover) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"f324fe9d-9110-578f-97db-f443a8d80d67"}}}