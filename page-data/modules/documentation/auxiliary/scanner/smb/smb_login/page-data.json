{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/smb/smb_login","result":{"data":{"moduleMetadataJson":{"id":"25a0acb7-adf3-5703-a177-7c6802f77c6b","name":"SMB Login Check Scanner","fullname":"auxiliary/scanner/smb/smb_login","description":"This module will test a SMB login on a range of machines and\n        report successful logins.  If you have loaded a database plugin\n        and connected to a database this module will record successful\n        logins and hosts so you can track your access.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/smb/smb_login","documentationSlug":"/modules/documentation/auxiliary/scanner/smb/smb_login"},"documentation":{"html":"<p>The smb_login module is used to bruteforce SMB remotely. SMB credentials are extra valuable because they are system credentials, and you can probably reuse some of them to log in to more machines.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>To use smb_login, make sure you are able to connect to a SMB service that supports SMBv1.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<p>The following demonstrates a basic scenario of using the <a href=\"https://github.com/rapid7/metasploit-framework/tree/master/data/wordlists\">built-in wordlists</a> to brute-force SMB:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/smb/smb_login \nmsf auxiliary(smb_login) &gt; set RHOSTS 192.168.1.80\nRHOSTS =&gt; 192.168.1.80\nmsf auxiliary(smb_login) &gt; set USER_FILE /Users/wchen/rapid7/msf/data/wordlists/unix_users.txt\nUSER_FILE =&gt; /Users/wchen/rapid7/msf/data/wordlists/unix_users.txt\nmsf auxiliary(smb_login) &gt; set PASS_FILE /Users/wchen/rapid7/msf/data/wordlists/unix_passwords.txt\nPASS_FILE =&gt; /Users/wchen/rapid7/msf/data/wordlists/unix_passwords.txt\nmsf auxiliary(smb_login) &gt; run\n\n[+] 192.168.1.80:445      - 192.168.1.80:445 SMB - Success: &#39;.\\root:monkey&#39; Administrator\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf auxiliary(smb_login) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you have a database connected, you should also see this credential logged:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(smb_login) &gt; creds\nCredentials\n===========\n\nhost          origin        service        public  private  realm  private_type\n----          ------        -------        ------  -------  -----  ------------\n192.168.1.80  192.168.1.80  445/tcp (smb)  root    monkey          Password\n\nmsf auxiliary(smb_login) </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>By default, the smb_login module only requires the RHOSTS option to run. But in reality, you will\nalso need to supply user names and passwords. The following options are available to support\ndifferent credential formats:</p>\n<p><strong>The USER_FILE option</strong></p>\n<p>If you happen to manage all the found user names in a separate file, then this option would be\nsuitable for that. One per line.</p>\n<p>An example of setting USER_FILE:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set USER_FILE [path to file]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The PASS_FILE option</strong></p>\n<p>If you happen to manage all the found passwords in a separate file, then this option would be\nsuitable for that. One per line.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set PASS_FILE [path to file]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The USERPASS_FILE option</strong></p>\n<p>If each user should be using a specific password in your file, then you can use this option. One\nusername/password per line:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set USERPASS_FILE [path to file]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The DB<em>ALL</em>CREDS option</strong></p>\n<p>This option allows you to reuse all the user names and passwords collected by the database:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set DB_ALL_CREDS true</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The DB<em>ALL</em>PASS option</strong></p>\n<p>This option allows you to reuse all the passwords collected by the database.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set DB_ALL_PASS true</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The DB<em>ALL</em>USERS option</strong></p>\n<p>This option allows you to reuse all the user names collected by the database.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set DB_ALL_USERS true</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The SMBUser option</strong></p>\n<p>If you are testing a specific user, use this option.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set SMBUser [user name]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>The SMBPass option</strong></p>\n<p>If you are testing a specific password, use this option.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set SMBPass [password]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Note: If an account has been successfully brute-forced, that account will not be tried again.</p>\n<p>Additionally, if you wish to disable automatic detection of all-access systems, you can change the following option:</p>\n<p><strong>The DETECT<em>ANY</em>AUTH option</strong></p>\n<p>This option enables detection of systems accepting any authentication. A bogus login will be attempted.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set DETECT_ANY_AUTH false</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>"}}},"pageContext":{"id":"25a0acb7-adf3-5703-a177-7c6802f77c6b"}}}