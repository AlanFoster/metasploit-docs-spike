{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/nfs/nfsmount","result":{"data":{"moduleMetadataJson":{"id":"45a35341-3e6f-59e7-971c-379d8f502404","name":"NFS Mount Scanner","fullname":"auxiliary/scanner/nfs/nfsmount","description":"This module scans NFS mounts and their permissions.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/nfs/nfsmount","documentationSlug":"/modules/documentation/auxiliary/scanner/nfs/nfsmount","referencesSlug":"/modules/references/auxiliary/scanner/nfs/nfsmount"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>NFS is very common, and this scanner searches for a mis-configuration, not a vulnerable software version.  Installation instructions for NFS can be found for every operating system.\nThe <a href=\"https://help.ubuntu.com/14.04/serverguide/network-file-system.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ubuntu 14.04</a> instructions can be used as an example for installing and configuring NFS.  The\nfollowing was done on Kali linux:</p>\n<ol>\n<li><code class=\"language-text\">apt-get install nfs-kernel-server</code></li>\n<li>\n<p>Create 2 folders to share:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">mkdir /tmp/open_share\nmkdir /tmp/closed_share</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Add them to the list of shares:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">echo &quot;/tmp/closed_share  10.1.2.3(ro,sync,no_root_squash)&quot; &gt;&gt; /etc/exports\necho &quot;/tmp/open_share    *(rw,sync,no_root_squash)&quot; &gt;&gt; /etc/exports</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n<li>Restart the service: <code class=\"language-text\">service nfs-kernel-server restart</code></li>\n</ol>\n<p>In this scenario, <code class=\"language-text\">closed_share</code> is set to read only, and only mountable by the IP 10.1.2.3.  <code class=\"language-text\">open_share</code> is mountable by anyone (<code class=\"language-text\">*</code>) in read/write mode.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install and configure NFS</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/nfs/nfsmount</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>  A run against the configuration from these docs</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  msf &gt; use auxiliary/scanner/nfs/nfsmount\n  msf auxiliary(nfsmount) &gt; set rhosts 127.0.0.1\n  rhosts =&gt; 127.0.0.1\n  msf auxiliary(nfsmount) &gt; run\n  \n  [+] 127.0.0.1:111         - 127.0.0.1 NFS Export: /tmp/open_share [*]\n  [+] 127.0.0.1:111         - 127.0.0.1 NFS Export: /tmp/closed_share [10.1.2.3]\n  [*] Scanned 1 of 1 hosts (100% complete)\n  [*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>  Another example can be found at this <a href=\"http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  [*] Scanned  24 of 240 hosts (10% complete)\n  [+] 10.10.xx.xx NFS Export: /data/iso [0.0.0.0/0.0.0.0]\n  [*] Scanned  48 of 240 hosts (20% complete)\n  [+] 10.10.xx.xx NFS Export: /DataVolume/Public [*]\n  [+] 10.10.xx.xx NFS Export: /DataVolume/Download [*]\n  [+] 10.10.xx.xx NFS Export: /DataVolume/Softshare [*]\n  [*] Scanned  72 of 240 hosts (30% complete)\n  [+] 10.10.xx.xx NFS Export: /var/ftp/pub [10.0.0.0/255.255.255.0]\n  [*] Scanned  96 of 240 hosts (40% complete)\n  [+] 10.10.xx.xx NFS Export: /common []</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"confirming\" style=\"position:relative;\"><a href=\"#confirming\" aria-label=\"confirming permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Confirming</h2>\n<p>Since NFS has been around since 1989, with modern NFS(v4) being released in 2000, there are many tools which can also be used to verify this configuration issue.\nThe following are other industry tools which can also be used.</p>\n<h3 id=\"nmap\" style=\"position:relative;\"><a href=\"#nmap\" aria-label=\"nmap permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://nmap.org/nsedoc/scripts/nfs-showmount.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nmap</a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">nmap -p 111 --script=nfs-showmount 127.0.0.1\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2017-02-12 19:41 EST\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.000037s latency).\nPORT    STATE SERVICE\n111/tcp open  rpcbind\n| nfs-showmount: \n|   /tmp/open_share *\n|_  /tmp/closed_share 10.1.2.3\n\nNmap done: 1 IP address (1 host up) scanned in 0.32 seconds</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"showmount\" style=\"position:relative;\"><a href=\"#showmount\" aria-label=\"showmount permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://packages.debian.org/sid/amd64/nfs-common/filelist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">showmount</a></h3>\n<p>showmount is a part of the <code class=\"language-text\">nfs-common</code> package for debian.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">showmount -e 127.0.0.1\nExport list for 127.0.0.1:\n/tmp/open_share   *\n/tmp/closed_share 10.1.2.3</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"exploitation\" style=\"position:relative;\"><a href=\"#exploitation\" aria-label=\"exploitation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploitation</h2>\n<p>Exploiting this mis-configuration is trivial, however exploitation doesn't necessarily give access (command execution) to the system.\nIf a share is mountable, ie you either are the IP listed in the filter (or could assume it through a DoS), or it is open (*), mounting is trivial.\nThe following instructions were written for Kali linux.</p>\n<ol>\n<li>Create a new directory to mount the remote volume to: <code class=\"language-text\">mkdir /mnt/remote</code></li>\n<li>Use <code class=\"language-text\">mount</code> to link the remote volume to the local folder: <code class=\"language-text\">mount -t nfs 127.0.0.1:/tmp/open_share /mnt/remote</code></li>\n</ol>\n<p>The mount and its writability can now be tested:</p>\n<ol>\n<li>Write a file:  <code class=\"language-text\">echo &quot;hello&quot; &gt; /mnt/remote/test</code></li>\n<li>\n<p>The remote end now has the file locally:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">cat /tmp/open_share/test \nhello</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n<li>To unmount: <code class=\"language-text\">umount /mnt/remote</code></li>\n</ol>\n<p>At this point, its time to hope for a file of value.  Maybe code with hardcoded credentials, a <code class=\"language-text\">passwords.txt</code>, or an <code class=\"language-text\">id_rsa</code>.</p>"}}},"pageContext":{"id":"45a35341-3e6f-59e7-971c-379d8f502404"}}}