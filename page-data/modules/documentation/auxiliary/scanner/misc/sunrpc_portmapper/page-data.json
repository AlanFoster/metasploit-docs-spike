{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/misc/sunrpc_portmapper","result":{"data":{"moduleMetadataJson":{"id":"fed81b8d-946f-5c2e-ab67-24e52fce9676","name":"SunRPC Portmap Program Enumerator","fullname":"auxiliary/scanner/misc/sunrpc_portmapper","description":"This module calls the target portmap service and enumerates all program\n        entries and their running port numbers.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/misc/sunrpc_portmapper","documentationSlug":"/modules/documentation/auxiliary/scanner/misc/sunrpc_portmapper","referencesSlug":"/modules/references/auxiliary/scanner/misc/sunrpc_portmapper"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>RPC Portmapper, or more recently renamed to rpcbind, is fairly common and this scanner searches for its existance.  The idea behind rpcbind was to create a\n'directory' that could be asked where a service is running (port).  Having this single port/service be queryable meant, the services being managed by rpcbind\ncould actually be running on any port or protocol, and rpdbind would be in charge of letting clients know where they were. This is more or less an outdated\nmodel/service, and NFS is arguably the most popular service still utilizing rpcbind.  The following was done on Kali linux:</p>\n<ol>\n<li>Install rpcbind: <code class=\"language-text\">apt-get install rpcbind</code></li>\n<li>\n<p>Now now have <code class=\"language-text\">rpcbind</code>, but this gives us minimal services running on it.  You may want to install additional:</p>\n<ul>\n<li>\n<p>NIS: <code class=\"language-text\">apt-get install nis</code></p>\n<ul>\n<li>Start the service: <code class=\"language-text\">ypserv</code></li>\n</ul>\n</li>\n<li>NFS: <code class=\"language-text\">apt-get install nfs-kernel-server</code></li>\n</ul>\n</li>\n<li>Just to be safe, restart rpcbind: <code class=\"language-text\">service rpcbind restart</code></li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install and configure rpcbind</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/misc/sunrpc_portmapper</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>  A run against the configuration from these docs</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  msf &gt; use auxiliary/scanner/misc/sunrpc_portmapper\n  msf auxiliary(sunrpc_portmapper) &gt; set rhosts 127.0.0.1\n  rhosts =&gt; 127.0.0.1\n  msf auxiliary(sunrpc_portmapper) &gt; run\n  \n  [+] 127.0.0.1:111         - SunRPC Programs for 127.0.0.1\n  =============================\n  \n   Name      Number  Version  Port   Protocol\n   ----      ------  -------  ----   --------\n   mountd    100005  1        60153  udp\n   mountd    100005  1        39027  tcp\n   mountd    100005  2        47725  udp\n   mountd    100005  2        53055  tcp\n   mountd    100005  3        49015  udp\n   mountd    100005  3        47033  tcp\n   nfs       100003  3        2049   tcp\n   nfs       100003  4        2049   tcp\n   nfs       100003  3        2049   udp\n   nfs       100003  4        2049   udp\n   nfs_acl   100227  3        2049   tcp\n   nfs_acl   100227  3        2049   udp\n   nlockmgr  100021  1        40970  udp\n   nlockmgr  100021  3        40970  udp\n   nlockmgr  100021  4        40970  udp\n   nlockmgr  100021  1        42279  tcp\n   nlockmgr  100021  3        42279  tcp\n   nlockmgr  100021  4        42279  tcp\n   rpcbind   100000  4        111    tcp\n   rpcbind   100000  3        111    tcp\n   rpcbind   100000  2        111    tcp\n   rpcbind   100000  4        111    udp\n   rpcbind   100000  3        111    udp\n   rpcbind   100000  2        111    udp\n   ypserv    100004  2        707    udp\n   ypserv    100004  1        707    udp\n   ypserv    100004  2        708    tcp\n   ypserv    100004  1        708    tcp\n  \n  [*] Scanned 1 of 1 hosts (100% complete)\n  [*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"confirming\" style=\"position:relative;\"><a href=\"#confirming\" aria-label=\"confirming permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Confirming</h2>\n<p>Since rpc port mapper has been around since 1995, there are many tools which can also query it.\nThe following are other industry tools which can also be used.</p>\n<h3 id=\"nmap\" style=\"position:relative;\"><a href=\"#nmap\" aria-label=\"nmap permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://nmap.org/nsedoc/scripts/rpcinfo.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nmap</a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">nmap -p 111 --script=rpcinfo 127.0.0.1\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2017-02-13 22:57 EST\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.000043s latency).\nPORT    STATE SERVICE\n111/tcp open  rpcbind\n| rpcinfo: \n|   program version   port/proto  service\n|   100000  2,3,4        111/tcp  rpcbind\n|   100000  2,3,4        111/udp  rpcbind\n|   100003  3,4         2049/tcp  nfs\n|   100003  3,4         2049/udp  nfs\n|   100004  1,2          707/udp  ypserv\n|   100004  1,2          708/tcp  ypserv\n|   100005  1,2,3      47033/tcp  mountd\n|   100005  1,2,3      49015/udp  mountd\n|   100021  1,3,4      40970/udp  nlockmgr\n|   100021  1,3,4      42279/tcp  nlockmgr\n|   100227  3           2049/tcp  nfs_acl\n|_  100227  3           2049/udp  nfs_acl</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"rpcinfo\" style=\"position:relative;\"><a href=\"#rpcinfo\" aria-label=\"rpcinfo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>rpcinfo</h3>\n<p>This is the standard package included with rpcbind to query the rpc interface.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">rpcinfo -p 127.0.0.1\n   program vers proto   port  service\n    100000    4   tcp    111  portmapper\n    100000    3   tcp    111  portmapper\n    100000    2   tcp    111  portmapper\n    100000    4   udp    111  portmapper\n    100000    3   udp    111  portmapper\n    100000    2   udp    111  portmapper\n    100005    1   udp  60153  mountd\n    100005    1   tcp  39027  mountd\n    100005    2   udp  47725  mountd\n    100005    2   tcp  53055  mountd\n    100005    3   udp  49015  mountd\n    100005    3   tcp  47033  mountd\n    100003    3   tcp   2049  nfs\n    100003    4   tcp   2049  nfs\n    100227    3   tcp   2049\n    100003    3   udp   2049  nfs\n    100003    4   udp   2049  nfs\n    100227    3   udp   2049\n    100021    1   udp  40970  nlockmgr\n    100021    3   udp  40970  nlockmgr\n    100021    4   udp  40970  nlockmgr\n    100021    1   tcp  42279  nlockmgr\n    100021    3   tcp  42279  nlockmgr\n    100021    4   tcp  42279  nlockmgr\n    100004    2   udp    707  ypserv\n    100004    1   udp    707  ypserv\n    100004    2   tcp    708  ypserv\n    100004    1   tcp    708  ypserv</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"fed81b8d-946f-5c2e-ab67-24e52fce9676"}}}