{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/gopher/gopher_gophermap","result":{"data":{"moduleMetadataJson":{"id":"e3481ec1-42af-5b94-860b-68a497f6ded8","name":"Gopher gophermap Scanner","fullname":"auxiliary/scanner/gopher/gopher_gophermap","description":"This module identifies Gopher servers, and processes the gophermap\n        file which lists all the files on the server.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/gopher/gopher_gophermap","documentationSlug":"/modules/documentation/auxiliary/scanner/gopher/gopher_gophermap"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Any gopher server will work.  There seems to only be <a href=\"https://en.wikipedia.org/wiki/Gopher_(protocol)#Server_software\">a few left</a>\nin 2017.</p>\n<p>  A few options for local installation and testing are below.</p>\n<h3 id=\"docker-install\" style=\"position:relative;\"><a href=\"#docker-install\" aria-label=\"docker install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker Install</h3>\n<p>A <a href=\"https://hub.docker.com/r/prodhe/gopher/\">dockerized gopher server written in Go</a> is available.  To install and run this, with content being\nserved out of a temporary directory in which you'll be left:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$  docker pull prodhe/gopher\nUsing default tag: latest\nlatest: Pulling from prodhe/gopher\n627beaf3eaaf: Already exists\n8800e3417eb1: Pull complete\nd9f3bcdad0eb: Pull complete\nc018073abd26: Pull complete\nb2855f535c50: Pull complete\n23480a2f73d8: Pull complete\n1555a5435ec5: Pull complete\n0728d289e0fc: Pull complete\n6f6f265b58ee: Pull complete\nDigest: sha256:69931d56946d192d9bd155a88b6f365cb276e9edf453129d374e64d244d1edaa\nStatus: Downloaded newer image for prodhe/gopher:latest\n$  cd `mktemp -d`;\n$  sudo docker run --rm -d -it --name gopher_test -v `pwd -P`:/public  -p 70:70  prodhe/gopher\n2017/10/20 16:45:01 Serving /public/ at localhost:70\n$ date &gt; test.txt\n$ echo HELLO &gt; README.md</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><em>NOTE</em>: Don't forget to <code class=\"language-text\">docker stop</code> the container ID returned from the <code class=\"language-text\">docker run</code> command just run above:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ docker stop X\nX</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3 id=\"ubuntu-1604-install\" style=\"position:relative;\"><a href=\"#ubuntu-1604-install\" aria-label=\"ubuntu 1604 install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16.04 Install</h3>\n<p>First we need to install the server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">sudo apt-get install gopher-server</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Next, we need to build content for the scanner to find.  Gopher works off of a <code class=\"language-text\">gophermap</code>, somewhat similar\nto a content index page, where files are listed in a menu type system.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">echo &quot;&lt;html&gt;&lt;h1&gt;hello world&lt;/h1&gt;&lt;/html&gt;&quot; | sudo tee /var/gopher/example.html\necho &quot;foobarbaz&quot; | sudo tee /var/gopher/foobar.txt\nsudo mkdir /var/gopher/msf\necho &quot;meterpreter rules&quot; | sudo tee /var/gopher/msf/meterp.txt\nsudo wget &quot;https://pbs.twimg.com/profile_images/580131056629735424/2ENTk2K2.png&quot; -O /var/gopher/msf/logo.png\n\necho -ne &quot;gopher custom gophermap\\n\\nhHello World\\t/example.html\\t1.1.1.1\\t70\\n0Foo File\\t/foobar.txt\\t1.1.1.1\\t70\\n1msf\\t/msf\\t1.1.1.1\\t70\\nhmetasploit homepage\\tURL:http://metasploit.com/\\n&quot; | sudo tee /var/gopher/gophermap\nsudo chmod +r -R /var/gopher</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In this case we create an html file, text file, a directory with a text file and png file in it.  Enough content so its nice to look at.\nNext we write our <code class=\"language-text\">gophermap</code> file.  The first line is just an intro.  After that, we list our files that the client can access.</p>\n<p>The format of these lines is: <code class=\"language-text\">XSome text here[TAB]/path/to/content[TAB]example.org[TAB]port</code>.  The first character, <code class=\"language-text\">X</code> is the file type\nwhich can be referenced in the table below.  The final address (example.org) and PORT are optional.</p>\n<p>The following table contains the file types associated with the characters:</p>\n<table>\n<thead>\n<tr>\n<th>Itemtype</th>\n<th>Content</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>Text file</td>\n</tr>\n<tr>\n<td>1</td>\n<td>Directory</td>\n</tr>\n<tr>\n<td>2</td>\n<td>CSO name server</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Error</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Mac HQX filer</td>\n</tr>\n<tr>\n<td>5</td>\n<td>PC binary</td>\n</tr>\n<tr>\n<td>6</td>\n<td>UNIX uuencoded file</td>\n</tr>\n<tr>\n<td>7</td>\n<td>Search server</td>\n</tr>\n<tr>\n<td>8</td>\n<td>Telnet Session</td>\n</tr>\n<tr>\n<td>9</td>\n<td>Binary File</td>\n</tr>\n<tr>\n<td>c</td>\n<td>Calendar (not in 2.06)</td>\n</tr>\n<tr>\n<td>e</td>\n<td>Event (not in 2.06)</td>\n</tr>\n<tr>\n<td>g</td>\n<td>GIF image</td>\n</tr>\n<tr>\n<td>h</td>\n<td>HTML, Hypertext Markup Language</td>\n</tr>\n<tr>\n<td>i</td>\n<td>inline text type</td>\n</tr>\n<tr>\n<td>s</td>\n<td>Sound</td>\n</tr>\n<tr>\n<td>I</td>\n<td>Image (other than GIF)</td>\n</tr>\n<tr>\n<td>M</td>\n<td>MIME multipart/mixed message</td>\n</tr>\n<tr>\n<td>T</td>\n<td>TN3270 Session</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Install the application</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/gopher/gopher_gophermap</code></li>\n<li>Do: <code class=\"language-text\">set rhosts [IPs]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should see the gophermap file printed in a parsed format</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>PATH</strong></p>\n<p>  It is possible to view content within a directory of the gophermap.  If the intial run shows directory <code class=\"language-text\">Directory: foobar</code>,\nsetting <strong>path</strong> to <code class=\"language-text\">/foobar</code> will enumerate the contents of that folder.  Default: [empty string].</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"docker-gopher-server\" style=\"position:relative;\"><a href=\"#docker-gopher-server\" aria-label=\"docker gopher server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker Gopher Server</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/gopher/gopher_gophermap\nmsf auxiliary(gopher_gophermap) &gt; set RHOSTS localhost\nRHOSTS =&gt; localhost\nmsf auxiliary(gopher_gophermap) &gt; run\n\n[+] 127.0.0.1:70          -   Text file: README.md\n[+] 127.0.0.1:70          -     Path: localhost:70/README.md\n[+] 127.0.0.1:70          -   Text file: test.txt\n[+] 127.0.0.1:70          -     Path: localhost:70/test.txt\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"gopher-server-on-ubuntu-1604\" style=\"position:relative;\"><a href=\"#gopher-server-on-ubuntu-1604\" aria-label=\"gopher server on ubuntu 1604 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gopher-server on Ubuntu 16.04</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/scanner/gopher/gopher_gophermap\nmsf auxiliary(gopher_gophermap) &gt; set rhosts 1.1.1.1\nrhosts =&gt; 1.1.1.1\nmsf auxiliary(gopher_gophermap) &gt; set verbose true\nverbose =&gt; true\nmsf auxiliary(gopher_gophermap) &gt; run\n\n[+] 1.1.1.1:70      - gopher custom gophermap\n[+] 1.1.1.1:70      -\n[+] 1.1.1.1:70      -   HTML: Hello World\n[+] 1.1.1.1:70      -     Path: 1.1.1.1:70/example.html\n[+] 1.1.1.1:70      -   Text file: Foo File\n[+] 1.1.1.1:70      -     Path: 1.1.1.1:70/foobar.txt\n[+] 1.1.1.1:70      -   Directory: msf\n[+] 1.1.1.1:70      -     Path: 1.1.1.1:70/msf\n[+] 1.1.1.1:70      -   HTML: metasploit homepage\n[+] 1.1.1.1:70      -     Path: 1.1.1.1:70/URL:http://metasploit.com/\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"e3481ec1-42af-5b94-860b-68a497f6ded8"}}}