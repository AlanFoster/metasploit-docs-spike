{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/scanner/rdp/rdp_scanner","result":{"data":{"moduleMetadataJson":{"id":"14efa7f4-6690-591f-ba23-8a12b9c04d72","name":"Identify endpoints speaking the Remote Desktop Protocol (RDP)","fullname":"auxiliary/scanner/rdp/rdp_scanner","description":"This module attempts to connect to the specified Remote Desktop Protocol port\n          and determines if it speaks RDP.\n\n          When available, the Credential Security Support Provider (CredSSP) protocol will be used to identify the\n          version of Windows on which the server is running. Enabling the DETECT_NLA option will cause a second\n          connection to be made to the server to identify if Network Level Authentication (NLA) is required.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/scanner/rdp/rdp_scanner","documentationSlug":"/modules/documentation/auxiliary/scanner/rdp/rdp_scanner","referencesSlug":"/modules/references/auxiliary/scanner/rdp/rdp_scanner"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  Any system exposing the remote desktop protocol, RDP, typically on 3389/TCP.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Do: <code class=\"language-text\">use auxiliary/scanner/rdp/rdp_scanner</code></li>\n<li>Do: <code class=\"language-text\">set [RHOSTS]</code>, replacing <code class=\"language-text\">[RHOSTS]</code> with a list of hosts to test for the presence of RDP</li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>If the host is exposing an identifiable RDP instance, it will print the endpoint.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  There are three options currently supported that control what security protocols to\nsend in the RDP negotiation request, which can be helpful in identifying RDP\nendpoints that might be locked down or configured differently:</p>\n<p>  <strong>TLS</strong> Set to true to request TLS security support\n<strong>CredSSP</strong> Set to true to request CredSSP support\n<strong>EarlyUser</strong> Set to true to request Early User Authorization Result PDU support</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(rdp_scanner) &gt; run\n\n[+] 10.4.18.26:3389       - Identified RDP\n[+] 10.4.18.22:3389       - Identified RDP\n[+] 10.4.18.89:3389       - Identified RDP\n[+] 10.4.18.9:3389        - Identified RDP\n[+] 10.4.18.67:3389       - Identified RDP\n[+] 10.4.18.80:3389       - Identified RDP\n[+] 10.4.18.34:3389       - Identified RDP\n[+] 10.4.18.70:3389       - Identified RDP\n[+] 10.4.18.30:3389       - Identified RDP\n[+] 10.4.18.76:3389       - Identified RDP\n[+] 10.4.18.13:3389       - Identified RDP\n[+] 10.4.18.91:3389       - Identified RDP\n[+] 10.4.18.5:3389        - Identified RDP\n[+] 10.4.18.47:3389       - Identified RDP\n[+] 10.4.18.41:3389       - Identified RDP\n[+] 10.4.18.105:3389      - Identified RDP\n[*] Scanned  44 of 256 hosts (17% complete)\n[*] Scanned  55 of 256 hosts (21% complete)\n[+] 10.4.18.118:3389      - Identified RDP\n[+] 10.4.18.108:3389      - Identified RDP\n[+] 10.4.18.139:3389      - Identified RDP\n[*] Scanned  94 of 256 hosts (36% complete)\n[*] Scanned 110 of 256 hosts (42% complete)\n[+] 10.4.18.157:3389      - Identified RDP\n[+] 10.4.18.166:3389      - Identified RDP\n[+] 10.4.18.164:3389      - Identified RDP\n[+] 10.4.18.170:3389      - Identified RDP\n[+] 10.4.18.185:3389      - Identified RDP\n[+] 10.4.18.209:3389      - Identified RDP\n[+] 10.4.18.188:3389      - Identified RDP\n[*] Scanned 156 of 256 hosts (60% complete)\n[+] 10.4.18.237:3389      - Identified RDP\n[+] 10.4.18.225:3389      - Identified RDP\n[*] Scanned 186 of 256 hosts (72% complete)\n[*] Scanned 194 of 256 hosts (75% complete)\n[*] Scanned 208 of 256 hosts (81% complete)\n[*] Scanned 253 of 256 hosts (98% complete)\n[*] Scanned 256 of 256 hosts (100% complete)\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"14efa7f4-6690-591f-ba23-8a12b9c04d72"}}}