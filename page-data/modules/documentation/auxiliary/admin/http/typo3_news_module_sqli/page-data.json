{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/admin/http/typo3_news_module_sqli","result":{"data":{"moduleMetadataJson":{"id":"1cafaa93-bd71-5614-91cf-79eda03abef0","name":"TYPO3 News Module SQL Injection","fullname":"auxiliary/admin/http/typo3_news_module_sqli","description":"This module exploits a SQL Injection vulnerability In TYPO3 NewsController.php\n        in the news module 5.3.2 and earlier. It allows an unauthenticated user to execute arbitrary\n        SQL commands via vectors involving overwriteDemand and OrderByAllowed. The SQL injection\n        can be used to obtain password hashes for application user accounts. This module has been\n        tested on TYPO3 3.16.0 running news extension 5.0.0.\n\n        This module tries to extract username and password hash of the administrator user.\n        It tries to inject sql and check every letter of a pattern, to see\n        if it belongs to the username or password it tries to alter the ordering of results. If\n        the letter doesn't belong to the word being extracted then all results are inverted\n        (News #2 appears before News #1, so Pattern2 before Pattern1), instead if the letter belongs\n        to the word being extracted then the results are in proper order (News #1 appears before News #2,\n        so Pattern1 before Pattern2)","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/http/typo3_news_module_sqli","documentationSlug":"/modules/documentation/auxiliary/admin/http/typo3_news_module_sqli"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>News module extensions v5.3.2 and earlier for TYPO3 contain an SQL injection vulnerability. This module allows an unauthenticated user to exploit the SQL injection vulnerability by generating requests to retrieve the password hash for the admin user of the application. This module has been tested on TYPO3 3.16.0 running news extension 5.0.0.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>In vulnerable versions of the news module for TYPO3, a filter for unsetting user specified values does not account for capitalization of the paramter name. This allows a user to inject values to an SQL query.</p>\n<p>To exploit the vulnerability, the module generates requests and sets a value for <code class=\"language-text\">order</code> and <code class=\"language-text\">OrderByAllowed</code>, which gets passed to the SQL query. The requests are constructed to reorder the display of news articles based on a character matching. This allows a blind SQL injection to be performed to retrieve a username and password hash.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>PATTERN1</strong> and <strong>PATTERN2</strong></p>\n<p>These patterns are used to determine whether the news articles have been reordered. By default, the module will search for headlines and set the first identified headline to PATTERN1 and the second to PATTERN2.</p>\n<p><strong>ID</strong></p>\n<p>The value for query parameter <code class=\"language-text\">id</code> of the page that the news extension is running on.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Install <a href=\"https://www.turnkeylinux.org/download?file=turnkey-typo3-14.1-jessie-amd64.ova\">Typo3 VM</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Launch the VM and configure it</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> SSH to the VM</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled>  <code class=\"language-text\">cd /var/www/typo3/ &amp;&amp; composer require georgringer/news:5.0.0</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Login to the web interface</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Enable the news extension</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Import <a href=\"https://github.com/rapid7/metasploit-framework/files/1015777/T3D__2017-05-20_02-17-z.t3d.zip\">vulnerable page</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Enable page</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Verify if page is visble to unauthenticated user and note the id</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language-text\">./msfconsole -q -x &#39;use auxiliary/admin/http/typo3_news_module_sqli; set rhost &lt;rhost&gt;; set id &lt;id&gt;; run&#39;</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Username and password hash should have been retrieved</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"news-module-500-on-typo3-3160\" style=\"position:relative;\"><a href=\"#news-module-500-on-typo3-3160\" aria-label=\"news module 500 on typo3 3160 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>News Module 5.0.0 on TYPO3 3.16.0</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msfdev@simulator:~/git/metasploit-framework$ ./msfconsole -q -x &#39;use auxiliary/admin/http/typo3_news_module_sqli; set rhost 172.22.222.136; set id 37; run&#39;\nrhost =&gt; 172.22.222.136\nid =&gt; 37\n[*] Trying to automatically determine Pattern1 and Pattern2...\n[*] Pattern1: Article #1, Pattern2: Article #2\n[+] Username: admin\n[+] Password Hash: $P$Ch4lme3.gje9o.DjMip59baG7b/mIp.\n[*] Auxiliary module execution completed\nmsf5 auxiliary(admin/http/typo3_news_module_sqli) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"1cafaa93-bd71-5614-91cf-79eda03abef0"}}}