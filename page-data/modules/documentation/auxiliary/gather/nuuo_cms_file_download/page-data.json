{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/gather/nuuo_cms_file_download","result":{"data":{"moduleMetadataJson":{"id":"b17bc00b-0c23-5313-bb3e-7da01fd99b10","name":"Nuuo Central Management Server Authenticated Arbitrary File Download","fullname":"auxiliary/gather/nuuo_cms_file_download","description":"The Nuuo Central Management Server allows an authenticated user to download files from the\n      installation folder. This functionality can be abused to obtain administrative credentials,\n      the SQL Server database password and arbitrary files off the system with directory traversal.\n      The module will attempt to download CMServer.cfg (the user configuration file with all the user\n      passwords including the admin one), ServerConfig.cfg (the server configuration file with the\n      SQL Server password) and a third file if the FILE argument is provided by the user.\n      The two .cfg files are zip-encrypted files, but due to limitations of the Ruby ZIP modules\n      included in Metasploit, these files cannot be decrypted programmatically. The user will\n      have to open them with zip or a similar program and provide the default password \"NUCMS2007!\".\n      This module will either use a provided session number (which can be guessed with an auxiliary\n      module) or attempt to login using a provided username and password - it will also try the\n      default credentials if nothing is provided.\n      All versions of CMS server up to and including 3.5 are vulnerable to this attack.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/gather/nuuo_cms_file_download","documentationSlug":"/modules/documentation/auxiliary/gather/nuuo_cms_file_download","referencesSlug":"/modules/references/auxiliary/gather/nuuo_cms_file_download"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>Nuuo CMS Authenticated Arbitrary File Download</p>\n<p>The GETCONFIG verb is used by a CMS client to obtain configuration files and other resources from the CMS server. An example request is below:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">GETCONFIG NUCM/1.0\nFileName: &lt;filename&gt;\nFileType: &lt;number&gt;\nUser-Session-No: &lt;session-number&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The FileType determines the directory where the file will be downloaded from. \"FileType: 0\" will download from the base installation directory (CMS<em>DIR), while \"FileType: 1\" will download from \"&#x3C;CMS</em>DIR>\\Images\\Map\". There are other defined FileType integers, but these have not been investigated in detail.</p>\n<p>The vulnerability is in the \"FileName\" parameter, which accepts directory traversal (..\\..\\) characters. Therefore, this function can be abused to obtain any files off the file system, including:</p>\n<ul>\n<li>CMServer.cfg, a file zipped with the password \"NUCMS2007!\" that contains the usernames and passwords of all the system users (enabling a less privileged user to obtain the administrator's password)</li>\n<li>ServerConfig.cfg, another file zipped with the password \"NUCMS2007!\" that contains the SQL Server \"sa\" password as well the FTP server username and password</li>\n<li>Any other sensitive files in the drive where CMS Server is installed.</li>\n</ul>\n<p>This module works in the following way:</p>\n<ul>\n<li>if a SESSION number is present, uses that to login</li>\n<li>if not, tries to authenticate with USERNAME and PASSWORD</li>\n</ul>\n<p>Due to the lack of ZIP encryption support in Metasploit, the module prints a warning indicating that the archive cannot be unzipped in Msf.</p>\n<p><a href=\"http://d1.nuuo.com/NUUO/CMS/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NUUO Central Management Server (CMS): all versions up to and including 3.5.0</a></p>\n<p>The following versions were tested:</p>\n<ul>\n<li>1.5.2 OK</li>\n<li>2.1.0 OK</li>\n<li>2.3.2 OK</li>\n<li>2.4.0 OK</li>\n<li>2.6.0 OK</li>\n<li>2.9.0 OK</li>\n<li>2.10.0 OK</li>\n<li>3.1 OK</li>\n<li>3.3 OK</li>\n<li>3.5 OK</li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"tested-on-windows-10-pro-x64-running-ncs-server-240\" style=\"position:relative;\"><a href=\"#tested-on-windows-10-pro-x64-running-ncs-server-240\" aria-label=\"tested on windows 10 pro x64 running ncs server 240 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tested on Windows 10 Pro x64 running NCS Server 2.4.0</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(gather/nuuo_cms_file_download) &gt; set rhosts 172.22.222.200\nrhosts =&gt; 172.22.222.200\nmsf5 auxiliary(gather/nuuo_cms_file_download) &gt; exploit\n\n[+] 172.22.222.200:5180 - Downloaded file to /home/msfdev/.msf4/loot/20190219064923_default_172.22.222.200_CMServer.cfg_227185.cfg\n[+] 172.22.222.200:5180 - Downloaded file to /home/msfdev/.msf4/loot/20190219064923_default_172.22.222.200_ServerConfig.cfg_050084.cfg\n[*] 172.22.222.200:5180 - The user and server configuration files were stored in the loot database.\n[*] 172.22.222.200:5180 - The files are ZIP encrypted, and due to the lack of the archive/zip gem,\n[*] 172.22.222.200:5180 - they cannot be decrypted in Metasploit.\n[*] 172.22.222.200:5180 - You will need to open them up with zip or a similar utility, and use the\n[*] 172.22.222.200:5180 - password NUCMS2007! to unzip them.\n[*] 172.22.222.200:5180 - Annoy the Metasploit developers until this gets fixed!\n[*] Auxiliary module execution completed\nmsf5 auxiliary(gather/nuuo_cms_file_download) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"b17bc00b-0c23-5313-bb3e-7da01fd99b10"}}}