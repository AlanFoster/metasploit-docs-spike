{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/client/iec104/iec104","result":{"data":{"moduleMetadataJson":{"id":"ea350d59-9ea0-584d-b15c-28c06a63dfee","name":"IEC104 Client Utility","fullname":"auxiliary/client/iec104/iec104","description":"This module allows sending 104 commands.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/client/iec104/iec104","documentationSlug":"/modules/documentation/auxiliary/client/iec104/iec104"},"documentation":{"html":"<h1 id=\"iec104-client-for-metasploit\" style=\"position:relative;\"><a href=\"#iec104-client-for-metasploit\" aria-label=\"iec104 client for metasploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IEC104 Client for Metasploit</h1>\n<h2 id=\"definition\" style=\"position:relative;\"><a href=\"#definition\" aria-label=\"definition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Definition</h2>\n<p>IEC 60870 part 5 is one of the IEC 60870 set of standards which define systems used for telecontrol (supervisory control and data acquisition) in electrical engineering and power system automation applications. Part 5 provides a communication profile for sending basic telecontrol messages between two systems, which uses permanent directly connected data circuits between the systems. The IEC Technical Committee 57 (Working Group 03) have developed a protocol standard for telecontrol, teleprotection, and associated telecommunications for electric power systems. The result of this work is IEC 60870-5. Five documents specify the base IEC 60870-5:</p>\n<p>IEC 60870-5-104 (IEC 104) protocol is an extension of IEC 101 protocol with the changes in transport, network, link &#x26; physical layer services to suit the complete network access. The standard uses an open TCP/IP interface to network to have connectivity to the LAN (Local Area Network) and routers with different facility (ISDN, X.25, Frame relay etc.) can be used to connect to the WAN (Wide Area Network). Application layer of IEC 104 is preserved same as that of IEC 101 with some of the data types and facilities not used. There are two separate link layers defined in the standard, which is suitable for data transfer over Ethernet &#x26; serial line (PPP - Point-to-Point Protocol). The control field data of IEC104 contains various types of mechanisms for effective handling of network data synchronization.</p>\n<h2 id=\"install\" style=\"position:relative;\"><a href=\"#install\" aria-label=\"install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install</h2>\n<p>Create a new folder for the IEC104 module, place script in new folder </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">mkdir -p $HOME/.msf4/modules/auxiliary/client/iec104\ncp iec104.rb $HOME/.msf4/modules/auxiliary/client/iec104/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<h3 id=\"selection-of-module-in-msfconsole\" style=\"position:relative;\"><a href=\"#selection-of-module-in-msfconsole\" aria-label=\"selection of module in msfconsole permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Selection of module in msfconsole</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use auxiliary/client/iec104/iec104</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3 id=\"show-module-options\" style=\"position:relative;\"><a href=\"#show-module-options\" aria-label=\"show module options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Show module options</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(client/iec104/iec104) &gt; show options\n\nModule options (auxiliary/client/iec104/iec104):\n\n   Name                Current Setting  Required  Description\n   ----                ---------------  --------  -----------\n   ASDU_ADDRESS        1                yes       Common Address of ASDU\n   COMMAND_ADDRESS     0                yes       Command Address / IOA Address\n   COMMAND_TYPE        100              yes       Command Type\n   COMMAND_VALUE       20               yes       Command Value\n   ORIGINATOR_ADDRESS  0                yes       Originator Address\n   RHOST                                yes       The target address\n   RPORT               2404             yes       The target port (TCP)\n\n\nAuxiliary action:\n\n   Name          Description\n   ----          -----------\n   SEND_COMMAND  Send command to device</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"usage-examples\" style=\"position:relative;\"><a href=\"#usage-examples\" aria-label=\"usage examples permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage Examples</h3>\n<p>Example of sending IEC104 general interrogation command\nThis is using thde default setting for command type, address and value, this is connecting to an local IEC104 server simulator for demo purposes</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(client/iec104/iec104) &gt; set rhost 127.0.0.1\nrhost =&gt; 127.0.0.1\nmsf auxiliary(client/iec104/iec104) &gt; run\n\n[+] 127.0.0.1:2404 - Received STARTDT_ACT\n[*] 127.0.0.1:2404 - Sending 104 command\n[+] 127.0.0.1:2404 -   Parsing response: Interrogation command (C_IC_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0000\n[+] 127.0.0.1:2404 -     CauseTx: 07 (Activation Confirmation)\n[+] 127.0.0.1:2404 -   Parsing response: Single point information (M_SP_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0002\n[+] 127.0.0.1:2404 -     CauseTx: 14 (Inrogen)\n[+] 127.0.0.1:2404 -     IOA: 1 SIQ: 0x00\n[+] 127.0.0.1:2404 -     IOA: 2 SIQ: 0x00\n[+] 127.0.0.1:2404 -     IOA: 3 SIQ: 0x01\n[+] 127.0.0.1:2404 -     IOA: 4 SIQ: 0x00\n[+] 127.0.0.1:2404 -   Parsing response: Single point information (M_SP_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0004\n[+] 127.0.0.1:2404 -     CauseTx: 14 (Inrogen)\n[+] 127.0.0.1:2404 -     IOA: 7 SIQ: 0x00\n[+] 127.0.0.1:2404 -   Parsing response: Double point information (M_DP_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0006\n[+] 127.0.0.1:2404 -     CauseTx: 14 (Inrogen)\n[+] 127.0.0.1:2404 -     IOA: 6 SIQ: 0x02\n[+] 127.0.0.1:2404 -   Parsing response: Interrogation command (C_IC_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0008\n[+] 127.0.0.1:2404 -     CauseTx: 0a (Termination Activation)\n[*] 127.0.0.1:2404 - operation ended\n[*] 127.0.0.1:2404 - Terminating Connection\n[+] 127.0.0.1:2404 - Received STOPDT_ACT\n[*] Auxiliary module execution completed\nmsf auxiliary(client/iec104/iec104) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Example sending switching command\nIOA address to be switched is \"5\", the command type is a double command \"46\", command is for switching off without time value \"5\"\nUsing local IEC 104 server simulator</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(client/iec104/iec104) &gt; set rhost 127.0.0.1\nrhost =&gt; 127.0.0.1\nmsf auxiliary(client/iec104/iec104) &gt; set command_address 5\ncommand_address =&gt; 5\nmsf auxiliary(client/iec104/iec104) &gt; set command_type 46\ncommand_type =&gt; 46\nmsf auxiliary(client/iec104/iec104) &gt; set command_value 5\ncommand_value =&gt; 5\nmsf auxiliary(client/iec104/iec104) &gt; run\n\n[+] 127.0.0.1:2404 - Received STARTDT_ACT\n[*] 127.0.0.1:2404 - Sending 104 command\n[+] 127.0.0.1:2404 -   Parsing response: Double command (C_DC_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0000\n[+] 127.0.0.1:2404 -     CauseTx: 07 (Activation Confirmation)\n[+] 127.0.0.1:2404 -     IOA: 5 DCO: 0x05\n[+] 127.0.0.1:2404 -   Parsing response: Single point information with time (M_SP_TB_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0002\n[+] 127.0.0.1:2404 -     CauseTx: 03 (Spontaneous)\n[+] 127.0.0.1:2404 -     IOA: 3 SIQ: 0x00\n[+] 127.0.0.1:2404 -     Timestamp: 2018-03-30 21:39:52.930\n[+] 127.0.0.1:2404 -   Parsing response: Double command (C_DC_NA_1)\n[+] 127.0.0.1:2404 -     TX: 0002 RX: 0004\n[+] 127.0.0.1:2404 -     CauseTx: 0a (Termination Activation)\n[+] 127.0.0.1:2404 -     IOA: 5 DCO: 0x05\n[*] 127.0.0.1:2404 - operation ended\n[*] 127.0.0.1:2404 - Terminating Connection\n[+] 127.0.0.1:2404 - Received STOPDT_ACT\n[*] Auxiliary module execution completed\nmsf auxiliary(client/iec104/iec104) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ea350d59-9ea0-584d-b15c-28c06a63dfee"}}}