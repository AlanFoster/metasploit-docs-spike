{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/mssql_local_auth_bypass","result":{"data":{"moduleMetadataJson":{"id":"4fa9956c-6e57-5448-8e4e-a951e3de23e4","name":"Windows Manage Local Microsoft SQL Server Authorization Bypass","fullname":"post/windows/manage/mssql_local_auth_bypass","description":"When this module is executed, it can be used to add a sysadmin to local\n        SQL Server instances.  It first attempts to gain LocalSystem privileges\n        using the \"getsystem\" escalation methods. If those privileges are not\n        sufficient to add a sysadmin, then it will migrate to the SQL Server\n        service process associated with the target instance.  The sysadmin\n        login is added to the local SQL Server using native SQL clients and\n        stored procedures.  If no instance is specified then the first identified\n        instance will be used.\n\n        Why is this possible? By default in SQL Server 2k-2k8, LocalSystem\n        is assigned syadmin privileges.  Microsoft changed the default in\n        SQL Server 2012 so that LocalSystem no longer has sysadmin privileges.\n        However, this can be overcome by migrating to the SQL Server process.","rank":300,"fields":{"detailsSlug":"/modules/details/post/windows/manage/mssql_local_auth_bypass","documentationSlug":"/modules/documentation/post/windows/manage/mssql_local_auth_bypass","referencesSlug":"/modules/references/post/windows/manage/mssql_local_auth_bypass"},"documentation":{"html":"<h2 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>This post-exploitation module enables you to add a sysadmin to local SQL Server instances, use that login to collect and gather data, and remove the login from the system. </p>\n<p>Pre-2008 versions of MSSQL servers automatically granted local sysadmins admin rights. This changed in MSSQL Server 2008, but there are still ways around to get around it, thanks to this module! If you are able to get domain admin privileges, you'll be able to add yourself to the database domain group and access the server with your newly added account. </p>\n<h2 id=\"basic-workflow\" style=\"position:relative;\"><a href=\"#basic-workflow\" aria-label=\"basic workflow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Workflow</h2>\n<ol>\n<li>Get a Meterpreter session using a module like psexec. </li>\n<li>Create a syadmin login on the SQL server.</li>\n<li>Log into SQL Server with the newly created login. </li>\n<li>Find and collect data from the server using a module like Microsoft SQL Server Find and Sample Data.</li>\n<li>Remove the sysadmin login when you are done. </li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>The following options are required:</p>\n<ul>\n<li><strong>DB_PASSWORD</strong> - This option sets the password for the new sysadmin login.</li>\n<li><strong>DB_USERNAME</strong> - This option sets the name for the new sysadmin login. </li>\n<li><strong>REMOVE_LOGIN</strong> - This option removes DB_USERNAME from the database. </li>\n<li><strong>SESSION</strong> - This option sets the session that you want to use to run this module against. </li>\n</ul>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Here's an example of how you can use this module:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">meterpreter &gt; use post/windows/manage/mssql_local_auth_bypass\nmeterpreter &gt; set DB_USERNAME tacocat\nmeterpreter &gt; set DB_PASSWORD 12345\nmeterpreter &gt; set SESSION 1\nmeterpreter &gt; exploit</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"4fa9956c-6e57-5448-8e4e-a951e3de23e4"}}}