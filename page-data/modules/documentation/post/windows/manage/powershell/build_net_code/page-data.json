{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/windows/manage/powershell/build_net_code","result":{"data":{"moduleMetadataJson":{"id":"587b4ba3-0256-5012-a6c7-fd6847a7828f","name":"Powershell .NET Compiler","fullname":"post/windows/manage/powershell/build_net_code","description":"This module will build a .NET source file using powershell. The compiler builds\n          the executable or library in memory and produces a binary. After compilation the\n          PowerShell session can also sign the executable if provided a path the\n          a .pfx formatted certificate. Compiler options and a list of assemblies\n          required can be configured in the datastore.","rank":600,"fields":{"detailsSlug":"/modules/details/post/windows/manage/powershell/build_net_code","documentationSlug":"/modules/documentation/post/windows/manage/powershell/build_net_code","referencesSlug":"/modules/references/post/windows/manage/powershell/build_net_code"},"documentation":{"html":"<h2 id=\"example-session\" style=\"position:relative;\"><a href=\"#example-session\" aria-label=\"example session permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example Session</h2>\n<p>/tmp/hello.cs contains the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">using System;\n\npublic class Hello\n{\n   public static void Main()\n   {\n      Console.WriteLine(&quot;Hello, World!&quot;);\n   }\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>To build and run the code:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(handler) &gt; use post/windows/manage/powershell/build_net_code\nmsf post(build_net_code) &gt; set SESSION -1\nSESSION =&gt; -1\nmsf post(build_net_code) &gt; show options\n\nModule options (post/windows/manage/powershell/build_net_code):\n\n   Name           Current Setting                                            Required  Description\n   ----           ---------------                                            --------  -----------\n   ASSEMBLIES     mscorlib.dll, System.dll, System.Xml.dll, System.Data.dll  no        Any assemblies outside the defaults\n   CODE_PROVIDER  Microsoft.CSharp.CSharpCodeProvider                        yes       Code provider to use\n   COMPILER_OPTS  /optimize                                                  no        Options to pass to compiler\n   OUTPUT_TARGET                                                             no        Name and path of the generated binary, default random, omit extension\n   RUN_BINARY     false                                                      no        Execute the generated binary\n   SESSION        -1                                                         yes       The session to run this module on.\n   SOURCE_FILE                                                               yes       Path to source code\n\nmsf post(build_net_code) &gt; set SOURCE_FILE /tmp/hello.cs\nSOURCE_FILE =&gt; /tmp/hello.cs\nmsf post(build_net_code) &gt; run\n\n[*] Building remote code.\n[+] File C:\\cygwin64\\tmp\\aNwCFmmLzlYvPWw.exe found, 3584kb\n[+] Finished!\n[*] Post module execution completed\nmsf post(build_net_code) &gt; sessions -i -1\n[*] Starting interaction with 1...\n\nmeterpreter &gt; shell\nProcess 4840 created.\nChannel 7 created.\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nE:\\metasploit-framework&gt;C:\\cygwin64\\tmp\\aNwCFmmLzlYvPWw.exe\nC:\\cygwin64\\tmp\\aNwCFmmLzlYvPWw.exe\nHello, World!</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You can also run the code automatically:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(handler) &gt; use post/windows/manage/powershell/build_net_code\nmsf post(build_net_code) &gt; set SOURCE_FILE /tmp/hello.cs\nSOURCE_FILE =&gt; /tmp/hello.cs\nmsf post(build_net_code) &gt; set RUN_BINARY true\nRUN_BINARY =&gt; true\nmsf post(build_net_code) &gt; set SESSION -1\nSESSION =&gt; -1\nmsf post(build_net_code) &gt; run\n\n[*] Building remote code.\n[+] File C:\\cygwin64\\tmp\\QuEQSEifJOe.exe found, 3584kb\n[+] Hello, World!\n\n[+] Finished!\n[*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"587b4ba3-0256-5012-a6c7-fd6847a7828f"}}}