{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/multi/recon/sudo_commands","result":{"data":{"moduleMetadataJson":{"id":"7d4d7b78-b407-50f1-b82e-263dd9c7782a","name":"Sudo Commands","fullname":"post/multi/recon/sudo_commands","description":"This module examines the sudoers configuration for the session user\n        and lists the commands executable via sudo.\n\n        This module also inspects each command and reports potential avenues\n        for privileged code execution due to poor file system permissions or\n        permitting execution of executables known to be useful for privesc,\n        such as utilities designed for file read/write, user modification,\n        or execution of arbitrary operating system commands.\n\n        Note, you may need to provide the password for the session user.","rank":300,"fields":{"detailsSlug":"/modules/details/post/multi/recon/sudo_commands","documentationSlug":"/modules/documentation/post/multi/recon/sudo_commands","referencesSlug":"/modules/references/post/multi/recon/sudo_commands"},"documentation":{"html":"<h2 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Description</h2>\n<p>  This module examines the sudoers configuration for the session user\nand lists the commands executable via <code class=\"language-text\">sudo</code>.</p>\n<p>  This module also inspects each command and reports potential avenues\nfor privileged code execution due to poor file system permissions or\npermitting execution of executables known to be useful for privesc,\nsuch as utilities designed for file read/write, user modification,\nor execution of arbitrary operating system commands.</p>\n<p>  Note, you may need to provide the password for the session user.</p>\n<h2 id=\"verification-steps\" style=\"position:relative;\"><a href=\"#verification-steps\" aria-label=\"verification steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verification Steps</h2>\n<ol>\n<li>Start <code class=\"language-text\">msfconsole</code></li>\n<li>Get a session</li>\n<li><code class=\"language-text\">use post/multi/recon/sudo_commands</code></li>\n<li><code class=\"language-text\">set SESSION [SESSION]</code></li>\n<li><code class=\"language-text\">run</code></li>\n<li>You should receive a list of available <code class=\"language-text\">sudo</code> commands</li>\n</ol>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SESSION</strong></p>\n<p>  Which session to use, which can be viewed with <code class=\"language-text\">sessions</code></p>\n<p>  <strong>SUDO_PATH</strong></p>\n<p>  Path to sudo executable (default: <code class=\"language-text\">/usr/bin/sudo</code>)</p>\n<p>  <strong>PASSWORD</strong></p>\n<p>  Password for the session user</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf5 &gt; use post/multi/recon/sudo_commands\nmsf5 post(multi/recon/sudo_commands) &gt; set session 1\nsession =&gt; 1\nmsf5 post(multi/recon/sudo_commands) &gt; set verbose true\nverbose =&gt; true\nmsf5 post(multi/recon/sudo_commands) &gt; run\n\n[*] Executing: /usr/bin/sudo -n -l\nMatching Defaults entries for wvu on localhost:\n    !visiblepw, always_set_home, match_group_by_gid, env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&quot;, env_keep+=&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;, env_keep+=&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&quot;, env_keep+=&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;, env_keep+=&quot;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;, secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser wvu may run the following commands on localhost:\n    (ALL) ALL\n    (ALL) NOPASSWD: ALL\n    (root) /sbin/mount /mnt/cdrom, /sbin/umount /mnt/cdrom\n    (root) /sbin/shutdown -h now\n\n[*] Command: &quot;ALL&quot; RunAsUsers: ALL\n[+] sudo any command!\n[*] Command: &quot;ALL&quot; RunAsUsers: ALL without providing a password\n[+] sudo any command!\n[*] Command: &quot;/sbin/mount /mnt/cdrom&quot; RunAsUsers: root\n[*] Command: &quot;/sbin/umount /mnt/cdrom&quot; RunAsUsers: root\n[*] Command: &quot;/sbin/shutdown -h now&quot; RunAsUsers: root\n\nSudo Commands\n=============\n\n  Command                  RunAsUsers  RunAsGroups  Password?  Privesc?\n  -------                  ----------  -----------  ---------  --------\n  /sbin/mount /mnt/cdrom   root                     True\n  /sbin/shutdown -h now    root                     True\n  /sbin/umount /mnt/cdrom  root                     True\n  ALL                      ALL                      True       True\n  ALL                      ALL                                 True\n\n[+] Output stored in: /Users/user/.msf4/loot/20180613134731_default_192.168.56.101_sudo.commands_305964.txt\n[*] Post module execution completed\nmsf5 post(multi/recon/sudo_commands) &gt; cat /Users/user/.msf4/loot/20180613134731_default_192.168.56.101_sudo.commands_305964.txt\n[*] exec: cat /Users/user/.msf4/loot/20180613134731_default_192.168.56.101_sudo.commands_305964.txt\n\nCommand,RunAsUsers,RunAsGroups,Password?,Privesc?\n&quot;/sbin/mount /mnt/cdrom&quot;,&quot;root&quot;,&quot;&quot;,&quot;True&quot;,&quot;&quot;\n&quot;/sbin/shutdown -h now&quot;,&quot;root&quot;,&quot;&quot;,&quot;True&quot;,&quot;&quot;\n&quot;/sbin/umount /mnt/cdrom&quot;,&quot;root&quot;,&quot;&quot;,&quot;True&quot;,&quot;&quot;\n&quot;ALL&quot;,&quot;ALL&quot;,&quot;&quot;,&quot;True&quot;,&quot;True&quot;\n&quot;ALL&quot;,&quot;ALL&quot;,&quot;&quot;,&quot;&quot;,&quot;True&quot;\nmsf5 post(multi/recon/sudo_commands) &gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"7d4d7b78-b407-50f1-b82e-263dd9c7782a"}}}