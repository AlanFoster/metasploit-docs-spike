{"componentChunkName":"component---src-templates-wiki-template-tsx","path":"/wiki/Misc/How-to-send-an-HTTP-request-using-Rex-Proto-Http-Client","result":{"data":{"markdownRemark":{"id":"468e3fe9-2ad4-5615-95d6-7eb9431ee000","frontmatter":{"title":"How to send an HTTP request using Rex Proto Http Client","root":null},"html":"<p><strong>Note: This documentation may need to be vetted.</strong></p>\n<h1 id=\"how-to-send-an-http-request-using-rexprotohttpclient\" style=\"position:relative;\"><a href=\"#how-to-send-an-http-request-using-rexprotohttpclient\" aria-label=\"how to send an http request using rexprotohttpclient permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to send an HTTP request using Rex::Proto::Http::Client</h1>\n<p>The Rex library (Ruby Extension Library) is the most fundamental piece of the Metasploit Framework architecture. Modules normally do not interact with Rex directly, instead they depend on the framework core and its mixins for better code sharing. If you are a Metasploit module developer, the <a href=\"https://github.com/rapid7/metasploit-framework/tree/master/lib/msf/core\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lib/msf/core</a> directory should be more than enough for most of your needs. If you are writing a module that speaks HTTP, then the <a href=\"https://github.com/rapid7/metasploit-framework/wiki/How-to-Send-an-HTTP-Request-Using-HTTPClient\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Msf::Exploit::Remote::HttpClient</a> mixin (which is found in <a href=\"https://github.com/rapid7/metasploit-framework/blob/master/lib/msf/core/exploit/http/client.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lib/msf/core/exploit/http/client</a>) is most likely the one you want.</p>\n<p>However, in some scenarios, you actually can't use the HttpClient mixin. The most common is actually when writing a form-based login module using the <a href=\"https://github.com/rapid7/metasploit-framework/wiki/Creating-Metasploit-Framework-LoginScanners\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">LoginScanner API</a>. If you find yourself in that situation, use <a href=\"https://github.com/rapid7/metasploit-framework/blob/master/lib/rex/proto/http/client.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rex::Proto::Http::Client</a>.</p>\n<h2 id=\"initializing-rexprotohttpclient\" style=\"position:relative;\"><a href=\"#initializing-rexprotohttpclient\" aria-label=\"initializing rexprotohttpclient permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Initializing Rex::Proto::Http::Client</h2>\n<p>The Rex::Proto::Http::Client initializer creates a new HTTP client instance, and the most important piece is this:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">initialize</span></span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port <span class=\"token operator\">=</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> ssl <span class=\"token operator\">=</span> <span class=\"token keyword\">nil</span><span class=\"token punctuation\">,</span> ssl_version <span class=\"token operator\">=</span> <span class=\"token keyword\">nil</span><span class=\"token punctuation\">,</span> proxies <span class=\"token operator\">=</span> <span class=\"token keyword\">nil</span><span class=\"token punctuation\">,</span> username <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> password <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you can use, only the host argument is required, the rest are optional. But let's go over all of them right quick:</p>\n<table>\n<thead>\n<tr>\n<th>Argument name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>host</td>\n<td>String</td>\n<td>Target host IP</td>\n</tr>\n<tr>\n<td>port</td>\n<td>Fixnum</td>\n<td>Target host port</td>\n</tr>\n<tr>\n<td>context</td>\n<td>Hash</td>\n<td>Determines what is responsible for requesting that a socket can be created</td>\n</tr>\n<tr>\n<td>ssl</td>\n<td>Boolean</td>\n<td>True to enable it</td>\n</tr>\n<tr>\n<td>ssl_version</td>\n<td>String</td>\n<td>SSL2, SSL3, or TLS1</td>\n</tr>\n<tr>\n<td>proxies</td>\n<td>String</td>\n<td>Configure a proxy</td>\n</tr>\n<tr>\n<td>username</td>\n<td>String</td>\n<td>Username for automatic authentication</td>\n</tr>\n<tr>\n<td>password</td>\n<td>String</td>\n<td>Password for automatic authentication</td>\n</tr>\n</tbody>\n</table>\n<p>Code example of initialing Rex::Proto::Http::Client:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">cli <span class=\"token operator\">=</span> <span class=\"token constant\">Rex</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Proto</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Http</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Client</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>rhost<span class=\"token punctuation\">,</span> rport<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8181</span><span class=\"token punctuation\">,</span> proxies<span class=\"token punctuation\">,</span> <span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'password'</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"making-an-http-request\" style=\"position:relative;\"><a href=\"#making-an-http-request\" aria-label=\"making an http request permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Making an HTTP request</h2>\n<p>Even though our main topic of this documentation is about Rex::Proto::Http::Client, it does not know how to make HTTP requests. Instead, <a href=\"https://github.com/rapid7/metasploit-framework/blob/master/lib/rex/proto/http/client_request.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rex::Proto::Http::ClientRequest</a> is actually the mother of all Metasploit's HTTP requests.</p>\n<p>So how does Rex::Proto::Http::ClientRequest give birth to an HTTP request? Well, you see son, it all begins when Rex::Proto::Http::Client asks for one with either the #request<em>cgi or the #request</em>raw method. The difference is that if #request<em>cgi is used, the request is meant to be CGI compatible, and in most cases this is what you want. If #request</em>raw is used, technically it means less options, less CGI compatible.</p>\n<p>A raw HTTP request supports the following options:</p>\n<table>\n<thead>\n<tr>\n<th>Option/key name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>query</td>\n<td>String</td>\n<td>Raw GET query string</td>\n</tr>\n<tr>\n<td>data</td>\n<td>String</td>\n<td>Raw POST data string</td>\n</tr>\n<tr>\n<td>uri</td>\n<td>String</td>\n<td>Raw URI string</td>\n</tr>\n<tr>\n<td>ssl</td>\n<td>Boolean</td>\n<td>True to use https://, otherwise http://</td>\n</tr>\n<tr>\n<td>agent</td>\n<td>String</td>\n<td>User-Agent. Default is: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)</td>\n</tr>\n<tr>\n<td>method</td>\n<td>String</td>\n<td>HTTP method</td>\n</tr>\n<tr>\n<td>proto</td>\n<td>String</td>\n<td>Protocol</td>\n</tr>\n<tr>\n<td>version</td>\n<td>String</td>\n<td>Version</td>\n</tr>\n<tr>\n<td>vhost</td>\n<td>String</td>\n<td>Host header</td>\n</tr>\n<tr>\n<td>port</td>\n<td>Fixnum</td>\n<td>Port for the host header</td>\n</tr>\n<tr>\n<td>authorization</td>\n<td>String</td>\n<td>The authorization header</td>\n</tr>\n<tr>\n<td>cookie</td>\n<td>String</td>\n<td>The cookie header</td>\n</tr>\n<tr>\n<td>connection</td>\n<td>String</td>\n<td>The connection header</td>\n</tr>\n<tr>\n<td>headers</td>\n<td>Hash</td>\n<td>A hash of custom headers. Safer than raw_headers</td>\n</tr>\n<tr>\n<td>raw_headers</td>\n<td>String</td>\n<td>A string of raw headers</td>\n</tr>\n<tr>\n<td>ctype</td>\n<td>String</td>\n<td>Content type</td>\n</tr>\n</tbody>\n</table>\n<p>An example of using #request_raw's options:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token comment\"># cli is a Rex::Proto::Http::Client object</span>\nreq <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>request_raw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token string\">'uri'</span>    <span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">'/test.php'</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string\">'method'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string\">'data'</span>   <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'A=B'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>#request_cgi inherits all the above</strong>, and more:</p>\n<table>\n<thead>\n<tr>\n<th>Option/key name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>pad<em>get</em>params</td>\n<td>Boolean</td>\n<td>Enable padding for GET parameters</td>\n</tr>\n<tr>\n<td>pad<em>get</em>params_count</td>\n<td>Fixnum</td>\n<td>Number of random GET parameters. You also need pad<em>get</em>params for this</td>\n</tr>\n<tr>\n<td>vars_get</td>\n<td>Hash</td>\n<td>A hash of GET parameters</td>\n</tr>\n<tr>\n<td>encode_params</td>\n<td>Boolean</td>\n<td>Enable URI encoding for GET or POST parameters</td>\n</tr>\n<tr>\n<td>pad<em>post</em>params</td>\n<td>Boolean</td>\n<td>Enable padding for POST parameters</td>\n</tr>\n<tr>\n<td>pad<em>post</em>params_count</td>\n<td>Fixnum</td>\n<td>Number of random POST parameters. You also need pad<em>post</em>params for this</td>\n</tr>\n</tbody>\n</table>\n<p>An example of using one of #request_cgi options:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token comment\"># cli is a Rex::Proto::Http::Client object</span>\nreq <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>request_cgi<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token string\">'uri'</span>      <span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">'/test.php'</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string\">'vars_get'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token string\">'param1'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token string\">'param2'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'value'</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"sending-an-http-request\" style=\"position:relative;\"><a href=\"#sending-an-http-request\" aria-label=\"sending an http request permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sending an HTTP request</h2>\n<p>Here are examples of how to actually speak to an HTTP server with either #request<em>cgi or #request</em>raw:</p>\n<p><strong>#request_cgi</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">cli <span class=\"token operator\">=</span> <span class=\"token constant\">Rex</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Proto</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Http</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Client</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>rhost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\ncli<span class=\"token punctuation\">.</span>connect\nreq <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>request_cgi<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'uri'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">'/'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nres <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>send_recv<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span>\ncli<span class=\"token punctuation\">.</span>close</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>#request_raw</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">cli <span class=\"token operator\">=</span> <span class=\"token constant\">Rex</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Proto</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Http</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Client</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>rhost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\ncli<span class=\"token punctuation\">.</span>connect\nreq <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>request_raw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'uri'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">'/'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nres <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>send_recv<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span>\ncli<span class=\"token punctuation\">.</span>close</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"configuring-advanced-options\" style=\"position:relative;\"><a href=\"#configuring-advanced-options\" aria-label=\"configuring advanced options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring advanced options</h2>\n<p><strong>Evasion Options</strong></p>\n<p>Rex::Proto::Http::Client also comes with its own collection of evasion options. You can set them either when you're asking Rex::Proto::Http::ClientRequest to make the HTTP request, or you can set them with a #set<em>config method. The main difference is that if you are using #set</em>config, you should make these options user-configurable.</p>\n<table>\n<thead>\n<tr>\n<th>Option</th>\n<th>Data type</th>\n<th>Default</th>\n<th>Known configurable option</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>encode_params</td>\n<td>Boolean</td>\n<td>true</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>encode</td>\n<td>Boolean</td>\n<td>false</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>uri<em>encode</em>mode</td>\n<td>String</td>\n<td>hex-normal</td>\n<td>HTTP::uri<em>encode</em>mode</td>\n</tr>\n<tr>\n<td>uri<em>encode</em>count</td>\n<td>Fixnum</td>\n<td>1</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>uri<em>full</em>url</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>full</em>url</td>\n</tr>\n<tr>\n<td>pad<em>method</em>uri_count</td>\n<td>Fixnum</td>\n<td>1</td>\n<td>HTTP::pad<em>method</em>uri_count</td>\n</tr>\n<tr>\n<td>pad<em>uri</em>version_count</td>\n<td>Fixnum</td>\n<td>1</td>\n<td>HTTP::pad<em>uri</em>version_count</td>\n</tr>\n<tr>\n<td>pad<em>method</em>uri_type</td>\n<td>String</td>\n<td>space</td>\n<td>HTTP::pad<em>method</em>uri_type</td>\n</tr>\n<tr>\n<td>pad<em>uri</em>version_type</td>\n<td>String</td>\n<td>space</td>\n<td>HTTP::pad<em>uri</em>version_type</td>\n</tr>\n<tr>\n<td>method<em>random</em>valid</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::method<em>random</em>valid</td>\n</tr>\n<tr>\n<td>method<em>random</em>invalid</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::method<em>random</em>invalid</td>\n</tr>\n<tr>\n<td>method<em>random</em>case</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::method<em>random</em>case</td>\n</tr>\n<tr>\n<td>version<em>random</em>valid</td>\n<td>Boolean</td>\n<td>false</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>version<em>random</em>invalid</td>\n<td>Boolean</td>\n<td>false</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>version<em>random</em>case</td>\n<td>Boolean</td>\n<td>false</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>uri<em>dir</em>self_reference</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>dir</em>self_reference</td>\n</tr>\n<tr>\n<td>uri<em>dir</em>fake_relative</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>dir</em>fake_relative</td>\n</tr>\n<tr>\n<td>uri<em>use</em>backslashes</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>use</em>backslashes</td>\n</tr>\n<tr>\n<td>pad<em>fake</em>headers</td>\n<td>Boolean</td>\n<td>pad<em>fake</em>headers</td>\n<td>HTTP::pad<em>fake</em>headers</td>\n</tr>\n<tr>\n<td>pad<em>fake</em>headers_count</td>\n<td>Fixnum</td>\n<td>16</td>\n<td>HTTP::pad<em>fake</em>headers_count</td>\n</tr>\n<tr>\n<td>pad<em>get</em>params</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::pad<em>get</em>params</td>\n</tr>\n<tr>\n<td>pad<em>get</em>params_count</td>\n<td>Boolean</td>\n<td>8</td>\n<td>HTTP::pad<em>get</em>params_count</td>\n</tr>\n<tr>\n<td>pad<em>post</em>params</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::pad<em>post</em>params</td>\n</tr>\n<tr>\n<td>pad<em>post</em>params_count</td>\n<td>Fixnum</td>\n<td>8</td>\n<td>HTTP::pad<em>post</em>params_count</td>\n</tr>\n<tr>\n<td>uri<em>fake</em>end</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>fake</em>end</td>\n</tr>\n<tr>\n<td>uri<em>fake</em>params_start</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::uri<em>fake</em>params_start</td>\n</tr>\n<tr>\n<td>header_folding</td>\n<td>Boolean</td>\n<td>false</td>\n<td>HTTP::header_folding</td>\n</tr>\n<tr>\n<td>chunked_size</td>\n<td>Fixnum</td>\n<td>0</td>\n<td>N/A</td>\n</tr>\n</tbody>\n</table>\n<p><strong>NTLM Options</strong></p>\n<p>HTTP authentication is automatic in Rex::Proto::Http::Client, and when it comes to the NTLM provider, it gets its own options. You MUST use the #set_config method to set them:</p>\n<table>\n<thead>\n<tr>\n<th>Option</th>\n<th>Data type</th>\n<th>Default</th>\n<th>Known configurable option</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>usentlm2_session</td>\n<td>Boolean</td>\n<td>true</td>\n<td>NTLM::UseNTLM2_session</td>\n</tr>\n<tr>\n<td>use_ntlmv2</td>\n<td>Boolean</td>\n<td>true</td>\n<td>NTLM::UseNTLMv2</td>\n</tr>\n<tr>\n<td>send_lm</td>\n<td>Boolean</td>\n<td>true</td>\n<td>NTLM::SendLM</td>\n</tr>\n<tr>\n<td>send_ntlm</td>\n<td>Boolean</td>\n<td>true</td>\n<td>NTLM::SendNTLM</td>\n</tr>\n<tr>\n<td>SendSPN</td>\n<td>Boolean</td>\n<td>true</td>\n<td>NTLM::SendSPN</td>\n</tr>\n<tr>\n<td>UseLMKey</td>\n<td>Boolean</td>\n<td>false</td>\n<td>NTLM::UseLMKey</td>\n</tr>\n<tr>\n<td>domain</td>\n<td>String</td>\n<td>WORKSTATION</td>\n<td>DOMAIN</td>\n</tr>\n<tr>\n<td>DigestAuthIIS</td>\n<td>Boolean</td>\n<td>true</td>\n<td>DigestAuthIIS</td>\n</tr>\n</tbody>\n</table>\n<p>Note: \"Known configuration options\" means there is a datastore option for it from HttpClient. If you can't use HttpClient, then you will have to consider register them yourself.</p>\n<h2 id=\"uri-parsing\" style=\"position:relative;\"><a href=\"#uri-parsing\" aria-label=\"uri parsing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URI Parsing</h2>\n<p>Rex::Proto::Http::Client actually does not support URI parsing, so for URI format validation and normalization, you are on your own, and you should probably do it.</p>\n<p>For URI format validation, we recommend using Ruby's URI module. You can use HttpClient's #<a href=\"https://github.com/rapid7/metasploit-framework/blob/a65ee6cf30e6f671985876f83457cfcbea008e49/lib/msf/core/exploit/http/client.rb#L335\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">target_uri</a> method as an example.</p>\n<p>For URI normalization, we recommend HttpClient's #<a href=\"https://github.com/rapid7/metasploit-framework/blob/a65ee6cf30e6f671985876f83457cfcbea008e49/lib/msf/core/exploit/http/client.rb#L360\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">normalize_uri</a> method as an example.</p>\n<h2 id=\"full-example\" style=\"position:relative;\"><a href=\"#full-example\" aria-label=\"full example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Full Example</h2>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">cli <span class=\"token operator\">=</span> <span class=\"token constant\">Rex</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Proto</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Http</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Client</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>rhost<span class=\"token punctuation\">,</span> rport<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> ssl<span class=\"token punctuation\">,</span> ssl_version<span class=\"token punctuation\">,</span> proxies<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">,</span> pass<span class=\"token punctuation\">)</span>\ncli<span class=\"token punctuation\">.</span>set_config<span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'vhost'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> vhost<span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'agent'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'UserAgent'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_encode_mode'</span>        <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_encode_mode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_full_url'</span>           <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_full_url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_method_uri_count'</span>   <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_method_uri_count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_uri_version_count'</span>  <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_uri_version_count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_method_uri_type'</span>    <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_method_uri_type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_uri_version_type'</span>   <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_uri_version_type'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'method_random_valid'</span>    <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::method_random_valid'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'method_random_invalid'</span>  <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::method_random_invalid'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'method_random_case'</span>     <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::method_random_case'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_dir_self_reference'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_dir_self_reference'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_dir_fake_relative'</span>  <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_dir_fake_relative'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_use_backslashes'</span>    <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_use_backslashes'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_fake_headers'</span>       <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_fake_headers'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_fake_headers_count'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_fake_headers_count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_get_params'</span>         <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_get_params'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_get_params_count'</span>   <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_get_params_count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_post_params'</span>        <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_post_params'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'pad_post_params_count'</span>  <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::pad_post_params_count'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_fake_end'</span>           <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_fake_end'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'uri_fake_params_start'</span>  <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::uri_fake_params_start'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'header_folding'</span>         <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'HTTP::header_folding'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'usentlm2_session'</span>       <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::UseNTLM2_session'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'use_ntlmv2'</span>             <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::UseNTLMv2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'send_lm'</span>                <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::SendLM'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'send_ntlm'</span>              <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::SendNTLM'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'SendSPN'</span>                <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::SendSPN'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'UseLMKey'</span>               <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'NTLM::UseLMKey'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'domain'</span>                 <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'DOMAIN'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'DigestAuthIIS'</span>          <span class=\"token operator\">=</span><span class=\"token operator\">></span> datastore<span class=\"token punctuation\">[</span><span class=\"token string\">'DigestAuthIIS'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\ncli<span class=\"token punctuation\">.</span>connect\nreq <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>request_cgi<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'uri'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">'/'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nres <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>send_recv<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">)</span>\ncli<span class=\"token punctuation\">.</span>close</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}},"pageContext":{"id":"468e3fe9-2ad4-5615-95d6-7eb9431ee000"}}}