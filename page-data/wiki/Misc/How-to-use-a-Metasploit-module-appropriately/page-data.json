{"componentChunkName":"component---src-templates-wiki-template-tsx","path":"/wiki/Misc/How-to-use-a-Metasploit-module-appropriately","result":{"data":{"markdownRemark":{"id":"95969360-05d8-5caa-93e0-31337e8487f7","frontmatter":{"title":"How to use a Metasploit module appropriately","root":null},"html":"<p>As an user, one thing we love Metasploit the most is it allows something really technically difficult to understand or engineer into something really easy to use, literally within a few clicks away to make you look like <a href=\"http://en.wikipedia.org/wiki/Neo_(The_Matrix)\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Neo</a> from the Matrix. It makes hacking super easy. However, if you're new to Metasploit, know this: <a href=\"https://www.youtube.com/watch?v=3vlzKaH4mpw\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Nobody makes their first jump</a>. You are expected to make mistakes, sometimes small, sometimes catastrophic... hopefully not. You're very likely to fall on your face with your first exploit, just like Neo. Obviously, to become The One you must learn to use these modules appropriately, and we will teach you how.</p>\n<p>In this documentation, understand that we require you no exploit development knowledge. Some programming knowledge would be nice, of course. The whole point is that there is actually \"homework\" before using an exploit, and you should always do your homework.</p>\n<h2 id=\"loading-a-metasploit-module\" style=\"position:relative;\"><a href=\"#loading-a-metasploit-module\" aria-label=\"loading a metasploit module permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading a Metasploit module</h2>\n<p>Each Metasploit module comes with some metadata that explains what it's about, and to see that you must load it first. An example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf &gt; use exploit/windows/smb/ms08_067_netapi</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"read-the-module-description-and-references\" style=\"position:relative;\"><a href=\"#read-the-module-description-and-references\" aria-label=\"read the module description and references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Read the module description and references</h2>\n<p>This may sound surprising, but sometimes we get asked questions that are already explained in the module. You should always look for the following in the description or the references it provides before deciding whether it's appropriate to use the exploit or not:</p>\n<ul>\n<li><strong>What products and versions are vulnerable</strong>: This is the most basic thing you should know about a vulnerability.</li>\n<li><strong>What type of vulnerability and how it works</strong>: Basically, you are learning the exploit's side-effects. For example, if you're exploiting a memory corruption, if it fails due to whatever reason, you may crash the service. Even if it doesn't, when you're done with the shell and type \"exit\", it's still possible to crash it too. High level bugs are generally safer, but not 100%. For example, maybe it needs to modify a config file or install something that can cause the application to be broken, and may become permanent.</li>\n<li><strong>Which ones have been tested</strong>: When a module is developed, usually the exploit isn't tested against every single setup if there are too many. Usually the developers will just try to test whatever they can get their hands on. So if your target isn't mentioned here, keep in mind there is no guarantee it's going to work 100%. The safest thing to do is to actually recreate the environment your target has, and test the exploit before hitting the real thing.</li>\n<li><strong>What conditions the server must meet in order to be exploitable</strong>: Quite often, a vulnerability requires multiple conditions to be exploitable. In some cases you can rely on the exploit's <a href=\"https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-check%28%29-method\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">check command</a>, because when Metasploit flags something as vulnerable, it actually exploited the bug. For browser exploits using the BrowserExploitServer mixin, it will also check exploitable requirements before loading the exploit. But automation isn't always there, so you should try to find this information before running that \"exploit\" command. Sometimes it's just common sense, really. For example: a web application's file upload feature might be abused to upload a web-based backdoor, and stuff like that usually requires the upload folder to be accessible for the user. If your target doesn't meet the requirement(s), there is no point to try.</li>\n</ul>\n<p>You can use the info command to see the module's description:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms08_067_netapi) &gt; info</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"read-the-target-list\" style=\"position:relative;\"><a href=\"#read-the-target-list\" aria-label=\"read the target list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Read the target list</h2>\n<p>Every Metasploit exploit has a target list. Basically this is a list of setups the developers have tested before making the exploit publicly available. If your target machine isn't on the list, it's better to assume the exploit has never been tested on that particular setup.</p>\n<p>If the exploit supports automatic targeting, it is always the first item on the list (or index 0). The first item is also almost always the default target. What this means is that you should never assume the exploit will automatically select a target for you if you've never used it before, and that the default setup might not be the one you're testing against.</p>\n<p>The \"show options\" command will tell you which target is selected. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms08_067_netapi) &gt; show options</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>The \"show targets\" command will give you a list of targets supported:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms08_067_netapi) &gt; show targets</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"check-all-the-options\" style=\"position:relative;\"><a href=\"#check-all-the-options\" aria-label=\"check all the options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Check all the options</h2>\n<p>All Metasploit modules come with most datastore options pre-configured. However, they may not be suitable for the particular setup you're testing. To do a quick double-check, usually the \"show options\" command is enough:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms08_067_netapi) &gt; show options</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>However, \"show options\" only shows you all the basic options. It does not show you the evasive or advanced options (try \"show evasion\" and \"show advanced\"), the command you should use that shows you all the datastore options is actually the \"set\" command:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">msf exploit(ms08_067_netapi) &gt; set</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"find-the-modules-pull-request\" style=\"position:relative;\"><a href=\"#find-the-modules-pull-request\" aria-label=\"find the modules pull request permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Find the module's pull request</h2>\n<p>The Metasploit repository is hosted on Github (duh... you're on it right now), and the developers/contributors rely on it heavily for development. Before a module is made public, it is submitted as a <a href=\"https://help.github.com/articles/using-pull-requests/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pull request</a> for final testing and review. In there, you will find pretty much everything you need to know about the module, and probably things you won't learn from reading the module's description or some random blog post. The information is like gold, really.</p>\n<p>Things you might learn from reading a pull request:</p>\n<ul>\n<li>Steps on how to set up the vulnerable environment.</li>\n<li>What targets were actually tested.</li>\n<li>How the module is meant to be used.</li>\n<li>How the module was verified.</li>\n<li>What problems were identified. Problems you might want to know.</li>\n<li>Demonstrations.</li>\n<li>Other surprises.</li>\n</ul>\n<p>There are mainly two ways to find the pull request of the module you're using:</p>\n<ul>\n<li><strong>Via the pull request number</strong>: If you actually know the pull request number, this is the easiest. Simply go:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">https://github.com/rapid7/metasploit-framework/pull/[PULL REQUEST NUMBER HERE]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li><strong>Via filters</strong>: This is most likely how you find the pull request. First off, you should go here: <a href=\"https://github.com/rapid7/metasploit-framework/pulls\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/rapid7/metasploit-framework/pulls</a>. At the top, you will see a search input box with the default filters: <code class=\"language-text\">is:pr is:open</code>. These default ones mean you're looking at pull requests, and you're looking at the ones that are still pending - still waiting to be merged to Metasploit. Well, since you're finding the one that's already merged, you should do these:</li>\n<li>Click on \"Closed\".</li>\n<li>Select label \"module\".</li>\n<li>In the search box, enter additional keywords related to the module. The module's title probably provides the best keywords.</li>\n</ul>\n<p>Note: If the module was written before Nov 2011, you WILL NOT find the pull request for it.</p>"}},"pageContext":{"id":"95969360-05d8-5caa-93e0-31337e8487f7"}}}