{"componentChunkName":"component---src-templates-wiki-template-tsx","path":"/wiki/Misc/Exploit-Ranking","result":{"data":{"markdownRemark":{"id":"aeba51ad-fb71-55d9-b153-963614128f64","frontmatter":{"title":"Exploit Ranking","root":null},"html":"<p>Every exploit module has been assigned a rank based on its potential impact to the target system. Users can search, categorize, and prioritize exploits based on rankings.</p>\n<p>The ranking is implemented by adding a <code class=\"language-text\">Rank</code> constant at the top of the class declaration in a module:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MetasploitModule</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">Msf</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Exploit</span>\n    <span class=\"token constant\">Rank</span> <span class=\"token operator\">=</span> <span class=\"token constant\">LowRanking</span>\n    <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">initialize</span></span><span class=\"token punctuation\">(</span>info<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">end</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The ranking values are one of the following, in descending order of reliability:</p>\n<table>\n<thead>\n<tr>\n<th>Ranking</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ExcellentRanking</strong></td>\n<td>The exploit will never crash the service. This is the case for SQL Injection, CMD execution, RFI, LFI, etc. No typical memory corruption exploits should be given this ranking unless there are extraordinary circumstances (<a href=\"https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/browser/ms06_001_wmf_setabortproc.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WMF Escape()</a>).</td>\n</tr>\n<tr>\n<td><strong>GreatRanking</strong></td>\n<td>The exploit has a default target AND either auto-detects the appropriate target or uses an application-specific return address AFTER a version check.</td>\n</tr>\n<tr>\n<td><strong>GoodRanking</strong></td>\n<td>The exploit has a default target and it is the \"common case\" for this type of software (English, Windows 7 for a desktop app, 2012 for server, etc).</td>\n</tr>\n<tr>\n<td><strong>NormalRanking</strong></td>\n<td>The exploit is otherwise reliable, but depends on a specific version and can't (or doesn't) reliably autodetect.</td>\n</tr>\n<tr>\n<td><strong>AverageRanking</strong></td>\n<td>The exploit is generally unreliable or difficult to exploit.</td>\n</tr>\n<tr>\n<td><strong>LowRanking</strong></td>\n<td>The exploit is nearly impossible to exploit (or under 50% success rate) for common platforms.</td>\n</tr>\n<tr>\n<td><strong>ManualRanking</strong></td>\n<td>The exploit is unstable or difficult to exploit and is basically a DoS. This ranking is also used when the module has no use unless specifically configured by the user (e.g.: <a href=\"https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/php_eval.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">exploit/unix/webapp/php_eval</a>).</td>\n</tr>\n</tbody>\n</table>\n<p>The ranking value is available the module Class object as well as instances:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">modcls <span class=\"token operator\">=</span> framework<span class=\"token punctuation\">.</span>exploits<span class=\"token punctuation\">[</span><span class=\"token string\">\"windows/browser/ie_createobject\"</span><span class=\"token punctuation\">]</span>\nmodcls<span class=\"token punctuation\">.</span>rank      <span class=\"token comment\"># => 600</span>\nmodcls<span class=\"token punctuation\">.</span>rank_to_s <span class=\"token comment\"># => \"excellent\"</span>\n\nmod <span class=\"token operator\">=</span> modcls<span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\nmod<span class=\"token punctuation\">.</span>rank      <span class=\"token comment\"># => 600</span>\nmod<span class=\"token punctuation\">.</span>rank_to_s <span class=\"token comment\"># => \"excellent\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>"}},"pageContext":{"id":"aeba51ad-fb71-55d9-b153-963614128f64"}}}